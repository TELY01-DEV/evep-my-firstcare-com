<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EVEP Mobile Reflection Unit - Complete Clinical Pathway</title>
    <style>
        @media print {
            body { margin: 0; padding: 20px; }
            .page-break { page-break-before: always; }
            .no-break { page-break-inside: avoid; }
        }
        
        body {
            font-family: 'Arial', sans-serif;
            line-height: 1.6;
            color: #333;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: white;
        }
        
        .header {
            text-align: center;
            border-bottom: 3px solid #2c3e50;
            padding-bottom: 20px;
            margin-bottom: 30px;
        }
        
        .header h1 {
            color: #2c3e50;
            margin: 0;
            font-size: 28px;
        }
        
        .header h2 {
            color: #7f8c8d;
            margin: 10px 0 0 0;
            font-size: 18px;
        }
        
        .flowchart {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        
        .step {
            border: 2px solid #3498db;
            border-radius: 10px;
            padding: 15px;
            margin: 10px 0;
            background: linear-gradient(135deg, #ecf0f1 0%, #bdc3c7 100%);
            position: relative;
        }
        
        .step-header {
            background: #3498db;
            color: white;
            padding: 10px 15px;
            margin: -15px -15px 15px -15px;
            border-radius: 8px 8px 0 0;
            font-weight: bold;
            font-size: 16px;
        }
        
        .step-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }
        
        .step-description {
            grid-column: 1 / -1;
            background: white;
            padding: 15px;
            border-radius: 8px;
            border-left: 4px solid #3498db;
        }
        
        .sub-step {
            background: white;
            padding: 12px;
            border-radius: 6px;
            border: 1px solid #bdc3c7;
        }
        
        .sub-step h4 {
            color: #2c3e50;
            margin: 0 0 10px 0;
            font-size: 14px;
        }
        
        .sub-step ul {
            margin: 0;
            padding-left: 20px;
        }
        
        .sub-step li {
            margin: 5px 0;
            font-size: 12px;
        }
        
        .decision-point {
            background: linear-gradient(135deg, #f39c12 0%, #e67e22 100%);
            border-color: #f39c12;
        }
        
        .decision-point .step-header {
            background: #f39c12;
        }
        
        .decision-point .step-description {
            border-left-color: #f39c12;
        }
        
        .arrow {
            text-align: center;
            font-size: 24px;
            color: #3498db;
            margin: 10px 0;
        }
        
        .pathway {
            display: flex;
            gap: 20px;
            margin: 15px 0;
        }
        
        .pathway-item {
            flex: 1;
            background: white;
            padding: 12px;
            border-radius: 6px;
            border: 1px solid #bdc3c7;
            text-align: center;
        }
        
        .pathway-item h4 {
            color: #2c3e50;
            margin: 0 0 8px 0;
            font-size: 13px;
        }
        
        .pathway-item ul {
            margin: 0;
            padding-left: 15px;
            text-align: left;
        }
        
        .pathway-item li {
            margin: 3px 0;
            font-size: 11px;
        }
        
        .legend {
            background: #ecf0f1;
            padding: 15px;
            border-radius: 8px;
            margin: 20px 0;
            border: 1px solid #bdc3c7;
        }
        
        .legend h3 {
            margin: 0 0 10px 0;
            color: #2c3e50;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            margin: 5px 0;
        }
        
        .legend-color {
            width: 20px;
            height: 20px;
            border-radius: 4px;
            margin-right: 10px;
        }
        
        .legend-color.blue { background: #3498db; }
        .legend-color.orange { background: #f39c12; }
        .legend-color.green { background: #27ae60; }
        .legend-color.red { background: #e74c3c; }
        .legend-color.purple { background: #8e44ad; }
        
        .footer {
            text-align: center;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid #bdc3c7;
            color: #7f8c8d;
            font-size: 12px;
        }
        
        @media print {
            .step { break-inside: avoid; }
            .pathway { break-inside: avoid; }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>EVEP Mobile Reflection Unit</h1>
        <h2>Complete Clinical Pathway Flowchart</h2>
        <p><strong>School-based Screening Workflow: Teacher Login → Student Selection → Screening → Save Outcome</strong></p>
        <p><strong>Hospital Mobile Unit Workflow: Appointment Schedule → Parent Consent → Student Registration → VA Screening → Glasses Selection → Inventory Check → School Delivery</strong></p>
        <p><strong>Implementation Status: ✅ Complete | Version: 2.1 | Last Updated: August 30, 2024</strong></p>
    </div>

    <div class="legend">
        <h3>Flowchart Legend</h3>
        <div class="legend-item">
            <div class="legend-color blue"></div>
            <span>Standard Process Steps</span>
        </div>
        <div class="legend-item">
            <div class="legend-color orange"></div>
            <span>Decision Points</span>
        </div>
        <div class="legend-item">
            <div class="legend-color green"></div>
            <span>Normal Outcomes</span>
        </div>
        <div class="legend-item">
            <div class="legend-color red"></div>
            <span>Abnormal Outcomes</span>
        </div>
        <div class="legend-item">
            <div class="legend-color purple"></div>
            <span>API Endpoints Available</span>
        </div>
    </div>

    <div class="flowchart">
        <!-- Phase 1: School-based Screening Management System -->
        <div class="step no-break" style="border-color: #27ae60; background: linear-gradient(135deg, #eafaf1 0%, #d5f4e6 100%);">
            <div class="step-header" style="background: #27ae60;">Phase 1: School-based Screening Management System</div>
            <div class="step-description">
                <strong>Purpose:</strong> School-based screening workflow where teachers conduct initial screenings and save outcomes to the system.
            </div>
            <div class="step-content">
                <div class="sub-step" style="background: #d5f4e6; border-left-color: #27ae60;">
                    <h4>System Relationships</h4>
                    <ul>
                        <li>Teacher belongs to School</li>
                        <li>Student belongs to Teacher</li>
                        <li>Parent has relationship with Student</li>
                        <li>School-based screening outcomes stored</li>
                    </ul>
                </div>
                <div class="sub-step" style="background: #d5f4e6; border-left-color: #27ae60;">
                    <h4>Teacher Workflow</h4>
                    <ul>
                        <li>Teacher login to system</li>
                        <li>Select Student from class list</li>
                        <li>Conduct screening assessment</li>
                        <li>Save screening outcome to system</li>
                        <li>Generate screening reports</li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="arrow">↓</div>

        <!-- Phase 2: Hospital Mobile Unit Appointment & Consent -->
        <div class="step no-break" style="border-color: #8e44ad; background: linear-gradient(135deg, #f4f1f8 0%, #e8d5f7 100%);">
            <div class="step-header" style="background: #8e44ad;">Phase 2: Hospital Mobile Unit - Appointment & Consent - API: POST /mobile-screening/appointments</div>
            <div class="step-description">
                <strong>Purpose:</strong> Hospital staff schedule appointments and obtain parent consent through LINE BOT.
                <br><strong>API Endpoint:</strong> <code>POST /api/v1/mobile-screening/appointments</code>
            </div>
            <div class="step-content">
                <div class="sub-step">
                    <h4>Hospital Staff Actions</h4>
                    <ul>
                        <li>Create appointment schedule</li>
                        <li>Send schedule to school</li>
                        <li>Prepare notification letters</li>
                        <li>Prepare consent documents</li>
                        <li>Set up LINE BOT integration</li>
                    </ul>
                </div>
                <div class="sub-step">
                    <h4>Teacher & Parent Communication</h4>
                    <ul>
                        <li>Teacher sends notification letter</li>
                        <li>Teacher sends consent document</li>
                        <li>LINE BOT delivers soft copy documents</li>
                        <li>Parents accept with consent</li>
                        <li>Consent confirmation received</li>
                    </ul>
                </div>
                <div class="sub-step">
                    <h4>Student List Generation</h4>
                    <ul>
                        <li>List all students with parent consent</li>
                        <li>Include school-based screening outcomes</li>
                        <li>Prioritize based on screening results</li>
                        <li>Generate appointment schedule</li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="arrow">↓</div>

        <!-- Phase 3: Mobile Reflection Unit Screening Day -->
        <div class="step no-break" style="border-color: #8e44ad; background: linear-gradient(135deg, #f4f1f8 0%, #e8d5f7 100%);">
            <div class="step-header" style="background: #8e44ad;">Phase 3: Mobile Reflection Unit Screening Day - API: POST /mobile-screening/screening-session</div>
            <div class="step-description">
                <strong>Purpose:</strong> Medical staff conduct comprehensive screening and diagnosis on scheduled screening day.
                <br><strong>API Endpoint:</strong> <code>POST /api/v1/mobile-screening/screening-session</code>
            </div>
            
            <div class="step-content">
                <div class="sub-step">
                    <h4>Step 1: Student Registration (Admit as Patient)</h4>
                    <ul>
                        <li>Medical staff register student to system</li>
                        <li>Verify student identity and consent</li>
                        <li>Review school-based screening outcomes</li>
                        <li>Create patient record</li>
                        <li>Assign patient ID</li>
                    </ul>
                </div>
                <div class="sub-step">
                    <h4>Step 2: VA Screening and Diagnosis Flow</h4>
                    <ul>
                        <li>Conduct comprehensive vision assessment</li>
                        <li>Auto-refractor measurements</li>
                        <li>Manual vision testing</li>
                        <li>Eye abnormality assessment</li>
                        <li>Generate diagnosis results</li>
                    </ul>
                </div>
                <div class="sub-step">
                    <h4>Step 3: Outcome Classification</h4>
                    <ul>
                        <li>Normal patients: Screening complete</li>
                        <li>Abnormal patients: Select glasses option</li>
                        <li>Document screening outcomes</li>
                        <li>Generate patient reports</li>
                    </ul>
                </div>
                <div class="sub-step">
                    <h4>Step 4: Glasses Selection Process</h4>
                    <ul>
                        <li>Check glasses inventory</li>
                        <li>Select appropriate frames</li>
                        <li>Verify prescription accuracy</li>
                        <li>Create glasses order</li>
                    </ul>
                </div>
            </div>
                        <li>Eyelid, conjunctiva, cornea assessment</li>
                        <li>Pupil response testing</li>
                        <li>Ocular motility testing</li>
                        <li>Color vision testing (Ishihara)</li>
                        <li>Depth perception testing</li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="arrow">↓</div>

        <!-- Phase 4: Glasses Delivery to School -->
        <div class="step no-break" style="border-color: #8e44ad; background: linear-gradient(135deg, #f4f1f8 0%, #e8d5f7 100%);">
            <div class="step-header" style="background: #8e44ad;">Phase 4: Glasses Delivery to School - API: POST /mobile-screening/delivery</div>
            <div class="step-description">
                <strong>Purpose:</strong> Deliver glasses to patients at school after 14 days from screening.
                <br><strong>API Endpoint:</strong> <code>POST /api/v1/mobile-screening/delivery</code>
            </div>
            <div class="step-content">
                <div class="sub-step">
                    <h4>Delivery Preparation</h4>
                    <ul>
                        <li>Manufacturing completion verification</li>
                        <li>Quality control check</li>
                        <li>Packaging and labeling</li>
                        <li>Delivery schedule coordination</li>
                        <li>School notification</li>
                    </ul>
                </div>
                <div class="sub-step">
                    <h4>School Delivery Process</h4>
                    <ul>
                        <li>14-day delivery timeline</li>
                        <li>Deliver to school location</li>
                        <li>Patient verification at school</li>
                        <li>Glasses fitting and adjustment</li>
                        <li>Delivery confirmation</li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="arrow">↓</div>

        <!-- Phase 5: Follow-up & Monitoring -->
        <div class="step no-break" style="border-color: #8e44ad; background: linear-gradient(135deg, #f4f1f8 0%, #e8d5f7 100%);">
            <div class="step-header" style="background: #8e44ad;">Phase 5: Follow-up & Monitoring - API: GET /mobile-screening/statistics</div>
            <div class="step-description">
                <strong>Purpose:</strong> Monitor patient progress and ensure continued quality of care.
                <br><strong>API Endpoint:</strong> <code>GET /api/v1/mobile-screening/statistics</code>
            </div>
        <div class="step decision-point no-break" style="border-color: #8e44ad;">
            <div class="step-header" style="background: #8e44ad;">Step 3: Assessment Outcomes & Decision Points - API: POST /mobile-screening/clinical-decisions</div>
            <div class="step-description">
                <strong>Purpose:</strong> Analyze assessment results and determine next steps in clinical pathway.
                <br><strong>API Endpoint:</strong> <code>POST /api/v1/mobile-screening/clinical-decisions</code>
            </div>
            <div class="step-content">
                <div class="sub-step" style="background: #d5f4e6; border-left-color: #27ae60;">
                    <h4>Normal Results (ปกติ)</h4>
                    <ul>
                        <li>All assessments within normal ranges</li>
                        <li>Distance vision 20/20 or better</li>
                        <li>Near vision N8 or better</li>
                        <li>No eye abnormalities detected</li>
                        <li>Normal color vision and depth perception</li>
                        <li><strong>Action:</strong> Return to classroom with advice</li>
                        <li><strong>Follow-up:</strong> Annual screening recommended</li>
                    </ul>
                </div>
                <div class="sub-step" style="background: #fadbd8; border-left-color: #e74c3c;">
                    <h4>Abnormal Results (ผิดปกติ)</h4>
                    <ul>
                        <li>Any measurement outside normal range</li>
                        <li>Vision below 20/30 in either eye</li>
                        <li>Presence of eye abnormalities</li>
                        <li>Color vision deficiency detected</li>
                        <li>Depth perception impairment</li>
                        <li><strong>Action:</strong> Proceed to detailed eye measurement</li>
                        <li><strong>Follow-up:</strong> Based on findings</li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="arrow">↓</div>

        <!-- Step 4: Detailed Eye Measurement -->
        <div class="step no-break" style="border-color: #8e44ad; background: linear-gradient(135deg, #f4f1f8 0%, #e8d5f7 100%);">
            <div class="step-header" style="background: #8e44ad;">Step 4: Detailed Eye Measurement (วัดสายตา) - API: POST /mobile-screening/glasses-prescriptions</div>
            <div class="step-description">
                <strong>Purpose:</strong> Conduct comprehensive evaluation for patients with abnormal initial assessments.
                <br><strong>API Endpoint:</strong> <code>POST /api/v1/mobile-screening/glasses-prescriptions</code>
            </div>
            <div class="step-content">
                <div class="sub-step" style="background: #fadbd8; border-left-color: #e74c3c;">
                    <h4>Category 4A: Eye Disease or Other Abnormality<br>(มีโรคตาหรือความผิดปกติอื่น)</h4>
                    <ul>
                        <li>Cataracts detection</li>
                        <li>Glaucoma screening</li>
                        <li>Retinal disorders assessment</li>
                        <li>Corneal abnormalities</li>
                        <li>Strabismus evaluation</li>
                        <li>Amblyopia detection</li>
                        <li><strong>Action:</strong> Refer according to rights/eligibility</li>
                        <li><strong>Documentation:</strong> Medical referral form</li>
                    </ul>
                </div>
                <div class="sub-step" style="background: #fef9e7; border-left-color: #f39c12;">
                    <h4>Category 4B: Vision Abnormality Only<br>(มีเพียงความผิดปกติทางสายตา)</h4>
                    <ul>
                        <li>Myopia (nearsightedness)</li>
                        <li>Hyperopia (farsightedness)</li>
                        <li>Astigmatism</li>
                        <li>Presbyopia</li>
                        <li>Severity classification (mild/moderate/severe)</li>
                        <li><strong>Action:</strong> Proceed to glasses prescription</li>
                        <li><strong>Documentation:</strong> Refractive error assessment</li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="arrow">↓</div>

        <!-- Step 5: Glasses Prescription Process -->
        <div class="step no-break" style="border-color: #8e44ad; background: linear-gradient(135deg, #f4f1f8 0%, #e8d5f7 100%);">
            <div class="step-header" style="background: #8e44ad;">Step 5: Glasses Prescription Process - API: POST /mobile-screening/manufacturing-orders</div>
            <div class="step-description">
                <strong>Purpose:</strong> Create accurate glasses prescription and select appropriate frames for patients requiring vision correction.
                <br><strong>API Endpoint:</strong> <code>POST /api/v1/mobile-screening/manufacturing-orders</code>
            </div>
            <div class="step-content">
                <div class="sub-step">
                    <h4>Frame Selection (เลือกกรอบแว่น)</h4>
                    <ul>
                        <li>Frame size selection (small/medium/large)</li>
                        <li>Face measurements (bridge width, temple length)</li>
                        <li>Frame material selection</li>
                        <li>Lens type (single vision/bifocal/progressive)</li>
                        <li>Lens coating options</li>
                        <li>Patient style preferences</li>
                    </ul>
                </div>
                <div class="sub-step">
                    <h4>Parameter Measurement (วัดค่าพารามิเตอร์)</h4>
                    <ul>
                        <li>Final prescription calculation</li>
                        <li>Left/Right eye sphere, cylinder, axis</li>
                        <li>Pupillary distance (PD)</li>
                        <li>Interpupillary distance (IPD)</li>
                        <li>Vertex distance measurement</li>
                        <li>Pantoscopic tilt measurement</li>
                        <li>Lens material specification</li>
                        <li>Lens thickness calculation</li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="arrow">↓</div>

        <!-- Step 6: Inventory Management -->
        <div class="step no-break" style="border-color: #8e44ad; background: linear-gradient(135deg, #f4f1f8 0%, #e8d5f7 100%);">
            <div class="step-header" style="background: #8e44ad;">Step 6: Inventory Management - API: POST /mobile-screening/inventory</div>
            <div class="step-description">
                <strong>Purpose:</strong> Manage glasses inventory, track stock levels, and coordinate manufacturing orders.
                <br><strong>API Endpoint:</strong> <code>POST /api/v1/mobile-screening/inventory</code>
            </div>
            <div class="step-content">
                <div class="sub-step">
                    <h4>Inventory Check & Stock Management</h4>
                    <ul>
                        <li>Check available frame sizes and types</li>
                        <li>Verify lens materials and prescriptions</li>
                        <li>Stock level monitoring</li>
                        <li>Reorder point alerts</li>
                        <li>Inventory forecasting</li>
                        <li>Supplier coordination</li>
                    </ul>
                </div>
                <div class="sub-step">
                    <h4>Manufacturing Order Processing</h4>
                    <ul>
                        <li>Create manufacturing orders</li>
                        <li>Track order status</li>
                        <li>Quality control verification</li>
                        <li>Shipping coordination</li>
                        <li>Delivery scheduling</li>
                        <li>Order timeline tracking</li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="arrow">↓</div>

        <!-- Step 7: Glasses Distribution & Patient Delivery -->
        <div class="step no-break" style="border-color: #8e44ad; background: linear-gradient(135deg, #f4f1f8 0%, #e8d5f7 100%);">
            <div class="step-header" style="background: #8e44ad;">Step 7: Glasses Distribution & Patient Delivery - API: POST /mobile-screening/follow-up-sessions</div>
            <div class="step-description">
                <strong>Purpose:</strong> Distribute glasses to patients and ensure proper fitting and delivery of vision correction.
                <br><strong>API Endpoint:</strong> <code>POST /api/v1/mobile-screening/follow-up-sessions</code>
            </div>
            <div class="step-content">
                <div class="sub-step">
                    <h4>Glasses Distribution</h4>
                    <ul>
                        <li>Receive manufactured glasses</li>
                        <li>Quality verification check</li>
                        <li>Patient fitting appointment</li>
                        <li>Glasses adjustment if needed</li>
                        <li>Frame size verification</li>
                        <li><strong>Timeline:</strong> Immediate upon receipt</li>
                    </ul>
                </div>
                <div class="sub-step">
                    <h4>Patient Delivery & Fitting</h4>
                    <ul>
                        <li>Coordinate with school administration</li>
                        <li>Schedule patient pickup</li>
                        <li>Verify patient identity</li>
                        <li>Hand over glasses to patient</li>
                        <li>Initial fitting and adjustments</li>
                        <li>Care instructions provided</li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="arrow">↓</div>

        <!-- Step 8: Delivery Tracking & Status Monitoring -->
        <div class="step no-break" style="border-color: #8e44ad; background: linear-gradient(135deg, #f4f1f8 0%, #e8d5f7 100%);">
            <div class="step-header" style="background: #8e44ad;">Step 8: Delivery Tracking & Status Monitoring - API: POST /mobile-screening/delivery-tracking</div>
            <div class="step-description">
                <strong>Purpose:</strong> Track delivery status, monitor patient receipt, and ensure successful glasses distribution.
                <br><strong>API Endpoint:</strong> <code>POST /api/v1/mobile-screening/delivery-tracking</code>
            </div>
            <div class="step-content">
                <div class="sub-step">
                    <h4>Delivery Status Tracking</h4>
                    <ul>
                        <li>Real-time delivery tracking</li>
                        <li>Delivery confirmation</li>
                        <li>Patient receipt verification</li>
                        <li>Delivery timeline monitoring</li>
                        <li>Exception handling</li>
                        <li>Status notifications</li>
                    </ul>
                </div>
                <div class="sub-step">
                    <h4>Quality Assurance & Feedback</h4>
                    <ul>
                        <li>Patient satisfaction survey</li>
                        <li>Glasses fitting verification</li>
                        <li>Quality feedback collection</li>
                        <li>Issue resolution tracking</li>
                        <li>Follow-up scheduling</li>
                        <li>Performance metrics</li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="arrow">↓</div>

        <!-- Step 9: Follow-up & Monitoring -->
        <div class="step no-break" style="border-color: #8e44ad; background: linear-gradient(135deg, #f4f1f8 0%, #e8d5f7 100%);">
            <div class="step-header" style="background: #8e44ad;">Step 9: Follow-up & Monitoring - API: GET /mobile-screening/statistics</div>
            <div class="step-description">
                <strong>Purpose:</strong> Monitor patient progress and ensure continued quality of care.
                <br><strong>API Endpoint:</strong> <code>GET /api/v1/mobile-screening/statistics</code>
            </div>
            <div class="step-content">
                <div class="sub-step">
                    <h4>6-Month Follow-up Assessment</h4>
                    <ul>
                        <li>Vision improvement evaluation</li>
                        <li>Glasses compliance assessment</li>
                        <li>Academic impact monitoring</li>
                        <li>Comfort and fit evaluation</li>
                        <li>Adjustment recommendations</li>
                        <li>Progress documentation</li>
                    </ul>
                </div>
                <div class="sub-step">
                    <h4>Annual Screening & Communication</h4>
                    <ul>
                        <li>Routine vision check</li>
                        <li>Prescription updates</li>
                        <li>Eye health monitoring</li>
                        <li>Parent communication</li>
                        <li>Progress updates</li>
                        <li>Academic impact tracking</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <!-- Complete Workflow API Section -->
    <div class="step no-break" style="border-color: #27ae60; background: linear-gradient(135deg, #eafaf1 0%, #d5f4e6 100%); margin-top: 30px;">
        <div class="step-header" style="background: #27ae60;">Complete Workflow API - POST /mobile-screening/complete-workflow</div>
        <div class="step-description">
            <strong>Purpose:</strong> Execute the entire mobile screening workflow in a single API call.
            <br><strong>API Endpoint:</strong> <code>POST /api/v1/mobile-screening/complete-workflow</code>
            <br><strong>Features:</strong> Creates all workflow steps automatically with proper data validation and relationships.
        </div>
        <div class="step-content">
            <div class="sub-step" style="background: #d5f4e6; border-left-color: #27ae60;">
                <h4>Input Parameters</h4>
                <ul>
                    <li>school_screening_data: School-based screening outcomes</li>
                    <li>appointment_data: Hospital appointment schedule</li>
                    <li>consent_data: Parent consent information</li>
                    <li>screening_session_data: Mobile unit screening session</li>
                    <li>glasses_selection_data: Glasses selection and inventory</li>
                    <li>delivery_data: School delivery information</li>
                    <li>followup_data: Follow-up monitoring (optional)</li>
                </ul>
            </div>
            <div class="sub-step" style="background: #d5f4e6; border-left-color: #27ae60;">
                <h4>Output Response</h4>
                <ul>
                    <li>Complete workflow with all IDs</li>
                    <li>Success status and message</li>
                    <li>All created records</li>
                    <li>Data validation results</li>
                </ul>
            </div>
        </div>
    </div>

    <!-- Additional API Endpoints Section -->
    <div class="step no-break" style="border-color: #f39c12; background: linear-gradient(135deg, #fef9e7 0%, #fdeaa7 100%); margin-top: 30px;">
        <div class="step-header" style="background: #f39c12;">Additional API Endpoints</div>
        <div class="step-description">
            <strong>Purpose:</strong> Additional endpoints for data retrieval, statistics, and patient workflow management.
        </div>
        <div class="step-content">
            <div class="sub-step" style="background: #fef9e7; border-left-color: #f39c12;">
                <h4>Data Retrieval Endpoints</h4>
                <ul>
                    <li><code>GET /mobile-screening/school-screening/{id}</code> - Get school screening data</li>
                    <li><code>GET /mobile-screening/appointments/{id}</code> - Get appointment details</li>
                    <li><code>GET /mobile-screening/consent/{id}</code> - Get consent information</li>
                    <li><code>GET /mobile-screening/screening-session/{id}</code> - Get screening session</li>
                    <li><code>GET /mobile-screening/delivery/status/{id}</code> - Get delivery status</li>
                </ul>
            </div>
            <div class="sub-step" style="background: #fef9e7; border-left-color: #f39c12;">
                <h4>Analytics Endpoints</h4>
                <ul>
                    <li><code>GET /mobile-screening/statistics</code> - Get screening statistics</li>
                    <li>School-based screening outcomes</li>
                    <li>Appointment scheduling analytics</li>
                    <li>Consent rate tracking</li>
                    <li>Mobile unit screening results</li>
                    <li>Delivery success metrics</li>
                    <li>Patient satisfaction scores</li>
                </ul>
            </div>
        </div>
    </div>

    <!-- Inventory & Delivery Management Section -->
    <div class="step no-break" style="border-color: #e67e22; background: linear-gradient(135deg, #fdf2e9 0%, #fad7a0 100%); margin-top: 30px;">
        <div class="step-header" style="background: #e67e22;">Inventory & Delivery Management System</div>
        <div class="step-description">
            <strong>Purpose:</strong> Comprehensive inventory management and delivery tracking system for glasses distribution.
        </div>
        <div class="step-content">
            <div class="sub-step" style="background: #fdf2e9; border-left-color: #e67e22;">
                <h4>Inventory Management Features</h4>
                <ul>
                    <li><code>POST /mobile-screening/inventory</code> - Create inventory records</li>
                    <li><code>GET /mobile-screening/inventory/status</code> - Check stock levels</li>
                    <li><code>PUT /mobile-screening/inventory/{id}</code> - Update inventory</li>
                    <li>Stock level monitoring</li>
                    <li>Reorder point alerts</li>
                    <li>Supplier management</li>
                </ul>
            </div>
            <div class="sub-step" style="background: #fdf2e9; border-left-color: #e67e22;">
                <h4>Delivery Tracking Features</h4>
                <ul>
                    <li><code>POST /mobile-screening/delivery-tracking</code> - Create tracking records</li>
                    <li><code>GET /mobile-screening/delivery/status/{id}</code> - Track delivery status</li>
                    <li><code>PUT /mobile-screening/delivery/update/{id}</code> - Update delivery status</li>
                    <li>Real-time tracking</li>
                    <li>Status notifications</li>
                    <li>Delivery confirmation</li>
                </ul>
            </div>
        </div>
    </div>

    <div class="footer">
        <p><strong>EVEP Platform - Mobile Reflection Unit Clinical Workflow</strong></p>
        <p>Document Version: 2.1 | Last Updated: August 30, 2024 | Next Review: November 2024</p>
        <p>This flowchart represents the complete clinical pathway for mobile vision screening and glasses prescription services.</p>
        <p><strong>Implementation Status: ✅ Complete | All API Endpoints Available | Ready for Production</strong></p>
    </div>
</body>
</html>
