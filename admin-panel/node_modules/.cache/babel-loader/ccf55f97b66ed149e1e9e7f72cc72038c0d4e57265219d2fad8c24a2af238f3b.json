{"ast":null,"code":"import _objectSpread from\"/Users/kitkamon/Cursor/evep-my-firstcare-com/admin-panel/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect,useRef}from'react';import{Box,Button,Dialog,DialogTitle,DialogContent,DialogActions,TextField,Typography,Alert,Chip,IconButton,Grid,Paper,Table,TableBody,TableCell,TableContainer,TableHead,TableRow,List,ListItem,ListItemText,ListItemSecondaryAction,Divider,Tabs,Tab,Card,CardContent,CardActions,FormControl,InputLabel,Select,MenuItem,FormControlLabel,Switch,Accordion,AccordionSummary,AccordionDetails,CircularProgress,Menu,ListItemIcon}from'@mui/material';import{Add,Delete,Edit,Star,StarBorder,LinkOff,Assignment,Group,Image,Code,Palette,ViewModule,Refresh,Person,CloudUpload,ExpandMore,Lock,LockOpen,Close,Help,DragIndicator,Link,Visibility,Settings,Error as ErrorIcon}from'@mui/icons-material';import{getRichMenus,getRichMenuDetails,createRichMenu,uploadRichMenuImage,setDefaultRichMenu,assignRichMenuToUser,deleteRichMenu,changeRichMenuImage,validateRichMenu,autoCorrectRichMenu,getRichMenuAliases,deleteRichMenuAlias,createAliasesForRichMenu,fetchAndLinkAliases,getUnlinkedRichMenus,createRichMenuAlias,cleanupRichMenuAliases,updateRichMenuAlias}from'../../api';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";// LINE Standard Rich Menu Sizes\nconst LINE_RICH_MENU_SIZES={FULL:{width:2500,height:1686,label:'Full Size (2500 x 1686)'},HALF:{width:2500,height:843,label:'Half Size (2500 x 843)'}};const RichMenuManager=()=>{var _richMenuDetails$rich,_richMenuDetails$rich2,_richMenuDetails$rich3,_richMenuDetails$rich4,_richMenuDetails$rich5,_richMenuDetails$rich6,_richMenuDetails$rich7,_richMenuDetails$rich8,_richMenuDetails$rich11,_richMenuDetails$rich12,_richMenuDetails$rich13,_richMenuDetails$rich14,_richMenuDetails$rich15,_richMenuDetails$rich16,_richMenuDetails$rich17,_richMenuDetails$rich18,_richMenuDetails$rich19,_richMenuDetails$rich20,_richMenuDetails$rich21,_richMenuDetails$rich22,_richMenuDetails$rich23,_richMenuDetails$rich24,_richMenuDetails$rich25,_editingButton$label,_editingHotspot$label;const[richMenus,setRichMenus]=useState([]);const[richMenuAliases,setRichMenuAliases]=useState([]);const[loading,setLoading]=useState(false);const[error,setError]=useState(null);const[success,setSuccess]=useState(null);// Dialog states\nconst[assignDialogOpen,setAssignDialogOpen]=useState(false);const[selectedRichMenu,setSelectedRichMenu]=useState(null);const[userId,setUserId]=useState('');const[assigning,setAssigning]=useState(false);// Rich Menu Size Selection\nconst[selectedRichMenuSize,setSelectedRichMenuSize]=useState('FULL');// Validate rich menu alias ID format\nconst validateRichMenuAliasId=aliasId=>{if(!aliasId||aliasId.length===0)return false;if(aliasId.length>40)return false;// Only allow alphanumeric characters and hyphens\nreturn /^[a-zA-Z0-9-]+$/.test(aliasId);};// Handle rich menu size change\nconst handleRichMenuSizeChange=newSize=>{setSelectedRichMenuSize(newSize);// If we have a background image, recalculate canvas dimensions\nif(backgroundImageFile&&canvasImage){const img=canvasImage;const canvas=canvasRef.current;if(canvas){// Get the selected rich menu size\nconst selectedSize=LINE_RICH_MENU_SIZES[newSize];const targetWidth=selectedSize.width;const targetHeight=selectedSize.height;const targetAspectRatio=targetWidth/targetHeight;// Calculate canvas dimensions to maintain the target aspect ratio\nconst maxCanvasWidth=800;const maxCanvasHeight=600;let canvasWidth,canvasHeight;// Calculate canvas size to fit within max dimensions while maintaining target aspect ratio\nif(targetAspectRatio>maxCanvasWidth/maxCanvasHeight){// Width is the limiting factor\ncanvasWidth=maxCanvasWidth;canvasHeight=maxCanvasWidth/targetAspectRatio;}else{// Height is the limiting factor\ncanvasHeight=maxCanvasHeight;canvasWidth=maxCanvasHeight*targetAspectRatio;}// Set canvas to calculated dimensions\ncanvas.width=canvasWidth;canvas.height=canvasHeight;// Calculate scale to fit image within canvas while maintaining aspect ratio\nconst scaleX=canvasWidth/img.width;const scaleY=canvasHeight/img.height;const scale=Math.min(scaleX,scaleY);// Calculate the actual dimensions the image will be drawn at\nconst drawnWidth=img.width*scale;const drawnHeight=img.height*scale;// Calculate centering offsets\nconst offsetX=(canvasWidth-drawnWidth)/2;const offsetY=(canvasHeight-drawnHeight)/2;// Store all the positioning data for consistent use\ncanvas.dataset.scale=scale.toString();canvas.dataset.drawnWidth=drawnWidth.toString();canvas.dataset.drawnHeight=drawnHeight.toString();canvas.dataset.offsetX=offsetX.toString();canvas.dataset.offsetY=offsetY.toString();canvas.dataset.imageWidth=img.width.toString();canvas.dataset.imageHeight=img.height.toString();console.log('Canvas updated for new rich menu size:',selectedSize.label);console.log('New canvas dimensions:',canvasWidth,'x',canvasHeight);// Redraw the canvas\nscheduleCanvasRender();}}};// Create Alias Dialog State\nconst[createAliasDialogOpen,setCreateAliasDialogOpen]=useState(false);const[unlinkedRichMenus,setUnlinkedRichMenus]=useState([]);const[selectedUnlinkedRichMenu,setSelectedUnlinkedRichMenu]=useState(null);const[aliasId,setAliasId]=useState('');const[creatingAlias,setCreatingAlias]=useState(false);// Update Alias Dialog State\nconst[updateAliasDialogOpen,setUpdateAliasDialogOpen]=useState(false);const[selectedAliasForUpdate,setSelectedAliasForUpdate]=useState(null);const[selectedRichMenuForUpdate,setSelectedRichMenuForUpdate]=useState(null);const[updatingAlias,setUpdatingAlias]=useState(false);// Rich Menu Details Dialog State\nconst[detailsDialogOpen,setDetailsDialogOpen]=useState(false);const[selectedRichMenuForDetails,setSelectedRichMenuForDetails]=useState(null);const[richMenuDetails,setRichMenuDetails]=useState(null);const[loadingDetails,setLoadingDetails]=useState(false);const[imageLoaded,setImageLoaded]=useState(false);const[imageDimensions,setImageDimensions]=useState({width:0,height:0});// Create rich menu states\nconst[createDialogOpen,setCreateDialogOpen]=useState(false);const[creating,setCreating]=useState(false);const[richMenuForm,setRichMenuForm]=useState({name:'',chatBarText:'Tap to open',displayByDefault:false,body:JSON.stringify({size:{width:2500,height:1686},selected:false,name:\"Rich Menu\",chatBarText:\"Tap to open\",areas:[{bounds:{x:0,y:0,width:2500,height:1686},action:{type:\"postback\",data:\"action=menu&item=main\"}}]},null,2)});// Upload image states\nconst[uploadDialogOpen,setUploadDialogOpen]=useState(false);const[uploadingImage,setUploadingImage]=useState(false);const[selectedFile,setSelectedFile]=useState(null);const[selectedRichMenuForUpload,setSelectedRichMenuForUpload]=useState(null);// Visual Builder State\nconst[createMode,setCreateMode]=useState('visual');const[backgroundImageUrl,setBackgroundImageUrl]=useState('');const[backgroundImageFile,setBackgroundImageFile]=useState(null);const[buttons,setButtons]=useState([]);const[buttonDialogOpen,setButtonDialogOpen]=useState(false);const[editingButton,setEditingButton]=useState(null);// Canvas Drawing State\nconst canvasRef=useRef(null);const[hotspots,setHotspots]=useState([]);const[drawingState,setDrawingState]=useState({isDrawing:false,startX:0,startY:0,currentHotspot:null,zoom:1,pan:{x:0,y:0},gridSnap:false,gridSize:100,showGrid:false,snapThreshold:5,isDragging:false,draggingHotspot:null,dragOffset:{x:0,y:0},isResizing:false,resizingHotspot:null,resizeHandle:null,zoomLocked:false,lockedZoomLevel:1,mousePosition:null});const[hotspotDialogOpen,setHotspotDialogOpen]=useState(false);const[editingHotspot,setEditingHotspot]=useState(null);const[canvasImage,setCanvasImage]=useState(null);const[animationFrameId,setAnimationFrameId]=useState(null);const[isCanvasReady,setIsCanvasReady]=useState(false);const[lastMouseMoveTime,setLastMouseMoveTime]=useState(0);const[throttleDelay]=useState(16);// ~60fps\nconst[showDrawingControls,setShowDrawingControls]=useState(true);const[jsonImportText,setJsonImportText]=useState('');const[importedHotspots,setImportedHotspots]=useState([]);const[showImportedHotspots,setShowImportedHotspots]=useState(false);const[contextMenu,setContextMenu]=useState(null);const[highTransparency,setHighTransparency]=useState(true);// Rich Menu Templates\nconst richMenuTemplates=[{name:\"Home Menu (3x2 Grid)\",description:\"Standard 3x2 grid layout with 6 buttons\",size:{width:2500,height:1686},areas:[{id:\"btn1\",bounds:{x:131,y:127,width:705,height:713},action:{type:\"uri\",uri:\"https://example.com/button1\"},label:\"Button 1\"},{id:\"btn2\",bounds:{x:904,y:127,width:709,height:718},action:{type:\"uri\",uri:\"https://example.com/button2\"},label:\"Button 2\"},{id:\"btn3\",bounds:{x:1672,y:127,width:735,height:726},action:{type:\"richmenuswitch\",data:\"change-to-page-clip1\",richMenuAliasId:\"page-clip1\"},label:\"Switch Menu\"},{id:\"btn4\",bounds:{x:127,y:874,width:701,height:701},action:{type:\"richmenuswitch\",data:\"change-to-page-dtx-book\",richMenuAliasId:\"page-dtx-book\"},label:\"DTX Book\"},{id:\"btn5\",bounds:{x:904,y:874,width:701,height:697},action:{type:\"uri\",uri:\"https://example.com/button5\"},label:\"Button 5\"},{id:\"btn6\",bounds:{x:1681,y:874,width:709,height:705},action:{type:\"uri\",uri:\"https://example.com/button6\"},label:\"Button 6\"}]},{name:\"Simple Menu (2x2 Grid)\",description:\"Simple 2x2 grid layout with 4 buttons\",size:{width:2500,height:1686},areas:[{id:\"btn1\",bounds:{x:200,y:200,width:1000,height:600},action:{type:\"postback\",data:\"action=menu&item=1\"},label:\"Menu Item 1\"},{id:\"btn2\",bounds:{x:1300,y:200,width:1000,height:600},action:{type:\"postback\",data:\"action=menu&item=2\"},label:\"Menu Item 2\"},{id:\"btn3\",bounds:{x:200,y:900,width:1000,height:600},action:{type:\"postback\",data:\"action=menu&item=3\"},label:\"Menu Item 3\"},{id:\"btn4\",bounds:{x:1300,y:900,width:1000,height:600},action:{type:\"postback\",data:\"action=menu&item=4\"},label:\"Menu Item 4\"}]},{name:\"Single Button Menu\",description:\"Single large button covering most of the menu\",size:{width:2500,height:1686},areas:[{id:\"main-btn\",bounds:{x:200,y:200,width:2100,height:1286},action:{type:\"uri\",uri:\"https://example.com/main\"},label:\"Main Action\"}]}];useEffect(()=>{loadRichMenus();loadRichMenuAliases();},[]);// Effect to redraw canvas when hotspots or background image changes\nuseEffect(()=>{if(isCanvasReady&&canvasImage){scheduleCanvasRender();}},[hotspots,backgroundImageUrl,drawingState.zoom,drawingState.pan,drawingState.showGrid,drawingState.currentHotspot]);// Cleanup effect for animation frames\nuseEffect(()=>{return()=>{if(animationFrameId){cancelAnimationFrame(animationFrameId);}};},[animationFrameId]);// Handle wheel events with proper non-passive listener\nuseEffect(()=>{const canvas=canvasRef.current;if(!canvas)return;const handleWheel=e=>{e.preventDefault();// Check if zoom is locked\nif(drawingState.zoomLocked){return;}const delta=e.deltaY>0?0.9:1.1;const newZoom=Math.max(0.5,Math.min(3,drawingState.zoom*delta));setDrawingState(prev=>_objectSpread(_objectSpread({},prev),{},{zoom:newZoom}));scheduleCanvasRender();};// Add event listener with non-passive option\ncanvas.addEventListener('wheel',handleWheel,{passive:false});return()=>{canvas.removeEventListener('wheel',handleWheel);};},[drawingState.zoomLocked,drawingState.zoom]);const loadRichMenus=async()=>{try{setLoading(true);setError(null);const response=await getRichMenus();const data=response.data;if(data.success){setRichMenus(data.rich_menus);setSuccess(\"Loaded \".concat(data.count,\" rich menus (\").concat(data.line_api_count,\" from LINE API, \").concat(data.database_only_count,\" from database only)\"));}else{setError('Failed to load rich menus');}}catch(err){var _err$response,_err$response$data;setError(((_err$response=err.response)===null||_err$response===void 0?void 0:(_err$response$data=_err$response.data)===null||_err$response$data===void 0?void 0:_err$response$data.detail)||'Failed to load rich menus');}finally{setLoading(false);}};const loadRichMenuAliases=async()=>{try{const response=await getRichMenuAliases();const data=response.data;if(data.success){setRichMenuAliases(data.aliases);}}catch(err){console.error('Error loading rich menu aliases:',err);}};const handleFetchAndLinkAliases=async()=>{try{setError(null);const response=await fetchAndLinkAliases();if(response.data.success){const{aliases,line_aliases_count,created_count,updated_count}=response.data;let successMessage=\"Synced \".concat(line_aliases_count,\" aliases from LINE API\\n\");successMessage+=\"\\u2022 Created: \".concat(created_count,\" new aliases\\n\");successMessage+=\"\\u2022 Updated: \".concat(updated_count,\" existing aliases\\n\");successMessage+=\"\\u2022 Total in database: \".concat(aliases.length,\" aliases\");if(aliases.length===0){successMessage+='\\n\\nNo rich menu aliases found in LINE API.';}setSuccess(successMessage);setRichMenuAliases(aliases);// Directly update the state with the aliases\n}else{setError(response.data.message||'Failed to fetch and link aliases');}}catch(error){var _error$response,_error$response$data;console.error('Error fetching and linking aliases:',error);setError(((_error$response=error.response)===null||_error$response===void 0?void 0:(_error$response$data=_error$response.data)===null||_error$response$data===void 0?void 0:_error$response$data.detail)||'Failed to fetch and link aliases');}};const handleCleanupAliases=async()=>{if(!window.confirm('Are you sure you want to clean up duplicate aliases? This will remove duplicate entries and keep only the linked ones.')){return;}try{setError(null);const response=await cleanupRichMenuAliases();if(response.data.success){setSuccess(response.data.message);loadRichMenuAliases();// Refresh the aliases list\n}else{setError(response.data.message||'Failed to cleanup aliases');}}catch(error){var _error$response2,_error$response2$data;console.error('Error cleaning up aliases:',error);setError(((_error$response2=error.response)===null||_error$response2===void 0?void 0:(_error$response2$data=_error$response2.data)===null||_error$response2$data===void 0?void 0:_error$response2$data.detail)||'Failed to cleanup aliases');}};const handleOpenCreateAliasDialog=async()=>{try{setError(null);const response=await getUnlinkedRichMenus();if(response.data.success){setUnlinkedRichMenus(response.data.unlinked_rich_menus);setCreateAliasDialogOpen(true);}else{setError(response.data.message||'Failed to get unlinked rich menus');}}catch(error){var _error$response3,_error$response3$data;console.error('Error getting unlinked rich menus:',error);setError(((_error$response3=error.response)===null||_error$response3===void 0?void 0:(_error$response3$data=_error$response3.data)===null||_error$response3$data===void 0?void 0:_error$response3$data.detail)||'Failed to get unlinked rich menus');}};const handleCreateRichMenuAlias=async()=>{if(!selectedUnlinkedRichMenu||!aliasId.trim()){setError('Please select a rich menu and enter an alias ID');return;}try{setCreatingAlias(true);setError(null);const aliasData={richMenuAliasId:aliasId.trim(),richMenuId:selectedUnlinkedRichMenu.rich_menu_id,name:\"Alias for \".concat(selectedUnlinkedRichMenu.name)};const response=await createRichMenuAlias(aliasData);if(response.data.success){setSuccess(\"Alias \\\"\".concat(aliasId,\"\\\" created successfully for rich menu \\\"\").concat(selectedUnlinkedRichMenu.name,\"\\\"\"));setCreateAliasDialogOpen(false);setSelectedUnlinkedRichMenu(null);setAliasId('');loadRichMenuAliases();// Refresh the aliases list\n}else{setError(response.data.message||'Failed to create alias');}}catch(error){var _error$response4,_error$response4$data;console.error('Error creating alias:',error);setError(((_error$response4=error.response)===null||_error$response4===void 0?void 0:(_error$response4$data=_error$response4.data)===null||_error$response4$data===void 0?void 0:_error$response4$data.detail)||'Failed to create alias');}finally{setCreatingAlias(false);}};const handleCreateAlias=async richMenuId=>{try{const response=await createAliasesForRichMenu(richMenuId);if(response.data.success){setSuccess(response.data.message);loadRichMenuAliases();// Refresh aliases\n}else{setError('Failed to create aliases');}}catch(err){var _err$response2,_err$response2$data;setError(((_err$response2=err.response)===null||_err$response2===void 0?void 0:(_err$response2$data=_err$response2.data)===null||_err$response2$data===void 0?void 0:_err$response2$data.detail)||'Failed to create aliases');}};const handleDeleteAlias=async aliasId=>{if(!window.confirm(\"Are you sure you want to delete the alias \\\"\".concat(aliasId,\"\\\"?\"))){return;}try{const response=await deleteRichMenuAlias(aliasId);if(response.data.success){setSuccess(response.data.message);loadRichMenuAliases();// Refresh aliases\n}else{setError('Failed to delete alias');}}catch(err){var _err$response3,_err$response3$data;setError(((_err$response3=err.response)===null||_err$response3===void 0?void 0:(_err$response3$data=_err$response3.data)===null||_err$response3$data===void 0?void 0:_err$response3$data.detail)||'Failed to delete alias');}};const handleOpenUpdateAliasDialog=alias=>{setSelectedAliasForUpdate(alias);setSelectedRichMenuForUpdate(null);setUpdateAliasDialogOpen(true);};const handleUpdateAlias=async()=>{if(!selectedAliasForUpdate||!selectedRichMenuForUpdate){setError('Please select a rich menu to link to this alias');return;}try{setUpdatingAlias(true);setError(null);const updateData={richMenuId:selectedRichMenuForUpdate.rich_menu_id};const response=await updateRichMenuAlias(selectedAliasForUpdate.richMenuAliasId,updateData);if(response.data.success){setSuccess(\"Alias \\\"\".concat(selectedAliasForUpdate.richMenuAliasId,\"\\\" updated successfully to point to \\\"\").concat(selectedRichMenuForUpdate.name,\"\\\"\"));setUpdateAliasDialogOpen(false);setSelectedAliasForUpdate(null);setSelectedRichMenuForUpdate(null);loadRichMenuAliases();// Refresh the aliases list\n}else{setError(response.data.message||'Failed to update alias');}}catch(error){var _error$response5,_error$response5$data;console.error('Error updating alias:',error);setError(((_error$response5=error.response)===null||_error$response5===void 0?void 0:(_error$response5$data=_error$response5.data)===null||_error$response5$data===void 0?void 0:_error$response5$data.detail)||'Failed to update alias');}finally{setUpdatingAlias(false);}};const handleOpenDetailsDialog=async richMenu=>{setSelectedRichMenuForDetails(richMenu);setRichMenuDetails(null);setImageLoaded(false);setImageDimensions({width:0,height:0});setDetailsDialogOpen(true);try{setLoadingDetails(true);setError(null);const response=await getRichMenuDetails(richMenu.richMenuId);if(response.data.success){setRichMenuDetails(response.data);}else{setError(response.data.message||'Failed to load rich menu details');}}catch(error){var _error$response6,_error$response6$data;console.error('Error loading rich menu details:',error);setError(((_error$response6=error.response)===null||_error$response6===void 0?void 0:(_error$response6$data=_error$response6.data)===null||_error$response6$data===void 0?void 0:_error$response6$data.detail)||'Failed to load rich menu details');}finally{setLoadingDetails(false);}};const handleImageLoad=event=>{const img=event.target;setImageDimensions({width:img.offsetWidth,height:img.offsetHeight});setImageLoaded(true);};const handleSetDefault=async richMenuId=>{try{setLoading(true);setError(null);const response=await setDefaultRichMenu(richMenuId);if(response.data.success){var _richMenus$find;setRichMenus(prev=>prev.map(menu=>_objectSpread(_objectSpread({},menu),{},{isDefault:menu.richMenuId===richMenuId})));setSuccess(\"Rich menu \\\"\".concat((_richMenus$find=richMenus.find(m=>m.richMenuId===richMenuId))===null||_richMenus$find===void 0?void 0:_richMenus$find.name,\"\\\" set as default\"));}else{setError('Failed to set default rich menu');}}catch(err){var _err$response4,_err$response4$data;setError(((_err$response4=err.response)===null||_err$response4===void 0?void 0:(_err$response4$data=_err$response4.data)===null||_err$response4$data===void 0?void 0:_err$response4$data.detail)||'Failed to set default rich menu');}finally{setLoading(false);}};const handleDeleteRichMenu=async richMenu=>{if(!window.confirm(\"Are you sure you want to delete the rich menu \\\"\".concat(richMenu.name,\"\\\"?\\n\\nThis will delete it from both LINE API and the database.\"))){return;}try{setLoading(true);setError(null);const response=await deleteRichMenu(richMenu.richMenuId);if(response.data.success){setRichMenus(prev=>prev.filter(menu=>menu.richMenuId!==richMenu.richMenuId));setSuccess(\"Rich menu \\\"\".concat(richMenu.name,\"\\\" deleted successfully\"));}else{setError('Failed to delete rich menu');}}catch(err){var _err$response5,_err$response5$data;setError(((_err$response5=err.response)===null||_err$response5===void 0?void 0:(_err$response5$data=_err$response5.data)===null||_err$response5$data===void 0?void 0:_err$response5$data.detail)||'Failed to delete rich menu');}finally{setLoading(false);}};const handleAssignToUser=async()=>{if(!selectedRichMenu||!userId.trim()){setError('Please enter a user ID');return;}try{setAssigning(true);setError(null);const response=await assignRichMenuToUser(selectedRichMenu.richMenuId,userId.trim());if(response.data.success){setSuccess(\"Rich menu \\\"\".concat(selectedRichMenu.name,\"\\\" assigned to user \").concat(userId));setAssignDialogOpen(false);setUserId('');setSelectedRichMenu(null);}else{setError('Failed to assign rich menu to user');}}catch(err){var _err$response6,_err$response6$data;setError(((_err$response6=err.response)===null||_err$response6===void 0?void 0:(_err$response6$data=_err$response6.data)===null||_err$response6$data===void 0?void 0:_err$response6$data.detail)||'Failed to assign rich menu to user');}finally{setAssigning(false);}};const validateAndFixURIs=richMenuData=>{if(richMenuData.areas&&Array.isArray(richMenuData.areas)){richMenuData.areas.forEach((area,index)=>{if(area.action&&area.action.type==='uri'&&area.action.uri){// Fix URI if it doesn't have a protocol\nif(!area.action.uri.match(/^https?:\\/\\//)){area.action.uri=\"https://\".concat(area.action.uri);console.log(\"Fixed URI for area \".concat(index,\": \").concat(area.action.uri));}}});}return richMenuData;};const handleCreateRichMenu=async()=>{if(!richMenuForm.name.trim()){setError('Please enter a rich menu name');return;}if(richMenuForm.chatBarText.length>14){setError('Chat Bar Text must not exceed 14 characters (LINE API limit)');return;}if(!richMenuForm.body.trim()){setError('Please enter the rich menu body JSON');return;}try{// Parse the JSON body\nlet richMenuData=JSON.parse(richMenuForm.body);// Validate rich menu size against LINE standards\nif(richMenuData.size){const richMenuSize={width:richMenuData.size.width,height:richMenuData.size.height};const isValidSize=Object.values(LINE_RICH_MENU_SIZES).some(standardSize=>standardSize.width===richMenuSize.width&&standardSize.height===richMenuSize.height);if(!isValidSize){const allowedSizes=Object.values(LINE_RICH_MENU_SIZES).map(size=>\"\".concat(size.width,\" x \").concat(size.height)).join(' or ');setError(\"\\u274C Invalid rich menu size! Only LINE standard sizes are allowed: \".concat(allowedSizes));return;}}// Validate all richMenuAliasId values in the rich menu\nif(richMenuData.areas){for(let i=0;i<richMenuData.areas.length;i++){const area=richMenuData.areas[i];if(area.action&&area.action.type==='richmenuswitch'&&area.action.richMenuAliasId){if(!validateRichMenuAliasId(area.action.richMenuAliasId)){setError(\"\\u274C Invalid rich menu alias ID in area \".concat(i+1,\": \\\"\").concat(area.action.richMenuAliasId,\"\\\". Only alphanumeric characters and hyphens are allowed (1-40 characters).\"));return;}}}}// Validate and fix URIs before sending to LINE API\nrichMenuData=validateAndFixURIs(richMenuData);setCreating(true);setError(null);// Step 1: Validate rich menu object before creation\nconst validationResponse=await validateRichMenu(richMenuData);if(!validationResponse.data.success){setError(\"Validation failed: \".concat(validationResponse.data.message||'Unknown validation error'));return;}// Step 2: Create rich menu after successful validation\nconst response=await createRichMenu(richMenuData);if(response.data.success){const richMenuId=response.data.rich_menu_id;const aliasesCreated=response.data.aliases_created||[];const aliasesSkipped=response.data.aliases_skipped||[];const aliasesFailed=response.data.aliases_failed||[];const aliasesLinked=response.data.aliases_linked||[];let successMessage=\"Rich menu \\\"\".concat(richMenuForm.name,\"\\\" created successfully! ID: \").concat(richMenuId);// Add alias information to success message\nif(aliasesCreated.length>0){successMessage+=\"\\n\\n\\u2705 Auto-created \".concat(aliasesCreated.length,\" aliases: \").concat(aliasesCreated.join(', '));}if(aliasesLinked.length>0){successMessage+=\"\\n\\n\\uD83D\\uDD17 Auto-linked \".concat(aliasesLinked.length,\" existing aliases: \").concat(aliasesLinked.join(', '));}if(aliasesSkipped.length>0){successMessage+=\"\\n\\n\\u26A0\\uFE0F Skipped \".concat(aliasesSkipped.length,\" aliases: \").concat(aliasesSkipped.join(', '));}if(aliasesFailed.length>0){successMessage+=\"\\n\\n\\u274C Failed to create \".concat(aliasesFailed.length,\" aliases: \").concat(aliasesFailed.join(', '));}setSuccess(successMessage);setCreateDialogOpen(false);resetCreateForm();loadRichMenus();// Refresh the list\nloadRichMenuAliases();// Refresh aliases\n}else{setError('Failed to create rich menu');}}catch(err){if(err.message&&err.message.includes('JSON')){setError('Invalid JSON format in rich menu body');}else{var _err$response7,_err$response7$data;setError(((_err$response7=err.response)===null||_err$response7===void 0?void 0:(_err$response7$data=_err$response7.data)===null||_err$response7$data===void 0?void 0:_err$response7$data.detail)||'Failed to create rich menu');}}finally{setCreating(false);}};const handleUploadImage=async richMenuId=>{if(!selectedFile)return;try{setUploadingImage(true);setError(null);// Check if rich menu already has an image\nconst richMenu=richMenus.find(rm=>rm.richMenuId===richMenuId);const hasExistingImage=(richMenu===null||richMenu===void 0?void 0:richMenu.hasImage)||false;let response;if(hasExistingImage){// Use change image endpoint (delete + create + upload)\nresponse=await changeRichMenuImage(richMenuId,selectedFile);if(response.data.success){setSuccess(\"Image changed successfully. New rich menu ID: \".concat(response.data.new_rich_menu_id));}else{setError('Failed to change image');}}else{// Use upload image endpoint (simple upload)\nresponse=await uploadRichMenuImage(richMenuId,selectedFile);if(response.data.success){setSuccess(\"Image uploaded successfully for rich menu \".concat(richMenuId));}else{setError('Failed to upload image');}}}catch(err){var _err$response8,_err$response8$data;setError(((_err$response8=err.response)===null||_err$response8===void 0?void 0:(_err$response8$data=_err$response8.data)===null||_err$response8$data===void 0?void 0:_err$response8$data.detail)||'Failed to upload/change image');}finally{setUploadingImage(false);}};const resetCreateForm=()=>{setRichMenuForm({name:'',chatBarText:'Tap to open',displayByDefault:false,body:JSON.stringify({size:{width:2500,height:1686},selected:false,name:\"Rich Menu\",chatBarText:\"Tap to open\",areas:[{bounds:{x:0,y:0,width:2500,height:1686},action:{type:\"postback\",data:\"action=menu&item=main\"}}]},null,2)});// Clear imported hotspots and related state\nsetImportedHotspots([]);setShowImportedHotspots(false);setJsonImportText('');// Clear background image\nsetBackgroundImageUrl('');setBackgroundImageFile(null);};// Visual Builder Helper Functions\nconst generateRichMenuJSON=(name,buttons,size)=>{return{size,selected:richMenuForm.displayByDefault,name,chatBarText:richMenuForm.chatBarText,areas:buttons.map(btn=>{// Ensure URI actions have proper protocol\nlet action=_objectSpread({},btn.action);if(action.type==='uri'&&action.uri&&!action.uri.match(/^https?:\\/\\//)){action.uri=\"https://\".concat(action.uri);}return{bounds:btn.bounds,action:action};})};};const handleBackgroundImageUpload=file=>{console.log('handleBackgroundImageUpload called with file:',file);console.log('File name:',file.name);console.log('File type:',file.type);console.log('File size:',file.size);const url=URL.createObjectURL(file);setBackgroundImageUrl(url);setBackgroundImageFile(file);// Store the actual file for later upload\nconsole.log('backgroundImageFile set to:',file);// Pre-load the image for smooth rendering\nconst img=new window.Image();img.onload=()=>{setCanvasImage(img);setIsCanvasReady(true);// Resize canvas to match selected LINE rich menu size ratio\nconst canvas=canvasRef.current;if(canvas){// Get the selected rich menu size\nconst selectedSize=LINE_RICH_MENU_SIZES[selectedRichMenuSize];const targetWidth=selectedSize.width;const targetHeight=selectedSize.height;const targetAspectRatio=targetWidth/targetHeight;// Calculate canvas dimensions to maintain the target aspect ratio\nconst maxCanvasWidth=800;const maxCanvasHeight=600;let canvasWidth,canvasHeight;// Calculate canvas size to fit within max dimensions while maintaining target aspect ratio\nif(targetAspectRatio>maxCanvasWidth/maxCanvasHeight){// Width is the limiting factor\ncanvasWidth=maxCanvasWidth;canvasHeight=maxCanvasWidth/targetAspectRatio;}else{// Height is the limiting factor\ncanvasHeight=maxCanvasHeight;canvasWidth=maxCanvasHeight*targetAspectRatio;}// Set canvas to calculated dimensions\ncanvas.width=canvasWidth;canvas.height=canvasHeight;// Calculate scale to fit image within canvas while maintaining aspect ratio\nconst scaleX=canvasWidth/img.width;const scaleY=canvasHeight/img.height;const scale=Math.min(scaleX,scaleY);// Calculate the actual dimensions the image will be drawn at\nconst drawnWidth=img.width*scale;const drawnHeight=img.height*scale;// Calculate centering offsets\nconst offsetX=(canvasWidth-drawnWidth)/2;const offsetY=(canvasHeight-drawnHeight)/2;// Store all the positioning data for consistent use\ncanvas.dataset.scale=scale.toString();canvas.dataset.drawnWidth=drawnWidth.toString();canvas.dataset.drawnHeight=drawnHeight.toString();canvas.dataset.offsetX=offsetX.toString();canvas.dataset.offsetY=offsetY.toString();canvas.dataset.imageWidth=img.width.toString();canvas.dataset.imageHeight=img.height.toString();console.log('Selected rich menu size:',selectedSize.label,\"(\".concat(targetWidth,\" x \").concat(targetHeight,\")\"));console.log('Target aspect ratio:',targetAspectRatio);console.log('Canvas dimensions:',canvasWidth,'x',canvasHeight);console.log('Image dimensions:',img.width,'x',img.height);console.log('Scale factor:',scale);console.log('Drawn image dimensions:',drawnWidth,'x',drawnHeight);console.log('Centering offsets:',offsetX,offsetY);console.log('Perfect positioning check:',{scaleConsistent:Math.abs(drawnWidth/img.width-drawnHeight/img.height)<0.000001,imageFits:drawnWidth<=canvasWidth&&drawnHeight<=canvasHeight,centered:offsetX>=0&&offsetY>=0});}// Cancel any pending animation frame\nif(animationFrameId){cancelAnimationFrame(animationFrameId);}// Schedule initial render\nscheduleCanvasRender();};img.src=url;};const scheduleCanvasRender=()=>{// Cancel any pending animation frame to prevent multiple renders\nif(animationFrameId){cancelAnimationFrame(animationFrameId);}const frameId=requestAnimationFrame(()=>{drawCanvas();setAnimationFrameId(null);});setAnimationFrameId(frameId);};const drawCanvas=()=>{const canvas=canvasRef.current;const ctx=canvas===null||canvas===void 0?void 0:canvas.getContext('2d');if(!canvas||!ctx||!canvasImage)return;// Clear canvas\nctx.clearRect(0,0,canvas.width,canvas.height);// Apply zoom and pan transformations\nctx.save();ctx.translate(drawingState.pan.x*drawingState.zoom,drawingState.pan.y*drawingState.zoom);ctx.scale(drawingState.zoom,drawingState.zoom);// Use the new positioning system stored in canvas dataset\nconst scale=parseFloat(canvas.dataset.scale||'0');const drawnWidth=parseFloat(canvas.dataset.drawnWidth||'0');const drawnHeight=parseFloat(canvas.dataset.drawnHeight||'0');const offsetX=parseFloat(canvas.dataset.offsetX||'0');const offsetY=parseFloat(canvas.dataset.offsetY||'0');// Debug: Log the scaling calculations\nconsole.log('Canvas scaling (new system):',{canvasDimensions:{width:canvas.width,height:canvas.height},imageDimensions:{width:canvasImage.width,height:canvasImage.height},scale,drawnDimensions:{width:drawnWidth,height:drawnHeight},offset:{x:offsetX,y:offsetY},usingNewSystem:scale>0&&drawnWidth>0&&drawnHeight>0});// Draw background image (cached)\nctx.drawImage(canvasImage,offsetX,offsetY,drawnWidth,drawnHeight);// Draw grid\ndrawGrid(ctx,canvas,scale,offsetX,offsetY);// Draw all hotspots\nhotspots.forEach(hotspot=>{drawHotspot(ctx,hotspot,scale,offsetX,offsetY);});// Draw imported hotspots if enabled\nif(showImportedHotspots){importedHotspots.forEach(hotspot=>{drawHotspot(ctx,hotspot,scale,offsetX,offsetY,false);});}// Draw current drawing hotspot\nif(drawingState.currentHotspot){drawHotspot(ctx,drawingState.currentHotspot,scale,offsetX,offsetY,true);}// Draw mouse position indicator (small crosshair)\nif(drawingState.mousePosition){const mouseX=drawingState.mousePosition.x;const mouseY=drawingState.mousePosition.y;// Convert image coordinates to canvas coordinates\nconst canvasX=offsetX+mouseX*scale;const canvasY=offsetY+mouseY*scale;// Draw crosshair\nctx.strokeStyle='#ff0000';ctx.lineWidth=2;ctx.setLineDash([]);const size=10;ctx.beginPath();ctx.moveTo(canvasX-size,canvasY);ctx.lineTo(canvasX+size,canvasY);ctx.moveTo(canvasX,canvasY-size);ctx.lineTo(canvasX,canvasY+size);ctx.stroke();// Draw coordinate text\nctx.fillStyle='#ff0000';ctx.font='12px Arial';ctx.fillText(\"(\".concat(Math.round(mouseX),\", \").concat(Math.round(mouseY),\")\"),canvasX+15,canvasY-15);}ctx.restore();};const updateHotspotPosition=(hotspotId,newBounds)=>{setHotspots(prevHotspots=>prevHotspots.map(h=>h.id===hotspotId?_objectSpread(_objectSpread({},h),{},{bounds:newBounds}):h));// Schedule canvas render instead of immediate render\nscheduleCanvasRender();};const handleTemplateSelect=template=>{setButtons(template.areas);setRichMenuForm({name:template.name,chatBarText:'Tap to open',displayByDefault:false,body:JSON.stringify(generateRichMenuJSON(template.name,template.areas,template.size),null,2)});setCreateMode('template');};const parseJsonToHotspots=jsonText=>{try{const jsonData=JSON.parse(jsonText);if(!jsonData.areas||!Array.isArray(jsonData.areas)){throw new Error('Invalid JSON: missing or invalid areas array');}return jsonData.areas.map((area,index)=>{if(!area.bounds||!area.action){throw new Error(\"Invalid area at index \".concat(index,\": missing bounds or action\"));}const bounds=area.bounds;const action=area.action;// Generate a unique color for each hotspot (lighter for better transparency)\nconst hue=index*137.5%360;// Golden angle for good color distribution\nconst color=\"hsl(\".concat(hue,\", 60%, 70%)\");// Create a descriptive label based on action type\nlet label=\"Hotspot \".concat(index+1);if(action.type==='uri'){label=\"URI \".concat(index+1);}else if(action.type==='postback'){label=\"Postback \".concat(index+1);}else if(action.type==='message'){label=\"Message \".concat(index+1);}else if(action.type==='richmenuswitch'){label=\"Switch \".concat(index+1);}return{id:\"imported_\".concat(index),bounds:{x:bounds.x||0,y:bounds.y||0,width:bounds.width||100,height:bounds.height||100},action:{type:action.type||'postback',data:action.data||'',text:action.text||'',uri:action.uri||'',richMenuAliasId:action.richMenuAliasId||''},label,color};});}catch(error){console.error('Error parsing JSON:',error);throw error;}};const handleJsonImport=()=>{try{const jsonData=JSON.parse(jsonImportText);// Validate rich menu size against LINE standards\nif(jsonData.size){const richMenuSize={width:jsonData.size.width,height:jsonData.size.height};const isValidSize=Object.values(LINE_RICH_MENU_SIZES).some(standardSize=>standardSize.width===richMenuSize.width&&standardSize.height===richMenuSize.height);if(!isValidSize){const allowedSizes=Object.values(LINE_RICH_MENU_SIZES).map(size=>\"\".concat(size.width,\" x \").concat(size.height)).join(' or ');setError(\"\\u274C Invalid rich menu size! Only LINE standard sizes are allowed: \".concat(allowedSizes));return;}}const hotspots=parseJsonToHotspots(jsonImportText);setImportedHotspots(hotspots);setShowImportedHotspots(true);// Auto-correct the JSON and update the form\n// Note: auto-correction would be handled by the backend API\nconst correctedData=jsonData;setRichMenuForm({name:correctedData.name||'Imported Rich Menu',chatBarText:correctedData.chatBarText||'Tap to open',displayByDefault:correctedData.selected||false,body:JSON.stringify(correctedData,null,2)});// Show success message\nsetSuccess(\"Successfully imported \".concat(hotspots.length,\" hotspots!\"));}catch(error){setError(\"Error importing JSON: \".concat(error instanceof Error?error.message:'Invalid JSON format'));}};const clearImportedHotspots=()=>{setImportedHotspots([]);setShowImportedHotspots(false);setJsonImportText('');};const handleContextMenu=(event,hotspot)=>{event.preventDefault();setContextMenu({mouseX:event.clientX+2,mouseY:event.clientY-6,hotspot});};const handleCloseContextMenu=()=>{setContextMenu(null);};const handleDeleteHotspot=hotspotId=>{// Remove from hotspots array\nsetHotspots(prevHotspots=>prevHotspots.filter(h=>h.id!==hotspotId));// Remove from imported hotspots array\nsetImportedHotspots(prevHotspots=>prevHotspots.filter(h=>h.id!==hotspotId));// Clear any active states\nsetDrawingState(prev=>{var _prev$draggingHotspot,_prev$resizingHotspot;return _objectSpread(_objectSpread({},prev),{},{draggingHotspot:((_prev$draggingHotspot=prev.draggingHotspot)===null||_prev$draggingHotspot===void 0?void 0:_prev$draggingHotspot.id)===hotspotId?null:prev.draggingHotspot,resizingHotspot:((_prev$resizingHotspot=prev.resizingHotspot)===null||_prev$resizingHotspot===void 0?void 0:_prev$resizingHotspot.id)===hotspotId?null:prev.resizingHotspot});});handleCloseContextMenu();scheduleCanvasRender();};const handleMoveHotspot=hotspotId=>{const hotspot=[...hotspots,...importedHotspots].find(h=>h.id===hotspotId);if(hotspot){setDrawingState(prev=>_objectSpread(_objectSpread({},prev),{},{isDragging:true,draggingHotspot:hotspot,dragOffset:{x:0,y:0}}));}handleCloseContextMenu();};const getCursorStyle=(clientX,clientY)=>{if(!backgroundImageUrl)return'default';const coords=getCanvasCoordinates(clientX,clientY);// Check if mouse is over a hotspot\nconst hoveredHotspot=[...hotspots,...(showImportedHotspots?importedHotspots:[])].find(hotspot=>coords.x>=hotspot.bounds.x&&coords.x<=hotspot.bounds.x+hotspot.bounds.width&&coords.y>=hotspot.bounds.y&&coords.y<=hotspot.bounds.y+hotspot.bounds.height);if(hoveredHotspot){// Check if mouse is over resize handles\nconst handleSize=8;const x=coords.x;const y=coords.y;if(x<=hoveredHotspot.bounds.x+handleSize&&y<=hoveredHotspot.bounds.y+handleSize){return'nw-resize';// Northwest handle\n}else if(x>=hoveredHotspot.bounds.x+hoveredHotspot.bounds.width-handleSize&&y<=hoveredHotspot.bounds.y+handleSize){return'ne-resize';// Northeast handle\n}else if(x<=hoveredHotspot.bounds.x+handleSize&&y>=hoveredHotspot.bounds.y+hoveredHotspot.bounds.height-handleSize){return'sw-resize';// Southwest handle\n}else if(x>=hoveredHotspot.bounds.x+hoveredHotspot.bounds.width-handleSize&&y>=hoveredHotspot.bounds.y+hoveredHotspot.bounds.height-handleSize){return'se-resize';// Southeast handle\n}else{return'move';// Dragging the hotspot\n}}// Default cursor based on drawing state\nif(drawingState.isDrawing){return'crosshair';}else if(drawingState.isDragging||drawingState.isResizing){return'grabbing';}else{return'default';}};// Canvas Drawing Functions\nconst getCanvasCoordinates=(clientX,clientY)=>{const canvas=canvasRef.current;if(!canvas||!canvasImage)return{x:0,y:0};const rect=canvas.getBoundingClientRect();// Convert mouse coordinates to canvas coordinates (accounting for CSS scaling)\nconst canvasX=(clientX-rect.left)*(canvas.width/rect.width);const canvasY=(clientY-rect.top)*(canvas.height/rect.height);// Apply zoom and pan transformations (reverse of what's done in drawCanvas)\nconst transformedX=(canvasX-drawingState.pan.x*drawingState.zoom)/drawingState.zoom;const transformedY=(canvasY-drawingState.pan.y*drawingState.zoom)/drawingState.zoom;// Use the new positioning system stored in canvas dataset\nconst scale=parseFloat(canvas.dataset.scale||'0');const drawnWidth=parseFloat(canvas.dataset.drawnWidth||'0');const drawnHeight=parseFloat(canvas.dataset.drawnHeight||'0');const offsetX=parseFloat(canvas.dataset.offsetX||'0');const offsetY=parseFloat(canvas.dataset.offsetY||'0');const imageWidth=parseInt(canvas.dataset.imageWidth||'0');const imageHeight=parseInt(canvas.dataset.imageHeight||'0');if(scale>0&&drawnWidth>0&&drawnHeight>0){// Convert to image coordinates using the new positioning system\nconst imageX=(transformedX-offsetX)/scale;const imageY=(transformedY-offsetY)/scale;// Ensure coordinates are within image bounds\nconst clampedX=Math.max(0,Math.min(imageX,imageWidth));const clampedY=Math.max(0,Math.min(imageY,imageHeight));// Debug: Log the coordinate transformation (only when creating hotspots)\nif(drawingState.isDrawing){console.log('Coordinate transformation (new system):',{clientCoords:{x:clientX,y:clientY},rect:{left:rect.left,top:rect.top,width:rect.width,height:rect.height},canvasCoords:{x:canvasX,y:canvasY},transformedCoords:{x:transformedX,y:transformedY},scale,drawnDimensions:{width:drawnWidth,height:drawnHeight},offset:{x:offsetX,y:offsetY},imageCoords:{x:imageX,y:imageY},clampedCoords:{x:clampedX,y:clampedY}});}return{x:clampedX,y:clampedY};}else{// Fallback to original calculation if new system is not available\nconst imageScale=Math.min(canvas.width/canvasImage.width,canvas.height/canvasImage.height);const scaledWidth=Math.round(canvasImage.width*imageScale);const scaledHeight=Math.round(canvasImage.height*imageScale);const fallbackOffsetX=Math.round((canvas.width-scaledWidth)/2);const fallbackOffsetY=Math.round((canvas.height-scaledHeight)/2);const imageX=(transformedX-fallbackOffsetX)/imageScale;const imageY=(transformedY-fallbackOffsetY)/imageScale;const clampedX=Math.max(0,Math.min(imageX,canvasImage.width));const clampedY=Math.max(0,Math.min(imageY,canvasImage.height));return{x:clampedX,y:clampedY};}};const snapToGrid=(value,gridSize)=>{if(!drawingState.gridSnap)return value;return Math.round(value/gridSize)*gridSize;};const snapCoordinates=(x,y)=>{return{x:snapToGrid(x,drawingState.gridSize),y:snapToGrid(y,drawingState.gridSize)};};const handleCanvasMouseDown=e=>{if(!backgroundImageUrl)return;const coords=getCanvasCoordinates(e.clientX,e.clientY);// Debug: Log coordinates for verification\nconsole.log('Mouse click coordinates:',{clientX:e.clientX,clientY:e.clientY,imageCoords:coords,canvasImage:canvasImage?{width:canvasImage.width,height:canvasImage.height}:null,hotspots:hotspots.map(h=>({id:h.id,bounds:h.bounds,isInside:coords.x>=h.bounds.x&&coords.x<=h.bounds.x+h.bounds.width&&coords.y>=h.bounds.y&&coords.y<=h.bounds.y+h.bounds.height}))});// Debug: Create a small hotspot at the exact click position to verify coordinates\nif(e.shiftKey){// Hold Shift to create debug hotspot\nconst debugHotspot={id:\"debug_\".concat(Date.now()),bounds:{x:coords.x-5,y:coords.y-5,width:10,height:10},action:{type:'postback',data:'action=debug'},label:\"Debug (\".concat(Math.round(coords.x),\", \").concat(Math.round(coords.y),\")\"),color:'#ffff00'};setHotspots([...hotspots,debugHotspot]);drawCanvas();console.log('Created debug hotspot at:',coords);return;}// Check if clicking on existing hotspot for dragging/resizing\nconst clickedHotspot=hotspots.find(hotspot=>coords.x>=hotspot.bounds.x&&coords.x<=hotspot.bounds.x+hotspot.bounds.width&&coords.y>=hotspot.bounds.y&&coords.y<=hotspot.bounds.y+hotspot.bounds.height);if(clickedHotspot){// Check if clicking on resize handles\nconst handleSize=8;const hotspot=clickedHotspot;const x=coords.x;const y=coords.y;// Check corner handles\nif(x<=hotspot.bounds.x+handleSize&&y<=hotspot.bounds.y+handleSize){// Northwest handle\nsetDrawingState(_objectSpread(_objectSpread({},drawingState),{},{isResizing:true,resizingHotspot:hotspot,resizeHandle:'nw'}));}else if(x>=hotspot.bounds.x+hotspot.bounds.width-handleSize&&y<=hotspot.bounds.y+handleSize){// Northeast handle\nsetDrawingState(_objectSpread(_objectSpread({},drawingState),{},{isResizing:true,resizingHotspot:hotspot,resizeHandle:'ne'}));}else if(x<=hotspot.bounds.x+handleSize&&y>=hotspot.bounds.y+hotspot.bounds.height-handleSize){// Southwest handle\nsetDrawingState(_objectSpread(_objectSpread({},drawingState),{},{isResizing:true,resizingHotspot:hotspot,resizeHandle:'sw'}));}else if(x>=hotspot.bounds.x+hotspot.bounds.width-handleSize&&y>=hotspot.bounds.y+hotspot.bounds.height-handleSize){// Southeast handle\nsetDrawingState(_objectSpread(_objectSpread({},drawingState),{},{isResizing:true,resizingHotspot:hotspot,resizeHandle:'se'}));}else{// Dragging the hotspot\nconst snappedCoords=snapCoordinates(coords.x,coords.y);setDrawingState(_objectSpread(_objectSpread({},drawingState),{},{isDragging:true,draggingHotspot:hotspot,dragOffset:{x:snappedCoords.x-hotspot.bounds.x,y:snappedCoords.y-hotspot.bounds.y}}));}return;}// Start drawing new hotspot\nconst snappedCoords=snapCoordinates(coords.x,coords.y);setDrawingState(_objectSpread(_objectSpread({},drawingState),{},{isDrawing:true,startX:snappedCoords.x,startY:snappedCoords.y,currentHotspot:null}));};const throttledMouseMove=e=>{const now=Date.now();if(now-lastMouseMoveTime<throttleDelay){return;}setLastMouseMoveTime(now);handleCanvasMouseMove(e);};const handleCanvasMouseMove=e=>{if(!backgroundImageUrl)return;const coords=getCanvasCoordinates(e.clientX,e.clientY);// Update mouse position for visual indicator\nsetDrawingState(_objectSpread(_objectSpread({},drawingState),{},{mousePosition:coords}));// Handle resizing\nif(drawingState.isResizing&&drawingState.resizingHotspot){const hotspot=drawingState.resizingHotspot;const snappedCoords=snapCoordinates(coords.x,coords.y);let newBounds=_objectSpread({},hotspot.bounds);switch(drawingState.resizeHandle){case'nw':newBounds.width=hotspot.bounds.x+hotspot.bounds.width-snappedCoords.x;newBounds.height=hotspot.bounds.y+hotspot.bounds.height-snappedCoords.y;newBounds.x=snappedCoords.x;newBounds.y=snappedCoords.y;break;case'ne':newBounds.width=snappedCoords.x-hotspot.bounds.x;newBounds.height=hotspot.bounds.y+hotspot.bounds.height-snappedCoords.y;newBounds.y=snappedCoords.y;break;case'sw':newBounds.width=hotspot.bounds.x+hotspot.bounds.width-snappedCoords.x;newBounds.height=snappedCoords.y-hotspot.bounds.y;newBounds.x=snappedCoords.x;break;case'se':newBounds.width=snappedCoords.x-hotspot.bounds.x;newBounds.height=snappedCoords.y-hotspot.bounds.y;break;}// Ensure minimum size\nif(newBounds.width>10&&newBounds.height>10){const updatedHotspot=_objectSpread(_objectSpread({},hotspot),{},{bounds:newBounds});updateHotspotPosition(hotspot.id,newBounds);setDrawingState(_objectSpread(_objectSpread({},drawingState),{},{resizingHotspot:updatedHotspot}));}return;}// Handle dragging\nif(drawingState.isDragging&&drawingState.draggingHotspot){const hotspot=drawingState.draggingHotspot;const snappedCoords=snapCoordinates(coords.x,coords.y);const newBounds={x:snappedCoords.x-drawingState.dragOffset.x,y:snappedCoords.y-drawingState.dragOffset.y,width:hotspot.bounds.width,height:hotspot.bounds.height};const updatedHotspot=_objectSpread(_objectSpread({},hotspot),{},{bounds:newBounds});updateHotspotPosition(hotspot.id,newBounds);setDrawingState(_objectSpread(_objectSpread({},drawingState),{},{draggingHotspot:updatedHotspot}));return;}// Handle drawing new hotspot\nif(drawingState.isDrawing){const snappedCoords=snapCoordinates(coords.x,coords.y);const width=Math.abs(snappedCoords.x-drawingState.startX);const height=Math.abs(snappedCoords.y-drawingState.startY);const x=Math.min(snappedCoords.x,drawingState.startX);const y=Math.min(snappedCoords.y,drawingState.startY);// Update the current drawing hotspot\nconst currentHotspot={id:'drawing',bounds:{x,y,width,height},action:{type:'postback',data:'action=hotspot'},label:'New Hotspot',color:'#ff0000'};setDrawingState(_objectSpread(_objectSpread({},drawingState),{},{currentHotspot}));// Schedule canvas render for smooth drawing\nscheduleCanvasRender();}};const handleCanvasMouseUp=e=>{if(!backgroundImageUrl)return;// Handle resizing completion\nif(drawingState.isResizing){setDrawingState(_objectSpread(_objectSpread({},drawingState),{},{isResizing:false,resizingHotspot:null,resizeHandle:null}));return;}// Handle dragging completion\nif(drawingState.isDragging){setDrawingState(_objectSpread(_objectSpread({},drawingState),{},{isDragging:false,draggingHotspot:null,dragOffset:{x:0,y:0}}));return;}// Handle drawing completion\nif(drawingState.isDrawing){const coords=getCanvasCoordinates(e.clientX,e.clientY);const snappedCoords=snapCoordinates(coords.x,coords.y);const width=Math.abs(snappedCoords.x-drawingState.startX);const height=Math.abs(snappedCoords.y-drawingState.startY);// Only create hotspot if it has minimum size\nif(width>10&&height>10){const x=Math.min(snappedCoords.x,drawingState.startX);const y=Math.min(snappedCoords.y,drawingState.startY);// Debug: Log the hotspot being created\nconsole.log('Creating hotspot:',{x,y,width,height,imageWidth:canvasImage===null||canvasImage===void 0?void 0:canvasImage.width,imageHeight:canvasImage===null||canvasImage===void 0?void 0:canvasImage.height,bounds:{x,y,width,height}});const newHotspot={id:\"hotspot_\".concat(Date.now()),bounds:{x,y,width,height},action:{type:'postback',data:'action=hotspot'},label:\"Hotspot \".concat(hotspots.length+1),color:\"hsl(\".concat(Math.random()*360,\", 60%, 70%)\")};setHotspots([...hotspots,newHotspot]);setEditingHotspot(newHotspot);setHotspotDialogOpen(true);}setDrawingState(_objectSpread(_objectSpread({},drawingState),{},{isDrawing:false,startX:0,startY:0,currentHotspot:null}));drawCanvas();}};const handleCanvasClick=e=>{if(drawingState.isDrawing||drawingState.isDragging||drawingState.isResizing)return;const coords=getCanvasCoordinates(e.clientX,e.clientY);// Check if clicking on existing hotspot (including imported hotspots)\nconst clickedHotspot=[...hotspots,...(showImportedHotspots?importedHotspots:[])].find(hotspot=>coords.x>=hotspot.bounds.x&&coords.x<=hotspot.bounds.x+hotspot.bounds.width&&coords.y>=hotspot.bounds.y&&coords.y<=hotspot.bounds.y+hotspot.bounds.height);if(clickedHotspot){setEditingHotspot(clickedHotspot);setHotspotDialogOpen(true);}};const handleCanvasContextMenu=e=>{if(!backgroundImageUrl)return;const coords=getCanvasCoordinates(e.clientX,e.clientY);// Find clicked hotspot (including imported hotspots)\nconst clickedHotspot=[...hotspots,...(showImportedHotspots?importedHotspots:[])].find(hotspot=>coords.x>=hotspot.bounds.x&&coords.x<=hotspot.bounds.x+hotspot.bounds.width&&coords.y>=hotspot.bounds.y&&coords.y<=hotspot.bounds.y+hotspot.bounds.height);if(clickedHotspot){handleContextMenu(e,clickedHotspot);}};const handleCanvasKeyDown=e=>{if(e.key==='g'||e.key==='G'){setDrawingState(_objectSpread(_objectSpread({},drawingState),{},{showGrid:!drawingState.showGrid}));drawCanvas();}else if(e.key==='s'||e.key==='S'){setDrawingState(_objectSpread(_objectSpread({},drawingState),{},{gridSnap:!drawingState.gridSnap}));}else if(e.key==='0'){setDrawingState(_objectSpread(_objectSpread({},drawingState),{},{zoom:1,pan:{x:0,y:0}}));drawCanvas();}else if(e.key==='Delete'||e.key==='Backspace'){// Delete selected hotspot\nif(editingHotspot){handleHotspotDelete(editingHotspot.id);}}};const toggleZoomLock=()=>{setDrawingState(_objectSpread(_objectSpread({},drawingState),{},{zoomLocked:!drawingState.zoomLocked,lockedZoomLevel:drawingState.zoomLocked?drawingState.zoom:drawingState.lockedZoomLevel}));};const drawGrid=(ctx,canvas,scale,offsetX,offsetY)=>{if(!drawingState.showGrid)return;ctx.strokeStyle='#e0e0e0';ctx.lineWidth=1;ctx.setLineDash([2,2]);const gridSize=drawingState.gridSize*scale*drawingState.zoom;// Draw vertical lines\nfor(let x=offsetX;x<canvas.width;x+=gridSize){ctx.beginPath();ctx.moveTo(x,0);ctx.lineTo(x,canvas.height);ctx.stroke();}// Draw horizontal lines\nfor(let y=offsetY;y<canvas.height;y+=gridSize){ctx.beginPath();ctx.moveTo(0,y);ctx.lineTo(canvas.width,y);ctx.stroke();}ctx.setLineDash([]);};const drawHotspot=function(ctx,hotspot,scale,offsetX,offsetY){var _drawingState$draggin,_drawingState$resizin;let isDrawing=arguments.length>5&&arguments[5]!==undefined?arguments[5]:false;// Since the canvas context is already transformed with zoom and pan in drawCanvas,\n// we need to work with the transformed coordinate system\n// The hotspot bounds are in image coordinates, so we convert them to the transformed canvas coordinates\n// Use the exact scale factor from canvas dataset for perfect coordinate mapping\nconst canvas=ctx.canvas;const newScale=parseFloat(canvas.dataset.scale||'0');const drawnWidth=parseFloat(canvas.dataset.drawnWidth||'0');const drawnHeight=parseFloat(canvas.dataset.drawnHeight||'0');const newOffsetX=parseFloat(canvas.dataset.offsetX||'0');const newOffsetY=parseFloat(canvas.dataset.offsetY||'0');let finalScale,finalOffsetX,finalOffsetY;if(newScale>0&&drawnWidth>0&&drawnHeight>0){// Use new positioning system\nfinalScale=newScale;finalOffsetX=newOffsetX;finalOffsetY=newOffsetY;}else{// Fallback to provided scale and offset\nfinalScale=scale;finalOffsetX=offsetX;finalOffsetY=offsetY;}// Calculate the image bounds in the transformed coordinate system\nconst imageBounds={x:finalOffsetX,y:finalOffsetY,width:canvasImage.width*finalScale,height:canvasImage.height*finalScale};// Convert hotspot bounds from image coordinates to transformed canvas coordinates\nconst x=imageBounds.x+hotspot.bounds.x*finalScale;const y=imageBounds.y+hotspot.bounds.y*finalScale;const width=hotspot.bounds.width*finalScale;const height=hotspot.bounds.height*finalScale;// Debug: Log the scaling calculations (only for drawing hotspots)\nif(isDrawing){console.log('Drawing hotspot:',{hotspotId:hotspot.id,hotspotImageBounds:hotspot.bounds,originalScale:scale,originalOffset:{x:offsetX,y:offsetY},finalScale,finalOffset:{x:finalOffsetX,y:finalOffsetY},canvasCoords:{x,y,width,height},imageBounds:imageBounds,canvasDimensions:{width:ctx.canvas.width,height:ctx.canvas.height},imageDimensions:{width:canvasImage.width,height:canvasImage.height},usingNewSystem:newScale>0});}// Check if this hotspot is being dragged or resized\nconst isActive=((_drawingState$draggin=drawingState.draggingHotspot)===null||_drawingState$draggin===void 0?void 0:_drawingState$draggin.id)===hotspot.id||((_drawingState$resizin=drawingState.resizingHotspot)===null||_drawingState$resizin===void 0?void 0:_drawingState$resizin.id)===hotspot.id;// Draw shadow for better visibility\nctx.shadowColor='rgba(0, 0, 0, 0.3)';ctx.shadowBlur=isActive?8:4;ctx.shadowOffsetX=isActive?4:2;ctx.shadowOffsetY=isActive?4:2;// Draw rectangle with rounded corners\nconst borderOpacity=highTransparency?'50':'80';ctx.strokeStyle=isActive?'#ff6b35':\"\".concat(hotspot.color).concat(borderOpacity);ctx.lineWidth=isActive?4:isDrawing?3:2;ctx.setLineDash(isDrawing?[5,5]:[]);// Draw rounded rectangle\nconst radius=8;ctx.beginPath();ctx.moveTo(x+radius,y);ctx.lineTo(x+width-radius,y);ctx.quadraticCurveTo(x+width,y,x+width,y+radius);ctx.lineTo(x+width,y+height-radius);ctx.quadraticCurveTo(x+width,y+height,x+width-radius,y+height);ctx.lineTo(x+radius,y+height);ctx.quadraticCurveTo(x,y+height,x,y+height-radius);ctx.lineTo(x,y+radius);ctx.quadraticCurveTo(x,y,x+radius,y);ctx.closePath();ctx.stroke();// Reset shadow\nctx.shadowColor='transparent';ctx.shadowBlur=0;ctx.shadowOffsetX=0;ctx.shadowOffsetY=0;// Draw fill with transparency based on user preference\nconst fillOpacity=highTransparency?isActive?'15':'10':isActive?'40':'20';ctx.fillStyle=\"\".concat(hotspot.color).concat(fillOpacity);ctx.fill();// Draw resize handles if not drawing\nif(!isDrawing){const handleSize=8;const handleColor=isActive?'#ff6b35':'#666';const borderColor=isActive?'#fff':'#333';ctx.fillStyle=handleColor;ctx.strokeStyle=borderColor;ctx.lineWidth=2;// Corner handles\nconst handles=[{x:x,y:y},// Northwest\n{x:x+width-handleSize,y:y},// Northeast\n{x:x,y:y+height-handleSize},// Southwest\n{x:x+width-handleSize,y:y+height-handleSize}// Southeast\n];handles.forEach(handle=>{// Draw handle with thicker border\nctx.fillRect(handle.x,handle.y,handleSize,handleSize);ctx.strokeRect(handle.x,handle.y,handleSize,handleSize);// Add inner highlight for better visibility\nctx.strokeStyle='#fff';ctx.lineWidth=1;ctx.strokeRect(handle.x+1,handle.y+1,handleSize-2,handleSize-2);});// Draw border lines for resize areas (optional visual guide)\nif(isActive){ctx.strokeStyle='rgba(255, 107, 53, 0.3)';ctx.lineWidth=1;ctx.setLineDash([3,3]);// Draw diagonal lines from corners to show resize areas\nctx.beginPath();ctx.moveTo(x,y);ctx.lineTo(x+width,y+height);ctx.moveTo(x+width,y);ctx.lineTo(x,y+height);ctx.stroke();ctx.setLineDash([]);}}// Draw label with better styling\nctx.fillStyle='#000';ctx.font=\"bold 12px Arial\";ctx.textAlign='center';ctx.textBaseline='middle';// Add text shadow for better readability\nctx.shadowColor='rgba(255, 255, 255, 0.8)';ctx.shadowBlur=2;ctx.shadowOffsetX=1;ctx.shadowOffsetY=1;ctx.fillText(hotspot.label,x+width/2,y+height/2);// Reset shadow\nctx.shadowColor='transparent';ctx.shadowBlur=0;ctx.shadowOffsetX=0;ctx.shadowOffsetY=0;};const handleHotspotSave=hotspot=>{if(editingHotspot){// Update the entire hotspot data, not just position\nsetHotspots(prevHotspots=>prevHotspots.map(h=>h.id===hotspot.id?hotspot:h));// Also update imported hotspots if it's an imported one\nsetImportedHotspots(prevImportedHotspots=>prevImportedHotspots.map(h=>h.id===hotspot.id?hotspot:h));}else{setHotspots([...hotspots,hotspot]);}setHotspotDialogOpen(false);setEditingHotspot(null);scheduleCanvasRender();};const handleHotspotDelete=hotspotId=>{// Remove from both drawn and imported hotspots\nsetHotspots(prevHotspots=>prevHotspots.filter(h=>h.id!==hotspotId));setImportedHotspots(prevImportedHotspots=>prevImportedHotspots.filter(h=>h.id!==hotspotId));setHotspotDialogOpen(false);setEditingHotspot(null);scheduleCanvasRender();};const convertHotspotsToButtons=()=>{// Combine both drawn hotspots and imported hotspots\nconst allHotspots=[...hotspots,...(showImportedHotspots?importedHotspots:[])];return allHotspots.map(hotspot=>({id:hotspot.id,bounds:hotspot.bounds,action:hotspot.action,label:hotspot.label}));};const handleCanvasCreate=async()=>{console.log('handleCanvasCreate called');console.log('richMenuForm.name:',richMenuForm.name);console.log('hotspots.length:',hotspots.length);console.log('importedHotspots.length:',importedHotspots.length);console.log('showImportedHotspots:',showImportedHotspots);if(!richMenuForm.name.trim()){console.log('Error: No rich menu name');setError('Please enter a rich menu name');return;}if(richMenuForm.chatBarText.length>14){console.log('Error: Chat Bar Text too long');setError('Chat Bar Text must not exceed 14 characters (LINE API limit)');return;}const totalHotspots=hotspots.length+(showImportedHotspots?importedHotspots.length:0);console.log('totalHotspots:',totalHotspots);if(totalHotspots===0){console.log('Error: No hotspots');setError('Please draw at least one hotspot or import hotspots from JSON');return;}try{console.log('Setting creating to true');setCreating(true);setError(null);const buttons=convertHotspotsToButtons();console.log('Converted buttons:',buttons);// Use the selected rich menu size\nconst selectedSize=LINE_RICH_MENU_SIZES[selectedRichMenuSize];const richMenuData=generateRichMenuJSON(richMenuForm.name,buttons,{width:selectedSize.width,height:selectedSize.height});console.log('Generated rich menu data:',richMenuData);// Validate rich menu size against LINE standards\nconst richMenuSize={width:richMenuData.size.width,height:richMenuData.size.height};const isValidSize=Object.values(LINE_RICH_MENU_SIZES).some(standardSize=>standardSize.width===richMenuSize.width&&standardSize.height===richMenuSize.height);if(!isValidSize){const allowedSizes=Object.values(LINE_RICH_MENU_SIZES).map(size=>\"\".concat(size.width,\" x \").concat(size.height)).join(' or ');setError(\"\\u274C Invalid rich menu size! Only LINE standard sizes are allowed: \".concat(allowedSizes));return;}// Validate all richMenuAliasId values in the rich menu\nif(richMenuData.areas){for(let i=0;i<richMenuData.areas.length;i++){const area=richMenuData.areas[i];if(area.action&&area.action.type==='richmenuswitch'&&area.action.richMenuAliasId){if(!validateRichMenuAliasId(area.action.richMenuAliasId)){setError(\"\\u274C Invalid rich menu alias ID in area \".concat(i+1,\": \\\"\").concat(area.action.richMenuAliasId,\"\\\". Only alphanumeric characters and hyphens are allowed (1-40 characters).\"));return;}}}}// Step 1: Validate rich menu object before creation\nconsole.log('Validating rich menu...');try{const validationResponse=await validateRichMenu(richMenuData);console.log('Validation response:',validationResponse);if(!validationResponse.data.success){console.log('Validation failed:',validationResponse.data.message);setError(\"Validation failed: \".concat(validationResponse.data.message||'Unknown validation error'));return;}}catch(validationErr){var _validationErr$respon,_validationErr$respon2,_validationErr$respon3,_validationErr$respon4,_validationErr$respon5,_validationErr$respon6;console.log('Validation error:',validationErr);const errorMessage=((_validationErr$respon=validationErr.response)===null||_validationErr$respon===void 0?void 0:(_validationErr$respon2=_validationErr$respon.data)===null||_validationErr$respon2===void 0?void 0:(_validationErr$respon3=_validationErr$respon2.detail)===null||_validationErr$respon3===void 0?void 0:(_validationErr$respon4=_validationErr$respon3.error)===null||_validationErr$respon4===void 0?void 0:_validationErr$respon4.message)||((_validationErr$respon5=validationErr.response)===null||_validationErr$respon5===void 0?void 0:(_validationErr$respon6=_validationErr$respon5.data)===null||_validationErr$respon6===void 0?void 0:_validationErr$respon6.detail)||'Validation failed';setError(\"Validation failed: \".concat(errorMessage));return;}// Step 2: Create rich menu after successful validation\nconsole.log('Creating rich menu...');const response=await createRichMenu(richMenuData);console.log('Create response:',response);if(response.data.success){const richMenuId=response.data.rich_menu_id;const aliasesCreated=response.data.aliases_created||[];const aliasesSkipped=response.data.aliases_skipped||[];const aliasesFailed=response.data.aliases_failed||[];const aliasesLinked=response.data.aliases_linked||[];console.log('Rich menu created successfully:',richMenuId);console.log('Aliases created:',aliasesCreated);console.log('Aliases skipped:',aliasesSkipped);console.log('Aliases failed:',aliasesFailed);console.log('Aliases linked:',aliasesLinked);// Step 3: Upload the background image if available\nconsole.log('backgroundImageFile:',backgroundImageFile);console.log('backgroundImageFile type:',backgroundImageFile===null||backgroundImageFile===void 0?void 0:backgroundImageFile.type);console.log('backgroundImageFile size:',backgroundImageFile===null||backgroundImageFile===void 0?void 0:backgroundImageFile.size);let successMessage=\"Rich menu \\\"\".concat(richMenuForm.name,\"\\\" created successfully! ID: \").concat(richMenuId);// Add alias information to success message\nif(aliasesCreated.length>0){successMessage+=\"\\n\\n\\u2705 Auto-created \".concat(aliasesCreated.length,\" aliases: \").concat(aliasesCreated.join(', '));}if(aliasesLinked.length>0){successMessage+=\"\\n\\n\\uD83D\\uDD17 Auto-linked \".concat(aliasesLinked.length,\" existing aliases: \").concat(aliasesLinked.join(', '));}if(aliasesSkipped.length>0){successMessage+=\"\\n\\n\\u26A0\\uFE0F Skipped \".concat(aliasesSkipped.length,\" aliases: \").concat(aliasesSkipped.join(', '));}if(aliasesFailed.length>0){successMessage+=\"\\n\\n\\u274C Failed to create \".concat(aliasesFailed.length,\" aliases: \").concat(aliasesFailed.join(', '));}if(backgroundImageFile){console.log('Uploading background image...');try{const uploadResponse=await uploadRichMenuImage(richMenuId,backgroundImageFile);if(uploadResponse.data.success){console.log('Image uploaded successfully');setSuccess(\"\".concat(successMessage,\"\\n\\n\\u2705 Image uploaded successfully!\"));}else{console.log('Image upload failed');setSuccess(\"\".concat(successMessage,\"\\n\\n\\u26A0\\uFE0F Image upload failed\"));}}catch(uploadErr){var _uploadErr$response,_uploadErr$response$d;console.log('Image upload error:',uploadErr);setSuccess(\"\".concat(successMessage,\"\\n\\n\\u26A0\\uFE0F Image upload failed: \").concat(((_uploadErr$response=uploadErr.response)===null||_uploadErr$response===void 0?void 0:(_uploadErr$response$d=_uploadErr$response.data)===null||_uploadErr$response$d===void 0?void 0:_uploadErr$response$d.detail)||'Unknown error'));}}else{console.log('No background image to upload');setSuccess(successMessage);}setCreateDialogOpen(false);resetCreateForm();setHotspots([]);setImportedHotspots([]);setShowImportedHotspots(false);setBackgroundImageUrl('');setBackgroundImageFile(null);loadRichMenus();// Refresh the list\nloadRichMenuAliases();// Refresh aliases\n}else{console.log('Failed to create rich menu');setError('Failed to create rich menu');}}catch(err){var _err$response9,_err$response9$data;console.log('Error in handleCanvasCreate:',err);setError(((_err$response9=err.response)===null||_err$response9===void 0?void 0:(_err$response9$data=_err$response9.data)===null||_err$response9$data===void 0?void 0:_err$response9$data.detail)||'Failed to create rich menu');}finally{console.log('Setting creating to false');setCreating(false);}};const handleFileSelect=event=>{var _event$target$files;const file=(_event$target$files=event.target.files)===null||_event$target$files===void 0?void 0:_event$target$files[0];if(file){setSelectedFile(file);}};const openAssignDialog=richMenu=>{setSelectedRichMenu(richMenu);setAssignDialogOpen(true);};const openUploadDialog=richMenu=>{setSelectedRichMenuForUpload(richMenu);setUploadDialogOpen(true);};const formatDate=dateString=>{return new Date(dateString).toLocaleString();};if(loading&&richMenus.length===0){return/*#__PURE__*/_jsx(Box,{sx:{display:'flex',justifyContent:'center',alignItems:'center',height:'200px'},children:/*#__PURE__*/_jsx(CircularProgress,{})});}return/*#__PURE__*/_jsxs(Box,{sx:{p:{xs:2,md:4},minHeight:'100vh',background:'linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%)'},children:[/*#__PURE__*/_jsxs(Box,{sx:{mb:4,display:'flex',alignItems:'center',gap:3,background:'white',p:3,borderRadius:3,boxShadow:'0 4px 12px rgba(0,0,0,0.08)',border:'1px solid rgba(0,0,0,0.05)'},children:[/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',alignItems:'center',gap:2,flex:1},children:[/*#__PURE__*/_jsx(Box,{sx:{bgcolor:'primary.main',width:56,height:56,borderRadius:2,display:'flex',alignItems:'center',justifyContent:'center',boxShadow:'0 4px 16px rgba(25, 118, 210, 0.3)'},children:/*#__PURE__*/_jsx(Group,{sx:{fontSize:28,color:'white'}})}),/*#__PURE__*/_jsxs(Box,{children:[/*#__PURE__*/_jsx(Typography,{variant:\"h4\",sx:{fontWeight:700,mb:1,background:'linear-gradient(135deg, #1e293b 0%, #334155 100%)',backgroundClip:'text',WebkitBackgroundClip:'text',WebkitTextFillColor:'transparent'},children:\"Rich Menu Management\"}),/*#__PURE__*/_jsx(Typography,{variant:\"body1\",color:\"text.secondary\",sx:{fontSize:'1.1rem'},children:\"Manage LINE Rich Menus and navigation\"})]})]}),/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',gap:2},children:[/*#__PURE__*/_jsx(Button,{variant:\"outlined\",startIcon:/*#__PURE__*/_jsx(Refresh,{}),onClick:loadRichMenus,disabled:loading,children:loading?'Loading...':'Refresh'}),/*#__PURE__*/_jsx(Button,{variant:\"contained\",startIcon:/*#__PURE__*/_jsx(Add,{}),onClick:()=>setCreateDialogOpen(true),disabled:loading,children:\"Create Rich Menu\"})]})]}),error&&/*#__PURE__*/_jsx(Alert,{severity:\"error\",sx:{mb:3},children:error}),success&&/*#__PURE__*/_jsx(Alert,{severity:\"success\",sx:{mb:3},children:success}),/*#__PURE__*/_jsxs(Grid,{container:true,spacing:3,children:[/*#__PURE__*/_jsx(Grid,{item:true,xs:12,children:/*#__PURE__*/_jsx(Card,{sx:{background:'white',borderRadius:3,boxShadow:'0 4px 12px rgba(0,0,0,0.08)',border:'1px solid rgba(0,0,0,0.05)'},children:/*#__PURE__*/_jsxs(CardContent,{sx:{p:3},children:[/*#__PURE__*/_jsxs(Typography,{variant:\"h6\",sx:{mb:2,fontWeight:600},children:[\"Rich Menus Table (\",richMenus.length,\")\"]}),richMenus.length===0?/*#__PURE__*/_jsx(Alert,{severity:\"info\",children:\"No rich menus found. Create rich menus in LINE Developers Console first.\"}):/*#__PURE__*/_jsx(Box,{sx:{overflowX:'auto'},children:/*#__PURE__*/_jsx(TableContainer,{component:Paper,sx:{maxHeight:400},children:/*#__PURE__*/_jsxs(Table,{stickyHeader:true,size:\"small\",children:[/*#__PURE__*/_jsx(TableHead,{children:/*#__PURE__*/_jsxs(TableRow,{children:[/*#__PURE__*/_jsx(TableCell,{sx:{fontWeight:600},children:\"Rich Menu ID\"}),/*#__PURE__*/_jsx(TableCell,{sx:{fontWeight:600},children:\"Name\"}),/*#__PURE__*/_jsx(TableCell,{sx:{fontWeight:600},children:\"Chat Bar Text\"}),/*#__PURE__*/_jsx(TableCell,{sx:{fontWeight:600},children:\"Size\"}),/*#__PURE__*/_jsx(TableCell,{sx:{fontWeight:600},children:\"Areas\"}),/*#__PURE__*/_jsx(TableCell,{sx:{fontWeight:600},children:\"Image\"}),/*#__PURE__*/_jsx(TableCell,{sx:{fontWeight:600},children:\"Default\"}),/*#__PURE__*/_jsx(TableCell,{sx:{fontWeight:600},children:\"Created\"}),/*#__PURE__*/_jsx(TableCell,{sx:{fontWeight:600},children:\"Actions\"})]})}),/*#__PURE__*/_jsx(TableBody,{children:richMenus.map(richMenu=>/*#__PURE__*/_jsxs(TableRow,{hover:true,children:[/*#__PURE__*/_jsx(TableCell,{sx:{fontFamily:'monospace',fontSize:'0.75rem'},children:richMenu.richMenuId}),/*#__PURE__*/_jsx(TableCell,{children:/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',alignItems:'center',gap:1},children:[/*#__PURE__*/_jsx(Typography,{variant:\"body2\",sx:{fontWeight:600},children:richMenu.name}),richMenu.isDefault&&/*#__PURE__*/_jsx(Star,{sx:{fontSize:'1rem',color:'primary.main'}}),richMenu.source===\"database_only\"&&/*#__PURE__*/_jsx(Chip,{label:\"DB Only\",size:\"small\",color:\"warning\",variant:\"outlined\",sx:{fontSize:'0.6rem'}})]})}),/*#__PURE__*/_jsx(TableCell,{children:/*#__PURE__*/_jsxs(Typography,{variant:\"body2\",color:\"text.secondary\",children:[\"\\\"\",richMenu.chatBarText,\"\\\"\"]})}),/*#__PURE__*/_jsx(TableCell,{children:/*#__PURE__*/_jsxs(Typography,{variant:\"body2\",children:[richMenu.size.width,\"\\xD7\",richMenu.size.height]})}),/*#__PURE__*/_jsx(TableCell,{children:/*#__PURE__*/_jsx(Chip,{label:richMenu.areas.length,size:\"small\",variant:\"outlined\"})}),/*#__PURE__*/_jsx(TableCell,{children:/*#__PURE__*/_jsx(Chip,{label:richMenu.hasImage?\"Yes\":\"No\",size:\"small\",color:richMenu.hasImage?\"success\":\"error\",variant:\"outlined\"})}),/*#__PURE__*/_jsxs(TableCell,{children:[richMenu.isDefault?/*#__PURE__*/_jsx(Chip,{label:\"Default\",size:\"small\",color:\"primary\",variant:\"filled\",icon:/*#__PURE__*/_jsx(Star,{})}):/*#__PURE__*/_jsx(Button,{variant:\"outlined\",size:\"small\",startIcon:/*#__PURE__*/_jsx(StarBorder,{}),onClick:()=>handleSetDefault(richMenu.richMenuId),disabled:!richMenu.hasImage,color:\"warning\",sx:{minWidth:'100px',fontSize:'0.7rem'},children:\"Set Default\"}),!richMenu.hasImage&&!richMenu.isDefault&&/*#__PURE__*/_jsx(Typography,{variant:\"caption\",display:\"block\",color:\"error.main\",sx:{mt:0.5},children:\"Upload image first\"})]}),/*#__PURE__*/_jsxs(TableCell,{children:[/*#__PURE__*/_jsx(Typography,{variant:\"caption\",display:\"block\",children:formatDate(richMenu.createdAt)}),richMenu.db_created_at&&/*#__PURE__*/_jsxs(Typography,{variant:\"caption\",display:\"block\",color:\"text.secondary\",children:[\"DB: \",formatDate(richMenu.db_created_at)]})]}),/*#__PURE__*/_jsx(TableCell,{children:/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',gap:0.5,flexDirection:'column'},children:[/*#__PURE__*/_jsx(Button,{variant:\"outlined\",size:\"small\",startIcon:/*#__PURE__*/_jsx(CloudUpload,{}),onClick:()=>openUploadDialog(richMenu),disabled:loading,sx:{minWidth:'80px',fontSize:'0.7rem'},children:richMenu.hasImage?\"Change\":\"Upload\"}),/*#__PURE__*/_jsx(Button,{variant:\"outlined\",size:\"small\",startIcon:/*#__PURE__*/_jsx(Person,{}),onClick:()=>openAssignDialog(richMenu),disabled:loading,sx:{minWidth:'80px',fontSize:'0.7rem'},children:\"Assign\"}),/*#__PURE__*/_jsx(Button,{variant:\"outlined\",size:\"small\",startIcon:/*#__PURE__*/_jsx(Delete,{}),onClick:()=>handleDeleteRichMenu(richMenu),disabled:loading,color:\"error\",sx:{minWidth:'80px',fontSize:'0.7rem'},children:\"Delete\"})]})})]},richMenu.richMenuId))})]})})})]})})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,children:/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsxs(CardContent,{children:[/*#__PURE__*/_jsxs(Typography,{variant:\"h6\",sx:{mb:2,fontWeight:600},children:[\"Rich Menus Details (\",richMenus.length,\")\"]}),richMenus.length===0?/*#__PURE__*/_jsx(Alert,{severity:\"info\",children:\"No rich menus found. Create rich menus in LINE Developers Console first.\"}):/*#__PURE__*/_jsx(List,{children:richMenus.map((richMenu,index)=>/*#__PURE__*/_jsxs(React.Fragment,{children:[/*#__PURE__*/_jsxs(ListItem,{children:[/*#__PURE__*/_jsx(ListItemText,{primary:/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',alignItems:'center',gap:1,mb:1},children:[/*#__PURE__*/_jsx(Typography,{variant:\"h6\",sx:{fontWeight:600,color:'primary.main'},children:richMenu.name}),richMenu.isDefault&&/*#__PURE__*/_jsx(Chip,{icon:/*#__PURE__*/_jsx(Star,{}),label:\"Default\",color:\"primary\",size:\"small\"})]}),secondary:/*#__PURE__*/_jsxs(Box,{children:[/*#__PURE__*/_jsxs(Box,{sx:{mb:2,p:1,bgcolor:'grey.50',borderRadius:1},children:[/*#__PURE__*/_jsx(Typography,{variant:\"body2\",sx:{fontWeight:600,color:'text.primary'},children:\"Rich Menu ID:\"}),/*#__PURE__*/_jsx(Typography,{variant:\"body2\",sx:{fontFamily:'monospace',fontSize:'0.8rem'},children:richMenu.richMenuId})]}),/*#__PURE__*/_jsxs(Grid,{container:true,spacing:2,sx:{mb:2},children:[/*#__PURE__*/_jsxs(Grid,{item:true,xs:12,md:6,children:[/*#__PURE__*/_jsx(Typography,{variant:\"body2\",sx:{fontWeight:600},children:\"Chat Bar Text:\"}),/*#__PURE__*/_jsxs(Typography,{variant:\"body2\",color:\"text.secondary\",children:[\"\\\"\",richMenu.chatBarText,\"\\\"\"]})]}),/*#__PURE__*/_jsxs(Grid,{item:true,xs:12,md:6,children:[/*#__PURE__*/_jsx(Typography,{variant:\"body2\",sx:{fontWeight:600},children:\"Size:\"}),/*#__PURE__*/_jsxs(Typography,{variant:\"body2\",color:\"text.secondary\",children:[richMenu.size.width,\" \\xD7 \",richMenu.size.height,\" pixels\"]})]}),/*#__PURE__*/_jsxs(Grid,{item:true,xs:12,md:6,children:[/*#__PURE__*/_jsx(Typography,{variant:\"body2\",sx:{fontWeight:600},children:\"Tap Areas:\"}),/*#__PURE__*/_jsxs(Typography,{variant:\"body2\",color:\"text.secondary\",children:[richMenu.areas.length,\" areas configured\"]})]}),/*#__PURE__*/_jsxs(Grid,{item:true,xs:12,md:6,children:[/*#__PURE__*/_jsx(Typography,{variant:\"body2\",sx:{fontWeight:600},children:\"Status:\"}),/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',gap:1,alignItems:'center'},children:[/*#__PURE__*/_jsx(Chip,{label:richMenu.isDefault?\"Default\":\"Set as Default\",size:\"small\",color:richMenu.isDefault?\"primary\":\"warning\",variant:richMenu.isDefault?\"filled\":\"outlined\",onClick:richMenu.isDefault?undefined:()=>handleSetDefault(richMenu.richMenuId),sx:richMenu.isDefault?{}:{cursor:'pointer'},disabled:!richMenu.hasImage}),!richMenu.hasImage&&/*#__PURE__*/_jsx(Chip,{label:\"No Image\",size:\"small\",color:\"error\",variant:\"outlined\"})]})]})]}),/*#__PURE__*/_jsxs(Box,{sx:{mb:2,p:1,bgcolor:'grey.50',borderRadius:1},children:[/*#__PURE__*/_jsx(Typography,{variant:\"body2\",sx:{fontWeight:600,mb:1},children:\"Timestamps:\"}),/*#__PURE__*/_jsxs(Grid,{container:true,spacing:1,children:[/*#__PURE__*/_jsxs(Grid,{item:true,xs:12,md:6,children:[/*#__PURE__*/_jsx(Typography,{variant:\"caption\",sx:{fontWeight:600},children:\"LINE Created:\"}),/*#__PURE__*/_jsx(Typography,{variant:\"caption\",display:\"block\",color:\"text.secondary\",children:formatDate(richMenu.createdAt)})]}),richMenu.db_created_at&&/*#__PURE__*/_jsxs(Grid,{item:true,xs:12,md:6,children:[/*#__PURE__*/_jsx(Typography,{variant:\"caption\",sx:{fontWeight:600},children:\"DB Created:\"}),/*#__PURE__*/_jsxs(Typography,{variant:\"caption\",display:\"block\",color:\"text.secondary\",children:[formatDate(richMenu.db_created_at),\" by \",richMenu.db_created_by||'Unknown']})]}),richMenu.db_updated_at&&/*#__PURE__*/_jsxs(Grid,{item:true,xs:12,md:6,children:[/*#__PURE__*/_jsx(Typography,{variant:\"caption\",sx:{fontWeight:600},children:\"Last Updated:\"}),/*#__PURE__*/_jsx(Typography,{variant:\"caption\",display:\"block\",color:\"text.secondary\",children:formatDate(richMenu.db_updated_at)})]})]})]}),/*#__PURE__*/_jsx(Box,{sx:{mb:2},children:/*#__PURE__*/_jsxs(Accordion,{sx:{boxShadow:'none'},children:[/*#__PURE__*/_jsx(AccordionSummary,{expandIcon:/*#__PURE__*/_jsx(ExpandMore,{}),children:/*#__PURE__*/_jsx(Typography,{variant:\"body2\",sx:{fontWeight:600},children:\"JSON Body (LINE API Structure)\"})}),/*#__PURE__*/_jsx(AccordionDetails,{children:/*#__PURE__*/_jsx(Box,{sx:{p:1,bgcolor:'grey.50',borderRadius:1},children:/*#__PURE__*/_jsx(\"pre\",{style:{fontSize:'0.75rem',overflow:'auto',margin:0,fontFamily:'monospace',whiteSpace:'pre-wrap',wordBreak:'break-word'},children:JSON.stringify({size:richMenu.size,selected:richMenu.selected,name:richMenu.name,chatBarText:richMenu.chatBarText,areas:richMenu.areas},null,2)})})})]})}),/*#__PURE__*/_jsxs(Box,{sx:{mb:2,p:1,bgcolor:'blue.50',borderRadius:1},children:[/*#__PURE__*/_jsx(Typography,{variant:\"body2\",sx:{fontWeight:600,mb:1,color:'primary.main'},children:\"User Assignment:\"}),/*#__PURE__*/_jsx(Typography,{variant:\"body2\",color:\"text.secondary\",sx:{mb:1},children:\"This rich menu can be assigned to specific users or set as default for all users.\"}),/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',gap:1,flexWrap:'wrap'},children:[/*#__PURE__*/_jsx(Chip,{label:\"Assign to User\",size:\"small\",color:\"info\",variant:\"outlined\",onClick:()=>openAssignDialog(richMenu),sx:{cursor:'pointer'}}),richMenu.isDefault?/*#__PURE__*/_jsx(Chip,{label:\"Default\",size:\"small\",color:\"primary\",variant:\"filled\",icon:/*#__PURE__*/_jsx(Star,{})}):/*#__PURE__*/_jsx(Button,{variant:\"outlined\",size:\"small\",startIcon:/*#__PURE__*/_jsx(StarBorder,{}),onClick:()=>handleSetDefault(richMenu.richMenuId),disabled:!richMenu.hasImage,color:\"warning\",sx:{minWidth:'120px',fontSize:'0.8rem'},children:\"Set as Default\"})]})]}),/*#__PURE__*/_jsxs(Accordion,{sx:{mt:1,boxShadow:'none'},children:[/*#__PURE__*/_jsx(AccordionSummary,{expandIcon:/*#__PURE__*/_jsx(ExpandMore,{}),children:/*#__PURE__*/_jsxs(Typography,{variant:\"caption\",children:[\"View \",richMenu.areas.length,\" tap areas\"]})}),/*#__PURE__*/_jsx(AccordionDetails,{children:/*#__PURE__*/_jsx(Grid,{container:true,spacing:1,children:richMenu.areas.map((area,areaIndex)=>/*#__PURE__*/_jsx(Grid,{item:true,xs:12,md:6,children:/*#__PURE__*/_jsxs(Box,{sx:{p:1,border:1,borderColor:'divider',borderRadius:1},children:[/*#__PURE__*/_jsxs(Typography,{variant:\"caption\",sx:{fontWeight:600},children:[\"Area \",areaIndex+1]}),/*#__PURE__*/_jsxs(Typography,{variant:\"caption\",display:\"block\",children:[\"Position: (\",area.bounds.x,\", \",area.bounds.y,\") Size: \",area.bounds.width,\"\\xD7\",area.bounds.height]}),/*#__PURE__*/_jsxs(Typography,{variant:\"caption\",display:\"block\",children:[\"Action: \",area.action.type,\" - \",area.action.label]}),area.action.uri&&/*#__PURE__*/_jsxs(Typography,{variant:\"caption\",display:\"block\",sx:{wordBreak:'break-all'},children:[\"URI: \",area.action.uri]})]})},areaIndex))})})]})]})}),/*#__PURE__*/_jsx(ListItemSecondaryAction,{children:/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',flexDirection:'column',gap:1,alignItems:'flex-end'},children:[/*#__PURE__*/_jsxs(Box,{sx:{textAlign:'right'},children:[/*#__PURE__*/_jsx(Typography,{variant:\"caption\",sx:{fontWeight:600,display:'block'},children:\"Image Status:\"}),/*#__PURE__*/_jsx(Chip,{label:richMenu.hasImage?\"Image Uploaded\":\"No Image\",size:\"small\",color:richMenu.hasImage?\"success\":\"error\",variant:\"outlined\"})]}),/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',gap:1,flexDirection:'column'},children:[/*#__PURE__*/_jsx(Button,{variant:\"outlined\",size:\"small\",startIcon:/*#__PURE__*/_jsx(Visibility,{}),onClick:()=>handleOpenDetailsDialog(richMenu),disabled:loading,sx:{minWidth:'120px'},children:\"View Details\"}),/*#__PURE__*/_jsx(Button,{variant:\"outlined\",size:\"small\",startIcon:/*#__PURE__*/_jsx(CloudUpload,{}),onClick:()=>openUploadDialog(richMenu),disabled:loading,sx:{minWidth:'120px'},children:richMenu.hasImage?\"Change Image\":\"Upload Image\"}),/*#__PURE__*/_jsx(Button,{variant:\"outlined\",size:\"small\",startIcon:/*#__PURE__*/_jsx(Person,{}),onClick:()=>openAssignDialog(richMenu),disabled:loading,sx:{minWidth:'120px'},children:\"Assign to User\"}),/*#__PURE__*/_jsx(Button,{variant:\"outlined\",size:\"small\",startIcon:/*#__PURE__*/_jsx(Link,{}),onClick:()=>handleCreateAlias(richMenu.richMenuId),disabled:loading,sx:{minWidth:'120px'},color:\"info\",children:\"Create Aliases\"})]})]})})]}),index<richMenus.length-1&&/*#__PURE__*/_jsx(Divider,{})]},richMenu.richMenuId))})]})})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,children:/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsxs(CardContent,{children:[/*#__PURE__*/_jsx(Typography,{variant:\"h6\",sx:{mb:2,fontWeight:600},children:\"Quick Actions\"}),/*#__PURE__*/_jsxs(Grid,{container:true,spacing:2,children:[/*#__PURE__*/_jsxs(Grid,{item:true,xs:12,md:6,children:[/*#__PURE__*/_jsx(TextField,{fullWidth:true,label:\"User ID to Unlink\",placeholder:\"Enter LINE User ID\",helperText:\"Remove custom rich menu assignment (user will see default)\"}),/*#__PURE__*/_jsx(Button,{variant:\"outlined\",startIcon:/*#__PURE__*/_jsx(LinkOff,{}),sx:{mt:1},disabled:loading,children:\"Unlink from User\"})]}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,md:6,children:/*#__PURE__*/_jsx(Alert,{severity:\"info\",children:/*#__PURE__*/_jsxs(Typography,{variant:\"body2\",children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Rich Menu Management Tips:\"}),/*#__PURE__*/_jsx(\"br\",{}),\"\\u2022 Create rich menus in LINE Developers Console\",/*#__PURE__*/_jsx(\"br\",{}),\"\\u2022 Default rich menu is shown to all users\",/*#__PURE__*/_jsx(\"br\",{}),\"\\u2022 Per-user rich menus override the default\",/*#__PURE__*/_jsx(\"br\",{}),\"\\u2022 Rich menus can have up to 20 tap areas\"]})})})]})]})})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,children:/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsxs(CardContent,{children:[/*#__PURE__*/_jsxs(Typography,{variant:\"h6\",sx:{mb:2,fontWeight:600},children:[\"Rich Menu Aliases (\",richMenuAliases.length,\")\"]}),/*#__PURE__*/_jsx(Alert,{severity:\"info\",sx:{mb:2},children:/*#__PURE__*/_jsxs(Typography,{variant:\"body2\",children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Rich Menu Aliases:\"}),\" These aliases enable switching between rich menus using the \\\"richmenuswitch\\\" action type. When you create a rich menu with \\\"richmenuswitch\\\" actions, you need to create corresponding aliases for the target rich menus.\"]})}),/*#__PURE__*/_jsxs(Box,{sx:{mb:2,display:'flex',gap:2,alignItems:'center'},children:[/*#__PURE__*/_jsx(Typography,{variant:\"body2\",sx:{fontWeight:600},children:\"Badge Legend:\"}),/*#__PURE__*/_jsx(Chip,{label:\"LINE\",color:\"primary\",size:\"small\",variant:\"filled\",sx:{fontSize:'0.7rem',height:24}}),/*#__PURE__*/_jsx(Typography,{variant:\"body2\",color:\"text.secondary\",children:\"Exists in LINE API\"}),/*#__PURE__*/_jsx(Chip,{label:\"Local\",color:\"secondary\",size:\"small\",variant:\"filled\",sx:{fontSize:'0.7rem',height:24}}),/*#__PURE__*/_jsx(Typography,{variant:\"body2\",color:\"text.secondary\",children:\"Stored in database\"})]}),/*#__PURE__*/_jsxs(Box,{sx:{mb:2,display:'flex',gap:1,flexWrap:'wrap'},children:[/*#__PURE__*/_jsx(Button,{variant:\"contained\",color:\"primary\",startIcon:/*#__PURE__*/_jsx(Refresh,{}),onClick:handleFetchAndLinkAliases,sx:{minWidth:200},children:\"Sync from LINE API\"}),/*#__PURE__*/_jsx(Button,{variant:\"contained\",color:\"secondary\",startIcon:/*#__PURE__*/_jsx(Add,{}),onClick:handleOpenCreateAliasDialog,sx:{minWidth:200},children:\"Create Alias\"}),/*#__PURE__*/_jsx(Button,{variant:\"outlined\",color:\"warning\",startIcon:/*#__PURE__*/_jsx(Delete,{}),onClick:handleCleanupAliases,sx:{minWidth:200},children:\"Cleanup Duplicates\"}),/*#__PURE__*/_jsx(Typography,{variant:\"body2\",color:\"text.secondary\",sx:{alignSelf:'center',ml:1},children:\"Sync from LINE API, create new aliases, or cleanup duplicates\"})]}),richMenuAliases.length===0?/*#__PURE__*/_jsx(Alert,{severity:\"warning\",children:\"No rich menu aliases found. Aliases are automatically created when you use \\\"Create Aliases\\\" action on rich menus with \\\"richmenuswitch\\\" actions.\"}):/*#__PURE__*/_jsx(TableContainer,{component:Paper,sx:{maxHeight:400},children:/*#__PURE__*/_jsxs(Table,{stickyHeader:true,children:[/*#__PURE__*/_jsx(TableHead,{children:/*#__PURE__*/_jsxs(TableRow,{children:[/*#__PURE__*/_jsx(TableCell,{sx:{fontWeight:600},children:\"Alias ID\"}),/*#__PURE__*/_jsx(TableCell,{sx:{fontWeight:600},children:\"Rich Menu ID\"}),/*#__PURE__*/_jsx(TableCell,{sx:{fontWeight:600},children:\"Name\"}),/*#__PURE__*/_jsx(TableCell,{sx:{fontWeight:600},children:\"Status\"}),/*#__PURE__*/_jsx(TableCell,{sx:{fontWeight:600},children:\"Created\"}),/*#__PURE__*/_jsx(TableCell,{sx:{fontWeight:600},children:\"Actions\"})]})}),/*#__PURE__*/_jsx(TableBody,{children:richMenuAliases.map(alias=>/*#__PURE__*/_jsxs(TableRow,{children:[/*#__PURE__*/_jsx(TableCell,{children:/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',alignItems:'center',gap:1},children:[/*#__PURE__*/_jsx(Typography,{variant:\"body2\",sx:{fontFamily:'monospace',fontSize:'0.8rem'},children:alias.richMenuAliasId}),/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',gap:0.5},children:[alias.status==='linked'&&/*#__PURE__*/_jsx(Chip,{label:\"LINE\",color:\"primary\",size:\"small\",variant:\"filled\",sx:{fontSize:'0.6rem',height:20}}),/*#__PURE__*/_jsx(Chip,{label:\"Local\",color:\"secondary\",size:\"small\",variant:\"filled\",sx:{fontSize:'0.6rem',height:20}})]})]})}),/*#__PURE__*/_jsx(TableCell,{children:/*#__PURE__*/_jsx(Typography,{variant:\"body2\",sx:{fontFamily:'monospace',fontSize:'0.8rem'},children:alias.richMenuId||'Not linked'})}),/*#__PURE__*/_jsx(TableCell,{children:alias.name}),/*#__PURE__*/_jsx(TableCell,{children:/*#__PURE__*/_jsx(Chip,{label:alias.status||'linked',color:alias.status==='unlinked'?'warning':'success',size:\"small\",variant:\"outlined\"})}),/*#__PURE__*/_jsx(TableCell,{children:formatDate(alias.created_at)}),/*#__PURE__*/_jsx(TableCell,{children:/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',gap:1},children:[/*#__PURE__*/_jsx(Button,{variant:\"outlined\",size:\"small\",color:\"primary\",startIcon:/*#__PURE__*/_jsx(Edit,{}),onClick:()=>handleOpenUpdateAliasDialog(alias),children:\"Update\"}),/*#__PURE__*/_jsx(Button,{variant:\"outlined\",size:\"small\",color:\"error\",startIcon:/*#__PURE__*/_jsx(Delete,{}),onClick:()=>handleDeleteAlias(alias.richMenuAliasId),children:\"Delete\"})]})})]},alias.richMenuAliasId))})]})})]})})})]}),/*#__PURE__*/_jsxs(Dialog,{open:detailsDialogOpen,onClose:()=>setDetailsDialogOpen(false),maxWidth:\"xl\",fullWidth:true,PaperProps:{sx:{borderRadius:2,maxHeight:'95vh',background:'#fafafa'}},children:[/*#__PURE__*/_jsxs(Box,{sx:{background:'#1976d2',color:'white',p:3,borderTopLeftRadius:8,borderTopRightRadius:8},children:[/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',alignItems:'center',justifyContent:'space-between',mb:2},children:[/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',alignItems:'center'},children:[/*#__PURE__*/_jsx(Image,{sx:{mr:2,fontSize:28}}),/*#__PURE__*/_jsxs(Box,{children:[/*#__PURE__*/_jsx(Typography,{variant:\"h4\",sx:{fontWeight:700,mb:0.5},children:\"Rich Menu Details\"}),selectedRichMenuForDetails&&/*#__PURE__*/_jsx(Typography,{variant:\"subtitle1\",sx:{opacity:0.9,fontWeight:400},children:selectedRichMenuForDetails.name})]})]}),/*#__PURE__*/_jsx(IconButton,{onClick:()=>setDetailsDialogOpen(false),sx:{color:'white',border:'2px solid rgba(255,255,255,0.3)','&:hover':{borderColor:'white',background:'rgba(255,255,255,0.1)'}},children:/*#__PURE__*/_jsx(Close,{})})]}),/*#__PURE__*/_jsxs(Grid,{container:true,spacing:2,children:[/*#__PURE__*/_jsx(Grid,{item:true,xs:12,sm:4,children:/*#__PURE__*/_jsxs(Box,{sx:{background:'rgba(255,255,255,0.1)',p:2,borderRadius:2,textAlign:'center'},children:[/*#__PURE__*/_jsx(Typography,{variant:\"h6\",sx:{fontWeight:600,mb:1},children:\"Rich Menu ID\"}),/*#__PURE__*/_jsx(Typography,{variant:\"body2\",sx:{fontFamily:'monospace',fontSize:'0.75rem',wordBreak:'break-all',opacity:0.9},children:(richMenuDetails===null||richMenuDetails===void 0?void 0:(_richMenuDetails$rich=richMenuDetails.rich_menu)===null||_richMenuDetails$rich===void 0?void 0:_richMenuDetails$rich.richMenuId)||'Loading...'})]})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,sm:4,children:/*#__PURE__*/_jsxs(Box,{sx:{background:'rgba(255,255,255,0.1)',p:2,borderRadius:2,textAlign:'center'},children:[/*#__PURE__*/_jsx(Typography,{variant:\"h6\",sx:{fontWeight:600,mb:1},children:\"Size\"}),/*#__PURE__*/_jsxs(Typography,{variant:\"h5\",sx:{fontWeight:700},children:[(richMenuDetails===null||richMenuDetails===void 0?void 0:(_richMenuDetails$rich2=richMenuDetails.rich_menu)===null||_richMenuDetails$rich2===void 0?void 0:(_richMenuDetails$rich3=_richMenuDetails$rich2.size)===null||_richMenuDetails$rich3===void 0?void 0:_richMenuDetails$rich3.width)||0,\" \\xD7 \",(richMenuDetails===null||richMenuDetails===void 0?void 0:(_richMenuDetails$rich4=richMenuDetails.rich_menu)===null||_richMenuDetails$rich4===void 0?void 0:(_richMenuDetails$rich5=_richMenuDetails$rich4.size)===null||_richMenuDetails$rich5===void 0?void 0:_richMenuDetails$rich5.height)||0]})]})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,sm:4,children:/*#__PURE__*/_jsxs(Box,{sx:{background:'rgba(255,255,255,0.1)',p:2,borderRadius:2,textAlign:'center'},children:[/*#__PURE__*/_jsx(Typography,{variant:\"h6\",sx:{fontWeight:600,mb:1},children:\"Hotspots\"}),/*#__PURE__*/_jsx(Typography,{variant:\"h5\",sx:{fontWeight:700},children:(richMenuDetails===null||richMenuDetails===void 0?void 0:(_richMenuDetails$rich6=richMenuDetails.rich_menu)===null||_richMenuDetails$rich6===void 0?void 0:(_richMenuDetails$rich7=_richMenuDetails$rich6.areas)===null||_richMenuDetails$rich7===void 0?void 0:_richMenuDetails$rich7.length)||0})]})})]})]}),/*#__PURE__*/_jsx(DialogContent,{sx:{p:0,background:'#fafafa'},children:loadingDetails?/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',flexDirection:'column',alignItems:'center',justifyContent:'center',p:8,minHeight:'500px'},children:[/*#__PURE__*/_jsx(CircularProgress,{size:80,sx:{mb:3,color:'#1976d2'}}),/*#__PURE__*/_jsx(Typography,{variant:\"h5\",color:\"text.secondary\",sx:{mb:1},children:\"Loading Rich Menu Details\"}),/*#__PURE__*/_jsx(Typography,{variant:\"body1\",color:\"text.secondary\",children:\"Fetching data from LINE API...\"})]}):richMenuDetails?/*#__PURE__*/_jsx(Box,{sx:{p:4},children:/*#__PURE__*/_jsxs(Grid,{container:true,spacing:4,children:[/*#__PURE__*/_jsxs(Grid,{item:true,xs:12,lg:8,children:[/*#__PURE__*/_jsxs(Card,{sx:{borderRadius:3,overflow:'hidden',boxShadow:'0 4px 20px rgba(0,0,0,0.1)',mb:4},children:[/*#__PURE__*/_jsxs(Box,{sx:{p:2.5,background:'#1976d2',color:'white',display:'flex',alignItems:'center',justifyContent:'space-between'},children:[/*#__PURE__*/_jsxs(Typography,{variant:\"h6\",sx:{fontWeight:600,display:'flex',alignItems:'center'},children:[/*#__PURE__*/_jsx(Image,{sx:{mr:1.5}}),\"Rich Menu Image Preview\"]}),/*#__PURE__*/_jsx(Chip,{label:richMenuDetails.image?'Image Available':'No Image',color:richMenuDetails.image?'success':'default',variant:\"filled\",size:\"small\"})]}),richMenuDetails.image?/*#__PURE__*/_jsx(Box,{sx:{position:'relative',background:'linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%)',minHeight:'500px',display:'flex',alignItems:'center',justifyContent:'center',p:3},children:/*#__PURE__*/_jsxs(Box,{sx:{position:'relative',borderRadius:3,overflow:'hidden',boxShadow:'0 8px 32px rgba(0,0,0,0.2)',border:'3px solid white'},children:[/*#__PURE__*/_jsx(\"img\",{src:richMenuDetails.image,alt:\"Rich Menu\",onLoad:handleImageLoad,style:{maxWidth:'100%',maxHeight:'600px',objectFit:'contain',display:'block'}}),imageLoaded&&((_richMenuDetails$rich8=richMenuDetails.rich_menu)===null||_richMenuDetails$rich8===void 0?void 0:_richMenuDetails$rich8.areas)&&richMenuDetails.rich_menu.areas.length>0&&/*#__PURE__*/_jsx(Box,{sx:{position:'absolute',top:0,left:0,width:'100%',height:'100%',pointerEvents:'none'},children:richMenuDetails.rich_menu.areas.map((area,index)=>{var _richMenuDetails$rich9,_richMenuDetails$rich0,_richMenuDetails$rich1,_richMenuDetails$rich10;// Calculate relative positions based on image size\nconst imageWidth=((_richMenuDetails$rich9=richMenuDetails.rich_menu)===null||_richMenuDetails$rich9===void 0?void 0:(_richMenuDetails$rich0=_richMenuDetails$rich9.size)===null||_richMenuDetails$rich0===void 0?void 0:_richMenuDetails$rich0.width)||2500;const imageHeight=((_richMenuDetails$rich1=richMenuDetails.rich_menu)===null||_richMenuDetails$rich1===void 0?void 0:(_richMenuDetails$rich10=_richMenuDetails$rich1.size)===null||_richMenuDetails$rich10===void 0?void 0:_richMenuDetails$rich10.height)||1686;// Calculate scale factors\nconst scaleX=imageDimensions.width/imageWidth;const scaleY=imageDimensions.height/imageHeight;// Calculate scaled positions and dimensions\nconst scaledX=area.bounds.x*scaleX;const scaledY=area.bounds.y*scaleY;const scaledWidth=area.bounds.width*scaleX;const scaledHeight=area.bounds.height*scaleY;return/*#__PURE__*/_jsx(Box,{sx:{position:'absolute',left:\"\".concat(scaledX,\"px\"),top:\"\".concat(scaledY,\"px\"),width:\"\".concat(scaledWidth,\"px\"),height:\"\".concat(scaledHeight,\"px\"),border:'3px solid #ff4444',background:'rgba(255, 68, 68, 0.2)',borderRadius:'4px',display:'flex',alignItems:'center',justifyContent:'center',pointerEvents:'none',zIndex:10,transition:'all 0.3s ease'},children:/*#__PURE__*/_jsxs(Box,{sx:{position:'absolute',top:'-25px',left:'50%',transform:'translateX(-50%)',background:'#ff4444',color:'white',padding:'2px 8px',borderRadius:'12px',fontSize:'12px',fontWeight:'bold',whiteSpace:'nowrap',zIndex:11,boxShadow:'0 2px 8px rgba(0,0,0,0.3)'},children:[\"Hotspot \",index+1]})},index);})})]})}):/*#__PURE__*/_jsxs(Box,{sx:{p:6,textAlign:'center',background:'linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%)',minHeight:'500px',display:'flex',flexDirection:'column',alignItems:'center',justifyContent:'center'},children:[/*#__PURE__*/_jsx(Box,{sx:{width:120,height:120,borderRadius:'50%',background:'rgba(25, 118, 210, 0.1)',display:'flex',alignItems:'center',justifyContent:'center',mb:3},children:/*#__PURE__*/_jsx(Image,{sx:{fontSize:60,color:'#1976d2'}})}),/*#__PURE__*/_jsx(Typography,{variant:\"h5\",color:\"text.secondary\",sx:{mb:2,fontWeight:600},children:\"No Image Available\"}),/*#__PURE__*/_jsx(Typography,{variant:\"body1\",color:\"text.secondary\",sx:{maxWidth:400},children:\"This rich menu doesn't have an image uploaded. Images are required for rich menus to be displayed properly in LINE.\"})]})]}),/*#__PURE__*/_jsxs(Card,{sx:{borderRadius:3,boxShadow:'0 4px 20px rgba(0,0,0,0.1)'},children:[/*#__PURE__*/_jsxs(Box,{sx:{p:2.5,background:'#1976d2',color:'white',display:'flex',alignItems:'center',justifyContent:'space-between'},children:[/*#__PURE__*/_jsxs(Typography,{variant:\"h6\",sx:{fontWeight:600,display:'flex',alignItems:'center'},children:[/*#__PURE__*/_jsx(Code,{sx:{mr:1.5}}),\"Interactive Hotspots & Actions\"]}),/*#__PURE__*/_jsx(Chip,{label:\"\".concat(((_richMenuDetails$rich11=richMenuDetails.rich_menu)===null||_richMenuDetails$rich11===void 0?void 0:(_richMenuDetails$rich12=_richMenuDetails$rich11.areas)===null||_richMenuDetails$rich12===void 0?void 0:_richMenuDetails$rich12.length)||0,\" Hotspots\"),color:\"secondary\",variant:\"filled\",size:\"small\"})]}),/*#__PURE__*/_jsx(Box,{sx:{p:3},children:(_richMenuDetails$rich13=richMenuDetails.rich_menu)!==null&&_richMenuDetails$rich13!==void 0&&_richMenuDetails$rich13.areas&&richMenuDetails.rich_menu.areas.length>0?/*#__PURE__*/_jsx(Grid,{container:true,spacing:3,children:richMenuDetails.rich_menu.areas.map((area,index)=>/*#__PURE__*/_jsx(Grid,{item:true,xs:12,md:6,children:/*#__PURE__*/_jsx(Card,{variant:\"outlined\",sx:{borderRadius:3,border:'2px solid #e3f2fd',background:'#fafafa','&:hover':{borderColor:'#1976d2',boxShadow:'0 4px 20px rgba(25, 118, 210, 0.15)',transform:'translateY(-2px)',transition:'all 0.3s ease'},transition:'all 0.3s ease'},children:/*#__PURE__*/_jsxs(CardContent,{sx:{p:3},children:[/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',alignItems:'center',mb:3,pb:2,borderBottom:'2px solid #e3f2fd'},children:[/*#__PURE__*/_jsx(Box,{sx:{width:40,height:40,borderRadius:'50%',background:'#1976d2',display:'flex',alignItems:'center',justifyContent:'center',mr:2,boxShadow:'0 2px 8px rgba(25, 118, 210, 0.3)'},children:/*#__PURE__*/_jsx(Typography,{variant:\"h6\",sx:{color:'white',fontWeight:700},children:index+1})}),/*#__PURE__*/_jsxs(Box,{children:[/*#__PURE__*/_jsxs(Typography,{variant:\"h6\",sx:{fontWeight:700,color:'#1976d2'},children:[\"Hotspot \",index+1]}),/*#__PURE__*/_jsx(Typography,{variant:\"caption\",color:\"text.secondary\",children:\"Tap Area Configuration\"})]})]}),/*#__PURE__*/_jsxs(Box,{sx:{mb:3},children:[/*#__PURE__*/_jsx(Typography,{variant:\"subtitle2\",color:\"text.secondary\",sx:{fontWeight:600,mb:1},children:\"\\uD83D\\uDCCD Position & Dimensions\"}),/*#__PURE__*/_jsxs(Box,{sx:{background:'#e3f2fd',p:2,borderRadius:2,border:'1px solid #bbdefb'},children:[/*#__PURE__*/_jsxs(Typography,{variant:\"body2\",sx:{fontFamily:'monospace',fontSize:'0.9rem',color:'#1976d2',fontWeight:600},children:[\"X: \",area.bounds.x,\" | Y: \",area.bounds.y]}),/*#__PURE__*/_jsxs(Typography,{variant:\"body2\",sx:{fontFamily:'monospace',fontSize:'0.9rem',color:'#1976d2',fontWeight:600},children:[\"Width: \",area.bounds.width,\" | Height: \",area.bounds.height]})]})]}),/*#__PURE__*/_jsxs(Box,{sx:{mb:3},children:[/*#__PURE__*/_jsx(Typography,{variant:\"subtitle2\",color:\"text.secondary\",sx:{fontWeight:600,mb:1},children:\"\\u26A1 Action Type\"}),/*#__PURE__*/_jsx(Chip,{label:area.action.type.toUpperCase(),size:\"medium\",color:area.action.type==='postback'?'primary':area.action.type==='message'?'secondary':area.action.type==='uri'?'success':area.action.type==='richmenuswitch'?'warning':'default',variant:\"filled\",sx:{fontWeight:700,fontSize:'0.8rem',height:32}})]}),area.action.type==='postback'&&area.action.data&&/*#__PURE__*/_jsxs(Box,{sx:{mb:2},children:[/*#__PURE__*/_jsx(Typography,{variant:\"subtitle2\",color:\"text.secondary\",sx:{fontWeight:600,mb:1},children:\"\\uD83D\\uDCE4 Postback Data\"}),/*#__PURE__*/_jsx(Box,{sx:{background:'#f5f5f5',p:2,borderRadius:2,border:'1px solid #e0e0e0'},children:/*#__PURE__*/_jsx(Typography,{variant:\"body2\",sx:{fontFamily:'monospace',fontSize:'0.85rem',wordBreak:'break-all',color:'#424242'},children:area.action.data})})]}),area.action.type==='message'&&area.action.text&&/*#__PURE__*/_jsxs(Box,{sx:{mb:2},children:[/*#__PURE__*/_jsx(Typography,{variant:\"subtitle2\",color:\"text.secondary\",sx:{fontWeight:600,mb:1},children:\"\\uD83D\\uDCAC Message Text\"}),/*#__PURE__*/_jsx(Box,{sx:{background:'#f5f5f5',p:2,borderRadius:2,border:'1px solid #e0e0e0'},children:/*#__PURE__*/_jsxs(Typography,{variant:\"body2\",sx:{color:'#424242',fontStyle:'italic'},children:[\"\\\"\",area.action.text,\"\\\"\"]})})]}),area.action.type==='uri'&&area.action.uri&&/*#__PURE__*/_jsxs(Box,{sx:{mb:2},children:[/*#__PURE__*/_jsx(Typography,{variant:\"subtitle2\",color:\"text.secondary\",sx:{fontWeight:600,mb:1},children:\"\\uD83D\\uDD17 URI Link\"}),/*#__PURE__*/_jsx(Box,{sx:{background:'#f5f5f5',p:2,borderRadius:2,border:'1px solid #e0e0e0'},children:/*#__PURE__*/_jsx(Typography,{variant:\"body2\",sx:{fontFamily:'monospace',fontSize:'0.8rem',wordBreak:'break-all',color:'#1976d2',textDecoration:'underline'},children:area.action.uri})})]}),area.action.type==='richmenuswitch'&&area.action.richMenuAliasId&&/*#__PURE__*/_jsxs(Box,{sx:{mb:2},children:[/*#__PURE__*/_jsx(Typography,{variant:\"subtitle2\",color:\"text.secondary\",sx:{fontWeight:600,mb:1},children:\"\\uD83D\\uDD04 Target Rich Menu\"}),/*#__PURE__*/_jsx(Box,{sx:{background:'#fff3e0',p:2,borderRadius:2,border:'1px solid #ffcc02'},children:/*#__PURE__*/_jsx(Typography,{variant:\"body2\",sx:{fontFamily:'monospace',fontSize:'0.85rem',color:'#f57c00',fontWeight:600},children:area.action.richMenuAliasId})})]})]})})},index))}):/*#__PURE__*/_jsxs(Box,{sx:{p:6,textAlign:'center',background:'linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%)',borderRadius:3},children:[/*#__PURE__*/_jsx(Box,{sx:{width:100,height:100,borderRadius:'50%',background:'rgba(25, 118, 210, 0.1)',display:'flex',alignItems:'center',justifyContent:'center',mx:'auto',mb:3},children:/*#__PURE__*/_jsx(Code,{sx:{fontSize:50,color:'#1976d2'}})}),/*#__PURE__*/_jsx(Typography,{variant:\"h5\",color:\"text.secondary\",sx:{mb:2,fontWeight:600},children:\"No Interactive Hotspots\"}),/*#__PURE__*/_jsx(Typography,{variant:\"body1\",color:\"text.secondary\",sx:{maxWidth:500,mx:'auto'},children:\"This rich menu doesn't have any tap areas or actions configured. Hotspots allow users to interact with your rich menu by tapping on specific areas.\"})]})})]})]}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,lg:4,children:/*#__PURE__*/_jsxs(Box,{sx:{position:'sticky',top:20},children:[/*#__PURE__*/_jsxs(Card,{sx:{borderRadius:3,boxShadow:'0 4px 20px rgba(0,0,0,0.1)',mb:3},children:[/*#__PURE__*/_jsx(Box,{sx:{p:2.5,background:'#1976d2',color:'white'},children:/*#__PURE__*/_jsxs(Typography,{variant:\"h6\",sx:{fontWeight:600,display:'flex',alignItems:'center'},children:[/*#__PURE__*/_jsx(Settings,{sx:{mr:1.5}}),\"Rich Menu Properties\"]})}),/*#__PURE__*/_jsxs(Box,{sx:{p:3},children:[/*#__PURE__*/_jsxs(Box,{sx:{mb:3},children:[/*#__PURE__*/_jsx(Typography,{variant:\"subtitle2\",color:\"text.secondary\",sx:{fontWeight:600,mb:1},children:\"\\uD83D\\uDCDD Name\"}),/*#__PURE__*/_jsx(Typography,{variant:\"h6\",sx:{fontWeight:700,color:'#1976d2',p:2,background:'#e3f2fd',borderRadius:2,border:'1px solid #bbdefb'},children:(_richMenuDetails$rich14=richMenuDetails.rich_menu)===null||_richMenuDetails$rich14===void 0?void 0:_richMenuDetails$rich14.name})]}),/*#__PURE__*/_jsxs(Box,{sx:{mb:3},children:[/*#__PURE__*/_jsx(Typography,{variant:\"subtitle2\",color:\"text.secondary\",sx:{fontWeight:600,mb:1},children:\"\\uD83D\\uDCAC Chat Bar Text\"}),/*#__PURE__*/_jsx(Box,{sx:{p:2,background:'#f5f5f5',borderRadius:2,border:'1px solid #e0e0e0',minHeight:60,display:'flex',alignItems:'center'},children:/*#__PURE__*/_jsxs(Typography,{variant:\"body1\",sx:{color:'#424242',fontStyle:'italic',textAlign:'center',width:'100%'},children:[\"\\\"\",((_richMenuDetails$rich15=richMenuDetails.rich_menu)===null||_richMenuDetails$rich15===void 0?void 0:_richMenuDetails$rich15.chatBarText)||'No chat bar text configured',\"\\\"\"]})})]}),/*#__PURE__*/_jsxs(Box,{sx:{mb:3},children:[/*#__PURE__*/_jsx(Typography,{variant:\"subtitle2\",color:\"text.secondary\",sx:{fontWeight:600,mb:1},children:\"\\uD83C\\uDFAF Default Status\"}),/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',alignItems:'center'},children:[/*#__PURE__*/_jsx(Chip,{label:(_richMenuDetails$rich16=richMenuDetails.rich_menu)!==null&&_richMenuDetails$rich16!==void 0&&_richMenuDetails$rich16.selected?'DEFAULT':'NOT DEFAULT',color:(_richMenuDetails$rich17=richMenuDetails.rich_menu)!==null&&_richMenuDetails$rich17!==void 0&&_richMenuDetails$rich17.selected?'success':'default',variant:\"filled\",sx:{fontWeight:700,fontSize:'0.8rem',height:32}}),/*#__PURE__*/_jsx(Typography,{variant:\"body2\",color:\"text.secondary\",sx:{ml:2},children:(_richMenuDetails$rich18=richMenuDetails.rich_menu)!==null&&_richMenuDetails$rich18!==void 0&&_richMenuDetails$rich18.selected?'Auto-displays to all users':'Not set as default menu'})]})]})]})]}),/*#__PURE__*/_jsxs(Card,{sx:{borderRadius:3,boxShadow:'0 4px 20px rgba(0,0,0,0.1)'},children:[/*#__PURE__*/_jsx(Box,{sx:{p:2.5,background:'#424242',color:'white'},children:/*#__PURE__*/_jsxs(Typography,{variant:\"h6\",sx:{fontWeight:600,display:'flex',alignItems:'center'},children:[/*#__PURE__*/_jsx(Code,{sx:{mr:1.5}}),\"Technical Details\"]})}),/*#__PURE__*/_jsxs(Box,{sx:{p:3},children:[/*#__PURE__*/_jsxs(Box,{sx:{mb:2},children:[/*#__PURE__*/_jsx(Typography,{variant:\"caption\",color:\"text.secondary\",sx:{fontWeight:600},children:\"Rich Menu ID\"}),/*#__PURE__*/_jsx(Typography,{variant:\"body2\",sx:{fontFamily:'monospace',fontSize:'0.75rem',background:'#f5f5f5',p:1.5,borderRadius:1,border:'1px solid #e0e0e0',wordBreak:'break-all',color:'#424242'},children:(_richMenuDetails$rich19=richMenuDetails.rich_menu)===null||_richMenuDetails$rich19===void 0?void 0:_richMenuDetails$rich19.richMenuId})]}),/*#__PURE__*/_jsxs(Box,{sx:{mb:2},children:[/*#__PURE__*/_jsx(Typography,{variant:\"caption\",color:\"text.secondary\",sx:{fontWeight:600},children:\"Dimensions\"}),/*#__PURE__*/_jsxs(Typography,{variant:\"body2\",sx:{fontFamily:'monospace',fontSize:'0.9rem',background:'#e3f2fd',p:1.5,borderRadius:1,border:'1px solid #bbdefb',color:'#1976d2',fontWeight:600},children:[(_richMenuDetails$rich20=richMenuDetails.rich_menu)===null||_richMenuDetails$rich20===void 0?void 0:(_richMenuDetails$rich21=_richMenuDetails$rich20.size)===null||_richMenuDetails$rich21===void 0?void 0:_richMenuDetails$rich21.width,\" \\xD7 \",(_richMenuDetails$rich22=richMenuDetails.rich_menu)===null||_richMenuDetails$rich22===void 0?void 0:(_richMenuDetails$rich23=_richMenuDetails$rich22.size)===null||_richMenuDetails$rich23===void 0?void 0:_richMenuDetails$rich23.height,\" px\"]})]}),/*#__PURE__*/_jsxs(Box,{sx:{mb:2},children:[/*#__PURE__*/_jsx(Typography,{variant:\"caption\",color:\"text.secondary\",sx:{fontWeight:600},children:\"Hotspot Count\"}),/*#__PURE__*/_jsxs(Typography,{variant:\"body2\",sx:{fontSize:'1.1rem',background:'#e8f5e8',p:1.5,borderRadius:1,border:'1px solid #c8e6c9',color:'#2e7d32',fontWeight:600,textAlign:'center'},children:[((_richMenuDetails$rich24=richMenuDetails.rich_menu)===null||_richMenuDetails$rich24===void 0?void 0:(_richMenuDetails$rich25=_richMenuDetails$rich24.areas)===null||_richMenuDetails$rich25===void 0?void 0:_richMenuDetails$rich25.length)||0,\" Interactive Areas\"]})]})]})]})]})})]})}):/*#__PURE__*/_jsxs(Box,{sx:{p:8,textAlign:'center',minHeight:'500px',display:'flex',flexDirection:'column',alignItems:'center',justifyContent:'center',background:'linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%)'},children:[/*#__PURE__*/_jsx(Box,{sx:{width:120,height:120,borderRadius:'50%',background:'rgba(244, 67, 54, 0.1)',display:'flex',alignItems:'center',justifyContent:'center',mb:3},children:/*#__PURE__*/_jsx(ErrorIcon,{sx:{fontSize:60,color:'#f44336'}})}),/*#__PURE__*/_jsx(Typography,{variant:\"h4\",color:\"error\",sx:{mb:2,fontWeight:700},children:\"Failed to Load Details\"}),/*#__PURE__*/_jsx(Typography,{variant:\"body1\",color:\"text.secondary\",sx:{maxWidth:500,mb:3},children:\"Unable to fetch rich menu details from LINE API. Please check your connection and try again.\"}),/*#__PURE__*/_jsx(Button,{variant:\"contained\",color:\"primary\",onClick:()=>handleOpenDetailsDialog(selectedRichMenuForDetails),startIcon:/*#__PURE__*/_jsx(Refresh,{}),children:\"Retry Loading\"})]})}),/*#__PURE__*/_jsx(DialogActions,{sx:{p:3,borderTop:'2px solid #e3f2fd',background:'#fafafa',borderBottomLeftRadius:8,borderBottomRightRadius:8},children:/*#__PURE__*/_jsx(Button,{onClick:()=>setDetailsDialogOpen(false),variant:\"outlined\",sx:{borderColor:'#1976d2',color:'#1976d2','&:hover':{borderColor:'#1565c0',background:'rgba(25, 118, 210, 0.04)'}},children:\"Close\"})})]}),/*#__PURE__*/_jsxs(Dialog,{open:updateAliasDialogOpen,onClose:()=>setUpdateAliasDialogOpen(false),maxWidth:\"md\",fullWidth:true,children:[/*#__PURE__*/_jsx(DialogTitle,{children:\"Update Rich Menu Alias\"}),/*#__PURE__*/_jsxs(DialogContent,{children:[/*#__PURE__*/_jsx(Alert,{severity:\"info\",sx:{mb:2},children:/*#__PURE__*/_jsxs(Typography,{variant:\"body2\",children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Update Alias:\"}),\" Change which rich menu this alias points to. This will update both LINE API and your database.\"]})}),selectedAliasForUpdate&&/*#__PURE__*/_jsxs(Box,{sx:{mb:3},children:[/*#__PURE__*/_jsxs(Typography,{variant:\"h6\",sx:{mb:2},children:[\"Current Alias: \",selectedAliasForUpdate.richMenuAliasId]}),/*#__PURE__*/_jsxs(Box,{sx:{mb:2,p:2,bgcolor:'grey.50',borderRadius:1},children:[/*#__PURE__*/_jsx(Typography,{variant:\"body2\",sx:{fontWeight:600,mb:1},children:\"Current Rich Menu:\"}),/*#__PURE__*/_jsx(Typography,{variant:\"body2\",color:\"text.secondary\",children:selectedAliasForUpdate.richMenuId||'Not linked'})]})]}),/*#__PURE__*/_jsxs(Box,{sx:{mb:3},children:[/*#__PURE__*/_jsxs(Typography,{variant:\"h6\",sx:{mb:2},children:[\"Select New Rich Menu (\",richMenus.length,\" available)\"]}),/*#__PURE__*/_jsxs(FormControl,{fullWidth:true,children:[/*#__PURE__*/_jsx(InputLabel,{children:\"Rich Menu\"}),/*#__PURE__*/_jsx(Select,{value:(selectedRichMenuForUpdate===null||selectedRichMenuForUpdate===void 0?void 0:selectedRichMenuForUpdate.rich_menu_id)||'',onChange:e=>{const selected=richMenus.find(rm=>rm.richMenuId===e.target.value);setSelectedRichMenuForUpdate(selected||null);},label:\"Rich Menu\",children:richMenus.map(richMenu=>/*#__PURE__*/_jsx(MenuItem,{value:richMenu.richMenuId,children:/*#__PURE__*/_jsxs(Box,{children:[/*#__PURE__*/_jsx(Typography,{variant:\"body1\",sx:{fontWeight:600},children:richMenu.name}),/*#__PURE__*/_jsx(Typography,{variant:\"caption\",color:\"text.secondary\",sx:{fontFamily:'monospace'},children:richMenu.richMenuId})]})},richMenu.richMenuId))})]})]}),selectedRichMenuForUpdate&&/*#__PURE__*/_jsx(Alert,{severity:\"success\",children:/*#__PURE__*/_jsxs(Typography,{variant:\"body2\",children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Will Update:\"}),\" Alias \\\"\",selectedAliasForUpdate===null||selectedAliasForUpdate===void 0?void 0:selectedAliasForUpdate.richMenuAliasId,\"\\\" will point to \\\"\",selectedRichMenuForUpdate.name,\"\\\"\"]})})]}),/*#__PURE__*/_jsxs(DialogActions,{children:[/*#__PURE__*/_jsx(Button,{onClick:()=>setUpdateAliasDialogOpen(false),children:\"Cancel\"}),/*#__PURE__*/_jsx(Button,{onClick:handleUpdateAlias,variant:\"contained\",disabled:!selectedRichMenuForUpdate||updatingAlias,startIcon:updatingAlias?/*#__PURE__*/_jsx(CircularProgress,{size:16}):/*#__PURE__*/_jsx(Edit,{}),children:updatingAlias?'Updating...':'Update Alias'})]})]}),/*#__PURE__*/_jsxs(Dialog,{open:createAliasDialogOpen,onClose:()=>setCreateAliasDialogOpen(false),maxWidth:\"md\",fullWidth:true,children:[/*#__PURE__*/_jsx(DialogTitle,{children:\"Create Rich Menu Alias\"}),/*#__PURE__*/_jsxs(DialogContent,{children:[/*#__PURE__*/_jsx(Alert,{severity:\"info\",sx:{mb:2},children:/*#__PURE__*/_jsxs(Typography,{variant:\"body2\",children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Rich Menu Aliases:\"}),\" Create aliases for rich menus to enable switching between them using the \\\"richmenuswitch\\\" action type. Select a rich menu and provide an alias ID that will be used in richmenuswitch actions.\"]})}),/*#__PURE__*/_jsxs(Box,{sx:{mb:3},children:[/*#__PURE__*/_jsxs(Typography,{variant:\"h6\",sx:{mb:2},children:[\"Select Rich Menu (\",unlinkedRichMenus.length,\" available)\"]}),unlinkedRichMenus.length===0?/*#__PURE__*/_jsx(Alert,{severity:\"warning\",children:\"No unlinked rich menus found. All rich menus are already linked to aliases.\"}):/*#__PURE__*/_jsxs(FormControl,{fullWidth:true,children:[/*#__PURE__*/_jsx(InputLabel,{children:\"Rich Menu\"}),/*#__PURE__*/_jsx(Select,{value:(selectedUnlinkedRichMenu===null||selectedUnlinkedRichMenu===void 0?void 0:selectedUnlinkedRichMenu.rich_menu_id)||'',onChange:e=>{const selected=unlinkedRichMenus.find(rm=>rm.rich_menu_id===e.target.value);setSelectedUnlinkedRichMenu(selected||null);if(selected){setAliasId(selected.name);// Use rich menu name as default alias ID\n}},label:\"Rich Menu\",children:unlinkedRichMenus.map(richMenu=>/*#__PURE__*/_jsx(MenuItem,{value:richMenu.rich_menu_id,children:/*#__PURE__*/_jsxs(Box,{children:[/*#__PURE__*/_jsx(Typography,{variant:\"body1\",sx:{fontWeight:600},children:richMenu.name}),/*#__PURE__*/_jsx(Typography,{variant:\"caption\",color:\"text.secondary\",sx:{fontFamily:'monospace'},children:richMenu.rich_menu_id})]})},richMenu.rich_menu_id))})]})]}),selectedUnlinkedRichMenu&&/*#__PURE__*/_jsxs(Box,{sx:{mb:3},children:[/*#__PURE__*/_jsx(Typography,{variant:\"h6\",sx:{mb:2},children:\"Alias Configuration\"}),/*#__PURE__*/_jsx(TextField,{fullWidth:true,label:\"Alias ID\",value:aliasId,onChange:e=>setAliasId(e.target.value),placeholder:\"Enter alias ID (e.g., home-menu, dtx-book)\",helperText:\"This alias ID will be used in richmenuswitch actions. Will be normalized to: \".concat(aliasId.toLowerCase(),\" (hyphens preserved, fallback to underscores if needed)\"),sx:{mb:2}}),/*#__PURE__*/_jsx(Alert,{severity:\"info\",children:/*#__PURE__*/_jsxs(Typography,{variant:\"body2\",children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Usage:\"}),\" Use this alias ID in richmenuswitch actions like:\",/*#__PURE__*/_jsx(\"code\",{style:{display:'block',marginTop:4,padding:4,backgroundColor:'#f5f5f5',borderRadius:4},children:\"{\\n  \\\"type\\\": \\\"richmenuswitch\\\",\\n  \\\"richMenuAliasId\\\": \\\"\".concat(aliasId.toLowerCase()||'your-alias-id',\"\\\"\\n}\")})]})})]})]}),/*#__PURE__*/_jsxs(DialogActions,{children:[/*#__PURE__*/_jsx(Button,{onClick:()=>setCreateAliasDialogOpen(false),children:\"Cancel\"}),/*#__PURE__*/_jsx(Button,{onClick:handleCreateRichMenuAlias,variant:\"contained\",disabled:!selectedUnlinkedRichMenu||!aliasId.trim()||creatingAlias,startIcon:creatingAlias?/*#__PURE__*/_jsx(CircularProgress,{size:16}):/*#__PURE__*/_jsx(Add,{}),children:creatingAlias?'Creating...':'Create Alias'})]})]}),/*#__PURE__*/_jsxs(Dialog,{open:assignDialogOpen,onClose:()=>setAssignDialogOpen(false),maxWidth:\"sm\",fullWidth:true,children:[/*#__PURE__*/_jsx(DialogTitle,{children:\"Assign Rich Menu to User\"}),/*#__PURE__*/_jsxs(DialogContent,{children:[selectedRichMenu&&/*#__PURE__*/_jsxs(Box,{sx:{mb:2},children:[/*#__PURE__*/_jsxs(Typography,{variant:\"subtitle2\",sx:{fontWeight:600},children:[\"Rich Menu: \",selectedRichMenu.name]}),/*#__PURE__*/_jsxs(Typography,{variant:\"body2\",color:\"text.secondary\",children:[\"ID: \",selectedRichMenu.richMenuId]})]}),/*#__PURE__*/_jsx(TextField,{fullWidth:true,label:\"LINE User ID\",value:userId,onChange:e=>setUserId(e.target.value),placeholder:\"U1234567890abcdef...\",helperText:\"Enter the LINE User ID to assign this rich menu\",margin:\"normal\"})]}),/*#__PURE__*/_jsxs(DialogActions,{children:[/*#__PURE__*/_jsx(Button,{onClick:()=>setAssignDialogOpen(false),children:\"Cancel\"}),/*#__PURE__*/_jsx(Button,{onClick:handleAssignToUser,variant:\"contained\",disabled:assigning||!userId.trim(),startIcon:assigning?/*#__PURE__*/_jsx(CircularProgress,{size:16}):/*#__PURE__*/_jsx(Assignment,{}),children:assigning?'Assigning...':'Assign'})]})]}),/*#__PURE__*/_jsxs(Dialog,{open:createDialogOpen,onClose:()=>setCreateDialogOpen(false),maxWidth:\"lg\",fullWidth:true,children:[/*#__PURE__*/_jsx(DialogTitle,{children:\"Create New Rich Menu\"}),/*#__PURE__*/_jsxs(DialogContent,{children:[createMode==='visual'&&/*#__PURE__*/_jsx(Alert,{severity:\"info\",sx:{mb:2},children:/*#__PURE__*/_jsxs(Typography,{variant:\"body2\",children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Visual Builder Workflow:\"}),/*#__PURE__*/_jsx(\"br\",{}),\"1. Upload a background image first\",/*#__PURE__*/_jsx(\"br\",{}),\"2. Draw hotspots on the image\",/*#__PURE__*/_jsx(\"br\",{}),\"3. Create rich menu (image will be automatically uploaded)\"]})}),/*#__PURE__*/_jsxs(Tabs,{value:createMode,onChange:(_,newValue)=>setCreateMode(newValue),sx:{mb:2},children:[/*#__PURE__*/_jsx(Tab,{label:\"Visual Builder\",value:\"visual\",icon:/*#__PURE__*/_jsx(Palette,{})}),/*#__PURE__*/_jsx(Tab,{label:\"Template\",value:\"template\",icon:/*#__PURE__*/_jsx(ViewModule,{})}),/*#__PURE__*/_jsx(Tab,{label:\"Manual JSON\",value:\"manual\",icon:/*#__PURE__*/_jsx(Code,{})}),/*#__PURE__*/_jsx(Tab,{label:\"Import JSON\",value:\"import\",icon:/*#__PURE__*/_jsx(CloudUpload,{})})]}),createMode==='visual'&&/*#__PURE__*/_jsxs(Grid,{container:true,spacing:2,children:[/*#__PURE__*/_jsx(Grid,{item:true,xs:12,children:/*#__PURE__*/_jsx(TextField,{fullWidth:true,label:\"Rich Menu Name\",value:richMenuForm.name,onChange:e=>setRichMenuForm(_objectSpread(_objectSpread({},richMenuForm),{},{name:e.target.value})),placeholder:\"Enter rich menu name\",margin:\"normal\"})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,children:/*#__PURE__*/_jsx(TextField,{fullWidth:true,label:\"Chat Bar Text\",value:richMenuForm.chatBarText,onChange:e=>{const value=e.target.value;if(value.length<=14){setRichMenuForm(_objectSpread(_objectSpread({},richMenuForm),{},{chatBarText:value}));}},placeholder:\"Text shown in chat bar when rich menu is active\",helperText:\"\".concat(richMenuForm.chatBarText.length,\"/14 characters (LINE API limit) - This text appears in the chat input area when the rich menu is displayed\"),margin:\"normal\",inputProps:{maxLength:14},error:richMenuForm.chatBarText.length>14})}),/*#__PURE__*/_jsxs(Grid,{item:true,xs:12,children:[/*#__PURE__*/_jsx(FormControlLabel,{control:/*#__PURE__*/_jsx(Switch,{checked:richMenuForm.displayByDefault,onChange:e=>setRichMenuForm(_objectSpread(_objectSpread({},richMenuForm),{},{displayByDefault:e.target.checked}))}),label:\"Display by Default\"}),/*#__PURE__*/_jsx(Typography,{variant:\"body2\",color:\"text.secondary\",sx:{ml:4,mt:0.5},children:\"When enabled, this rich menu will be displayed by default when users open the chat\"})]}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,children:/*#__PURE__*/_jsxs(FormControl,{fullWidth:true,margin:\"normal\",children:[/*#__PURE__*/_jsx(InputLabel,{children:\"Rich Menu Size\"}),/*#__PURE__*/_jsx(Select,{value:selectedRichMenuSize,onChange:e=>handleRichMenuSizeChange(e.target.value),label:\"Rich Menu Size\",children:Object.entries(LINE_RICH_MENU_SIZES).map(_ref=>{let[key,size]=_ref;return/*#__PURE__*/_jsx(MenuItem,{value:key,children:size.label},key);})}),/*#__PURE__*/_jsx(Typography,{variant:\"body2\",color:\"text.secondary\",sx:{mt:0.5},children:\"Select the standard LINE rich menu size. The canvas will be scaled to match this ratio.\"})]})}),/*#__PURE__*/_jsxs(Grid,{item:true,xs:12,children:[/*#__PURE__*/_jsx(Typography,{variant:\"h6\",gutterBottom:true,children:\"Background Image (Required for Drawing)\"}),/*#__PURE__*/_jsx(\"input\",{accept:\"image/*\",type:\"file\",onChange:e=>{var _e$target$files;return((_e$target$files=e.target.files)===null||_e$target$files===void 0?void 0:_e$target$files[0])&&handleBackgroundImageUpload(e.target.files[0]);},style:{display:'none'},id:\"background-image-upload\"}),/*#__PURE__*/_jsx(\"label\",{htmlFor:\"background-image-upload\",children:/*#__PURE__*/_jsx(Button,{variant:\"contained\",component:\"span\",startIcon:/*#__PURE__*/_jsx(Image,{}),children:\"Upload Background Image\"})}),backgroundImageUrl&&/*#__PURE__*/_jsx(Alert,{severity:\"success\",sx:{mt:1},children:\"Background image uploaded successfully! You can now draw hotspots on the image.\"})]}),backgroundImageUrl&&/*#__PURE__*/_jsxs(Grid,{item:true,xs:12,children:[/*#__PURE__*/_jsx(Typography,{variant:\"h6\",gutterBottom:true,children:\"Draw Hotspots on Image\"}),/*#__PURE__*/_jsx(Alert,{severity:\"info\",sx:{mb:2},children:/*#__PURE__*/_jsxs(Typography,{variant:\"body2\",children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Instructions:\"}),/*#__PURE__*/_jsx(\"br\",{}),\"\\u2022 Click and drag on the image to draw hotspots\",/*#__PURE__*/_jsx(\"br\",{}),\"\\u2022 Click on existing hotspots to edit them\",/*#__PURE__*/_jsx(\"br\",{}),\"\\u2022 Each hotspot will become a touchable area in your rich menu\"]})}),/*#__PURE__*/_jsxs(Box,{sx:{border:'2px dashed #ccc',borderRadius:2,p:2,textAlign:'center',backgroundColor:'#f9f9f9',position:'relative'},children:[/*#__PURE__*/_jsxs(Box,{sx:{position:'absolute',top:10,right:10,zIndex:10,display:'flex',flexDirection:'column',gap:1},children:[/*#__PURE__*/_jsx(Chip,{label:\"Zoom: \".concat(Math.round(drawingState.zoom*100),\"%\"),size:\"small\",color:\"primary\",variant:\"outlined\"}),/*#__PURE__*/_jsx(Chip,{label:drawingState.zoomLocked?\" Zoom Locked\":\" Zoom Unlocked\",size:\"small\",color:drawingState.zoomLocked?\"warning\":\"default\",variant:\"outlined\",onClick:toggleZoomLock,sx:{cursor:'pointer'}}),/*#__PURE__*/_jsx(Chip,{label:drawingState.gridSnap?\"Grid Snap: ON\":\"Grid Snap: OFF\",size:\"small\",color:drawingState.gridSnap?\"success\":\"default\",variant:\"outlined\",onClick:()=>setDrawingState(_objectSpread(_objectSpread({},drawingState),{},{gridSnap:!drawingState.gridSnap})),sx:{cursor:'pointer'}}),/*#__PURE__*/_jsx(Chip,{label:drawingState.showGrid?\"Grid: ON\":\"Grid: OFF\",size:\"small\",color:drawingState.showGrid?\"success\":\"default\",variant:\"outlined\",onClick:()=>setDrawingState(_objectSpread(_objectSpread({},drawingState),{},{showGrid:!drawingState.showGrid})),sx:{cursor:'pointer'}})]}),showDrawingControls?/*#__PURE__*/_jsxs(Box,{sx:{position:'absolute',top:10,left:10,zIndex:10,backgroundColor:'rgba(255, 255, 255, 0.95)',borderRadius:1,p:1.5,fontSize:'0.75rem',boxShadow:'0 2px 8px rgba(0,0,0,0.1)',border:'1px solid rgba(0,0,0,0.1)',maxWidth:250},children:[/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',justifyContent:'space-between',alignItems:'center',mb:1},children:[/*#__PURE__*/_jsx(Typography,{variant:\"caption\",sx:{fontWeight:'bold',color:'#333'},children:\"Drawing Controls:\"}),/*#__PURE__*/_jsx(IconButton,{size:\"small\",onClick:()=>setShowDrawingControls(false),sx:{p:0.5,minWidth:'auto',color:'#666','&:hover':{color:'#333'}},children:/*#__PURE__*/_jsx(Close,{fontSize:\"small\"})})]}),/*#__PURE__*/_jsx(Typography,{variant:\"caption\",display:\"block\",sx:{color:'#555',mb:0.5},children:\"\\u2022 Click & drag to draw hotspots\"}),/*#__PURE__*/_jsx(Typography,{variant:\"caption\",display:\"block\",sx:{color:'#555',mb:0.5},children:\"\\u2022 Drag hotspots to move them\"}),/*#__PURE__*/_jsx(Typography,{variant:\"caption\",display:\"block\",sx:{color:'#555',mb:0.5},children:\"\\u2022 Drag corner handles to resize\"}),/*#__PURE__*/_jsx(Typography,{variant:\"caption\",display:\"block\",sx:{color:'#555',mb:0.5},children:\"\\u2022 Mouse wheel to zoom\"}),/*#__PURE__*/_jsx(Typography,{variant:\"caption\",display:\"block\",sx:{color:'#555',mb:0.5},children:\"\\u2022 Lock zoom to prevent accidental changes\"}),/*#__PURE__*/_jsx(Typography,{variant:\"caption\",display:\"block\",sx:{color:'#555',mb:0.5},children:\"\\u2022 Press 'G' to toggle grid\"}),/*#__PURE__*/_jsx(Typography,{variant:\"caption\",display:\"block\",sx:{color:'#555',mb:0.5},children:\"\\u2022 Press 'S' to toggle snap\"}),/*#__PURE__*/_jsx(Typography,{variant:\"caption\",display:\"block\",sx:{color:'#555',mb:0.5},children:\"\\u2022 Press '0' to reset view\"}),/*#__PURE__*/_jsx(Typography,{variant:\"caption\",display:\"block\",sx:{color:'#555'},children:\"\\u2022 Press 'Delete' to remove hotspot\"})]}):/*#__PURE__*/_jsx(Box,{sx:{position:'absolute',top:10,left:10,zIndex:10},children:/*#__PURE__*/_jsx(Button,{size:\"small\",variant:\"outlined\",onClick:()=>setShowDrawingControls(true),startIcon:/*#__PURE__*/_jsx(Help,{}),sx:{backgroundColor:'rgba(255, 255, 255, 0.9)',borderColor:'rgba(0, 0, 0, 0.2)',color:'#666',fontSize:'0.75rem','&:hover':{backgroundColor:'rgba(255, 255, 255, 1)',borderColor:'rgba(0, 0, 0, 0.3)',color:'#333'}},children:\"Show Help\"})}),/*#__PURE__*/_jsx(\"canvas\",{ref:canvasRef,onMouseDown:handleCanvasMouseDown,onMouseMove:e=>{throttledMouseMove(e);// Update cursor style\nconst canvas=canvasRef.current;if(canvas){canvas.style.cursor=getCursorStyle(e.clientX,e.clientY);}},onMouseUp:handleCanvasMouseUp,onClick:handleCanvasClick,onContextMenu:handleCanvasContextMenu,onKeyDown:handleCanvasKeyDown,onMouseLeave:()=>{// Reset cursor when leaving canvas\nconst canvas=canvasRef.current;if(canvas){canvas.style.cursor='default';}// Clear mouse position\nsetDrawingState(_objectSpread(_objectSpread({},drawingState),{},{mousePosition:null}));},tabIndex:0,style:{width:'100%',maxWidth:'800px',height:'auto',cursor:'default',border:'1px solid #ddd',borderRadius:4,boxShadow:'0 2px 8px rgba(0,0,0,0.1)',userSelect:'none',touchAction:'none'}})]}),/*#__PURE__*/_jsxs(Box,{sx:{mt:2,display:'flex',gap:1,flexWrap:'wrap',alignItems:'center'},children:[/*#__PURE__*/_jsx(Button,{variant:\"outlined\",size:\"small\",onClick:()=>{setHotspots([]);setImportedHotspots([]);drawCanvas();},startIcon:/*#__PURE__*/_jsx(Delete,{}),children:\"Clear All Hotspots\"}),/*#__PURE__*/_jsx(Button,{variant:\"outlined\",size:\"small\",onClick:()=>{// Create test hotspots that cover the entire image\nif(canvasImage){const testHotspots=[{id:'test_1',bounds:{x:0,y:0,width:canvasImage.width/3,height:canvasImage.height/2},action:{type:'postback',data:'action=test1'},label:'Test 1',color:'#ff0000'},{id:'test_2',bounds:{x:canvasImage.width/3,y:0,width:canvasImage.width/3,height:canvasImage.height/2},action:{type:'postback',data:'action=test2'},label:'Test 2',color:'#00ff00'},{id:'test_3',bounds:{x:canvasImage.width/3*2,y:0,width:canvasImage.width/3,height:canvasImage.height/2},action:{type:'postback',data:'action=test3'},label:'Test 3',color:'#0000ff'}];setHotspots(testHotspots);drawCanvas();}},startIcon:/*#__PURE__*/_jsx(Add,{}),children:\"Add Test Hotspots\"}),/*#__PURE__*/_jsx(Button,{variant:\"outlined\",size:\"small\",onClick:drawCanvas,startIcon:/*#__PURE__*/_jsx(Refresh,{}),children:\"Refresh Canvas\"}),/*#__PURE__*/_jsx(Button,{variant:\"outlined\",size:\"small\",onClick:()=>{if(canvasImage){// Create a test hotspot at the center of the image\nconst centerX=canvasImage.width/2;const centerY=canvasImage.height/2;const testHotspot={id:'test_center',bounds:{x:centerX-50,y:centerY-50,width:100,height:100},action:{type:'postback',data:'action=test_center'},label:'Center Test',color:'#ff0000'};setHotspots([testHotspot]);drawCanvas();console.log('Created center test hotspot:',testHotspot);}},startIcon:/*#__PURE__*/_jsx(Add,{}),children:\"Test Center Hotspot\"}),/*#__PURE__*/_jsx(Button,{variant:\"outlined\",size:\"small\",onClick:()=>{if(canvasImage){// Create test hotspots at known positions to verify coordinate transformation\nconst testHotspots=[{id:'test_top_left',bounds:{x:0,y:0,width:100,height:100},action:{type:'postback',data:'action=top_left'},label:'Top Left',color:'#ff0000'},{id:'test_top_right',bounds:{x:canvasImage.width-100,y:0,width:100,height:100},action:{type:'postback',data:'action=top_right'},label:'Top Right',color:'#00ff00'},{id:'test_bottom_left',bounds:{x:0,y:canvasImage.height-100,width:100,height:100},action:{type:'postback',data:'action=bottom_left'},label:'Bottom Left',color:'#0000ff'},{id:'test_bottom_right',bounds:{x:canvasImage.width-100,y:canvasImage.height-100,width:100,height:100},action:{type:'postback',data:'action=bottom_right'},label:'Bottom Right',color:'#ffff00'}];setHotspots(testHotspots);drawCanvas();console.log('Created corner test hotspots:',testHotspots);}},startIcon:/*#__PURE__*/_jsx(Add,{}),children:\"Test Corner Hotspots\"}),/*#__PURE__*/_jsx(Button,{variant:\"outlined\",size:\"small\",onClick:()=>setDrawingState(_objectSpread(_objectSpread({},drawingState),{},{zoom:1,pan:{x:0,y:0}})),children:\"Reset View\"}),/*#__PURE__*/_jsx(Button,{variant:drawingState.zoomLocked?\"contained\":\"outlined\",size:\"small\",color:drawingState.zoomLocked?\"warning\":\"primary\",onClick:toggleZoomLock,startIcon:drawingState.zoomLocked?/*#__PURE__*/_jsx(Lock,{}):/*#__PURE__*/_jsx(LockOpen,{}),children:drawingState.zoomLocked?\"Unlock Zoom\":\"Lock Zoom\"}),/*#__PURE__*/_jsxs(FormControl,{size:\"small\",sx:{minWidth:120},children:[/*#__PURE__*/_jsx(InputLabel,{children:\"Grid Size\"}),/*#__PURE__*/_jsxs(Select,{value:drawingState.gridSize,onChange:e=>setDrawingState(_objectSpread(_objectSpread({},drawingState),{},{gridSize:e.target.value})),label:\"Grid Size\",children:[/*#__PURE__*/_jsx(MenuItem,{value:50,children:\"50px\"}),/*#__PURE__*/_jsx(MenuItem,{value:100,children:\"100px\"}),/*#__PURE__*/_jsx(MenuItem,{value:200,children:\"200px\"}),/*#__PURE__*/_jsx(MenuItem,{value:500,children:\"500px\"})]})]}),/*#__PURE__*/_jsx(FormControlLabel,{control:/*#__PURE__*/_jsx(Switch,{checked:drawingState.gridSnap,onChange:e=>setDrawingState(_objectSpread(_objectSpread({},drawingState),{},{gridSnap:e.target.checked})),size:\"small\"}),label:\"Grid Snap\",sx:{ml:1}}),/*#__PURE__*/_jsx(FormControlLabel,{control:/*#__PURE__*/_jsx(Switch,{checked:drawingState.showGrid,onChange:e=>setDrawingState(_objectSpread(_objectSpread({},drawingState),{},{showGrid:e.target.checked})),size:\"small\"}),label:\"Show Grid\"}),/*#__PURE__*/_jsx(FormControlLabel,{control:/*#__PURE__*/_jsx(Switch,{checked:drawingState.zoomLocked,onChange:e=>setDrawingState(_objectSpread(_objectSpread({},drawingState),{},{zoomLocked:e.target.checked})),size:\"small\"}),label:\"Lock Zoom\"}),/*#__PURE__*/_jsx(FormControlLabel,{control:/*#__PURE__*/_jsx(Switch,{checked:highTransparency,onChange:e=>{setHighTransparency(e.target.checked);scheduleCanvasRender();},size:\"small\"}),label:\"High Transparency\"})]})]}),/*#__PURE__*/_jsxs(Grid,{item:true,xs:12,children:[/*#__PURE__*/_jsx(Box,{sx:{display:'flex',justifyContent:'space-between',alignItems:'center',mb:2},children:/*#__PURE__*/_jsxs(Typography,{variant:\"h6\",children:[\"Hotspots (\",hotspots.length,\")\"]})}),hotspots.length===0?/*#__PURE__*/_jsx(Alert,{severity:\"info\",children:backgroundImageUrl?\"No hotspots drawn yet. Click and drag on the image above to create hotspots.\":\"Upload a background image first to start drawing hotspots.\"}):/*#__PURE__*/_jsx(Grid,{container:true,spacing:1,children:hotspots.map(hotspot=>/*#__PURE__*/_jsx(Grid,{item:true,xs:12,sm:6,md:4,children:/*#__PURE__*/_jsxs(Card,{children:[/*#__PURE__*/_jsxs(CardContent,{children:[/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',alignItems:'center',mb:1},children:[/*#__PURE__*/_jsx(Box,{sx:{width:16,height:16,backgroundColor:hotspot.color,borderRadius:1,mr:1}}),/*#__PURE__*/_jsx(Typography,{variant:\"subtitle2\",children:hotspot.label})]}),/*#__PURE__*/_jsxs(Typography,{variant:\"caption\",color:\"textSecondary\",children:[hotspot.action.type,\" - \",Math.round(hotspot.bounds.width),\"x\",Math.round(hotspot.bounds.height),hotspot.action.data&&\" | Data: \".concat(hotspot.action.data.substring(0,20)).concat(hotspot.action.data.length>20?'...':''),hotspot.action.text&&\" | Text: \".concat(hotspot.action.text.substring(0,20)).concat(hotspot.action.text.length>20?'...':''),hotspot.action.uri&&\" | URI: \".concat(hotspot.action.uri.substring(0,20)).concat(hotspot.action.uri.length>20?'...':'')]})]}),/*#__PURE__*/_jsxs(CardActions,{children:[/*#__PURE__*/_jsx(IconButton,{size:\"small\",onClick:()=>{setEditingHotspot(hotspot);setHotspotDialogOpen(true);},children:/*#__PURE__*/_jsx(Edit,{})}),/*#__PURE__*/_jsx(IconButton,{size:\"small\",onClick:()=>handleHotspotDelete(hotspot.id),children:/*#__PURE__*/_jsx(Delete,{})}),/*#__PURE__*/_jsx(Button,{size:\"small\",variant:\"outlined\",color:\"error\",onClick:()=>handleHotspotDelete(hotspot.id),sx:{ml:'auto'},children:\"Delete\"})]})]})},hotspot.id))})]})]}),createMode==='template'&&/*#__PURE__*/_jsxs(Grid,{container:true,spacing:2,children:[/*#__PURE__*/_jsxs(Grid,{item:true,xs:12,children:[/*#__PURE__*/_jsx(Typography,{variant:\"h6\",gutterBottom:true,children:\"Select a Template\"}),/*#__PURE__*/_jsx(Grid,{container:true,spacing:2,children:richMenuTemplates.map(template=>/*#__PURE__*/_jsx(Grid,{item:true,xs:12,md:4,children:/*#__PURE__*/_jsxs(Card,{children:[/*#__PURE__*/_jsxs(CardContent,{children:[/*#__PURE__*/_jsx(Typography,{variant:\"h6\",children:template.name}),/*#__PURE__*/_jsx(Typography,{variant:\"body2\",color:\"textSecondary\",sx:{mb:2},children:template.description}),/*#__PURE__*/_jsxs(Typography,{variant:\"caption\",children:[\"Size: \",template.size.width,\"x\",template.size.height,\" | Buttons: \",template.areas.length]})]}),/*#__PURE__*/_jsx(CardActions,{children:/*#__PURE__*/_jsx(Button,{size:\"small\",variant:\"contained\",onClick:()=>handleTemplateSelect(template),children:\"Use Template\"})})]})},template.name))})]}),buttons.length>0&&/*#__PURE__*/_jsxs(Grid,{item:true,xs:12,children:[/*#__PURE__*/_jsx(Typography,{variant:\"h6\",gutterBottom:true,children:\"Template Preview\"}),/*#__PURE__*/_jsx(TextField,{fullWidth:true,label:\"Rich Menu Name\",value:richMenuForm.name,onChange:e=>setRichMenuForm(_objectSpread(_objectSpread({},richMenuForm),{},{name:e.target.value})),margin:\"normal\"}),/*#__PURE__*/_jsx(TextField,{fullWidth:true,label:\"Chat Bar Text\",value:richMenuForm.chatBarText,onChange:e=>setRichMenuForm(_objectSpread(_objectSpread({},richMenuForm),{},{chatBarText:e.target.value})),placeholder:\"Text shown in chat bar when rich menu is active\",helperText:\"This text appears in the chat input area when the rich menu is displayed\",margin:\"normal\"}),/*#__PURE__*/_jsx(FormControlLabel,{control:/*#__PURE__*/_jsx(Switch,{checked:richMenuForm.displayByDefault,onChange:e=>setRichMenuForm(_objectSpread(_objectSpread({},richMenuForm),{},{displayByDefault:e.target.checked}))}),label:\"Display by Default\"}),/*#__PURE__*/_jsx(Typography,{variant:\"body2\",color:\"text.secondary\",sx:{ml:4,mt:0.5},children:\"When enabled, this rich menu will be displayed by default when users open the chat\"}),/*#__PURE__*/_jsx(TextField,{fullWidth:true,value:richMenuForm.body,multiline:true,rows:6,margin:\"normal\",InputProps:{readOnly:true},label:\"Generated JSON\"})]})]}),createMode==='manual'&&/*#__PURE__*/_jsxs(Grid,{container:true,spacing:2,children:[/*#__PURE__*/_jsx(Grid,{item:true,xs:12,children:/*#__PURE__*/_jsx(TextField,{fullWidth:true,label:\"Rich Menu Name\",value:richMenuForm.name,onChange:e=>setRichMenuForm(_objectSpread(_objectSpread({},richMenuForm),{},{name:e.target.value})),placeholder:\"Enter rich menu name\",margin:\"normal\"})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,children:/*#__PURE__*/_jsx(TextField,{fullWidth:true,label:\"Chat Bar Text\",value:richMenuForm.chatBarText,onChange:e=>{const value=e.target.value;if(value.length<=14){setRichMenuForm(_objectSpread(_objectSpread({},richMenuForm),{},{chatBarText:value}));}},placeholder:\"Text shown in chat bar when rich menu is active\",helperText:\"\".concat(richMenuForm.chatBarText.length,\"/14 characters (LINE API limit) - This text appears in the chat input area when the rich menu is displayed\"),margin:\"normal\",inputProps:{maxLength:14},error:richMenuForm.chatBarText.length>14})}),/*#__PURE__*/_jsxs(Grid,{item:true,xs:12,children:[/*#__PURE__*/_jsx(FormControlLabel,{control:/*#__PURE__*/_jsx(Switch,{checked:richMenuForm.displayByDefault,onChange:e=>setRichMenuForm(_objectSpread(_objectSpread({},richMenuForm),{},{displayByDefault:e.target.checked}))}),label:\"Display by Default\"}),/*#__PURE__*/_jsx(Typography,{variant:\"body2\",color:\"text.secondary\",sx:{ml:4,mt:0.5},children:\"When enabled, this rich menu will be displayed by default when users open the chat\"})]}),/*#__PURE__*/_jsxs(Grid,{item:true,xs:12,children:[/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',gap:1,mb:1},children:[/*#__PURE__*/_jsx(Typography,{variant:\"subtitle2\",sx:{fontWeight:600},children:\"Rich Menu Body (JSON)\"}),/*#__PURE__*/_jsx(Button,{size:\"small\",variant:\"outlined\",onClick:async()=>{try{const richMenuData=JSON.parse(richMenuForm.body);const response=await autoCorrectRichMenu(richMenuData);if(response.data.success){setRichMenuForm(_objectSpread(_objectSpread({},richMenuForm),{},{body:JSON.stringify(response.data.corrected_data,null,2)}));setSuccess('JSON auto-corrected successfully!');}}catch(err){setError('Invalid JSON format. Please fix the JSON syntax first.');}},sx:{ml:'auto'},children:\"Auto-Correct JSON\"})]}),/*#__PURE__*/_jsx(TextField,{fullWidth:true,value:richMenuForm.body,onChange:e=>setRichMenuForm(_objectSpread(_objectSpread({},richMenuForm),{},{body:e.target.value})),multiline:true,rows:8,placeholder:\"{ \\\"size\\\": { \\\"width\\\": 2500, \\\"height\\\": 1686 }, \\\"selected\\\": false, \\\"name\\\": \\\"Rich Menu\\\", \\\"chatBarText\\\": \\\"Tap to open\\\", \\\"areas\\\": [ { \\\"bounds\\\": { \\\"x\\\": 0, \\\"y\\\": 0, \\\"width\\\": 2500, \\\"height\\\": 1686 }, \\\"action\\\": { \\\"type\\\": \\\"postback\\\", \\\"data\\\": \\\"action=menu&item=main\\\" } } ]\\n}\",helperText:\"Complete JSON body sent to LINE API. Use Auto-Correct JSON to fix common format issues.\",margin:\"normal\"})]})]}),createMode==='import'&&/*#__PURE__*/_jsxs(Grid,{container:true,spacing:2,children:[/*#__PURE__*/_jsxs(Grid,{item:true,xs:12,children:[/*#__PURE__*/_jsx(Typography,{variant:\"h6\",gutterBottom:true,children:\"Import Rich Menu JSON\"}),/*#__PURE__*/_jsx(Alert,{severity:\"info\",sx:{mb:2},children:/*#__PURE__*/_jsxs(Typography,{variant:\"body2\",children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Instructions:\"}),/*#__PURE__*/_jsx(\"br\",{}),\"\\u2022 Paste your rich menu JSON below\",/*#__PURE__*/_jsx(\"br\",{}),\"\\u2022 The hotspots will be displayed on the canvas\",/*#__PURE__*/_jsx(\"br\",{}),\"\\u2022 You can then edit, move, or modify the imported hotspots\"]})})]}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,children:/*#__PURE__*/_jsx(TextField,{fullWidth:true,label:\"Rich Menu JSON\",value:jsonImportText,onChange:e=>setJsonImportText(e.target.value),placeholder:\"Paste your rich menu JSON here...\",multiline:true,rows:12,margin:\"normal\"})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,children:/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',gap:2,flexWrap:'wrap'},children:[/*#__PURE__*/_jsx(Button,{variant:\"contained\",onClick:handleJsonImport,startIcon:/*#__PURE__*/_jsx(CloudUpload,{}),disabled:!jsonImportText.trim(),children:\"Import & Display Hotspots\"}),/*#__PURE__*/_jsx(Button,{variant:\"outlined\",onClick:clearImportedHotspots,startIcon:/*#__PURE__*/_jsx(Delete,{}),disabled:!showImportedHotspots,children:\"Clear Imported Hotspots\"}),/*#__PURE__*/_jsx(FormControlLabel,{control:/*#__PURE__*/_jsx(Switch,{checked:showImportedHotspots,onChange:e=>setShowImportedHotspots(e.target.checked),disabled:importedHotspots.length===0}),label:\"Show Imported Hotspots\"})]})}),showImportedHotspots&&importedHotspots.length>0&&/*#__PURE__*/_jsx(Grid,{item:true,xs:12,children:/*#__PURE__*/_jsx(Alert,{severity:\"success\",children:/*#__PURE__*/_jsxs(Typography,{variant:\"body2\",children:[/*#__PURE__*/_jsxs(\"strong\",{children:[\"Imported \",importedHotspots.length,\" hotspots!\"]}),/*#__PURE__*/_jsx(\"br\",{}),\"\\u2022 Hotspots are displayed on the canvas with unique colors\",/*#__PURE__*/_jsx(\"br\",{}),\"\\u2022 You can now edit, move, or modify them\",/*#__PURE__*/_jsx(\"br\",{}),\"\\u2022 Use the \\\"Create Rich Menu\\\" button to create the final rich menu\"]})})})]})]}),/*#__PURE__*/_jsxs(DialogActions,{children:[/*#__PURE__*/_jsx(Button,{onClick:()=>{setCreateDialogOpen(false);resetCreateForm();setButtons([]);setBackgroundImageUrl('');},children:\"Cancel\"}),/*#__PURE__*/_jsx(Button,{onClick:()=>{console.log('Button clicked!');console.log('createMode:',createMode);console.log('creating:',creating);console.log('richMenuForm.name:',richMenuForm.name);console.log('hotspots.length:',hotspots.length);console.log('Button disabled:',creating||!richMenuForm.name.trim()||createMode==='visual'&&hotspots.length===0);if(createMode==='visual'){handleCanvasCreate();}else{handleCreateRichMenu();}},variant:\"contained\",disabled:creating||!richMenuForm.name.trim()||createMode==='visual'&&(hotspots.length===0||!backgroundImageFile),startIcon:creating?/*#__PURE__*/_jsx(CircularProgress,{size:16}):/*#__PURE__*/_jsx(Add,{}),children:creating?'Creating...':'Create Rich Menu'})]})]}),/*#__PURE__*/_jsxs(Dialog,{open:uploadDialogOpen,onClose:()=>setUploadDialogOpen(false),maxWidth:\"sm\",fullWidth:true,children:[/*#__PURE__*/_jsx(DialogTitle,{children:selectedRichMenuForUpload!==null&&selectedRichMenuForUpload!==void 0&&selectedRichMenuForUpload.hasImage?'Change Rich Menu Image':'Upload Rich Menu Image'}),/*#__PURE__*/_jsxs(DialogContent,{children:[selectedRichMenuForUpload&&/*#__PURE__*/_jsxs(Box,{sx:{mb:2},children:[/*#__PURE__*/_jsxs(Typography,{variant:\"subtitle2\",sx:{fontWeight:600},children:[\"Rich Menu: \",selectedRichMenuForUpload.name]}),/*#__PURE__*/_jsxs(Typography,{variant:\"body2\",color:\"text.secondary\",children:[\"ID: \",selectedRichMenuForUpload.richMenuId]})]}),/*#__PURE__*/_jsx(Typography,{variant:\"subtitle2\",sx:{fontWeight:600,mb:1,color:'error.main'},children:\"* Rich Menu Image (Required)\"}),(selectedRichMenuForUpload===null||selectedRichMenuForUpload===void 0?void 0:selectedRichMenuForUpload.hasImage)&&/*#__PURE__*/_jsx(Alert,{severity:\"warning\",sx:{mb:2},children:/*#__PURE__*/_jsxs(Typography,{variant:\"body2\",children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Note:\"}),\" Changing the image will create a new rich menu with a new ID. The old rich menu will be deleted from LINE. If this rich menu was set as default, the new rich menu will automatically be set as default.\"]})}),/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',alignItems:'center',gap:1,mb:2},children:[/*#__PURE__*/_jsx(\"input\",{accept:\"image/*\",style:{display:'none'},id:\"upload-rich-menu-image\",type:\"file\",onChange:handleFileSelect}),/*#__PURE__*/_jsx(\"label\",{htmlFor:\"upload-rich-menu-image\",children:/*#__PURE__*/_jsx(Button,{variant:\"outlined\",component:\"span\",startIcon:/*#__PURE__*/_jsx(CloudUpload,{}),color:selectedFile?\"success\":\"primary\",children:selectedFile?'Select New Image':'Select Image'})}),selectedFile&&/*#__PURE__*/_jsxs(Typography,{variant:\"body2\",color:\"success.main\",sx:{fontWeight:600},children:[\"\\u2713 \",selectedFile.name,\" (\",Math.round(selectedFile.size/1024),\"KB)\"]}),!selectedFile&&/*#__PURE__*/_jsx(Typography,{variant:\"body2\",color:\"error.main\",children:\"Image is required for rich menu to function\"})]}),/*#__PURE__*/_jsx(Alert,{severity:\"info\",children:/*#__PURE__*/_jsxs(Typography,{variant:\"body2\",children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Image Requirements:\"}),/*#__PURE__*/_jsx(\"br\",{}),\"\\u2022 Supported formats: PNG, JPEG, GIF\",/*#__PURE__*/_jsx(\"br\",{}),\"\\u2022 Recommended size: \",selectedRichMenuForUpload===null||selectedRichMenuForUpload===void 0?void 0:selectedRichMenuForUpload.size.width,\"\\xD7\",selectedRichMenuForUpload===null||selectedRichMenuForUpload===void 0?void 0:selectedRichMenuForUpload.size.height,\" pixels\",/*#__PURE__*/_jsx(\"br\",{}),\"\\u2022 File size: Up to 1MB\"]})})]}),/*#__PURE__*/_jsxs(DialogActions,{children:[/*#__PURE__*/_jsx(Button,{onClick:()=>{setUploadDialogOpen(false);setSelectedFile(null);},children:\"Cancel\"}),/*#__PURE__*/_jsx(Button,{onClick:async()=>{if(selectedRichMenuForUpload&&selectedFile){await handleUploadImage(selectedRichMenuForUpload.richMenuId);setUploadDialogOpen(false);setSelectedFile(null);setSelectedRichMenuForUpload(null);}},variant:\"contained\",disabled:!selectedFile,startIcon:uploadingImage?/*#__PURE__*/_jsx(CircularProgress,{size:16}):/*#__PURE__*/_jsx(CloudUpload,{}),children:uploadingImage?'Processing...':selectedRichMenuForUpload!==null&&selectedRichMenuForUpload!==void 0&&selectedRichMenuForUpload.hasImage?'Change Image':'Upload Image'})]})]}),/*#__PURE__*/_jsxs(Dialog,{open:buttonDialogOpen,onClose:()=>setButtonDialogOpen(false),maxWidth:\"md\",fullWidth:true,children:[/*#__PURE__*/_jsx(DialogTitle,{children:editingButton?'Edit Button':'Add Button'}),/*#__PURE__*/_jsx(DialogContent,{children:/*#__PURE__*/_jsxs(Grid,{container:true,spacing:2,children:[/*#__PURE__*/_jsx(Grid,{item:true,xs:12,children:/*#__PURE__*/_jsx(TextField,{fullWidth:true,label:\"Button Label\",value:(editingButton===null||editingButton===void 0?void 0:editingButton.label)||'',onChange:e=>setEditingButton(editingButton?_objectSpread(_objectSpread({},editingButton),{},{label:e.target.value}):null),placeholder:\"Enter button label\",margin:\"normal\"})}),/*#__PURE__*/_jsxs(Grid,{item:true,xs:12,children:[/*#__PURE__*/_jsx(Typography,{variant:\"h6\",gutterBottom:true,children:\"Button Position & Size\"}),/*#__PURE__*/_jsxs(Grid,{container:true,spacing:2,children:[/*#__PURE__*/_jsx(Grid,{item:true,xs:3,children:/*#__PURE__*/_jsx(TextField,{fullWidth:true,label:\"X Position\",type:\"number\",value:(editingButton===null||editingButton===void 0?void 0:editingButton.bounds.x)||0,onChange:e=>setEditingButton(editingButton?_objectSpread(_objectSpread({},editingButton),{},{bounds:_objectSpread(_objectSpread({},editingButton.bounds),{},{x:parseInt(e.target.value)||0})}):null),margin:\"normal\"})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:3,children:/*#__PURE__*/_jsx(TextField,{fullWidth:true,label:\"Y Position\",type:\"number\",value:(editingButton===null||editingButton===void 0?void 0:editingButton.bounds.y)||0,onChange:e=>setEditingButton(editingButton?_objectSpread(_objectSpread({},editingButton),{},{bounds:_objectSpread(_objectSpread({},editingButton.bounds),{},{y:parseInt(e.target.value)||0})}):null),margin:\"normal\"})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:3,children:/*#__PURE__*/_jsx(TextField,{fullWidth:true,label:\"Width\",type:\"number\",value:(editingButton===null||editingButton===void 0?void 0:editingButton.bounds.width)||200,onChange:e=>setEditingButton(editingButton?_objectSpread(_objectSpread({},editingButton),{},{bounds:_objectSpread(_objectSpread({},editingButton.bounds),{},{width:parseInt(e.target.value)||200})}):null),margin:\"normal\"})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:3,children:/*#__PURE__*/_jsx(TextField,{fullWidth:true,label:\"Height\",type:\"number\",value:(editingButton===null||editingButton===void 0?void 0:editingButton.bounds.height)||100,onChange:e=>setEditingButton(editingButton?_objectSpread(_objectSpread({},editingButton),{},{bounds:_objectSpread(_objectSpread({},editingButton.bounds),{},{height:parseInt(e.target.value)||100})}):null),margin:\"normal\"})})]})]}),/*#__PURE__*/_jsxs(Grid,{item:true,xs:12,children:[/*#__PURE__*/_jsx(Typography,{variant:\"h6\",gutterBottom:true,children:\"Button Action\"}),/*#__PURE__*/_jsxs(FormControl,{fullWidth:true,margin:\"normal\",children:[/*#__PURE__*/_jsx(InputLabel,{children:\"Action Type\"}),/*#__PURE__*/_jsxs(Select,{value:(editingButton===null||editingButton===void 0?void 0:editingButton.action.type)||'postback',onChange:e=>setEditingButton(editingButton?_objectSpread(_objectSpread({},editingButton),{},{action:_objectSpread(_objectSpread({},editingButton.action),{},{type:e.target.value})}):null),children:[/*#__PURE__*/_jsx(MenuItem,{value:\"postback\",children:\"Postback\"}),/*#__PURE__*/_jsx(MenuItem,{value:\"message\",children:\"Message\"}),/*#__PURE__*/_jsx(MenuItem,{value:\"uri\",children:\"URI\"}),/*#__PURE__*/_jsx(MenuItem,{value:\"richmenuswitch\",children:\"Rich Menu Switch\"})]})]})]}),(editingButton===null||editingButton===void 0?void 0:editingButton.action.type)==='postback'&&/*#__PURE__*/_jsx(Grid,{item:true,xs:12,children:/*#__PURE__*/_jsx(TextField,{fullWidth:true,label:\"Postback Data\",value:editingButton.action.data||'',onChange:e=>setEditingButton(editingButton?_objectSpread(_objectSpread({},editingButton),{},{action:_objectSpread(_objectSpread({},editingButton.action),{},{data:e.target.value})}):null),placeholder:\"action=menu&item=1\",margin:\"normal\"})}),(editingButton===null||editingButton===void 0?void 0:editingButton.action.type)==='message'&&/*#__PURE__*/_jsx(Grid,{item:true,xs:12,children:/*#__PURE__*/_jsx(TextField,{fullWidth:true,label:\"Message Text\",value:editingButton.action.text||'',onChange:e=>setEditingButton(editingButton?_objectSpread(_objectSpread({},editingButton),{},{action:_objectSpread(_objectSpread({},editingButton.action),{},{text:e.target.value})}):null),placeholder:\"Hello, world!\",margin:\"normal\"})}),(editingButton===null||editingButton===void 0?void 0:editingButton.action.type)==='uri'&&/*#__PURE__*/_jsx(Grid,{item:true,xs:12,children:/*#__PURE__*/_jsx(TextField,{fullWidth:true,label:\"URI\",value:editingButton.action.uri||'',onChange:e=>setEditingButton(editingButton?_objectSpread(_objectSpread({},editingButton),{},{action:_objectSpread(_objectSpread({},editingButton.action),{},{uri:e.target.value})}):null),placeholder:\"https://example.com\",margin:\"normal\"})}),(editingButton===null||editingButton===void 0?void 0:editingButton.action.type)==='richmenuswitch'&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Grid,{item:true,xs:6,children:/*#__PURE__*/_jsx(TextField,{fullWidth:true,label:\"Rich Menu Alias ID\",value:editingButton.action.richMenuAliasId||'',onChange:e=>setEditingButton(editingButton?_objectSpread(_objectSpread({},editingButton),{},{action:_objectSpread(_objectSpread({},editingButton.action),{},{richMenuAliasId:e.target.value})}):null),placeholder:\"menu-main\",margin:\"normal\",helperText:\"1-40 characters, alphanumeric and hyphens only (LINE API requirement)\",error:editingButton.action.richMenuAliasId?!validateRichMenuAliasId(editingButton.action.richMenuAliasId):false})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:6,children:/*#__PURE__*/_jsx(TextField,{fullWidth:true,label:\"Switch Data\",value:editingButton.action.data||'',onChange:e=>setEditingButton(editingButton?_objectSpread(_objectSpread({},editingButton),{},{action:_objectSpread(_objectSpread({},editingButton.action),{},{data:e.target.value})}):null),placeholder:\"change-to-menu\",margin:\"normal\"})})]})]})}),/*#__PURE__*/_jsxs(DialogActions,{children:[/*#__PURE__*/_jsx(Button,{onClick:()=>setButtonDialogOpen(false),children:\"Cancel\"}),/*#__PURE__*/_jsx(Button,{onClick:()=>editingButton&&handleHotspotSave(editingButton),variant:\"contained\",disabled:!(editingButton!==null&&editingButton!==void 0&&(_editingButton$label=editingButton.label)!==null&&_editingButton$label!==void 0&&_editingButton$label.trim()),children:\"Save Button\"})]})]}),/*#__PURE__*/_jsxs(Dialog,{open:hotspotDialogOpen,onClose:()=>setHotspotDialogOpen(false),maxWidth:\"md\",fullWidth:true,children:[/*#__PURE__*/_jsx(DialogTitle,{children:editingHotspot?'Edit Hotspot':'Add Hotspot'}),/*#__PURE__*/_jsx(DialogContent,{children:/*#__PURE__*/_jsxs(Grid,{container:true,spacing:2,children:[/*#__PURE__*/_jsx(Grid,{item:true,xs:12,children:/*#__PURE__*/_jsx(TextField,{fullWidth:true,label:\"Hotspot Label\",value:(editingHotspot===null||editingHotspot===void 0?void 0:editingHotspot.label)||'',onChange:e=>setEditingHotspot(editingHotspot?_objectSpread(_objectSpread({},editingHotspot),{},{label:e.target.value}):null),placeholder:\"Enter hotspot label\",margin:\"normal\"})}),/*#__PURE__*/_jsxs(Grid,{item:true,xs:12,children:[/*#__PURE__*/_jsx(Typography,{variant:\"h6\",gutterBottom:true,children:\"Hotspot Position & Size\"}),/*#__PURE__*/_jsxs(Grid,{container:true,spacing:2,children:[/*#__PURE__*/_jsx(Grid,{item:true,xs:3,children:/*#__PURE__*/_jsx(TextField,{fullWidth:true,label:\"X Position\",type:\"number\",value:(editingHotspot===null||editingHotspot===void 0?void 0:editingHotspot.bounds.x)||0,onChange:e=>setEditingHotspot(editingHotspot?_objectSpread(_objectSpread({},editingHotspot),{},{bounds:_objectSpread(_objectSpread({},editingHotspot.bounds),{},{x:parseInt(e.target.value)||0})}):null),margin:\"normal\"})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:3,children:/*#__PURE__*/_jsx(TextField,{fullWidth:true,label:\"Y Position\",type:\"number\",value:(editingHotspot===null||editingHotspot===void 0?void 0:editingHotspot.bounds.y)||0,onChange:e=>setEditingHotspot(editingHotspot?_objectSpread(_objectSpread({},editingHotspot),{},{bounds:_objectSpread(_objectSpread({},editingHotspot.bounds),{},{y:parseInt(e.target.value)||0})}):null),margin:\"normal\"})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:3,children:/*#__PURE__*/_jsx(TextField,{fullWidth:true,label:\"Width\",type:\"number\",value:(editingHotspot===null||editingHotspot===void 0?void 0:editingHotspot.bounds.width)||100,onChange:e=>setEditingHotspot(editingHotspot?_objectSpread(_objectSpread({},editingHotspot),{},{bounds:_objectSpread(_objectSpread({},editingHotspot.bounds),{},{width:parseInt(e.target.value)||100})}):null),margin:\"normal\"})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:3,children:/*#__PURE__*/_jsx(TextField,{fullWidth:true,label:\"Height\",type:\"number\",value:(editingHotspot===null||editingHotspot===void 0?void 0:editingHotspot.bounds.height)||100,onChange:e=>setEditingHotspot(editingHotspot?_objectSpread(_objectSpread({},editingHotspot),{},{bounds:_objectSpread(_objectSpread({},editingHotspot.bounds),{},{height:parseInt(e.target.value)||100})}):null),margin:\"normal\"})})]})]}),/*#__PURE__*/_jsxs(Grid,{item:true,xs:12,children:[/*#__PURE__*/_jsx(Typography,{variant:\"h6\",gutterBottom:true,children:\"Hotspot Action\"}),/*#__PURE__*/_jsxs(FormControl,{fullWidth:true,margin:\"normal\",children:[/*#__PURE__*/_jsx(InputLabel,{children:\"Action Type\"}),/*#__PURE__*/_jsxs(Select,{value:(editingHotspot===null||editingHotspot===void 0?void 0:editingHotspot.action.type)||'postback',onChange:e=>setEditingHotspot(editingHotspot?_objectSpread(_objectSpread({},editingHotspot),{},{action:_objectSpread(_objectSpread({},editingHotspot.action),{},{type:e.target.value})}):null),children:[/*#__PURE__*/_jsx(MenuItem,{value:\"postback\",children:\"Postback\"}),/*#__PURE__*/_jsx(MenuItem,{value:\"message\",children:\"Message\"}),/*#__PURE__*/_jsx(MenuItem,{value:\"uri\",children:\"URI\"}),/*#__PURE__*/_jsx(MenuItem,{value:\"richmenuswitch\",children:\"Rich Menu Switch\"})]})]})]}),(editingHotspot===null||editingHotspot===void 0?void 0:editingHotspot.action.type)==='postback'&&/*#__PURE__*/_jsx(Grid,{item:true,xs:12,children:/*#__PURE__*/_jsx(TextField,{fullWidth:true,label:\"Postback Data\",value:editingHotspot.action.data||'',onChange:e=>setEditingHotspot(editingHotspot?_objectSpread(_objectSpread({},editingHotspot),{},{action:_objectSpread(_objectSpread({},editingHotspot.action),{},{data:e.target.value})}):null),placeholder:\"action=menu&item=1\",margin:\"normal\"})}),(editingHotspot===null||editingHotspot===void 0?void 0:editingHotspot.action.type)==='message'&&/*#__PURE__*/_jsx(Grid,{item:true,xs:12,children:/*#__PURE__*/_jsx(TextField,{fullWidth:true,label:\"Message Text\",value:editingHotspot.action.text||'',onChange:e=>setEditingHotspot(editingHotspot?_objectSpread(_objectSpread({},editingHotspot),{},{action:_objectSpread(_objectSpread({},editingHotspot.action),{},{text:e.target.value})}):null),placeholder:\"Hello, world!\",margin:\"normal\"})}),(editingHotspot===null||editingHotspot===void 0?void 0:editingHotspot.action.type)==='uri'&&/*#__PURE__*/_jsx(Grid,{item:true,xs:12,children:/*#__PURE__*/_jsx(TextField,{fullWidth:true,label:\"URI\",value:editingHotspot.action.uri||'',onChange:e=>{let uri=e.target.value;// Auto-add https:// if no protocol is specified\nif(uri&&!uri.match(/^https?:\\/\\//)){uri=\"https://\".concat(uri);}setEditingHotspot(editingHotspot?_objectSpread(_objectSpread({},editingHotspot),{},{action:_objectSpread(_objectSpread({},editingHotspot.action),{},{uri:uri})}):null);},placeholder:\"https://example.com\",margin:\"normal\",helperText:\"Must start with http:// or https://\",error:Boolean((editingHotspot===null||editingHotspot===void 0?void 0:editingHotspot.action.uri)&&editingHotspot.action.uri!==''&&!editingHotspot.action.uri.match(/^https?:\\/\\//))})}),(editingHotspot===null||editingHotspot===void 0?void 0:editingHotspot.action.type)==='richmenuswitch'&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Grid,{item:true,xs:6,children:/*#__PURE__*/_jsx(TextField,{fullWidth:true,label:\"Rich Menu Alias ID\",value:editingHotspot.action.richMenuAliasId||'',onChange:e=>setEditingHotspot(editingHotspot?_objectSpread(_objectSpread({},editingHotspot),{},{action:_objectSpread(_objectSpread({},editingHotspot.action),{},{richMenuAliasId:e.target.value})}):null),placeholder:\"menu-main\",margin:\"normal\",helperText:\"1-40 characters, alphanumeric and hyphens only (LINE API requirement)\",error:editingHotspot.action.richMenuAliasId?!validateRichMenuAliasId(editingHotspot.action.richMenuAliasId):false})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:6,children:/*#__PURE__*/_jsx(TextField,{fullWidth:true,label:\"Switch Data\",value:editingHotspot.action.data||'',onChange:e=>setEditingHotspot(editingHotspot?_objectSpread(_objectSpread({},editingHotspot),{},{action:_objectSpread(_objectSpread({},editingHotspot.action),{},{data:e.target.value})}):null),placeholder:\"change-to-menu\",margin:\"normal\"})})]})]})}),/*#__PURE__*/_jsxs(DialogActions,{children:[/*#__PURE__*/_jsx(Button,{onClick:()=>setHotspotDialogOpen(false),children:\"Cancel\"}),/*#__PURE__*/_jsx(Button,{onClick:()=>editingHotspot&&handleHotspotSave(editingHotspot),variant:\"contained\",disabled:!(editingHotspot!==null&&editingHotspot!==void 0&&(_editingHotspot$label=editingHotspot.label)!==null&&_editingHotspot$label!==void 0&&_editingHotspot$label.trim()),children:\"Save Hotspot\"}),editingHotspot&&/*#__PURE__*/_jsx(Button,{onClick:()=>handleHotspotDelete(editingHotspot.id),variant:\"outlined\",color:\"error\",startIcon:/*#__PURE__*/_jsx(Delete,{}),children:\"Delete Hotspot\"})]})]}),/*#__PURE__*/_jsxs(Menu,{open:contextMenu!==null,onClose:handleCloseContextMenu,anchorReference:\"anchorPosition\",anchorPosition:contextMenu!==null?{top:contextMenu.mouseY,left:contextMenu.mouseX}:undefined,children:[/*#__PURE__*/_jsxs(MenuItem,{onClick:()=>(contextMenu===null||contextMenu===void 0?void 0:contextMenu.hotspot)&&handleMoveHotspot(contextMenu.hotspot.id),children:[/*#__PURE__*/_jsx(ListItemIcon,{children:/*#__PURE__*/_jsx(DragIndicator,{fontSize:\"small\"})}),/*#__PURE__*/_jsx(ListItemText,{children:\"Move Hotspot\"})]}),/*#__PURE__*/_jsxs(MenuItem,{onClick:()=>(contextMenu===null||contextMenu===void 0?void 0:contextMenu.hotspot)&&handleDeleteHotspot(contextMenu.hotspot.id),children:[/*#__PURE__*/_jsx(ListItemIcon,{children:/*#__PURE__*/_jsx(Delete,{fontSize:\"small\"})}),/*#__PURE__*/_jsx(ListItemText,{children:\"Delete Hotspot\"})]})]})]});};export default RichMenuManager;","map":{"version":3,"names":["React","useState","useEffect","useRef","Box","Button","Dialog","DialogTitle","DialogContent","DialogActions","TextField","Typography","Alert","Chip","IconButton","Grid","Paper","Table","TableBody","TableCell","TableContainer","TableHead","TableRow","List","ListItem","ListItemText","ListItemSecondaryAction","Divider","Tabs","Tab","Card","CardContent","CardActions","FormControl","InputLabel","Select","MenuItem","FormControlLabel","Switch","Accordion","AccordionSummary","AccordionDetails","CircularProgress","Menu","ListItemIcon","Add","Delete","Edit","Star","StarBorder","LinkOff","Assignment","Group","Image","Code","Palette","ViewModule","Refresh","Person","CloudUpload","ExpandMore","Lock","LockOpen","Close","Help","DragIndicator","Link","Visibility","Settings","Error","ErrorIcon","getRichMenus","getRichMenuDetails","createRichMenu","uploadRichMenuImage","setDefaultRichMenu","assignRichMenuToUser","deleteRichMenu","changeRichMenuImage","validateRichMenu","autoCorrectRichMenu","getRichMenuAliases","deleteRichMenuAlias","createAliasesForRichMenu","fetchAndLinkAliases","getUnlinkedRichMenus","createRichMenuAlias","cleanupRichMenuAliases","updateRichMenuAlias","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","LINE_RICH_MENU_SIZES","FULL","width","height","label","HALF","RichMenuManager","_richMenuDetails$rich","_richMenuDetails$rich2","_richMenuDetails$rich3","_richMenuDetails$rich4","_richMenuDetails$rich5","_richMenuDetails$rich6","_richMenuDetails$rich7","_richMenuDetails$rich8","_richMenuDetails$rich11","_richMenuDetails$rich12","_richMenuDetails$rich13","_richMenuDetails$rich14","_richMenuDetails$rich15","_richMenuDetails$rich16","_richMenuDetails$rich17","_richMenuDetails$rich18","_richMenuDetails$rich19","_richMenuDetails$rich20","_richMenuDetails$rich21","_richMenuDetails$rich22","_richMenuDetails$rich23","_richMenuDetails$rich24","_richMenuDetails$rich25","_editingButton$label","_editingHotspot$label","richMenus","setRichMenus","richMenuAliases","setRichMenuAliases","loading","setLoading","error","setError","success","setSuccess","assignDialogOpen","setAssignDialogOpen","selectedRichMenu","setSelectedRichMenu","userId","setUserId","assigning","setAssigning","selectedRichMenuSize","setSelectedRichMenuSize","validateRichMenuAliasId","aliasId","length","test","handleRichMenuSizeChange","newSize","backgroundImageFile","canvasImage","img","canvas","canvasRef","current","selectedSize","targetWidth","targetHeight","targetAspectRatio","maxCanvasWidth","maxCanvasHeight","canvasWidth","canvasHeight","scaleX","scaleY","scale","Math","min","drawnWidth","drawnHeight","offsetX","offsetY","dataset","toString","imageWidth","imageHeight","console","log","scheduleCanvasRender","createAliasDialogOpen","setCreateAliasDialogOpen","unlinkedRichMenus","setUnlinkedRichMenus","selectedUnlinkedRichMenu","setSelectedUnlinkedRichMenu","setAliasId","creatingAlias","setCreatingAlias","updateAliasDialogOpen","setUpdateAliasDialogOpen","selectedAliasForUpdate","setSelectedAliasForUpdate","selectedRichMenuForUpdate","setSelectedRichMenuForUpdate","updatingAlias","setUpdatingAlias","detailsDialogOpen","setDetailsDialogOpen","selectedRichMenuForDetails","setSelectedRichMenuForDetails","richMenuDetails","setRichMenuDetails","loadingDetails","setLoadingDetails","imageLoaded","setImageLoaded","imageDimensions","setImageDimensions","createDialogOpen","setCreateDialogOpen","creating","setCreating","richMenuForm","setRichMenuForm","name","chatBarText","displayByDefault","body","JSON","stringify","size","selected","areas","bounds","x","y","action","type","data","uploadDialogOpen","setUploadDialogOpen","uploadingImage","setUploadingImage","selectedFile","setSelectedFile","selectedRichMenuForUpload","setSelectedRichMenuForUpload","createMode","setCreateMode","backgroundImageUrl","setBackgroundImageUrl","setBackgroundImageFile","buttons","setButtons","buttonDialogOpen","setButtonDialogOpen","editingButton","setEditingButton","hotspots","setHotspots","drawingState","setDrawingState","isDrawing","startX","startY","currentHotspot","zoom","pan","gridSnap","gridSize","showGrid","snapThreshold","isDragging","draggingHotspot","dragOffset","isResizing","resizingHotspot","resizeHandle","zoomLocked","lockedZoomLevel","mousePosition","hotspotDialogOpen","setHotspotDialogOpen","editingHotspot","setEditingHotspot","setCanvasImage","animationFrameId","setAnimationFrameId","isCanvasReady","setIsCanvasReady","lastMouseMoveTime","setLastMouseMoveTime","throttleDelay","showDrawingControls","setShowDrawingControls","jsonImportText","setJsonImportText","importedHotspots","setImportedHotspots","showImportedHotspots","setShowImportedHotspots","contextMenu","setContextMenu","highTransparency","setHighTransparency","richMenuTemplates","description","id","uri","richMenuAliasId","loadRichMenus","loadRichMenuAliases","cancelAnimationFrame","handleWheel","e","preventDefault","delta","deltaY","newZoom","max","prev","_objectSpread","addEventListener","passive","removeEventListener","response","rich_menus","concat","count","line_api_count","database_only_count","err","_err$response","_err$response$data","detail","aliases","handleFetchAndLinkAliases","line_aliases_count","created_count","updated_count","successMessage","message","_error$response","_error$response$data","handleCleanupAliases","window","confirm","_error$response2","_error$response2$data","handleOpenCreateAliasDialog","unlinked_rich_menus","_error$response3","_error$response3$data","handleCreateRichMenuAlias","trim","aliasData","richMenuId","rich_menu_id","_error$response4","_error$response4$data","handleCreateAlias","_err$response2","_err$response2$data","handleDeleteAlias","_err$response3","_err$response3$data","handleOpenUpdateAliasDialog","alias","handleUpdateAlias","updateData","_error$response5","_error$response5$data","handleOpenDetailsDialog","richMenu","_error$response6","_error$response6$data","handleImageLoad","event","target","offsetWidth","offsetHeight","handleSetDefault","_richMenus$find","map","menu","isDefault","find","m","_err$response4","_err$response4$data","handleDeleteRichMenu","filter","_err$response5","_err$response5$data","handleAssignToUser","_err$response6","_err$response6$data","validateAndFixURIs","richMenuData","Array","isArray","forEach","area","index","match","handleCreateRichMenu","parse","richMenuSize","isValidSize","Object","values","some","standardSize","allowedSizes","join","i","validationResponse","aliasesCreated","aliases_created","aliasesSkipped","aliases_skipped","aliasesFailed","aliases_failed","aliasesLinked","aliases_linked","resetCreateForm","includes","_err$response7","_err$response7$data","handleUploadImage","rm","hasExistingImage","hasImage","new_rich_menu_id","_err$response8","_err$response8$data","generateRichMenuJSON","btn","handleBackgroundImageUpload","file","url","URL","createObjectURL","onload","scaleConsistent","abs","imageFits","centered","src","frameId","requestAnimationFrame","drawCanvas","ctx","getContext","clearRect","save","translate","parseFloat","canvasDimensions","drawnDimensions","offset","usingNewSystem","drawImage","drawGrid","hotspot","drawHotspot","mouseX","mouseY","canvasX","canvasY","strokeStyle","lineWidth","setLineDash","beginPath","moveTo","lineTo","stroke","fillStyle","font","fillText","round","restore","updateHotspotPosition","hotspotId","newBounds","prevHotspots","h","handleTemplateSelect","template","parseJsonToHotspots","jsonText","jsonData","hue","color","text","handleJsonImport","correctedData","clearImportedHotspots","handleContextMenu","clientX","clientY","handleCloseContextMenu","handleDeleteHotspot","_prev$draggingHotspot","_prev$resizingHotspot","handleMoveHotspot","getCursorStyle","coords","getCanvasCoordinates","hoveredHotspot","handleSize","rect","getBoundingClientRect","left","top","transformedX","transformedY","parseInt","imageX","imageY","clampedX","clampedY","clientCoords","canvasCoords","transformedCoords","imageCoords","clampedCoords","imageScale","scaledWidth","scaledHeight","fallbackOffsetX","fallbackOffsetY","snapToGrid","value","snapCoordinates","handleCanvasMouseDown","isInside","shiftKey","debugHotspot","Date","now","clickedHotspot","snappedCoords","throttledMouseMove","handleCanvasMouseMove","updatedHotspot","handleCanvasMouseUp","newHotspot","random","handleCanvasClick","handleCanvasContextMenu","handleCanvasKeyDown","key","handleHotspotDelete","toggleZoomLock","_drawingState$draggin","_drawingState$resizin","arguments","undefined","newScale","newOffsetX","newOffsetY","finalScale","finalOffsetX","finalOffsetY","imageBounds","hotspotImageBounds","originalScale","originalOffset","finalOffset","isActive","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","borderOpacity","radius","quadraticCurveTo","closePath","fillOpacity","fill","handleColor","borderColor","handles","handle","fillRect","strokeRect","textAlign","textBaseline","handleHotspotSave","prevImportedHotspots","convertHotspotsToButtons","allHotspots","handleCanvasCreate","totalHotspots","validationErr","_validationErr$respon","_validationErr$respon2","_validationErr$respon3","_validationErr$respon4","_validationErr$respon5","_validationErr$respon6","errorMessage","uploadResponse","uploadErr","_uploadErr$response","_uploadErr$response$d","_err$response9","_err$response9$data","handleFileSelect","_event$target$files","files","openAssignDialog","openUploadDialog","formatDate","dateString","toLocaleString","sx","display","justifyContent","alignItems","children","p","xs","md","minHeight","background","mb","gap","borderRadius","boxShadow","border","flex","bgcolor","fontSize","variant","fontWeight","backgroundClip","WebkitBackgroundClip","WebkitTextFillColor","startIcon","onClick","disabled","severity","container","spacing","item","overflowX","component","maxHeight","stickyHeader","hover","fontFamily","source","icon","minWidth","mt","createdAt","db_created_at","flexDirection","primary","secondary","cursor","db_created_by","db_updated_at","expandIcon","style","overflow","margin","whiteSpace","wordBreak","flexWrap","areaIndex","fullWidth","placeholder","helperText","alignSelf","ml","status","created_at","open","onClose","maxWidth","PaperProps","borderTopLeftRadius","borderTopRightRadius","mr","opacity","sm","rich_menu","lg","image","position","alt","onLoad","objectFit","pointerEvents","_richMenuDetails$rich9","_richMenuDetails$rich0","_richMenuDetails$rich1","_richMenuDetails$rich10","scaledX","scaledY","zIndex","transition","transform","padding","pb","borderBottom","toUpperCase","fontStyle","textDecoration","mx","borderTop","borderBottomLeftRadius","borderBottomRightRadius","onChange","toLowerCase","marginTop","backgroundColor","_","newValue","inputProps","maxLength","control","checked","entries","_ref","gutterBottom","accept","_e$target$files","htmlFor","right","ref","onMouseDown","onMouseMove","onMouseUp","onContextMenu","onKeyDown","onMouseLeave","tabIndex","userSelect","touchAction","testHotspots","centerX","centerY","testHotspot","substring","multiline","rows","InputProps","readOnly","corrected_data","Boolean","anchorReference","anchorPosition"],"sources":["/Users/kitkamon/Cursor/evep-my-firstcare-com/admin-panel/src/components/line-bot/RichMenuManager.tsx"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\nimport {\n  Box,\n  Button,\n  Dialog,\n  DialogTitle,\n  DialogContent,\n  DialogActions,\n  TextField,\n  Typography,\n  Alert,\n  Chip,\n  IconButton,\n  Grid,\n  Paper,\n  Table,\n  TableBody,\n  TableCell,\n  TableContainer,\n  TableHead,\n  TableRow,\n  List,\n  ListItem,\n  ListItemText,\n  ListItemSecondaryAction,\n  Divider,\n  Tabs,\n  Tab,\n  Card,\n  CardContent,\n  CardActions,\n  FormControl,\n  InputLabel,\n  Select,\n  MenuItem,\n  FormControlLabel,\n  Switch,\n  Accordion,\n  AccordionSummary,\n  AccordionDetails,\n  CircularProgress,\n  Menu,\n  ListItemIcon\n} from '@mui/material';\nimport {\n  Add,\n  Delete,\n  Edit,\n  Star,\n  StarBorder,\n  LinkOff,\n  Assignment,\n  Group,\n  Image,\n  Code,\n  Palette,\n  ViewModule,\n  Refresh,\n  Person,\n  CloudUpload,\n  ExpandMore,\n  Lock,\n  LockOpen,\n  Close,\n  Help,\n  DragIndicator,\n  Link,\n  Visibility,\n  Settings,\n  Error as ErrorIcon\n} from '@mui/icons-material';\nimport { getRichMenus, getRichMenuDetails, createRichMenu, uploadRichMenuImage, setDefaultRichMenu, assignRichMenuToUser, deleteRichMenu, changeRichMenuImage, validateRichMenu, autoCorrectRichMenu, getRichMenuAliases, deleteRichMenuAlias, createAliasesForRichMenu, fetchAndLinkAliases, getUnlinkedRichMenus, createRichMenuAlias, cleanupRichMenuAliases, updateRichMenuAlias } from '../../api';\n\ninterface RichMenu {\n  richMenuId: string;\n  name: string;\n  chatBarText: string;\n  size: { width: number; height: number };\n  areas: Array<{\n    bounds: { x: number; y: number; width: number; height: number };\n    action: {\n      type: string;\n      data?: string;\n      text?: string;\n      uri?: string;\n      richMenuAliasId?: string;\n      label?: string;\n    };\n  }>;\n  selected: boolean;\n  isDefault: boolean;\n  hasImage: boolean;\n  createdAt: string;\n  updatedAt: string;\n  source: 'line_api' | 'database_only';\n  // Database fields\n  db_name?: string;\n  db_created_at?: string;\n  db_updated_at?: string;\n  db_created_by?: string;\n  db_status?: string;\n  db_has_image?: boolean;\n  db_is_default?: boolean;\n}\n\ninterface RichMenuButton {\n  id: string;\n  bounds: { x: number; y: number; width: number; height: number };\n  action: {\n    type: 'postback' | 'message' | 'uri' | 'richmenuswitch';\n    data?: string;\n    text?: string;\n    uri?: string;\n    richMenuAliasId?: string;\n  };\n  label: string;\n}\n\ninterface Hotspot {\n  id: string;\n  bounds: { x: number; y: number; width: number; height: number };\n  action: {\n    type: 'postback' | 'message' | 'uri' | 'richmenuswitch';\n    data?: string;\n    text?: string;\n    uri?: string;\n    richMenuAliasId?: string;\n  };\n  label: string;\n  color: string;\n}\n\ninterface DrawingState {\n  isDrawing: boolean;\n  startX: number;\n  startY: number;\n  currentHotspot: Hotspot | null;\n  zoom: number;\n  pan: { x: number; y: number };\n  gridSnap: boolean;\n  gridSize: number;\n  showGrid: boolean;\n  snapThreshold: number;\n  isDragging: boolean;\n  draggingHotspot: Hotspot | null;\n  dragOffset: { x: number; y: number };\n  isResizing: boolean;\n  resizingHotspot: Hotspot | null;\n  resizeHandle: 'nw' | 'ne' | 'sw' | 'se' | null;\n  zoomLocked: boolean;\n  lockedZoomLevel: number;\n  mousePosition: { x: number; y: number } | null;\n}\n\ninterface RichMenuTemplate {\n  name: string;\n  description: string;\n  size: { width: number; height: number };\n  areas: RichMenuButton[];\n}\n\ninterface RichMenusResponse {\n  success: boolean;\n  rich_menus: RichMenu[];\n  default_rich_menu_id: string | null;\n  count: number;\n  db_count: number;\n  line_api_count: number;\n  database_only_count: number;\n}\n\ninterface RichMenuAlias {\n  _id?: string;\n  richMenuAliasId: string;\n  richMenuId: string;\n  name: string;\n  status?: 'linked' | 'unlinked';\n  created_at: string;\n  updated_at: string;\n}\n\ninterface RichMenuAliasesResponse {\n  success: boolean;\n  aliases: RichMenuAlias[];\n}\n\n// LINE Standard Rich Menu Sizes\nconst LINE_RICH_MENU_SIZES = {\n  FULL: { width: 2500, height: 1686, label: 'Full Size (2500 x 1686)' },\n  HALF: { width: 2500, height: 843, label: 'Half Size (2500 x 843)' }\n};\n\nconst RichMenuManager: React.FC = () => {\n  const [richMenus, setRichMenus] = useState<RichMenu[]>([]);\n  const [richMenuAliases, setRichMenuAliases] = useState<RichMenuAlias[]>([]);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  const [success, setSuccess] = useState<string | null>(null);\n\n  \n  // Dialog states\n  const [assignDialogOpen, setAssignDialogOpen] = useState(false);\n  const [selectedRichMenu, setSelectedRichMenu] = useState<RichMenu | null>(null);\n  const [userId, setUserId] = useState('');\n  const [assigning, setAssigning] = useState(false);\n  \n  // Rich Menu Size Selection\n  const [selectedRichMenuSize, setSelectedRichMenuSize] = useState<keyof typeof LINE_RICH_MENU_SIZES>('FULL');\n  \n  // Validate rich menu alias ID format\n  const validateRichMenuAliasId = (aliasId: string): boolean => {\n    if (!aliasId || aliasId.length === 0) return false;\n    if (aliasId.length > 40) return false;\n    // Only allow alphanumeric characters and hyphens\n    return /^[a-zA-Z0-9-]+$/.test(aliasId);\n  };\n  \n  // Handle rich menu size change\n  const handleRichMenuSizeChange = (newSize: keyof typeof LINE_RICH_MENU_SIZES) => {\n    setSelectedRichMenuSize(newSize);\n    // If we have a background image, recalculate canvas dimensions\n    if (backgroundImageFile && canvasImage) {\n      const img = canvasImage;\n      const canvas = canvasRef.current;\n      if (canvas) {\n        // Get the selected rich menu size\n        const selectedSize = LINE_RICH_MENU_SIZES[newSize];\n        const targetWidth = selectedSize.width;\n        const targetHeight = selectedSize.height;\n        const targetAspectRatio = targetWidth / targetHeight;\n        \n        // Calculate canvas dimensions to maintain the target aspect ratio\n        const maxCanvasWidth = 800;\n        const maxCanvasHeight = 600;\n        \n        let canvasWidth, canvasHeight;\n        \n        // Calculate canvas size to fit within max dimensions while maintaining target aspect ratio\n        if (targetAspectRatio > maxCanvasWidth / maxCanvasHeight) {\n          // Width is the limiting factor\n          canvasWidth = maxCanvasWidth;\n          canvasHeight = maxCanvasWidth / targetAspectRatio;\n        } else {\n          // Height is the limiting factor\n          canvasHeight = maxCanvasHeight;\n          canvasWidth = maxCanvasHeight * targetAspectRatio;\n        }\n        \n        // Set canvas to calculated dimensions\n        canvas.width = canvasWidth;\n        canvas.height = canvasHeight;\n        \n        // Calculate scale to fit image within canvas while maintaining aspect ratio\n        const scaleX = canvasWidth / img.width;\n        const scaleY = canvasHeight / img.height;\n        const scale = Math.min(scaleX, scaleY);\n        \n        // Calculate the actual dimensions the image will be drawn at\n        const drawnWidth = img.width * scale;\n        const drawnHeight = img.height * scale;\n        \n        // Calculate centering offsets\n        const offsetX = (canvasWidth - drawnWidth) / 2;\n        const offsetY = (canvasHeight - drawnHeight) / 2;\n        \n        // Store all the positioning data for consistent use\n        canvas.dataset.scale = scale.toString();\n        canvas.dataset.drawnWidth = drawnWidth.toString();\n        canvas.dataset.drawnHeight = drawnHeight.toString();\n        canvas.dataset.offsetX = offsetX.toString();\n        canvas.dataset.offsetY = offsetY.toString();\n        canvas.dataset.imageWidth = img.width.toString();\n        canvas.dataset.imageHeight = img.height.toString();\n        \n        console.log('Canvas updated for new rich menu size:', selectedSize.label);\n        console.log('New canvas dimensions:', canvasWidth, 'x', canvasHeight);\n        \n        // Redraw the canvas\n        scheduleCanvasRender();\n      }\n    }\n  };\n  \n  // Create Alias Dialog State\n  const [createAliasDialogOpen, setCreateAliasDialogOpen] = useState(false);\n  const [unlinkedRichMenus, setUnlinkedRichMenus] = useState<any[]>([]);\n  const [selectedUnlinkedRichMenu, setSelectedUnlinkedRichMenu] = useState<any>(null);\n  const [aliasId, setAliasId] = useState('');\n  const [creatingAlias, setCreatingAlias] = useState(false);\n  \n  // Update Alias Dialog State\n  const [updateAliasDialogOpen, setUpdateAliasDialogOpen] = useState(false);\n  const [selectedAliasForUpdate, setSelectedAliasForUpdate] = useState<any>(null);\n  const [selectedRichMenuForUpdate, setSelectedRichMenuForUpdate] = useState<any>(null);\n  const [updatingAlias, setUpdatingAlias] = useState(false);\n  \n  // Rich Menu Details Dialog State\n  const [detailsDialogOpen, setDetailsDialogOpen] = useState(false);\n  const [selectedRichMenuForDetails, setSelectedRichMenuForDetails] = useState<any>(null);\n  const [richMenuDetails, setRichMenuDetails] = useState<any>(null);\n  const [loadingDetails, setLoadingDetails] = useState(false);\n  const [imageLoaded, setImageLoaded] = useState(false);\n  const [imageDimensions, setImageDimensions] = useState({ width: 0, height: 0 });\n  \n  // Create rich menu states\n  const [createDialogOpen, setCreateDialogOpen] = useState(false);\n  const [creating, setCreating] = useState(false);\n  const [richMenuForm, setRichMenuForm] = useState({\n    name: '',\n    chatBarText: 'Tap to open',\n    displayByDefault: false,\n    body: JSON.stringify({\n      size: { width: 2500, height: 1686 },\n      selected: false,\n      name: \"Rich Menu\",\n      chatBarText: \"Tap to open\",\n      areas: [\n        {\n          bounds: { x: 0, y: 0, width: 2500, height: 1686 },\n          action: { type: \"postback\", data: \"action=menu&item=main\" }\n        }\n      ]\n    }, null, 2)\n  });\n\n  // Upload image states\n  const [uploadDialogOpen, setUploadDialogOpen] = useState(false);\n  const [uploadingImage, setUploadingImage] = useState(false);\n  const [selectedFile, setSelectedFile] = useState<File | null>(null);\n  const [selectedRichMenuForUpload, setSelectedRichMenuForUpload] = useState<RichMenu | null>(null);\n\n  // Visual Builder State\n  const [createMode, setCreateMode] = useState<'visual' | 'manual' | 'template' | 'import'>('visual');\n  const [backgroundImageUrl, setBackgroundImageUrl] = useState<string>('');\n  const [backgroundImageFile, setBackgroundImageFile] = useState<File | null>(null);\n  const [buttons, setButtons] = useState<RichMenuButton[]>([]);\n  const [buttonDialogOpen, setButtonDialogOpen] = useState(false);\n  const [editingButton, setEditingButton] = useState<RichMenuButton | null>(null);\n\n  // Canvas Drawing State\n  const canvasRef = useRef<HTMLCanvasElement>(null);\n  const [hotspots, setHotspots] = useState<Hotspot[]>([]);\n  const [drawingState, setDrawingState] = useState<DrawingState>({\n    isDrawing: false,\n    startX: 0,\n    startY: 0,\n    currentHotspot: null,\n    zoom: 1,\n    pan: { x: 0, y: 0 },\n    gridSnap: false,\n    gridSize: 100,\n    showGrid: false,\n    snapThreshold: 5,\n    isDragging: false,\n    draggingHotspot: null,\n    dragOffset: { x: 0, y: 0 },\n    isResizing: false,\n    resizingHotspot: null,\n    resizeHandle: null,\n    zoomLocked: false,\n    lockedZoomLevel: 1,\n    mousePosition: null\n  });\n  const [hotspotDialogOpen, setHotspotDialogOpen] = useState(false);\n  const [editingHotspot, setEditingHotspot] = useState<Hotspot | null>(null);\n  const [canvasImage, setCanvasImage] = useState<HTMLImageElement | null>(null);\n  const [animationFrameId, setAnimationFrameId] = useState<number | null>(null);\n  const [isCanvasReady, setIsCanvasReady] = useState(false);\n  const [lastMouseMoveTime, setLastMouseMoveTime] = useState(0);\n  const [throttleDelay] = useState(16); // ~60fps\n  const [showDrawingControls, setShowDrawingControls] = useState(true);\n  const [jsonImportText, setJsonImportText] = useState('');\n  const [importedHotspots, setImportedHotspots] = useState<Hotspot[]>([]);\n  const [showImportedHotspots, setShowImportedHotspots] = useState(false);\n  const [contextMenu, setContextMenu] = useState<{\n    mouseX: number;\n    mouseY: number;\n    hotspot: Hotspot | null;\n  } | null>(null);\n  const [highTransparency, setHighTransparency] = useState(true);\n\n  // Rich Menu Templates\n  const richMenuTemplates: RichMenuTemplate[] = [\n    {\n      name: \"Home Menu (3x2 Grid)\",\n      description: \"Standard 3x2 grid layout with 6 buttons\",\n      size: { width: 2500, height: 1686 },\n      areas: [\n        {\n          id: \"btn1\",\n          bounds: { x: 131, y: 127, width: 705, height: 713 },\n          action: { type: \"uri\", uri: \"https://example.com/button1\" },\n          label: \"Button 1\"\n        },\n        {\n          id: \"btn2\",\n          bounds: { x: 904, y: 127, width: 709, height: 718 },\n          action: { type: \"uri\", uri: \"https://example.com/button2\" },\n          label: \"Button 2\"\n        },\n        {\n          id: \"btn3\",\n          bounds: { x: 1672, y: 127, width: 735, height: 726 },\n          action: { type: \"richmenuswitch\", data: \"change-to-page-clip1\", richMenuAliasId: \"page-clip1\" },\n          label: \"Switch Menu\"\n        },\n        {\n          id: \"btn4\",\n          bounds: { x: 127, y: 874, width: 701, height: 701 },\n          action: { type: \"richmenuswitch\", data: \"change-to-page-dtx-book\", richMenuAliasId: \"page-dtx-book\" },\n          label: \"DTX Book\"\n        },\n        {\n          id: \"btn5\",\n          bounds: { x: 904, y: 874, width: 701, height: 697 },\n          action: { type: \"uri\", uri: \"https://example.com/button5\" },\n          label: \"Button 5\"\n        },\n        {\n          id: \"btn6\",\n          bounds: { x: 1681, y: 874, width: 709, height: 705 },\n          action: { type: \"uri\", uri: \"https://example.com/button6\" },\n          label: \"Button 6\"\n        }\n      ]\n    },\n    {\n      name: \"Simple Menu (2x2 Grid)\",\n      description: \"Simple 2x2 grid layout with 4 buttons\",\n      size: { width: 2500, height: 1686 },\n      areas: [\n        {\n          id: \"btn1\",\n          bounds: { x: 200, y: 200, width: 1000, height: 600 },\n          action: { type: \"postback\", data: \"action=menu&item=1\" },\n          label: \"Menu Item 1\"\n        },\n        {\n          id: \"btn2\",\n          bounds: { x: 1300, y: 200, width: 1000, height: 600 },\n          action: { type: \"postback\", data: \"action=menu&item=2\" },\n          label: \"Menu Item 2\"\n        },\n        {\n          id: \"btn3\",\n          bounds: { x: 200, y: 900, width: 1000, height: 600 },\n          action: { type: \"postback\", data: \"action=menu&item=3\" },\n          label: \"Menu Item 3\"\n        },\n        {\n          id: \"btn4\",\n          bounds: { x: 1300, y: 900, width: 1000, height: 600 },\n          action: { type: \"postback\", data: \"action=menu&item=4\" },\n          label: \"Menu Item 4\"\n        }\n      ]\n    },\n    {\n      name: \"Single Button Menu\",\n      description: \"Single large button covering most of the menu\",\n      size: { width: 2500, height: 1686 },\n      areas: [\n        {\n          id: \"main-btn\",\n          bounds: { x: 200, y: 200, width: 2100, height: 1286 },\n          action: { type: \"uri\", uri: \"https://example.com/main\" },\n          label: \"Main Action\"\n        }\n      ]\n    }\n  ];\n\n  useEffect(() => {\n    loadRichMenus();\n    loadRichMenuAliases();\n  }, []);\n\n  // Effect to redraw canvas when hotspots or background image changes\n  useEffect(() => {\n    if (isCanvasReady && canvasImage) {\n      scheduleCanvasRender();\n    }\n  }, [hotspots, backgroundImageUrl, drawingState.zoom, drawingState.pan, drawingState.showGrid, drawingState.currentHotspot]);\n\n  // Cleanup effect for animation frames\n  useEffect(() => {\n    return () => {\n      if (animationFrameId) {\n        cancelAnimationFrame(animationFrameId);\n      }\n    };\n  }, [animationFrameId]);\n\n  // Handle wheel events with proper non-passive listener\n  useEffect(() => {\n    const canvas = canvasRef.current;\n    if (!canvas) return;\n\n    const handleWheel = (e: WheelEvent) => {\n      e.preventDefault();\n      \n      // Check if zoom is locked\n      if (drawingState.zoomLocked) {\n        return;\n      }\n      \n      const delta = e.deltaY > 0 ? 0.9 : 1.1;\n      const newZoom = Math.max(0.5, Math.min(3, drawingState.zoom * delta));\n      \n      setDrawingState(prev => ({\n        ...prev,\n        zoom: newZoom\n      }));\n      \n      scheduleCanvasRender();\n    };\n\n    // Add event listener with non-passive option\n    canvas.addEventListener('wheel', handleWheel, { passive: false });\n\n    return () => {\n      canvas.removeEventListener('wheel', handleWheel);\n    };\n  }, [drawingState.zoomLocked, drawingState.zoom]);\n\n  const loadRichMenus = async () => {\n    try {\n      setLoading(true);\n      setError(null);\n      \n      const response = await getRichMenus();\n      const data: RichMenusResponse = response.data;\n      \n      if (data.success) {\n        setRichMenus(data.rich_menus);\n        setSuccess(`Loaded ${data.count} rich menus (${data.line_api_count} from LINE API, ${data.database_only_count} from database only)`);\n      } else {\n        setError('Failed to load rich menus');\n      }\n    } catch (err: any) {\n      setError(err.response?.data?.detail || 'Failed to load rich menus');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const loadRichMenuAliases = async () => {\n    try {\n      const response = await getRichMenuAliases();\n      const data: RichMenuAliasesResponse = response.data;\n      \n      if (data.success) {\n        setRichMenuAliases(data.aliases);\n      }\n    } catch (err: any) {\n      console.error('Error loading rich menu aliases:', err);\n    }\n  };\n\n  const handleFetchAndLinkAliases = async () => {\n    try {\n      setError(null);\n      const response = await fetchAndLinkAliases();\n      \n      if (response.data.success) {\n        const { aliases, line_aliases_count, created_count, updated_count } = response.data;\n        \n        let successMessage = `Synced ${line_aliases_count} aliases from LINE API\\n`;\n        successMessage += ` Created: ${created_count} new aliases\\n`;\n        successMessage += ` Updated: ${updated_count} existing aliases\\n`;\n        successMessage += ` Total in database: ${aliases.length} aliases`;\n        \n        if (aliases.length === 0) {\n          successMessage += '\\n\\nNo rich menu aliases found in LINE API.';\n        }\n        \n        setSuccess(successMessage);\n        setRichMenuAliases(aliases); // Directly update the state with the aliases\n      } else {\n        setError(response.data.message || 'Failed to fetch and link aliases');\n      }\n    } catch (error: any) {\n      console.error('Error fetching and linking aliases:', error);\n      setError(error.response?.data?.detail || 'Failed to fetch and link aliases');\n    }\n  };\n\n  const handleCleanupAliases = async () => {\n    if (!window.confirm('Are you sure you want to clean up duplicate aliases? This will remove duplicate entries and keep only the linked ones.')) {\n      return;\n    }\n\n    try {\n      setError(null);\n      const response = await cleanupRichMenuAliases();\n      \n      if (response.data.success) {\n        setSuccess(response.data.message);\n        loadRichMenuAliases(); // Refresh the aliases list\n      } else {\n        setError(response.data.message || 'Failed to cleanup aliases');\n      }\n    } catch (error: any) {\n      console.error('Error cleaning up aliases:', error);\n      setError(error.response?.data?.detail || 'Failed to cleanup aliases');\n    }\n  };\n\n  const handleOpenCreateAliasDialog = async () => {\n    try {\n      setError(null);\n      const response = await getUnlinkedRichMenus();\n      \n      if (response.data.success) {\n        setUnlinkedRichMenus(response.data.unlinked_rich_menus);\n        setCreateAliasDialogOpen(true);\n      } else {\n        setError(response.data.message || 'Failed to get unlinked rich menus');\n      }\n    } catch (error: any) {\n      console.error('Error getting unlinked rich menus:', error);\n      setError(error.response?.data?.detail || 'Failed to get unlinked rich menus');\n    }\n  };\n\n  const handleCreateRichMenuAlias = async () => {\n    if (!selectedUnlinkedRichMenu || !aliasId.trim()) {\n      setError('Please select a rich menu and enter an alias ID');\n      return;\n    }\n\n    try {\n      setCreatingAlias(true);\n      setError(null);\n      \n      const aliasData = {\n        richMenuAliasId: aliasId.trim(),\n        richMenuId: selectedUnlinkedRichMenu.rich_menu_id,\n        name: `Alias for ${selectedUnlinkedRichMenu.name}`\n      };\n      \n      const response = await createRichMenuAlias(aliasData);\n      \n      if (response.data.success) {\n        setSuccess(`Alias \"${aliasId}\" created successfully for rich menu \"${selectedUnlinkedRichMenu.name}\"`);\n        setCreateAliasDialogOpen(false);\n        setSelectedUnlinkedRichMenu(null);\n        setAliasId('');\n        loadRichMenuAliases(); // Refresh the aliases list\n      } else {\n        setError(response.data.message || 'Failed to create alias');\n      }\n    } catch (error: any) {\n      console.error('Error creating alias:', error);\n      setError(error.response?.data?.detail || 'Failed to create alias');\n    } finally {\n      setCreatingAlias(false);\n    }\n  };\n\n  const handleCreateAlias = async (richMenuId: string) => {\n    try {\n      const response = await createAliasesForRichMenu(richMenuId);\n      if (response.data.success) {\n        setSuccess(response.data.message);\n        loadRichMenuAliases(); // Refresh aliases\n      } else {\n        setError('Failed to create aliases');\n      }\n    } catch (err: any) {\n      setError(err.response?.data?.detail || 'Failed to create aliases');\n    }\n  };\n\n  const handleDeleteAlias = async (aliasId: string) => {\n    if (!window.confirm(`Are you sure you want to delete the alias \"${aliasId}\"?`)) {\n      return;\n    }\n    \n    try {\n      const response = await deleteRichMenuAlias(aliasId);\n      if (response.data.success) {\n        setSuccess(response.data.message);\n        loadRichMenuAliases(); // Refresh aliases\n      } else {\n        setError('Failed to delete alias');\n      }\n    } catch (err: any) {\n      setError(err.response?.data?.detail || 'Failed to delete alias');\n    }\n  };\n\n  const handleOpenUpdateAliasDialog = (alias: any) => {\n    setSelectedAliasForUpdate(alias);\n    setSelectedRichMenuForUpdate(null);\n    setUpdateAliasDialogOpen(true);\n  };\n\n  const handleUpdateAlias = async () => {\n    if (!selectedAliasForUpdate || !selectedRichMenuForUpdate) {\n      setError('Please select a rich menu to link to this alias');\n      return;\n    }\n\n    try {\n      setUpdatingAlias(true);\n      setError(null);\n      \n      const updateData = {\n        richMenuId: selectedRichMenuForUpdate.rich_menu_id\n      };\n      \n      const response = await updateRichMenuAlias(selectedAliasForUpdate.richMenuAliasId, updateData);\n      \n      if (response.data.success) {\n        setSuccess(`Alias \"${selectedAliasForUpdate.richMenuAliasId}\" updated successfully to point to \"${selectedRichMenuForUpdate.name}\"`);\n        setUpdateAliasDialogOpen(false);\n        setSelectedAliasForUpdate(null);\n        setSelectedRichMenuForUpdate(null);\n        loadRichMenuAliases(); // Refresh the aliases list\n      } else {\n        setError(response.data.message || 'Failed to update alias');\n      }\n    } catch (error: any) {\n      console.error('Error updating alias:', error);\n      setError(error.response?.data?.detail || 'Failed to update alias');\n    } finally {\n      setUpdatingAlias(false);\n    }\n  };\n\n  const handleOpenDetailsDialog = async (richMenu: any) => {\n    setSelectedRichMenuForDetails(richMenu);\n    setRichMenuDetails(null);\n    setImageLoaded(false);\n    setImageDimensions({ width: 0, height: 0 });\n    setDetailsDialogOpen(true);\n    \n    try {\n      setLoadingDetails(true);\n      setError(null);\n      \n      const response = await getRichMenuDetails(richMenu.richMenuId);\n      \n      if (response.data.success) {\n        setRichMenuDetails(response.data);\n      } else {\n        setError(response.data.message || 'Failed to load rich menu details');\n      }\n    } catch (error: any) {\n      console.error('Error loading rich menu details:', error);\n      setError(error.response?.data?.detail || 'Failed to load rich menu details');\n    } finally {\n      setLoadingDetails(false);\n    }\n  };\n\n  const handleImageLoad = (event: React.SyntheticEvent<HTMLImageElement>) => {\n    const img = event.target as HTMLImageElement;\n    setImageDimensions({\n      width: img.offsetWidth,\n      height: img.offsetHeight\n    });\n    setImageLoaded(true);\n  };\n\n  const handleSetDefault = async (richMenuId: string) => {\n    try {\n      setLoading(true);\n      setError(null);\n      \n      const response = await setDefaultRichMenu(richMenuId);\n      \n      if (response.data.success) {\n        setRichMenus(prev => prev.map(menu => ({\n          ...menu,\n          isDefault: menu.richMenuId === richMenuId\n        })));\n        setSuccess(`Rich menu \"${richMenus.find(m => m.richMenuId === richMenuId)?.name}\" set as default`);\n      } else {\n        setError('Failed to set default rich menu');\n      }\n    } catch (err: any) {\n      setError(err.response?.data?.detail || 'Failed to set default rich menu');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleDeleteRichMenu = async (richMenu: RichMenu) => {\n    if (!window.confirm(`Are you sure you want to delete the rich menu \"${richMenu.name}\"?\\n\\nThis will delete it from both LINE API and the database.`)) {\n      return;\n    }\n\n    try {\n      setLoading(true);\n      setError(null);\n      \n      const response = await deleteRichMenu(richMenu.richMenuId);\n      \n      if (response.data.success) {\n        setRichMenus(prev => prev.filter(menu => menu.richMenuId !== richMenu.richMenuId));\n        setSuccess(`Rich menu \"${richMenu.name}\" deleted successfully`);\n      } else {\n        setError('Failed to delete rich menu');\n      }\n    } catch (err: any) {\n      setError(err.response?.data?.detail || 'Failed to delete rich menu');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleAssignToUser = async () => {\n    if (!selectedRichMenu || !userId.trim()) {\n      setError('Please enter a user ID');\n      return;\n    }\n\n    try {\n      setAssigning(true);\n      setError(null);\n      \n      const response = await assignRichMenuToUser(selectedRichMenu.richMenuId, userId.trim());\n      \n      if (response.data.success) {\n        setSuccess(`Rich menu \"${selectedRichMenu.name}\" assigned to user ${userId}`);\n        setAssignDialogOpen(false);\n        setUserId('');\n        setSelectedRichMenu(null);\n      } else {\n        setError('Failed to assign rich menu to user');\n      }\n    } catch (err: any) {\n      setError(err.response?.data?.detail || 'Failed to assign rich menu to user');\n    } finally {\n      setAssigning(false);\n    }\n  };\n\n\n\n  const validateAndFixURIs = (richMenuData: any) => {\n    if (richMenuData.areas && Array.isArray(richMenuData.areas)) {\n      richMenuData.areas.forEach((area: any, index: number) => {\n        if (area.action && area.action.type === 'uri' && area.action.uri) {\n          // Fix URI if it doesn't have a protocol\n          if (!area.action.uri.match(/^https?:\\/\\//)) {\n            area.action.uri = `https://${area.action.uri}`;\n            console.log(`Fixed URI for area ${index}: ${area.action.uri}`);\n          }\n        }\n      });\n    }\n    return richMenuData;\n  };\n\n  const handleCreateRichMenu = async () => {\n    if (!richMenuForm.name.trim()) {\n      setError('Please enter a rich menu name');\n      return;\n    }\n\n    if (richMenuForm.chatBarText.length > 14) {\n      setError('Chat Bar Text must not exceed 14 characters (LINE API limit)');\n      return;\n    }\n\n    if (!richMenuForm.body.trim()) {\n      setError('Please enter the rich menu body JSON');\n      return;\n    }\n\n    try {\n      // Parse the JSON body\n      let richMenuData = JSON.parse(richMenuForm.body);\n      \n      // Validate rich menu size against LINE standards\n      if (richMenuData.size) {\n        const richMenuSize = { width: richMenuData.size.width, height: richMenuData.size.height };\n        const isValidSize = Object.values(LINE_RICH_MENU_SIZES).some(standardSize => \n          standardSize.width === richMenuSize.width && standardSize.height === richMenuSize.height\n        );\n        \n        if (!isValidSize) {\n          const allowedSizes = Object.values(LINE_RICH_MENU_SIZES).map(size => `${size.width} x ${size.height}`).join(' or ');\n          setError(` Invalid rich menu size! Only LINE standard sizes are allowed: ${allowedSizes}`);\n          return;\n        }\n      }\n      \n      // Validate all richMenuAliasId values in the rich menu\n      if (richMenuData.areas) {\n        for (let i = 0; i < richMenuData.areas.length; i++) {\n          const area = richMenuData.areas[i];\n          if (area.action && area.action.type === 'richmenuswitch' && area.action.richMenuAliasId) {\n            if (!validateRichMenuAliasId(area.action.richMenuAliasId)) {\n              setError(` Invalid rich menu alias ID in area ${i + 1}: \"${area.action.richMenuAliasId}\". Only alphanumeric characters and hyphens are allowed (1-40 characters).`);\n              return;\n            }\n          }\n        }\n      }\n      \n      // Validate and fix URIs before sending to LINE API\n      richMenuData = validateAndFixURIs(richMenuData);\n      \n      setCreating(true);\n      setError(null);\n      \n      // Step 1: Validate rich menu object before creation\n      const validationResponse = await validateRichMenu(richMenuData);\n      \n      if (!validationResponse.data.success) {\n        setError(`Validation failed: ${validationResponse.data.message || 'Unknown validation error'}`);\n        return;\n      }\n      \n      // Step 2: Create rich menu after successful validation\n      const response = await createRichMenu(richMenuData);\n      \n      if (response.data.success) {\n        const richMenuId = response.data.rich_menu_id;\n        const aliasesCreated = response.data.aliases_created || [];\n        const aliasesSkipped = response.data.aliases_skipped || [];\n        const aliasesFailed = response.data.aliases_failed || [];\n        const aliasesLinked = response.data.aliases_linked || [];\n        \n        let successMessage = `Rich menu \"${richMenuForm.name}\" created successfully! ID: ${richMenuId}`;\n        \n        // Add alias information to success message\n        if (aliasesCreated.length > 0) {\n          successMessage += `\\n\\n Auto-created ${aliasesCreated.length} aliases: ${aliasesCreated.join(', ')}`;\n        }\n        \n        if (aliasesLinked.length > 0) {\n          successMessage += `\\n\\n Auto-linked ${aliasesLinked.length} existing aliases: ${aliasesLinked.join(', ')}`;\n        }\n        \n        if (aliasesSkipped.length > 0) {\n          successMessage += `\\n\\n Skipped ${aliasesSkipped.length} aliases: ${aliasesSkipped.join(', ')}`;\n        }\n        \n        if (aliasesFailed.length > 0) {\n          successMessage += `\\n\\n Failed to create ${aliasesFailed.length} aliases: ${aliasesFailed.join(', ')}`;\n        }\n        \n        setSuccess(successMessage);\n        setCreateDialogOpen(false);\n        resetCreateForm();\n        loadRichMenus(); // Refresh the list\n        loadRichMenuAliases(); // Refresh aliases\n      } else {\n        setError('Failed to create rich menu');\n      }\n    } catch (err: any) {\n      if (err.message && err.message.includes('JSON')) {\n        setError('Invalid JSON format in rich menu body');\n      } else {\n        setError(err.response?.data?.detail || 'Failed to create rich menu');\n      }\n    } finally {\n      setCreating(false);\n    }\n  };\n\n  const handleUploadImage = async (richMenuId: string) => {\n    if (!selectedFile) return;\n\n    try {\n      setUploadingImage(true);\n      setError(null);\n      \n      // Check if rich menu already has an image\n      const richMenu = richMenus.find(rm => rm.richMenuId === richMenuId);\n      const hasExistingImage = richMenu?.hasImage || false;\n      \n      let response;\n      if (hasExistingImage) {\n        // Use change image endpoint (delete + create + upload)\n        response = await changeRichMenuImage(richMenuId, selectedFile);\n        if (response.data.success) {\n          setSuccess(`Image changed successfully. New rich menu ID: ${response.data.new_rich_menu_id}`);\n        } else {\n          setError('Failed to change image');\n        }\n      } else {\n        // Use upload image endpoint (simple upload)\n        response = await uploadRichMenuImage(richMenuId, selectedFile);\n        if (response.data.success) {\n          setSuccess(`Image uploaded successfully for rich menu ${richMenuId}`);\n        } else {\n          setError('Failed to upload image');\n        }\n      }\n    } catch (err: any) {\n      setError(err.response?.data?.detail || 'Failed to upload/change image');\n    } finally {\n      setUploadingImage(false);\n    }\n  };\n\n  const resetCreateForm = () => {\n    setRichMenuForm({\n      name: '',\n      chatBarText: 'Tap to open',\n      displayByDefault: false,\n      body: JSON.stringify({\n        size: { width: 2500, height: 1686 },\n        selected: false,\n        name: \"Rich Menu\",\n        chatBarText: \"Tap to open\",\n        areas: [\n          {\n            bounds: { x: 0, y: 0, width: 2500, height: 1686 },\n            action: { type: \"postback\", data: \"action=menu&item=main\" }\n          }\n        ]\n      }, null, 2)\n    });\n    // Clear imported hotspots and related state\n    setImportedHotspots([]);\n    setShowImportedHotspots(false);\n    setJsonImportText('');\n    // Clear background image\n    setBackgroundImageUrl('');\n    setBackgroundImageFile(null);\n  };\n\n  // Visual Builder Helper Functions\n  const generateRichMenuJSON = (name: string, buttons: RichMenuButton[], size: { width: number; height: number }) => {\n    return {\n      size,\n      selected: richMenuForm.displayByDefault,\n      name,\n      chatBarText: richMenuForm.chatBarText,\n      areas: buttons.map(btn => {\n        // Ensure URI actions have proper protocol\n        let action = { ...btn.action };\n        if (action.type === 'uri' && action.uri && !action.uri.match(/^https?:\\/\\//)) {\n          action.uri = `https://${action.uri}`;\n        }\n        \n        return {\n          bounds: btn.bounds,\n          action: action\n        };\n      })\n    };\n  };\n\n  const handleBackgroundImageUpload = (file: File) => {\n    console.log('handleBackgroundImageUpload called with file:', file);\n    console.log('File name:', file.name);\n    console.log('File type:', file.type);\n    console.log('File size:', file.size);\n    \n    const url = URL.createObjectURL(file);\n    setBackgroundImageUrl(url);\n    setBackgroundImageFile(file); // Store the actual file for later upload\n    console.log('backgroundImageFile set to:', file);\n    \n    // Pre-load the image for smooth rendering\n    const img = new window.Image();\n    img.onload = () => {\n      setCanvasImage(img);\n      setIsCanvasReady(true);\n      \n      // Resize canvas to match selected LINE rich menu size ratio\n      const canvas = canvasRef.current;\n      if (canvas) {\n        // Get the selected rich menu size\n        const selectedSize = LINE_RICH_MENU_SIZES[selectedRichMenuSize];\n        const targetWidth = selectedSize.width;\n        const targetHeight = selectedSize.height;\n        const targetAspectRatio = targetWidth / targetHeight;\n        \n        // Calculate canvas dimensions to maintain the target aspect ratio\n        const maxCanvasWidth = 800;\n        const maxCanvasHeight = 600;\n        \n        let canvasWidth, canvasHeight;\n        \n        // Calculate canvas size to fit within max dimensions while maintaining target aspect ratio\n        if (targetAspectRatio > maxCanvasWidth / maxCanvasHeight) {\n          // Width is the limiting factor\n          canvasWidth = maxCanvasWidth;\n          canvasHeight = maxCanvasWidth / targetAspectRatio;\n        } else {\n          // Height is the limiting factor\n          canvasHeight = maxCanvasHeight;\n          canvasWidth = maxCanvasHeight * targetAspectRatio;\n        }\n        \n        // Set canvas to calculated dimensions\n        canvas.width = canvasWidth;\n        canvas.height = canvasHeight;\n        \n        // Calculate scale to fit image within canvas while maintaining aspect ratio\n        const scaleX = canvasWidth / img.width;\n        const scaleY = canvasHeight / img.height;\n        const scale = Math.min(scaleX, scaleY);\n        \n        // Calculate the actual dimensions the image will be drawn at\n        const drawnWidth = img.width * scale;\n        const drawnHeight = img.height * scale;\n        \n        // Calculate centering offsets\n        const offsetX = (canvasWidth - drawnWidth) / 2;\n        const offsetY = (canvasHeight - drawnHeight) / 2;\n        \n        // Store all the positioning data for consistent use\n        canvas.dataset.scale = scale.toString();\n        canvas.dataset.drawnWidth = drawnWidth.toString();\n        canvas.dataset.drawnHeight = drawnHeight.toString();\n        canvas.dataset.offsetX = offsetX.toString();\n        canvas.dataset.offsetY = offsetY.toString();\n        canvas.dataset.imageWidth = img.width.toString();\n        canvas.dataset.imageHeight = img.height.toString();\n        \n        console.log('Selected rich menu size:', selectedSize.label, `(${targetWidth} x ${targetHeight})`);\n        console.log('Target aspect ratio:', targetAspectRatio);\n        console.log('Canvas dimensions:', canvasWidth, 'x', canvasHeight);\n        console.log('Image dimensions:', img.width, 'x', img.height);\n        console.log('Scale factor:', scale);\n        console.log('Drawn image dimensions:', drawnWidth, 'x', drawnHeight);\n        console.log('Centering offsets:', offsetX, offsetY);\n        console.log('Perfect positioning check:', {\n          scaleConsistent: Math.abs((drawnWidth / img.width) - (drawnHeight / img.height)) < 0.000001,\n          imageFits: drawnWidth <= canvasWidth && drawnHeight <= canvasHeight,\n          centered: offsetX >= 0 && offsetY >= 0\n        });\n      }\n      \n      // Cancel any pending animation frame\n      if (animationFrameId) {\n        cancelAnimationFrame(animationFrameId);\n      }\n      // Schedule initial render\n      scheduleCanvasRender();\n    };\n    img.src = url;\n  };\n\n  const scheduleCanvasRender = () => {\n    // Cancel any pending animation frame to prevent multiple renders\n    if (animationFrameId) {\n      cancelAnimationFrame(animationFrameId);\n    }\n    \n    const frameId = requestAnimationFrame(() => {\n      drawCanvas();\n      setAnimationFrameId(null);\n    });\n    \n    setAnimationFrameId(frameId);\n  };\n\n  const drawCanvas = () => {\n    const canvas = canvasRef.current;\n    const ctx = canvas?.getContext('2d');\n    if (!canvas || !ctx || !canvasImage) return;\n    \n    // Clear canvas\n    ctx.clearRect(0, 0, canvas.width, canvas.height);\n    \n    // Apply zoom and pan transformations\n    ctx.save();\n    ctx.translate(drawingState.pan.x * drawingState.zoom, drawingState.pan.y * drawingState.zoom);\n    ctx.scale(drawingState.zoom, drawingState.zoom);\n    \n    // Use the new positioning system stored in canvas dataset\n    const scale = parseFloat(canvas.dataset.scale || '0');\n    const drawnWidth = parseFloat(canvas.dataset.drawnWidth || '0');\n    const drawnHeight = parseFloat(canvas.dataset.drawnHeight || '0');\n    const offsetX = parseFloat(canvas.dataset.offsetX || '0');\n    const offsetY = parseFloat(canvas.dataset.offsetY || '0');\n    \n    // Debug: Log the scaling calculations\n    console.log('Canvas scaling (new system):', {\n      canvasDimensions: { width: canvas.width, height: canvas.height },\n      imageDimensions: { width: canvasImage.width, height: canvasImage.height },\n      scale,\n      drawnDimensions: { width: drawnWidth, height: drawnHeight },\n      offset: { x: offsetX, y: offsetY },\n      usingNewSystem: scale > 0 && drawnWidth > 0 && drawnHeight > 0\n    });\n    \n    // Draw background image (cached)\n    ctx.drawImage(canvasImage, offsetX, offsetY, drawnWidth, drawnHeight);\n    \n    // Draw grid\n    drawGrid(ctx, canvas, scale, offsetX, offsetY);\n    \n    // Draw all hotspots\n    hotspots.forEach(hotspot => {\n      drawHotspot(ctx, hotspot, scale, offsetX, offsetY);\n    });\n    \n    // Draw imported hotspots if enabled\n    if (showImportedHotspots) {\n      importedHotspots.forEach(hotspot => {\n        drawHotspot(ctx, hotspot, scale, offsetX, offsetY, false);\n      });\n    }\n    \n    // Draw current drawing hotspot\n    if (drawingState.currentHotspot) {\n      drawHotspot(ctx, drawingState.currentHotspot, scale, offsetX, offsetY, true);\n    }\n    \n    // Draw mouse position indicator (small crosshair)\n    if (drawingState.mousePosition) {\n      const mouseX = drawingState.mousePosition.x;\n      const mouseY = drawingState.mousePosition.y;\n      \n      // Convert image coordinates to canvas coordinates\n      const canvasX = offsetX + (mouseX * scale);\n      const canvasY = offsetY + (mouseY * scale);\n      \n      // Draw crosshair\n      ctx.strokeStyle = '#ff0000';\n      ctx.lineWidth = 2;\n      ctx.setLineDash([]);\n      \n      const size = 10;\n      ctx.beginPath();\n      ctx.moveTo(canvasX - size, canvasY);\n      ctx.lineTo(canvasX + size, canvasY);\n      ctx.moveTo(canvasX, canvasY - size);\n      ctx.lineTo(canvasX, canvasY + size);\n      ctx.stroke();\n      \n      // Draw coordinate text\n      ctx.fillStyle = '#ff0000';\n      ctx.font = '12px Arial';\n      ctx.fillText(`(${Math.round(mouseX)}, ${Math.round(mouseY)})`, canvasX + 15, canvasY - 15);\n    }\n    \n    ctx.restore();\n  };\n\n  const updateHotspotPosition = (hotspotId: string, newBounds: { x: number; y: number; width: number; height: number }) => {\n    setHotspots(prevHotspots => \n      prevHotspots.map(h => \n        h.id === hotspotId ? { ...h, bounds: newBounds } : h\n      )\n    );\n    \n    // Schedule canvas render instead of immediate render\n    scheduleCanvasRender();\n  };\n\n  const handleTemplateSelect = (template: RichMenuTemplate) => {\n    setButtons(template.areas);\n    setRichMenuForm({\n      name: template.name,\n      chatBarText: 'Tap to open',\n      displayByDefault: false,\n      body: JSON.stringify(generateRichMenuJSON(template.name, template.areas, template.size), null, 2)\n    });\n    setCreateMode('template');\n  };\n\n  const parseJsonToHotspots = (jsonText: string): Hotspot[] => {\n    try {\n      const jsonData = JSON.parse(jsonText);\n      \n      if (!jsonData.areas || !Array.isArray(jsonData.areas)) {\n        throw new Error('Invalid JSON: missing or invalid areas array');\n      }\n\n      return jsonData.areas.map((area: any, index: number) => {\n        if (!area.bounds || !area.action) {\n          throw new Error(`Invalid area at index ${index}: missing bounds or action`);\n        }\n\n        const bounds = area.bounds;\n        const action = area.action;\n\n        // Generate a unique color for each hotspot (lighter for better transparency)\n        const hue = (index * 137.5) % 360; // Golden angle for good color distribution\n        const color = `hsl(${hue}, 60%, 70%)`;\n\n        // Create a descriptive label based on action type\n        let label = `Hotspot ${index + 1}`;\n        if (action.type === 'uri') {\n          label = `URI ${index + 1}`;\n        } else if (action.type === 'postback') {\n          label = `Postback ${index + 1}`;\n        } else if (action.type === 'message') {\n          label = `Message ${index + 1}`;\n        } else if (action.type === 'richmenuswitch') {\n          label = `Switch ${index + 1}`;\n        }\n\n        return {\n          id: `imported_${index}`,\n          bounds: {\n            x: bounds.x || 0,\n            y: bounds.y || 0,\n            width: bounds.width || 100,\n            height: bounds.height || 100\n          },\n          action: {\n            type: action.type || 'postback',\n            data: action.data || '',\n            text: action.text || '',\n            uri: action.uri || '',\n            richMenuAliasId: action.richMenuAliasId || ''\n          },\n          label,\n          color\n        };\n      });\n    } catch (error) {\n      console.error('Error parsing JSON:', error);\n      throw error;\n    }\n  };\n\n  const handleJsonImport = () => {\n    try {\n      const jsonData = JSON.parse(jsonImportText);\n      \n      // Validate rich menu size against LINE standards\n      if (jsonData.size) {\n        const richMenuSize = { width: jsonData.size.width, height: jsonData.size.height };\n        const isValidSize = Object.values(LINE_RICH_MENU_SIZES).some(standardSize => \n          standardSize.width === richMenuSize.width && standardSize.height === richMenuSize.height\n        );\n        \n        if (!isValidSize) {\n          const allowedSizes = Object.values(LINE_RICH_MENU_SIZES).map(size => `${size.width} x ${size.height}`).join(' or ');\n          setError(` Invalid rich menu size! Only LINE standard sizes are allowed: ${allowedSizes}`);\n          return;\n        }\n      }\n      \n      const hotspots = parseJsonToHotspots(jsonImportText);\n      setImportedHotspots(hotspots);\n      setShowImportedHotspots(true);\n      \n      // Auto-correct the JSON and update the form\n      // Note: auto-correction would be handled by the backend API\n      const correctedData = jsonData;\n      \n      setRichMenuForm({\n        name: correctedData.name || 'Imported Rich Menu',\n        chatBarText: correctedData.chatBarText || 'Tap to open',\n        displayByDefault: correctedData.selected || false,\n        body: JSON.stringify(correctedData, null, 2)\n      });\n      \n      // Show success message\n      setSuccess(`Successfully imported ${hotspots.length} hotspots!`);\n    } catch (error) {\n      setError(`Error importing JSON: ${error instanceof Error ? error.message : 'Invalid JSON format'}`);\n    }\n  };\n\n  const clearImportedHotspots = () => {\n    setImportedHotspots([]);\n    setShowImportedHotspots(false);\n    setJsonImportText('');\n  };\n\n  const handleContextMenu = (event: React.MouseEvent, hotspot: Hotspot) => {\n    event.preventDefault();\n    setContextMenu({\n      mouseX: event.clientX + 2,\n      mouseY: event.clientY - 6,\n      hotspot\n    });\n  };\n\n  const handleCloseContextMenu = () => {\n    setContextMenu(null);\n  };\n\n  const handleDeleteHotspot = (hotspotId: string) => {\n    // Remove from hotspots array\n    setHotspots(prevHotspots => prevHotspots.filter(h => h.id !== hotspotId));\n    \n    // Remove from imported hotspots array\n    setImportedHotspots(prevHotspots => prevHotspots.filter(h => h.id !== hotspotId));\n    \n    // Clear any active states\n    setDrawingState(prev => ({\n      ...prev,\n      draggingHotspot: prev.draggingHotspot?.id === hotspotId ? null : prev.draggingHotspot,\n      resizingHotspot: prev.resizingHotspot?.id === hotspotId ? null : prev.resizingHotspot\n    }));\n    \n    handleCloseContextMenu();\n    scheduleCanvasRender();\n  };\n\n  const handleMoveHotspot = (hotspotId: string) => {\n    const hotspot = [...hotspots, ...importedHotspots].find(h => h.id === hotspotId);\n    if (hotspot) {\n      setDrawingState(prev => ({\n        ...prev,\n        isDragging: true,\n        draggingHotspot: hotspot,\n        dragOffset: { x: 0, y: 0 }\n      }));\n    }\n    handleCloseContextMenu();\n  };\n\n  const getCursorStyle = (clientX: number, clientY: number): string => {\n    if (!backgroundImageUrl) return 'default';\n    \n    const coords = getCanvasCoordinates(clientX, clientY);\n    \n    // Check if mouse is over a hotspot\n    const hoveredHotspot = [...hotspots, ...(showImportedHotspots ? importedHotspots : [])].find(hotspot => \n      coords.x >= hotspot.bounds.x && \n      coords.x <= hotspot.bounds.x + hotspot.bounds.width &&\n      coords.y >= hotspot.bounds.y && \n      coords.y <= hotspot.bounds.y + hotspot.bounds.height\n    );\n    \n    if (hoveredHotspot) {\n      // Check if mouse is over resize handles\n      const handleSize = 8;\n      const x = coords.x;\n      const y = coords.y;\n      \n      if (x <= hoveredHotspot.bounds.x + handleSize && y <= hoveredHotspot.bounds.y + handleSize) {\n        return 'nw-resize'; // Northwest handle\n      } else if (x >= hoveredHotspot.bounds.x + hoveredHotspot.bounds.width - handleSize && y <= hoveredHotspot.bounds.y + handleSize) {\n        return 'ne-resize'; // Northeast handle\n      } else if (x <= hoveredHotspot.bounds.x + handleSize && y >= hoveredHotspot.bounds.y + hoveredHotspot.bounds.height - handleSize) {\n        return 'sw-resize'; // Southwest handle\n      } else if (x >= hoveredHotspot.bounds.x + hoveredHotspot.bounds.width - handleSize && y >= hoveredHotspot.bounds.y + hoveredHotspot.bounds.height - handleSize) {\n        return 'se-resize'; // Southeast handle\n      } else {\n        return 'move'; // Dragging the hotspot\n      }\n    }\n    \n    // Default cursor based on drawing state\n    if (drawingState.isDrawing) {\n      return 'crosshair';\n    } else if (drawingState.isDragging || drawingState.isResizing) {\n      return 'grabbing';\n    } else {\n      return 'default';\n    }\n  };\n\n  // Canvas Drawing Functions\n  const getCanvasCoordinates = (clientX: number, clientY: number) => {\n    const canvas = canvasRef.current;\n    if (!canvas || !canvasImage) return { x: 0, y: 0 };\n    \n    const rect = canvas.getBoundingClientRect();\n    \n    // Convert mouse coordinates to canvas coordinates (accounting for CSS scaling)\n    const canvasX = (clientX - rect.left) * (canvas.width / rect.width);\n    const canvasY = (clientY - rect.top) * (canvas.height / rect.height);\n    \n    // Apply zoom and pan transformations (reverse of what's done in drawCanvas)\n    const transformedX = (canvasX - drawingState.pan.x * drawingState.zoom) / drawingState.zoom;\n    const transformedY = (canvasY - drawingState.pan.y * drawingState.zoom) / drawingState.zoom;\n    \n    // Use the new positioning system stored in canvas dataset\n    const scale = parseFloat(canvas.dataset.scale || '0');\n    const drawnWidth = parseFloat(canvas.dataset.drawnWidth || '0');\n    const drawnHeight = parseFloat(canvas.dataset.drawnHeight || '0');\n    const offsetX = parseFloat(canvas.dataset.offsetX || '0');\n    const offsetY = parseFloat(canvas.dataset.offsetY || '0');\n    const imageWidth = parseInt(canvas.dataset.imageWidth || '0');\n    const imageHeight = parseInt(canvas.dataset.imageHeight || '0');\n    \n    if (scale > 0 && drawnWidth > 0 && drawnHeight > 0) {\n      // Convert to image coordinates using the new positioning system\n      const imageX = (transformedX - offsetX) / scale;\n      const imageY = (transformedY - offsetY) / scale;\n      \n      // Ensure coordinates are within image bounds\n      const clampedX = Math.max(0, Math.min(imageX, imageWidth));\n      const clampedY = Math.max(0, Math.min(imageY, imageHeight));\n      \n      // Debug: Log the coordinate transformation (only when creating hotspots)\n      if (drawingState.isDrawing) {\n        console.log('Coordinate transformation (new system):', {\n          clientCoords: { x: clientX, y: clientY },\n          rect: { left: rect.left, top: rect.top, width: rect.width, height: rect.height },\n          canvasCoords: { x: canvasX, y: canvasY },\n          transformedCoords: { x: transformedX, y: transformedY },\n          scale,\n          drawnDimensions: { width: drawnWidth, height: drawnHeight },\n          offset: { x: offsetX, y: offsetY },\n          imageCoords: { x: imageX, y: imageY },\n          clampedCoords: { x: clampedX, y: clampedY }\n        });\n      }\n      \n      return { x: clampedX, y: clampedY };\n    } else {\n      // Fallback to original calculation if new system is not available\n      const imageScale = Math.min(\n        canvas.width / canvasImage.width,\n        canvas.height / canvasImage.height\n      );\n      \n      const scaledWidth = Math.round(canvasImage.width * imageScale);\n      const scaledHeight = Math.round(canvasImage.height * imageScale);\n      const fallbackOffsetX = Math.round((canvas.width - scaledWidth) / 2);\n      const fallbackOffsetY = Math.round((canvas.height - scaledHeight) / 2);\n      \n      const imageX = (transformedX - fallbackOffsetX) / imageScale;\n      const imageY = (transformedY - fallbackOffsetY) / imageScale;\n      \n      const clampedX = Math.max(0, Math.min(imageX, canvasImage.width));\n      const clampedY = Math.max(0, Math.min(imageY, canvasImage.height));\n      \n      return { x: clampedX, y: clampedY };\n    }\n  };\n\n  const snapToGrid = (value: number, gridSize: number): number => {\n    if (!drawingState.gridSnap) return value;\n    return Math.round(value / gridSize) * gridSize;\n  };\n\n  const snapCoordinates = (x: number, y: number) => {\n    return {\n      x: snapToGrid(x, drawingState.gridSize),\n      y: snapToGrid(y, drawingState.gridSize)\n    };\n  };\n\n  const handleCanvasMouseDown = (e: React.MouseEvent<HTMLCanvasElement>) => {\n    if (!backgroundImageUrl) return;\n    \n    const coords = getCanvasCoordinates(e.clientX, e.clientY);\n    \n    // Debug: Log coordinates for verification\n    console.log('Mouse click coordinates:', {\n      clientX: e.clientX,\n      clientY: e.clientY,\n      imageCoords: coords,\n      canvasImage: canvasImage ? { width: canvasImage.width, height: canvasImage.height } : null,\n      hotspots: hotspots.map(h => ({\n        id: h.id,\n        bounds: h.bounds,\n        isInside: coords.x >= h.bounds.x && \n                 coords.x <= h.bounds.x + h.bounds.width &&\n                 coords.y >= h.bounds.y && \n                 coords.y <= h.bounds.y + h.bounds.height\n      }))\n    });\n    \n    // Debug: Create a small hotspot at the exact click position to verify coordinates\n    if (e.shiftKey) { // Hold Shift to create debug hotspot\n      const debugHotspot: Hotspot = {\n        id: `debug_${Date.now()}`,\n        bounds: { \n          x: coords.x - 5, \n          y: coords.y - 5, \n          width: 10, \n          height: 10 \n        },\n        action: { type: 'postback', data: 'action=debug' },\n        label: `Debug (${Math.round(coords.x)}, ${Math.round(coords.y)})`,\n        color: '#ffff00'\n      };\n      setHotspots([...hotspots, debugHotspot]);\n      drawCanvas();\n      console.log('Created debug hotspot at:', coords);\n      return;\n    }\n    \n    // Check if clicking on existing hotspot for dragging/resizing\n    const clickedHotspot = hotspots.find(hotspot => \n      coords.x >= hotspot.bounds.x && \n      coords.x <= hotspot.bounds.x + hotspot.bounds.width &&\n      coords.y >= hotspot.bounds.y && \n      coords.y <= hotspot.bounds.y + hotspot.bounds.height\n    );\n    \n    if (clickedHotspot) {\n      // Check if clicking on resize handles\n      const handleSize = 8;\n      const hotspot = clickedHotspot;\n      const x = coords.x;\n      const y = coords.y;\n      \n      // Check corner handles\n      if (x <= hotspot.bounds.x + handleSize && y <= hotspot.bounds.y + handleSize) {\n        // Northwest handle\n        setDrawingState({\n          ...drawingState,\n          isResizing: true,\n          resizingHotspot: hotspot,\n          resizeHandle: 'nw'\n        });\n      } else if (x >= hotspot.bounds.x + hotspot.bounds.width - handleSize && y <= hotspot.bounds.y + handleSize) {\n        // Northeast handle\n        setDrawingState({\n          ...drawingState,\n          isResizing: true,\n          resizingHotspot: hotspot,\n          resizeHandle: 'ne'\n        });\n      } else if (x <= hotspot.bounds.x + handleSize && y >= hotspot.bounds.y + hotspot.bounds.height - handleSize) {\n        // Southwest handle\n        setDrawingState({\n          ...drawingState,\n          isResizing: true,\n          resizingHotspot: hotspot,\n          resizeHandle: 'sw'\n        });\n      } else if (x >= hotspot.bounds.x + hotspot.bounds.width - handleSize && y >= hotspot.bounds.y + hotspot.bounds.height - handleSize) {\n        // Southeast handle\n        setDrawingState({\n          ...drawingState,\n          isResizing: true,\n          resizingHotspot: hotspot,\n          resizeHandle: 'se'\n        });\n      } else {\n        // Dragging the hotspot\n        const snappedCoords = snapCoordinates(coords.x, coords.y);\n        setDrawingState({\n          ...drawingState,\n          isDragging: true,\n          draggingHotspot: hotspot,\n          dragOffset: {\n            x: snappedCoords.x - hotspot.bounds.x,\n            y: snappedCoords.y - hotspot.bounds.y\n          }\n        });\n      }\n      return;\n    }\n    \n    // Start drawing new hotspot\n    const snappedCoords = snapCoordinates(coords.x, coords.y);\n    setDrawingState({\n      ...drawingState,\n      isDrawing: true,\n      startX: snappedCoords.x,\n      startY: snappedCoords.y,\n      currentHotspot: null\n    });\n  };\n\n  const throttledMouseMove = (e: React.MouseEvent<HTMLCanvasElement>) => {\n    const now = Date.now();\n    if (now - lastMouseMoveTime < throttleDelay) {\n      return;\n    }\n    setLastMouseMoveTime(now);\n    handleCanvasMouseMove(e);\n  };\n\n  const handleCanvasMouseMove = (e: React.MouseEvent<HTMLCanvasElement>) => {\n    if (!backgroundImageUrl) return;\n    \n    const coords = getCanvasCoordinates(e.clientX, e.clientY);\n    \n    // Update mouse position for visual indicator\n    setDrawingState({\n      ...drawingState,\n      mousePosition: coords\n    });\n    \n    // Handle resizing\n    if (drawingState.isResizing && drawingState.resizingHotspot) {\n      const hotspot = drawingState.resizingHotspot;\n      const snappedCoords = snapCoordinates(coords.x, coords.y);\n      \n      let newBounds = { ...hotspot.bounds };\n      \n      switch (drawingState.resizeHandle) {\n        case 'nw':\n          newBounds.width = hotspot.bounds.x + hotspot.bounds.width - snappedCoords.x;\n          newBounds.height = hotspot.bounds.y + hotspot.bounds.height - snappedCoords.y;\n          newBounds.x = snappedCoords.x;\n          newBounds.y = snappedCoords.y;\n          break;\n        case 'ne':\n          newBounds.width = snappedCoords.x - hotspot.bounds.x;\n          newBounds.height = hotspot.bounds.y + hotspot.bounds.height - snappedCoords.y;\n          newBounds.y = snappedCoords.y;\n          break;\n        case 'sw':\n          newBounds.width = hotspot.bounds.x + hotspot.bounds.width - snappedCoords.x;\n          newBounds.height = snappedCoords.y - hotspot.bounds.y;\n          newBounds.x = snappedCoords.x;\n          break;\n        case 'se':\n          newBounds.width = snappedCoords.x - hotspot.bounds.x;\n          newBounds.height = snappedCoords.y - hotspot.bounds.y;\n          break;\n      }\n      \n      // Ensure minimum size\n      if (newBounds.width > 10 && newBounds.height > 10) {\n        const updatedHotspot = { ...hotspot, bounds: newBounds };\n        updateHotspotPosition(hotspot.id, newBounds);\n        setDrawingState({\n          ...drawingState,\n          resizingHotspot: updatedHotspot\n        });\n      }\n      return;\n    }\n    \n    // Handle dragging\n    if (drawingState.isDragging && drawingState.draggingHotspot) {\n      const hotspot = drawingState.draggingHotspot;\n      const snappedCoords = snapCoordinates(coords.x, coords.y);\n      \n      const newBounds = {\n        x: snappedCoords.x - drawingState.dragOffset.x,\n        y: snappedCoords.y - drawingState.dragOffset.y,\n        width: hotspot.bounds.width,\n        height: hotspot.bounds.height\n      };\n      \n      const updatedHotspot = { ...hotspot, bounds: newBounds };\n      updateHotspotPosition(hotspot.id, newBounds);\n      setDrawingState({\n        ...drawingState,\n        draggingHotspot: updatedHotspot\n      });\n      return;\n    }\n    \n    // Handle drawing new hotspot\n    if (drawingState.isDrawing) {\n      const snappedCoords = snapCoordinates(coords.x, coords.y);\n      \n      const width = Math.abs(snappedCoords.x - drawingState.startX);\n      const height = Math.abs(snappedCoords.y - drawingState.startY);\n      const x = Math.min(snappedCoords.x, drawingState.startX);\n      const y = Math.min(snappedCoords.y, drawingState.startY);\n      \n      // Update the current drawing hotspot\n      const currentHotspot: Hotspot = {\n        id: 'drawing',\n        bounds: { x, y, width, height },\n        action: { type: 'postback', data: 'action=hotspot' },\n        label: 'New Hotspot',\n        color: '#ff0000'\n      };\n      \n      setDrawingState({\n        ...drawingState,\n        currentHotspot\n      });\n      \n      // Schedule canvas render for smooth drawing\n      scheduleCanvasRender();\n    }\n  };\n\n  const handleCanvasMouseUp = (e: React.MouseEvent<HTMLCanvasElement>) => {\n    if (!backgroundImageUrl) return;\n    \n    // Handle resizing completion\n    if (drawingState.isResizing) {\n      setDrawingState({\n        ...drawingState,\n        isResizing: false,\n        resizingHotspot: null,\n        resizeHandle: null\n      });\n      return;\n    }\n    \n    // Handle dragging completion\n    if (drawingState.isDragging) {\n      setDrawingState({\n        ...drawingState,\n        isDragging: false,\n        draggingHotspot: null,\n        dragOffset: { x: 0, y: 0 }\n      });\n      return;\n    }\n    \n    // Handle drawing completion\n    if (drawingState.isDrawing) {\n      const coords = getCanvasCoordinates(e.clientX, e.clientY);\n      const snappedCoords = snapCoordinates(coords.x, coords.y);\n      const width = Math.abs(snappedCoords.x - drawingState.startX);\n      const height = Math.abs(snappedCoords.y - drawingState.startY);\n      \n      // Only create hotspot if it has minimum size\n      if (width > 10 && height > 10) {\n        const x = Math.min(snappedCoords.x, drawingState.startX);\n        const y = Math.min(snappedCoords.y, drawingState.startY);\n        \n        // Debug: Log the hotspot being created\n        console.log('Creating hotspot:', {\n          x, y, width, height,\n          imageWidth: canvasImage?.width,\n          imageHeight: canvasImage?.height,\n          bounds: { x, y, width, height }\n        });\n        \n        const newHotspot: Hotspot = {\n          id: `hotspot_${Date.now()}`,\n          bounds: { x, y, width, height },\n          action: { type: 'postback', data: 'action=hotspot' },\n          label: `Hotspot ${hotspots.length + 1}`,\n          color: `hsl(${Math.random() * 360}, 60%, 70%)`\n        };\n        \n        setHotspots([...hotspots, newHotspot]);\n        setEditingHotspot(newHotspot);\n        setHotspotDialogOpen(true);\n      }\n      \n      setDrawingState({\n        ...drawingState,\n        isDrawing: false,\n        startX: 0,\n        startY: 0,\n        currentHotspot: null\n      });\n      \n      drawCanvas();\n    }\n  };\n\n  const handleCanvasClick = (e: React.MouseEvent<HTMLCanvasElement>) => {\n    if (drawingState.isDrawing || drawingState.isDragging || drawingState.isResizing) return;\n    \n    const coords = getCanvasCoordinates(e.clientX, e.clientY);\n    \n    // Check if clicking on existing hotspot (including imported hotspots)\n    const clickedHotspot = [...hotspots, ...(showImportedHotspots ? importedHotspots : [])].find(hotspot => \n      coords.x >= hotspot.bounds.x && \n      coords.x <= hotspot.bounds.x + hotspot.bounds.width &&\n      coords.y >= hotspot.bounds.y && \n      coords.y <= hotspot.bounds.y + hotspot.bounds.height\n    );\n    \n    if (clickedHotspot) {\n      setEditingHotspot(clickedHotspot);\n      setHotspotDialogOpen(true);\n    }\n  };\n\n  const handleCanvasContextMenu = (e: React.MouseEvent<HTMLCanvasElement>) => {\n    if (!backgroundImageUrl) return;\n    \n    const coords = getCanvasCoordinates(e.clientX, e.clientY);\n    \n    // Find clicked hotspot (including imported hotspots)\n    const clickedHotspot = [...hotspots, ...(showImportedHotspots ? importedHotspots : [])].find(hotspot => \n      coords.x >= hotspot.bounds.x && \n      coords.x <= hotspot.bounds.x + hotspot.bounds.width &&\n      coords.y >= hotspot.bounds.y && \n      coords.y <= hotspot.bounds.y + hotspot.bounds.height\n    );\n    \n    if (clickedHotspot) {\n      handleContextMenu(e, clickedHotspot);\n    }\n  };\n\n  const handleCanvasKeyDown = (e: React.KeyboardEvent<HTMLCanvasElement>) => {\n    if (e.key === 'g' || e.key === 'G') {\n      setDrawingState({\n        ...drawingState,\n        showGrid: !drawingState.showGrid\n      });\n      drawCanvas();\n    } else if (e.key === 's' || e.key === 'S') {\n      setDrawingState({\n        ...drawingState,\n        gridSnap: !drawingState.gridSnap\n      });\n    } else if (e.key === '0') {\n      setDrawingState({\n        ...drawingState,\n        zoom: 1,\n        pan: { x: 0, y: 0 }\n      });\n      drawCanvas();\n    } else if (e.key === 'Delete' || e.key === 'Backspace') {\n      // Delete selected hotspot\n      if (editingHotspot) {\n        handleHotspotDelete(editingHotspot.id);\n      }\n    }\n  };\n\n\n\n  const toggleZoomLock = () => {\n    setDrawingState({\n      ...drawingState,\n      zoomLocked: !drawingState.zoomLocked,\n      lockedZoomLevel: drawingState.zoomLocked ? drawingState.zoom : drawingState.lockedZoomLevel\n    });\n  };\n\n\n\n  const drawGrid = (ctx: CanvasRenderingContext2D, canvas: HTMLCanvasElement, scale: number, offsetX: number, offsetY: number) => {\n    if (!drawingState.showGrid) return;\n    \n    ctx.strokeStyle = '#e0e0e0';\n    ctx.lineWidth = 1;\n    ctx.setLineDash([2, 2]);\n    \n    const gridSize = drawingState.gridSize * scale * drawingState.zoom;\n    \n    // Draw vertical lines\n    for (let x = offsetX; x < canvas.width; x += gridSize) {\n      ctx.beginPath();\n      ctx.moveTo(x, 0);\n      ctx.lineTo(x, canvas.height);\n      ctx.stroke();\n    }\n    \n    // Draw horizontal lines\n    for (let y = offsetY; y < canvas.height; y += gridSize) {\n      ctx.beginPath();\n      ctx.moveTo(0, y);\n      ctx.lineTo(canvas.width, y);\n      ctx.stroke();\n    }\n    \n    ctx.setLineDash([]);\n  };\n\n  const drawHotspot = (\n    ctx: CanvasRenderingContext2D, \n    hotspot: Hotspot, \n    scale: number, \n    offsetX: number, \n    offsetY: number,\n    isDrawing: boolean = false\n  ) => {\n    // Since the canvas context is already transformed with zoom and pan in drawCanvas,\n    // we need to work with the transformed coordinate system\n    // The hotspot bounds are in image coordinates, so we convert them to the transformed canvas coordinates\n    \n    // Use the exact scale factor from canvas dataset for perfect coordinate mapping\n    const canvas = ctx.canvas;\n    const newScale = parseFloat(canvas.dataset.scale || '0');\n    const drawnWidth = parseFloat(canvas.dataset.drawnWidth || '0');\n    const drawnHeight = parseFloat(canvas.dataset.drawnHeight || '0');\n    const newOffsetX = parseFloat(canvas.dataset.offsetX || '0');\n    const newOffsetY = parseFloat(canvas.dataset.offsetY || '0');\n    \n    let finalScale, finalOffsetX, finalOffsetY;\n    \n    if (newScale > 0 && drawnWidth > 0 && drawnHeight > 0) {\n      // Use new positioning system\n      finalScale = newScale;\n      finalOffsetX = newOffsetX;\n      finalOffsetY = newOffsetY;\n    } else {\n      // Fallback to provided scale and offset\n      finalScale = scale;\n      finalOffsetX = offsetX;\n      finalOffsetY = offsetY;\n    }\n    \n    // Calculate the image bounds in the transformed coordinate system\n    const imageBounds = {\n      x: finalOffsetX,\n      y: finalOffsetY,\n      width: canvasImage!.width * finalScale,\n      height: canvasImage!.height * finalScale\n    };\n    \n    // Convert hotspot bounds from image coordinates to transformed canvas coordinates\n    const x = imageBounds.x + (hotspot.bounds.x * finalScale);\n    const y = imageBounds.y + (hotspot.bounds.y * finalScale);\n    const width = hotspot.bounds.width * finalScale;\n    const height = hotspot.bounds.height * finalScale;\n    \n    // Debug: Log the scaling calculations (only for drawing hotspots)\n    if (isDrawing) {\n      console.log('Drawing hotspot:', {\n        hotspotId: hotspot.id,\n        hotspotImageBounds: hotspot.bounds,\n        originalScale: scale,\n        originalOffset: { x: offsetX, y: offsetY },\n        finalScale,\n        finalOffset: { x: finalOffsetX, y: finalOffsetY },\n        canvasCoords: { x, y, width, height },\n        imageBounds: imageBounds,\n        canvasDimensions: { width: ctx.canvas.width, height: ctx.canvas.height },\n        imageDimensions: { width: canvasImage!.width, height: canvasImage!.height },\n        usingNewSystem: newScale > 0\n      });\n    }\n    \n    // Check if this hotspot is being dragged or resized\n    const isActive = (drawingState.draggingHotspot?.id === hotspot.id) || \n                    (drawingState.resizingHotspot?.id === hotspot.id);\n    \n    // Draw shadow for better visibility\n    ctx.shadowColor = 'rgba(0, 0, 0, 0.3)';\n    ctx.shadowBlur = isActive ? 8 : 4;\n    ctx.shadowOffsetX = isActive ? 4 : 2;\n    ctx.shadowOffsetY = isActive ? 4 : 2;\n    \n    // Draw rectangle with rounded corners\n    const borderOpacity = highTransparency ? '50' : '80';\n    ctx.strokeStyle = isActive ? '#ff6b35' : `${hotspot.color}${borderOpacity}`;\n    ctx.lineWidth = isActive ? 4 : (isDrawing ? 3 : 2);\n    ctx.setLineDash(isDrawing ? [5, 5] : []);\n    \n    // Draw rounded rectangle\n    const radius = 8;\n    ctx.beginPath();\n    ctx.moveTo(x + radius, y);\n    ctx.lineTo(x + width - radius, y);\n    ctx.quadraticCurveTo(x + width, y, x + width, y + radius);\n    ctx.lineTo(x + width, y + height - radius);\n    ctx.quadraticCurveTo(x + width, y + height, x + width - radius, y + height);\n    ctx.lineTo(x + radius, y + height);\n    ctx.quadraticCurveTo(x, y + height, x, y + height - radius);\n    ctx.lineTo(x, y + radius);\n    ctx.quadraticCurveTo(x, y, x + radius, y);\n    ctx.closePath();\n    ctx.stroke();\n    \n    // Reset shadow\n    ctx.shadowColor = 'transparent';\n    ctx.shadowBlur = 0;\n    ctx.shadowOffsetX = 0;\n    ctx.shadowOffsetY = 0;\n    \n    // Draw fill with transparency based on user preference\n    const fillOpacity = highTransparency ? (isActive ? '15' : '10') : (isActive ? '40' : '20');\n    ctx.fillStyle = `${hotspot.color}${fillOpacity}`;\n    ctx.fill();\n    \n    // Draw resize handles if not drawing\n    if (!isDrawing) {\n      const handleSize = 8;\n      const handleColor = isActive ? '#ff6b35' : '#666';\n      const borderColor = isActive ? '#fff' : '#333';\n      \n      ctx.fillStyle = handleColor;\n      ctx.strokeStyle = borderColor;\n      ctx.lineWidth = 2;\n      \n      // Corner handles\n      const handles = [\n        { x: x, y: y }, // Northwest\n        { x: x + width - handleSize, y: y }, // Northeast\n        { x: x, y: y + height - handleSize }, // Southwest\n        { x: x + width - handleSize, y: y + height - handleSize } // Southeast\n      ];\n      \n      handles.forEach(handle => {\n        // Draw handle with thicker border\n        ctx.fillRect(handle.x, handle.y, handleSize, handleSize);\n        ctx.strokeRect(handle.x, handle.y, handleSize, handleSize);\n        \n        // Add inner highlight for better visibility\n        ctx.strokeStyle = '#fff';\n        ctx.lineWidth = 1;\n        ctx.strokeRect(handle.x + 1, handle.y + 1, handleSize - 2, handleSize - 2);\n      });\n      \n      // Draw border lines for resize areas (optional visual guide)\n      if (isActive) {\n        ctx.strokeStyle = 'rgba(255, 107, 53, 0.3)';\n        ctx.lineWidth = 1;\n        ctx.setLineDash([3, 3]);\n        \n        // Draw diagonal lines from corners to show resize areas\n        ctx.beginPath();\n        ctx.moveTo(x, y);\n        ctx.lineTo(x + width, y + height);\n        ctx.moveTo(x + width, y);\n        ctx.lineTo(x, y + height);\n        ctx.stroke();\n        \n        ctx.setLineDash([]);\n      }\n    }\n    \n    // Draw label with better styling\n    ctx.fillStyle = '#000';\n    ctx.font = `bold 12px Arial`;\n    ctx.textAlign = 'center';\n    ctx.textBaseline = 'middle';\n    \n    // Add text shadow for better readability\n    ctx.shadowColor = 'rgba(255, 255, 255, 0.8)';\n    ctx.shadowBlur = 2;\n    ctx.shadowOffsetX = 1;\n    ctx.shadowOffsetY = 1;\n    \n    ctx.fillText(hotspot.label, x + width / 2, y + height / 2);\n    \n    // Reset shadow\n    ctx.shadowColor = 'transparent';\n    ctx.shadowBlur = 0;\n    ctx.shadowOffsetX = 0;\n    ctx.shadowOffsetY = 0;\n  };\n\n  const handleHotspotSave = (hotspot: Hotspot) => {\n    if (editingHotspot) {\n      // Update the entire hotspot data, not just position\n      setHotspots(prevHotspots => \n        prevHotspots.map(h => \n          h.id === hotspot.id ? hotspot : h\n        )\n      );\n      // Also update imported hotspots if it's an imported one\n      setImportedHotspots(prevImportedHotspots => \n        prevImportedHotspots.map(h => \n          h.id === hotspot.id ? hotspot : h\n        )\n      );\n    } else {\n      setHotspots([...hotspots, hotspot]);\n    }\n    setHotspotDialogOpen(false);\n    setEditingHotspot(null);\n    scheduleCanvasRender();\n  };\n\n  const handleHotspotDelete = (hotspotId: string) => {\n    // Remove from both drawn and imported hotspots\n    setHotspots(prevHotspots => prevHotspots.filter(h => h.id !== hotspotId));\n    setImportedHotspots(prevImportedHotspots => prevImportedHotspots.filter(h => h.id !== hotspotId));\n    setHotspotDialogOpen(false);\n    setEditingHotspot(null);\n    scheduleCanvasRender();\n  };\n\n  const convertHotspotsToButtons = () => {\n    // Combine both drawn hotspots and imported hotspots\n    const allHotspots = [...hotspots, ...(showImportedHotspots ? importedHotspots : [])];\n    return allHotspots.map(hotspot => ({\n      id: hotspot.id,\n      bounds: hotspot.bounds,\n      action: hotspot.action,\n      label: hotspot.label\n    }));\n  };\n\n  const handleCanvasCreate = async () => {\n    console.log('handleCanvasCreate called');\n    console.log('richMenuForm.name:', richMenuForm.name);\n    console.log('hotspots.length:', hotspots.length);\n    console.log('importedHotspots.length:', importedHotspots.length);\n    console.log('showImportedHotspots:', showImportedHotspots);\n    \n    if (!richMenuForm.name.trim()) {\n      console.log('Error: No rich menu name');\n      setError('Please enter a rich menu name');\n      return;\n    }\n\n    if (richMenuForm.chatBarText.length > 14) {\n      console.log('Error: Chat Bar Text too long');\n      setError('Chat Bar Text must not exceed 14 characters (LINE API limit)');\n      return;\n    }\n\n    const totalHotspots = hotspots.length + (showImportedHotspots ? importedHotspots.length : 0);\n    console.log('totalHotspots:', totalHotspots);\n    \n    if (totalHotspots === 0) {\n      console.log('Error: No hotspots');\n      setError('Please draw at least one hotspot or import hotspots from JSON');\n      return;\n    }\n\n    try {\n      console.log('Setting creating to true');\n      setCreating(true);\n      setError(null);\n\n      const buttons = convertHotspotsToButtons();\n      console.log('Converted buttons:', buttons);\n      \n      // Use the selected rich menu size\n      const selectedSize = LINE_RICH_MENU_SIZES[selectedRichMenuSize];\n      const richMenuData = generateRichMenuJSON(richMenuForm.name, buttons, { width: selectedSize.width, height: selectedSize.height });\n      console.log('Generated rich menu data:', richMenuData);\n      \n      // Validate rich menu size against LINE standards\n      const richMenuSize = { width: richMenuData.size.width, height: richMenuData.size.height };\n      const isValidSize = Object.values(LINE_RICH_MENU_SIZES).some(standardSize => \n        standardSize.width === richMenuSize.width && standardSize.height === richMenuSize.height\n      );\n      \n      if (!isValidSize) {\n        const allowedSizes = Object.values(LINE_RICH_MENU_SIZES).map(size => `${size.width} x ${size.height}`).join(' or ');\n        setError(` Invalid rich menu size! Only LINE standard sizes are allowed: ${allowedSizes}`);\n        return;\n      }\n      \n      // Validate all richMenuAliasId values in the rich menu\n      if (richMenuData.areas) {\n        for (let i = 0; i < richMenuData.areas.length; i++) {\n          const area = richMenuData.areas[i];\n          if (area.action && area.action.type === 'richmenuswitch' && area.action.richMenuAliasId) {\n            if (!validateRichMenuAliasId(area.action.richMenuAliasId)) {\n              setError(` Invalid rich menu alias ID in area ${i + 1}: \"${area.action.richMenuAliasId}\". Only alphanumeric characters and hyphens are allowed (1-40 characters).`);\n              return;\n            }\n          }\n        }\n      }\n      \n      // Step 1: Validate rich menu object before creation\n      console.log('Validating rich menu...');\n      try {\n        const validationResponse = await validateRichMenu(richMenuData);\n        console.log('Validation response:', validationResponse);\n        \n        if (!validationResponse.data.success) {\n          console.log('Validation failed:', validationResponse.data.message);\n          setError(`Validation failed: ${validationResponse.data.message || 'Unknown validation error'}`);\n          return;\n        }\n      } catch (validationErr: any) {\n        console.log('Validation error:', validationErr);\n        const errorMessage = validationErr.response?.data?.detail?.error?.message || \n                           validationErr.response?.data?.detail || \n                           'Validation failed';\n        setError(`Validation failed: ${errorMessage}`);\n        return;\n      }\n      \n      // Step 2: Create rich menu after successful validation\n      console.log('Creating rich menu...');\n      const response = await createRichMenu(richMenuData);\n      console.log('Create response:', response);\n      \n      if (response.data.success) {\n        const richMenuId = response.data.rich_menu_id;\n        const aliasesCreated = response.data.aliases_created || [];\n        const aliasesSkipped = response.data.aliases_skipped || [];\n        const aliasesFailed = response.data.aliases_failed || [];\n        const aliasesLinked = response.data.aliases_linked || [];\n        \n        console.log('Rich menu created successfully:', richMenuId);\n        console.log('Aliases created:', aliasesCreated);\n        console.log('Aliases skipped:', aliasesSkipped);\n        console.log('Aliases failed:', aliasesFailed);\n        console.log('Aliases linked:', aliasesLinked);\n        \n        // Step 3: Upload the background image if available\n        console.log('backgroundImageFile:', backgroundImageFile);\n        console.log('backgroundImageFile type:', backgroundImageFile?.type);\n        console.log('backgroundImageFile size:', backgroundImageFile?.size);\n        \n        let successMessage = `Rich menu \"${richMenuForm.name}\" created successfully! ID: ${richMenuId}`;\n        \n        // Add alias information to success message\n        if (aliasesCreated.length > 0) {\n          successMessage += `\\n\\n Auto-created ${aliasesCreated.length} aliases: ${aliasesCreated.join(', ')}`;\n        }\n        \n        if (aliasesLinked.length > 0) {\n          successMessage += `\\n\\n Auto-linked ${aliasesLinked.length} existing aliases: ${aliasesLinked.join(', ')}`;\n        }\n        \n        if (aliasesSkipped.length > 0) {\n          successMessage += `\\n\\n Skipped ${aliasesSkipped.length} aliases: ${aliasesSkipped.join(', ')}`;\n        }\n        \n        if (aliasesFailed.length > 0) {\n          successMessage += `\\n\\n Failed to create ${aliasesFailed.length} aliases: ${aliasesFailed.join(', ')}`;\n        }\n        \n        if (backgroundImageFile) {\n          console.log('Uploading background image...');\n          try {\n            const uploadResponse = await uploadRichMenuImage(richMenuId, backgroundImageFile);\n            if (uploadResponse.data.success) {\n              console.log('Image uploaded successfully');\n              setSuccess(`${successMessage}\\n\\n Image uploaded successfully!`);\n            } else {\n              console.log('Image upload failed');\n              setSuccess(`${successMessage}\\n\\n Image upload failed`);\n            }\n          } catch (uploadErr: any) {\n            console.log('Image upload error:', uploadErr);\n            setSuccess(`${successMessage}\\n\\n Image upload failed: ${uploadErr.response?.data?.detail || 'Unknown error'}`);\n          }\n        } else {\n          console.log('No background image to upload');\n          setSuccess(successMessage);\n        }\n        \n        setCreateDialogOpen(false);\n        resetCreateForm();\n        setHotspots([]);\n        setImportedHotspots([]);\n        setShowImportedHotspots(false);\n        setBackgroundImageUrl('');\n        setBackgroundImageFile(null);\n        loadRichMenus(); // Refresh the list\n        loadRichMenuAliases(); // Refresh aliases\n      } else {\n        console.log('Failed to create rich menu');\n        setError('Failed to create rich menu');\n      }\n    } catch (err: any) {\n      console.log('Error in handleCanvasCreate:', err);\n      setError(err.response?.data?.detail || 'Failed to create rich menu');\n    } finally {\n      console.log('Setting creating to false');\n      setCreating(false);\n    }\n  };\n\n  const handleFileSelect = (event: React.ChangeEvent<HTMLInputElement>) => {\n    const file = event.target.files?.[0];\n    if (file) {\n      setSelectedFile(file);\n    }\n  };\n\n\n\n  const openAssignDialog = (richMenu: RichMenu) => {\n    setSelectedRichMenu(richMenu);\n    setAssignDialogOpen(true);\n  };\n\n  const openUploadDialog = (richMenu: RichMenu) => {\n    setSelectedRichMenuForUpload(richMenu);\n    setUploadDialogOpen(true);\n  };\n\n  const formatDate = (dateString: string) => {\n    return new Date(dateString).toLocaleString();\n  };\n\n\n\n  if (loading && richMenus.length === 0) {\n    return (\n      <Box sx={{ display: 'flex', justifyContent: 'center', alignItems: 'center', height: '200px' }}>\n        <CircularProgress />\n      </Box>\n    );\n  }\n\n  return (\n    <Box sx={{ \n      p: { xs: 2, md: 4 }, \n      minHeight: '100vh',\n      background: 'linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%)'\n    }}>\n      {/* Header Section */}\n      <Box sx={{ \n        mb: 4, \n        display: 'flex', \n        alignItems: 'center', \n        gap: 3,\n        background: 'white',\n        p: 3,\n        borderRadius: 3,\n        boxShadow: '0 4px 12px rgba(0,0,0,0.08)',\n        border: '1px solid rgba(0,0,0,0.05)'\n      }}>\n        <Box sx={{ \n          display: 'flex', \n          alignItems: 'center', \n          gap: 2,\n          flex: 1\n        }}>\n          <Box sx={{ \n            bgcolor: 'primary.main', \n            width: 56, \n            height: 56,\n            borderRadius: 2,\n            display: 'flex',\n            alignItems: 'center',\n            justifyContent: 'center',\n            boxShadow: '0 4px 16px rgba(25, 118, 210, 0.3)'\n          }}>\n            <Group sx={{ fontSize: 28, color: 'white' }} />\n          </Box>\n          <Box>\n            <Typography variant=\"h4\" sx={{ \n              fontWeight: 700, \n              mb: 1,\n              background: 'linear-gradient(135deg, #1e293b 0%, #334155 100%)',\n              backgroundClip: 'text',\n              WebkitBackgroundClip: 'text',\n              WebkitTextFillColor: 'transparent'\n            }}>\n              Rich Menu Management\n            </Typography>\n            <Typography variant=\"body1\" color=\"text.secondary\" sx={{ fontSize: '1.1rem' }}>\n              Manage LINE Rich Menus and navigation\n            </Typography>\n          </Box>\n        </Box>\n        <Box sx={{ display: 'flex', gap: 2 }}>\n          <Button\n            variant=\"outlined\"\n            startIcon={<Refresh />}\n            onClick={loadRichMenus}\n            disabled={loading}\n          >\n            {loading ? 'Loading...' : 'Refresh'}\n          </Button>\n          <Button\n            variant=\"contained\"\n            startIcon={<Add />}\n            onClick={() => setCreateDialogOpen(true)}\n            disabled={loading}\n          >\n            Create Rich Menu\n          </Button>\n        </Box>\n      </Box>\n\n      {error && (\n        <Alert severity=\"error\" sx={{ mb: 3 }}>\n          {error}\n        </Alert>\n      )}\n\n      {success && (\n        <Alert severity=\"success\" sx={{ mb: 3 }}>\n          {success}\n        </Alert>\n      )}\n\n      <Grid container spacing={3}>\n        {/* Rich Menus Table */}\n        <Grid item xs={12}>\n          <Card sx={{ \n            background: 'white',\n            borderRadius: 3,\n            boxShadow: '0 4px 12px rgba(0,0,0,0.08)',\n            border: '1px solid rgba(0,0,0,0.05)'\n          }}>\n            <CardContent sx={{ p: 3 }}>\n              <Typography variant=\"h6\" sx={{ mb: 2, fontWeight: 600 }}>\n                Rich Menus Table ({richMenus.length})\n              </Typography>\n              \n              {richMenus.length === 0 ? (\n                <Alert severity=\"info\">\n                  No rich menus found. Create rich menus in LINE Developers Console first.\n                </Alert>\n              ) : (\n                <Box sx={{ overflowX: 'auto' }}>\n                  <TableContainer component={Paper} sx={{ maxHeight: 400 }}>\n                    <Table stickyHeader size=\"small\">\n                      <TableHead>\n                        <TableRow>\n                          <TableCell sx={{ fontWeight: 600 }}>Rich Menu ID</TableCell>\n                          <TableCell sx={{ fontWeight: 600 }}>Name</TableCell>\n                          <TableCell sx={{ fontWeight: 600 }}>Chat Bar Text</TableCell>\n                          <TableCell sx={{ fontWeight: 600 }}>Size</TableCell>\n                          <TableCell sx={{ fontWeight: 600 }}>Areas</TableCell>\n                          <TableCell sx={{ fontWeight: 600 }}>Image</TableCell>\n                          <TableCell sx={{ fontWeight: 600 }}>Default</TableCell>\n                          <TableCell sx={{ fontWeight: 600 }}>Created</TableCell>\n                          <TableCell sx={{ fontWeight: 600 }}>Actions</TableCell>\n                        </TableRow>\n                      </TableHead>\n                      <TableBody>\n                        {richMenus.map((richMenu) => (\n                          <TableRow key={richMenu.richMenuId} hover>\n                            <TableCell sx={{ fontFamily: 'monospace', fontSize: '0.75rem' }}>\n                              {richMenu.richMenuId}\n                            </TableCell>\n                            <TableCell>\n                              <Box sx={{ display: 'flex', alignItems: 'center', gap: 1 }}>\n                                <Typography variant=\"body2\" sx={{ fontWeight: 600 }}>\n                                  {richMenu.name}\n                                </Typography>\n                                {richMenu.isDefault && (\n                                  <Star sx={{ fontSize: '1rem', color: 'primary.main' }} />\n                                )}\n                                {richMenu.source === \"database_only\" && (\n                                  <Chip \n                                    label=\"DB Only\" \n                                    size=\"small\" \n                                    color=\"warning\" \n                                    variant=\"outlined\"\n                                    sx={{ fontSize: '0.6rem' }}\n                                  />\n                                )}\n                              </Box>\n                            </TableCell>\n                            <TableCell>\n                              <Typography variant=\"body2\" color=\"text.secondary\">\n                                \"{richMenu.chatBarText}\"\n                              </Typography>\n                            </TableCell>\n                            <TableCell>\n                              <Typography variant=\"body2\">\n                                {richMenu.size.width}{richMenu.size.height}\n                              </Typography>\n                            </TableCell>\n                            <TableCell>\n                              <Chip \n                                label={richMenu.areas.length} \n                                size=\"small\" \n                                variant=\"outlined\"\n                              />\n                            </TableCell>\n                            <TableCell>\n                              <Chip \n                                label={richMenu.hasImage ? \"Yes\" : \"No\"} \n                                size=\"small\" \n                                color={richMenu.hasImage ? \"success\" : \"error\"}\n                                variant=\"outlined\"\n                              />\n                            </TableCell>\n                            <TableCell>\n                              {richMenu.isDefault ? (\n                                <Chip \n                                  label=\"Default\" \n                                  size=\"small\" \n                                  color=\"primary\"\n                                  variant=\"filled\"\n                                  icon={<Star />}\n                                />\n                              ) : (\n                                <Button\n                                  variant=\"outlined\"\n                                  size=\"small\"\n                                  startIcon={<StarBorder />}\n                                  onClick={() => handleSetDefault(richMenu.richMenuId)}\n                                  disabled={!richMenu.hasImage}\n                                  color=\"warning\"\n                                  sx={{ minWidth: '100px', fontSize: '0.7rem' }}\n                                >\n                                  Set Default\n                                </Button>\n                              )}\n                              {!richMenu.hasImage && !richMenu.isDefault && (\n                                <Typography variant=\"caption\" display=\"block\" color=\"error.main\" sx={{ mt: 0.5 }}>\n                                  Upload image first\n                                </Typography>\n                              )}\n                            </TableCell>\n                            <TableCell>\n                              <Typography variant=\"caption\" display=\"block\">\n                                {formatDate(richMenu.createdAt)}\n                              </Typography>\n                              {richMenu.db_created_at && (\n                                <Typography variant=\"caption\" display=\"block\" color=\"text.secondary\">\n                                  DB: {formatDate(richMenu.db_created_at)}\n                                </Typography>\n                              )}\n                            </TableCell>\n                            <TableCell>\n                              <Box sx={{ display: 'flex', gap: 0.5, flexDirection: 'column' }}>\n                                <Button\n                                  variant=\"outlined\"\n                                  size=\"small\"\n                                  startIcon={<CloudUpload />}\n                                  onClick={() => openUploadDialog(richMenu)}\n                                  disabled={loading}\n                                  sx={{ minWidth: '80px', fontSize: '0.7rem' }}\n                                >\n                                  {richMenu.hasImage ? \"Change\" : \"Upload\"}\n                                </Button>\n                                <Button\n                                  variant=\"outlined\"\n                                  size=\"small\"\n                                  startIcon={<Person />}\n                                  onClick={() => openAssignDialog(richMenu)}\n                                  disabled={loading}\n                                  sx={{ minWidth: '80px', fontSize: '0.7rem' }}\n                                >\n                                  Assign\n                                </Button>\n                                <Button\n                                  variant=\"outlined\"\n                                  size=\"small\"\n                                  startIcon={<Delete />}\n                                  onClick={() => handleDeleteRichMenu(richMenu)}\n                                  disabled={loading}\n                                  color=\"error\"\n                                  sx={{ minWidth: '80px', fontSize: '0.7rem' }}\n                                >\n                                  Delete\n                                </Button>\n                              </Box>\n                            </TableCell>\n                          </TableRow>\n                        ))}\n                      </TableBody>\n                    </Table>\n                  </TableContainer>\n                </Box>\n              )}\n            </CardContent>\n          </Card>\n        </Grid>\n\n        {/* Rich Menus Detailed List */}\n        <Grid item xs={12}>\n          <Card>\n            <CardContent>\n              <Typography variant=\"h6\" sx={{ mb: 2, fontWeight: 600 }}>\n                Rich Menus Details ({richMenus.length})\n              </Typography>\n              \n              {richMenus.length === 0 ? (\n                <Alert severity=\"info\">\n                  No rich menus found. Create rich menus in LINE Developers Console first.\n                </Alert>\n              ) : (\n                <List>\n                  {richMenus.map((richMenu, index) => (\n                    <React.Fragment key={richMenu.richMenuId}>\n                      <ListItem>\n                        <ListItemText\n                          primary={\n                            <Box sx={{ display: 'flex', alignItems: 'center', gap: 1, mb: 1 }}>\n                              <Typography variant=\"h6\" sx={{ fontWeight: 600, color: 'primary.main' }}>\n                                {richMenu.name}\n                              </Typography>\n                              {richMenu.isDefault && (\n                                <Chip \n                                  icon={<Star />} \n                                  label=\"Default\" \n                                  color=\"primary\" \n                                  size=\"small\" \n                                />\n                              )}\n                            </Box>\n                          }\n                          secondary={\n                            <Box>\n                              {/* Rich Menu ID */}\n                              <Box sx={{ mb: 2, p: 1, bgcolor: 'grey.50', borderRadius: 1 }}>\n                                <Typography variant=\"body2\" sx={{ fontWeight: 600, color: 'text.primary' }}>\n                                  Rich Menu ID:\n                                </Typography>\n                                <Typography variant=\"body2\" sx={{ fontFamily: 'monospace', fontSize: '0.8rem' }}>\n                                  {richMenu.richMenuId}\n                                </Typography>\n                              </Box>\n\n                              {/* Basic Info */}\n                              <Grid container spacing={2} sx={{ mb: 2 }}>\n                                <Grid item xs={12} md={6}>\n                                  <Typography variant=\"body2\" sx={{ fontWeight: 600 }}>\n                                    Chat Bar Text:\n                                  </Typography>\n                                  <Typography variant=\"body2\" color=\"text.secondary\">\n                                    \"{richMenu.chatBarText}\"\n                                  </Typography>\n                                </Grid>\n                                <Grid item xs={12} md={6}>\n                                  <Typography variant=\"body2\" sx={{ fontWeight: 600 }}>\n                                    Size:\n                                  </Typography>\n                                  <Typography variant=\"body2\" color=\"text.secondary\">\n                                    {richMenu.size.width}  {richMenu.size.height} pixels\n                                  </Typography>\n                                </Grid>\n                                <Grid item xs={12} md={6}>\n                                  <Typography variant=\"body2\" sx={{ fontWeight: 600 }}>\n                                    Tap Areas:\n                                  </Typography>\n                                  <Typography variant=\"body2\" color=\"text.secondary\">\n                                    {richMenu.areas.length} areas configured\n                                  </Typography>\n                                </Grid>\n                                <Grid item xs={12} md={6}>\n                                  <Typography variant=\"body2\" sx={{ fontWeight: 600 }}>\n                                    Status:\n                                  </Typography>\n                                  <Box sx={{ display: 'flex', gap: 1, alignItems: 'center' }}>\n                                    <Chip \n                                      label={richMenu.isDefault ? \"Default\" : \"Set as Default\"} \n                                      size=\"small\" \n                                      color={richMenu.isDefault ? \"primary\" : \"warning\"}\n                                      variant={richMenu.isDefault ? \"filled\" : \"outlined\"}\n                                      onClick={richMenu.isDefault ? undefined : () => handleSetDefault(richMenu.richMenuId)}\n                                      sx={richMenu.isDefault ? {} : { cursor: 'pointer' }}\n                                      disabled={!richMenu.hasImage}\n                                    />\n                                    {!richMenu.hasImage && (\n                                      <Chip \n                                        label=\"No Image\" \n                                        size=\"small\" \n                                        color=\"error\" \n                                        variant=\"outlined\"\n                                      />\n                                    )}\n                                  </Box>\n                                </Grid>\n                              </Grid>\n\n                              {/* Timestamps */}\n                              <Box sx={{ mb: 2, p: 1, bgcolor: 'grey.50', borderRadius: 1 }}>\n                                <Typography variant=\"body2\" sx={{ fontWeight: 600, mb: 1 }}>\n                                  Timestamps:\n                                </Typography>\n                                <Grid container spacing={1}>\n                                  <Grid item xs={12} md={6}>\n                                    <Typography variant=\"caption\" sx={{ fontWeight: 600 }}>\n                                      LINE Created:\n                                    </Typography>\n                                    <Typography variant=\"caption\" display=\"block\" color=\"text.secondary\">\n                                      {formatDate(richMenu.createdAt)}\n                                    </Typography>\n                                  </Grid>\n                                  {richMenu.db_created_at && (\n                                    <Grid item xs={12} md={6}>\n                                      <Typography variant=\"caption\" sx={{ fontWeight: 600 }}>\n                                        DB Created:\n                                      </Typography>\n                                      <Typography variant=\"caption\" display=\"block\" color=\"text.secondary\">\n                                        {formatDate(richMenu.db_created_at)} by {richMenu.db_created_by || 'Unknown'}\n                                      </Typography>\n                                    </Grid>\n                                  )}\n                                  {richMenu.db_updated_at && (\n                                    <Grid item xs={12} md={6}>\n                                      <Typography variant=\"caption\" sx={{ fontWeight: 600 }}>\n                                        Last Updated:\n                                      </Typography>\n                                      <Typography variant=\"caption\" display=\"block\" color=\"text.secondary\">\n                                        {formatDate(richMenu.db_updated_at)}\n                                      </Typography>\n                                    </Grid>\n                                  )}\n                                </Grid>\n                              </Box>\n\n                              {/* JSON Body */}\n                              <Box sx={{ mb: 2 }}>\n                                <Accordion sx={{ boxShadow: 'none' }}>\n                                  <AccordionSummary expandIcon={<ExpandMore />}>\n                                    <Typography variant=\"body2\" sx={{ fontWeight: 600 }}>\n                                      JSON Body (LINE API Structure)\n                                    </Typography>\n                                  </AccordionSummary>\n                                  <AccordionDetails>\n                                    <Box sx={{ p: 1, bgcolor: 'grey.50', borderRadius: 1 }}>\n                                      <pre style={{ \n                                        fontSize: '0.75rem', \n                                        overflow: 'auto', \n                                        margin: 0,\n                                        fontFamily: 'monospace',\n                                        whiteSpace: 'pre-wrap',\n                                        wordBreak: 'break-word'\n                                      }}>\n{JSON.stringify({\n  size: richMenu.size,\n  selected: richMenu.selected,\n  name: richMenu.name,\n  chatBarText: richMenu.chatBarText,\n  areas: richMenu.areas\n}, null, 2)}\n                                      </pre>\n                                    </Box>\n                                  </AccordionDetails>\n                                </Accordion>\n                              </Box>\n\n                              {/* User Assignment */}\n                              <Box sx={{ mb: 2, p: 1, bgcolor: 'blue.50', borderRadius: 1 }}>\n                                <Typography variant=\"body2\" sx={{ fontWeight: 600, mb: 1, color: 'primary.main' }}>\n                                  User Assignment:\n                                </Typography>\n                                <Typography variant=\"body2\" color=\"text.secondary\" sx={{ mb: 1 }}>\n                                  This rich menu can be assigned to specific users or set as default for all users.\n                                </Typography>\n                                <Box sx={{ display: 'flex', gap: 1, flexWrap: 'wrap' }}>\n                                  <Chip \n                                    label=\"Assign to User\" \n                                    size=\"small\" \n                                    color=\"info\" \n                                    variant=\"outlined\"\n                                    onClick={() => openAssignDialog(richMenu)}\n                                    sx={{ cursor: 'pointer' }}\n                                  />\n                                  {richMenu.isDefault ? (\n                                    <Chip \n                                      label=\"Default\" \n                                      size=\"small\" \n                                      color=\"primary\"\n                                      variant=\"filled\"\n                                      icon={<Star />}\n                                    />\n                                  ) : (\n                                    <Button\n                                      variant=\"outlined\"\n                                      size=\"small\"\n                                      startIcon={<StarBorder />}\n                                      onClick={() => handleSetDefault(richMenu.richMenuId)}\n                                      disabled={!richMenu.hasImage}\n                                      color=\"warning\"\n                                      sx={{ minWidth: '120px', fontSize: '0.8rem' }}\n                                    >\n                                      Set as Default\n                                    </Button>\n                                  )}\n                                </Box>\n                              </Box>\n                              \n                              {/* Areas Details */}\n                              <Accordion sx={{ mt: 1, boxShadow: 'none' }}>\n                                <AccordionSummary expandIcon={<ExpandMore />}>\n                                  <Typography variant=\"caption\">\n                                    View {richMenu.areas.length} tap areas\n                                  </Typography>\n                                </AccordionSummary>\n                                <AccordionDetails>\n                                  <Grid container spacing={1}>\n                                    {richMenu.areas.map((area, areaIndex) => (\n                                      <Grid item xs={12} md={6} key={areaIndex}>\n                                        <Box sx={{ p: 1, border: 1, borderColor: 'divider', borderRadius: 1 }}>\n                                          <Typography variant=\"caption\" sx={{ fontWeight: 600 }}>\n                                            Area {areaIndex + 1}\n                                          </Typography>\n                                          <Typography variant=\"caption\" display=\"block\">\n                                            Position: ({area.bounds.x}, {area.bounds.y}) \n                                            Size: {area.bounds.width}{area.bounds.height}\n                                          </Typography>\n                                          <Typography variant=\"caption\" display=\"block\">\n                                            Action: {area.action.type} - {area.action.label}\n                                          </Typography>\n                                          {area.action.uri && (\n                                            <Typography variant=\"caption\" display=\"block\" sx={{ wordBreak: 'break-all' }}>\n                                              URI: {area.action.uri}\n                                            </Typography>\n                                          )}\n                                        </Box>\n                                      </Grid>\n                                    ))}\n                                  </Grid>\n                                </AccordionDetails>\n                              </Accordion>\n                            </Box>\n                          }\n                        />\n                        <ListItemSecondaryAction>\n                          <Box sx={{ display: 'flex', flexDirection: 'column', gap: 1, alignItems: 'flex-end' }}>\n                            {/* Image Status */}\n                            <Box sx={{ textAlign: 'right' }}>\n                              <Typography variant=\"caption\" sx={{ fontWeight: 600, display: 'block' }}>\n                                Image Status:\n                              </Typography>\n                              <Chip \n                                label={richMenu.hasImage ? \"Image Uploaded\" : \"No Image\"} \n                                size=\"small\" \n                                color={richMenu.hasImage ? \"success\" : \"error\"}\n                                variant=\"outlined\"\n                              />\n                            </Box>\n                            \n                            {/* Action Buttons */}\n                            <Box sx={{ display: 'flex', gap: 1, flexDirection: 'column' }}>\n                              <Button\n                                variant=\"outlined\"\n                                size=\"small\"\n                                startIcon={<Visibility />}\n                                onClick={() => handleOpenDetailsDialog(richMenu)}\n                                disabled={loading}\n                                sx={{ minWidth: '120px' }}\n                              >\n                                View Details\n                              </Button>\n                              <Button\n                                variant=\"outlined\"\n                                size=\"small\"\n                                startIcon={<CloudUpload />}\n                                onClick={() => openUploadDialog(richMenu)}\n                                disabled={loading}\n                                sx={{ minWidth: '120px' }}\n                              >\n                                {richMenu.hasImage ? \"Change Image\" : \"Upload Image\"}\n                              </Button>\n                              <Button\n                                variant=\"outlined\"\n                                size=\"small\"\n                                startIcon={<Person />}\n                                onClick={() => openAssignDialog(richMenu)}\n                                disabled={loading}\n                                sx={{ minWidth: '120px' }}\n                              >\n                                Assign to User\n                              </Button>\n                              <Button\n                                variant=\"outlined\"\n                                size=\"small\"\n                                startIcon={<Link />}\n                                onClick={() => handleCreateAlias(richMenu.richMenuId)}\n                                disabled={loading}\n                                sx={{ minWidth: '120px' }}\n                                color=\"info\"\n                              >\n                                Create Aliases\n                              </Button>\n                            </Box>\n                          </Box>\n                        </ListItemSecondaryAction>\n                      </ListItem>\n                      {index < richMenus.length - 1 && <Divider />}\n                    </React.Fragment>\n                  ))}\n                </List>\n              )}\n            </CardContent>\n          </Card>\n        </Grid>\n\n        {/* Quick Actions */}\n        <Grid item xs={12}>\n          <Card>\n            <CardContent>\n              <Typography variant=\"h6\" sx={{ mb: 2, fontWeight: 600 }}>\n                Quick Actions\n              </Typography>\n              \n              <Grid container spacing={2}>\n                <Grid item xs={12} md={6}>\n                  <TextField\n                    fullWidth\n                    label=\"User ID to Unlink\"\n                    placeholder=\"Enter LINE User ID\"\n                    helperText=\"Remove custom rich menu assignment (user will see default)\"\n                  />\n                  <Button\n                    variant=\"outlined\"\n                    startIcon={<LinkOff />}\n                    sx={{ mt: 1 }}\n                    disabled={loading}\n                  >\n                    Unlink from User\n                  </Button>\n                </Grid>\n                \n                <Grid item xs={12} md={6}>\n                  <Alert severity=\"info\">\n                    <Typography variant=\"body2\">\n                      <strong>Rich Menu Management Tips:</strong>\n                      <br />\n                       Create rich menus in LINE Developers Console\n                      <br />\n                       Default rich menu is shown to all users\n                      <br />\n                       Per-user rich menus override the default\n                      <br />\n                       Rich menus can have up to 20 tap areas\n                    </Typography>\n                  </Alert>\n                </Grid>\n              </Grid>\n            </CardContent>\n          </Card>\n        </Grid>\n\n        {/* Rich Menu Aliases Management */}\n        <Grid item xs={12}>\n          <Card>\n            <CardContent>\n              <Typography variant=\"h6\" sx={{ mb: 2, fontWeight: 600 }}>\n                Rich Menu Aliases ({richMenuAliases.length})\n              </Typography>\n              \n              <Alert severity=\"info\" sx={{ mb: 2 }}>\n                <Typography variant=\"body2\">\n                  <strong>Rich Menu Aliases:</strong> These aliases enable switching between rich menus using the \"richmenuswitch\" action type. \n                  When you create a rich menu with \"richmenuswitch\" actions, you need to create corresponding aliases for the target rich menus.\n                </Typography>\n              </Alert>\n              \n              <Box sx={{ mb: 2, display: 'flex', gap: 2, alignItems: 'center' }}>\n                <Typography variant=\"body2\" sx={{ fontWeight: 600 }}>\n                  Badge Legend:\n                </Typography>\n                <Chip\n                  label=\"LINE\"\n                  color=\"primary\"\n                  size=\"small\"\n                  variant=\"filled\"\n                  sx={{ fontSize: '0.7rem', height: 24 }}\n                />\n                <Typography variant=\"body2\" color=\"text.secondary\">\n                  Exists in LINE API\n                </Typography>\n                <Chip\n                  label=\"Local\"\n                  color=\"secondary\"\n                  size=\"small\"\n                  variant=\"filled\"\n                  sx={{ fontSize: '0.7rem', height: 24 }}\n                />\n                <Typography variant=\"body2\" color=\"text.secondary\">\n                  Stored in database\n                </Typography>\n              </Box>\n\n              <Box sx={{ mb: 2, display: 'flex', gap: 1, flexWrap: 'wrap' }}>\n                <Button\n                  variant=\"contained\"\n                  color=\"primary\"\n                  startIcon={<Refresh />}\n                  onClick={handleFetchAndLinkAliases}\n                  sx={{ minWidth: 200 }}\n                >\n                  Sync from LINE API\n                </Button>\n                <Button\n                  variant=\"contained\"\n                  color=\"secondary\"\n                  startIcon={<Add />}\n                  onClick={handleOpenCreateAliasDialog}\n                  sx={{ minWidth: 200 }}\n                >\n                  Create Alias\n                </Button>\n                <Button\n                  variant=\"outlined\"\n                  color=\"warning\"\n                  startIcon={<Delete />}\n                  onClick={handleCleanupAliases}\n                  sx={{ minWidth: 200 }}\n                >\n                  Cleanup Duplicates\n                </Button>\n                <Typography variant=\"body2\" color=\"text.secondary\" sx={{ alignSelf: 'center', ml: 1 }}>\n                  Sync from LINE API, create new aliases, or cleanup duplicates\n                </Typography>\n              </Box>\n\n              {richMenuAliases.length === 0 ? (\n                <Alert severity=\"warning\">\n                  No rich menu aliases found. Aliases are automatically created when you use \"Create Aliases\" action on rich menus with \"richmenuswitch\" actions.\n                </Alert>\n              ) : (\n                <TableContainer component={Paper} sx={{ maxHeight: 400 }}>\n                  <Table stickyHeader>\n                    <TableHead>\n                      <TableRow>\n                        <TableCell sx={{ fontWeight: 600 }}>Alias ID</TableCell>\n                        <TableCell sx={{ fontWeight: 600 }}>Rich Menu ID</TableCell>\n                        <TableCell sx={{ fontWeight: 600 }}>Name</TableCell>\n                        <TableCell sx={{ fontWeight: 600 }}>Status</TableCell>\n                        <TableCell sx={{ fontWeight: 600 }}>Created</TableCell>\n                        <TableCell sx={{ fontWeight: 600 }}>Actions</TableCell>\n                      </TableRow>\n                    </TableHead>\n                    <TableBody>\n                      {richMenuAliases.map((alias) => (\n                        <TableRow key={alias.richMenuAliasId}>\n                          <TableCell>\n                            <Box sx={{ display: 'flex', alignItems: 'center', gap: 1 }}>\n                              <Typography variant=\"body2\" sx={{ fontFamily: 'monospace', fontSize: '0.8rem' }}>\n                                {alias.richMenuAliasId}\n                              </Typography>\n                              <Box sx={{ display: 'flex', gap: 0.5 }}>\n                                {alias.status === 'linked' && (\n                                  <Chip\n                                    label=\"LINE\"\n                                    color=\"primary\"\n                                    size=\"small\"\n                                    variant=\"filled\"\n                                    sx={{ fontSize: '0.6rem', height: 20 }}\n                                  />\n                                )}\n                                <Chip\n                                  label=\"Local\"\n                                  color=\"secondary\"\n                                  size=\"small\"\n                                  variant=\"filled\"\n                                  sx={{ fontSize: '0.6rem', height: 20 }}\n                                />\n                              </Box>\n                            </Box>\n                          </TableCell>\n                          <TableCell>\n                            <Typography variant=\"body2\" sx={{ fontFamily: 'monospace', fontSize: '0.8rem' }}>\n                              {alias.richMenuId || 'Not linked'}\n                            </Typography>\n                          </TableCell>\n                          <TableCell>{alias.name}</TableCell>\n                          <TableCell>\n                            <Chip\n                              label={alias.status || 'linked'}\n                              color={alias.status === 'unlinked' ? 'warning' : 'success'}\n                              size=\"small\"\n                              variant=\"outlined\"\n                            />\n                          </TableCell>\n                          <TableCell>{formatDate(alias.created_at)}</TableCell>\n                          <TableCell>\n                            <Box sx={{ display: 'flex', gap: 1 }}>\n                              <Button\n                                variant=\"outlined\"\n                                size=\"small\"\n                                color=\"primary\"\n                                startIcon={<Edit />}\n                                onClick={() => handleOpenUpdateAliasDialog(alias)}\n                              >\n                                Update\n                              </Button>\n                              <Button\n                                variant=\"outlined\"\n                                size=\"small\"\n                                color=\"error\"\n                                startIcon={<Delete />}\n                                onClick={() => handleDeleteAlias(alias.richMenuAliasId)}\n                              >\n                                Delete\n                              </Button>\n                            </Box>\n                          </TableCell>\n                        </TableRow>\n                      ))}\n                    </TableBody>\n                  </Table>\n                </TableContainer>\n              )}\n            </CardContent>\n          </Card>\n        </Grid>\n      </Grid>\n\n            {/* Rich Menu Details Dialog */}\n      <Dialog \n        open={detailsDialogOpen} \n        onClose={() => setDetailsDialogOpen(false)} \n        maxWidth=\"xl\" \n        fullWidth\n        PaperProps={{\n          sx: {\n            borderRadius: 2,\n            maxHeight: '95vh',\n            background: '#fafafa'\n          }\n        }}\n      >\n        {/* Header */}\n        <Box sx={{ \n          background: '#1976d2', \n          color: 'white',\n          p: 3,\n          borderTopLeftRadius: 8,\n          borderTopRightRadius: 8\n        }}>\n          <Box sx={{ display: 'flex', alignItems: 'center', justifyContent: 'space-between', mb: 2 }}>\n            <Box sx={{ display: 'flex', alignItems: 'center' }}>\n              <Image sx={{ mr: 2, fontSize: 28 }} />\n              <Box>\n                <Typography variant=\"h4\" sx={{ fontWeight: 700, mb: 0.5 }}>\n                  Rich Menu Details\n                </Typography>\n                {selectedRichMenuForDetails && (\n                  <Typography variant=\"subtitle1\" sx={{ opacity: 0.9, fontWeight: 400 }}>\n                    {selectedRichMenuForDetails.name}\n                  </Typography>\n                )}\n              </Box>\n            </Box>\n            <IconButton \n              onClick={() => setDetailsDialogOpen(false)}\n              sx={{ \n                color: 'white',\n                border: '2px solid rgba(255,255,255,0.3)',\n                '&:hover': {\n                  borderColor: 'white',\n                  background: 'rgba(255,255,255,0.1)'\n                }\n              }}\n            >\n              <Close />\n            </IconButton>\n          </Box>\n          \n          {/* Quick Stats */}\n          <Grid container spacing={2}>\n            <Grid item xs={12} sm={4}>\n              <Box sx={{ \n                background: 'rgba(255,255,255,0.1)', \n                p: 2, \n                borderRadius: 2,\n                textAlign: 'center'\n              }}>\n                <Typography variant=\"h6\" sx={{ fontWeight: 600, mb: 1 }}>\n                  Rich Menu ID\n                </Typography>\n                <Typography variant=\"body2\" sx={{ \n                  fontFamily: 'monospace', \n                  fontSize: '0.75rem',\n                  wordBreak: 'break-all',\n                  opacity: 0.9\n                }}>\n                  {richMenuDetails?.rich_menu?.richMenuId || 'Loading...'}\n                </Typography>\n              </Box>\n            </Grid>\n            <Grid item xs={12} sm={4}>\n              <Box sx={{ \n                background: 'rgba(255,255,255,0.1)', \n                p: 2, \n                borderRadius: 2,\n                textAlign: 'center'\n              }}>\n                <Typography variant=\"h6\" sx={{ fontWeight: 600, mb: 1 }}>\n                  Size\n                </Typography>\n                <Typography variant=\"h5\" sx={{ fontWeight: 700 }}>\n                  {richMenuDetails?.rich_menu?.size?.width || 0}  {richMenuDetails?.rich_menu?.size?.height || 0}\n                </Typography>\n              </Box>\n            </Grid>\n            <Grid item xs={12} sm={4}>\n              <Box sx={{ \n                background: 'rgba(255,255,255,0.1)', \n                p: 2, \n                borderRadius: 2,\n                textAlign: 'center'\n              }}>\n                <Typography variant=\"h6\" sx={{ fontWeight: 600, mb: 1 }}>\n                  Hotspots\n                </Typography>\n                <Typography variant=\"h5\" sx={{ fontWeight: 700 }}>\n                  {richMenuDetails?.rich_menu?.areas?.length || 0}\n                </Typography>\n              </Box>\n            </Grid>\n          </Grid>\n        </Box>\n        \n        <DialogContent sx={{ p: 0, background: '#fafafa' }}>\n          {loadingDetails ? (\n            <Box sx={{ \n              display: 'flex', \n              flexDirection: 'column',\n              alignItems: 'center', \n              justifyContent: 'center', \n              p: 8,\n              minHeight: '500px'\n            }}>\n              <CircularProgress size={80} sx={{ mb: 3, color: '#1976d2' }} />\n              <Typography variant=\"h5\" color=\"text.secondary\" sx={{ mb: 1 }}>\n                Loading Rich Menu Details\n              </Typography>\n              <Typography variant=\"body1\" color=\"text.secondary\">\n                Fetching data from LINE API...\n              </Typography>\n            </Box>\n          ) : richMenuDetails ? (\n            <Box sx={{ p: 4 }}>\n              {/* Main Content Grid */}\n              <Grid container spacing={4}>\n                {/* Left Column - Image and Basic Info */}\n                <Grid item xs={12} lg={8}>\n                  {/* Image Section */}\n                  <Card sx={{ \n                    borderRadius: 3, \n                    overflow: 'hidden', \n                    boxShadow: '0 4px 20px rgba(0,0,0,0.1)',\n                    mb: 4\n                  }}>\n                    <Box sx={{ \n                      p: 2.5, \n                      background: '#1976d2',\n                      color: 'white',\n                      display: 'flex',\n                      alignItems: 'center',\n                      justifyContent: 'space-between'\n                    }}>\n                      <Typography variant=\"h6\" sx={{ fontWeight: 600, display: 'flex', alignItems: 'center' }}>\n                        <Image sx={{ mr: 1.5 }} />\n                        Rich Menu Image Preview\n                      </Typography>\n                      <Chip \n                        label={richMenuDetails.image ? 'Image Available' : 'No Image'} \n                        color={richMenuDetails.image ? 'success' : 'default'}\n                        variant=\"filled\"\n                        size=\"small\"\n                      />\n                    </Box>\n                    \n                                         {richMenuDetails.image ? (\n                       <Box sx={{ \n                         position: 'relative',\n                         background: 'linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%)',\n                         minHeight: '500px',\n                         display: 'flex',\n                         alignItems: 'center',\n                         justifyContent: 'center',\n                         p: 3\n                       }}>\n                         <Box sx={{ \n                           position: 'relative',\n                           borderRadius: 3,\n                           overflow: 'hidden',\n                           boxShadow: '0 8px 32px rgba(0,0,0,0.2)',\n                           border: '3px solid white'\n                         }}>\n                           <img \n                             src={richMenuDetails.image} \n                             alt=\"Rich Menu\" \n                             onLoad={handleImageLoad}\n                             style={{ \n                               maxWidth: '100%', \n                               maxHeight: '600px',\n                               objectFit: 'contain',\n                               display: 'block'\n                             }} \n                           />\n                           \n                           {/* Hotspot Overlays */}\n                           {imageLoaded && richMenuDetails.rich_menu?.areas && richMenuDetails.rich_menu.areas.length > 0 && (\n                             <Box sx={{ \n                               position: 'absolute', \n                               top: 0, \n                               left: 0, \n                               width: '100%', \n                               height: '100%',\n                               pointerEvents: 'none'\n                             }}>\n                               {richMenuDetails.rich_menu.areas.map((area: any, index: number) => {\n                                 // Calculate relative positions based on image size\n                                 const imageWidth = richMenuDetails.rich_menu?.size?.width || 2500;\n                                 const imageHeight = richMenuDetails.rich_menu?.size?.height || 1686;\n                                 \n                                 // Calculate scale factors\n                                 const scaleX = imageDimensions.width / imageWidth;\n                                 const scaleY = imageDimensions.height / imageHeight;\n                                 \n                                 // Calculate scaled positions and dimensions\n                                 const scaledX = area.bounds.x * scaleX;\n                                 const scaledY = area.bounds.y * scaleY;\n                                 const scaledWidth = area.bounds.width * scaleX;\n                                 const scaledHeight = area.bounds.height * scaleY;\n                                 \n                                 return (\n                                   <Box\n                                     key={index}\n                                     sx={{\n                                       position: 'absolute',\n                                       left: `${scaledX}px`,\n                                       top: `${scaledY}px`,\n                                       width: `${scaledWidth}px`,\n                                       height: `${scaledHeight}px`,\n                                       border: '3px solid #ff4444',\n                                       background: 'rgba(255, 68, 68, 0.2)',\n                                       borderRadius: '4px',\n                                       display: 'flex',\n                                       alignItems: 'center',\n                                       justifyContent: 'center',\n                                       pointerEvents: 'none',\n                                       zIndex: 10,\n                                       transition: 'all 0.3s ease'\n                                     }}\n                                   >\n                                     <Box sx={{\n                                       position: 'absolute',\n                                       top: '-25px',\n                                       left: '50%',\n                                       transform: 'translateX(-50%)',\n                                       background: '#ff4444',\n                                       color: 'white',\n                                       padding: '2px 8px',\n                                       borderRadius: '12px',\n                                       fontSize: '12px',\n                                       fontWeight: 'bold',\n                                       whiteSpace: 'nowrap',\n                                       zIndex: 11,\n                                       boxShadow: '0 2px 8px rgba(0,0,0,0.3)'\n                                     }}>\n                                       Hotspot {index + 1}\n                                     </Box>\n                                   </Box>\n                                 );\n                               })}\n                             </Box>\n                           )}\n                         </Box>\n                       </Box>\n                    ) : (\n                      <Box sx={{ \n                        p: 6, \n                        textAlign: 'center',\n                        background: 'linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%)',\n                        minHeight: '500px',\n                        display: 'flex',\n                        flexDirection: 'column',\n                        alignItems: 'center',\n                        justifyContent: 'center'\n                      }}>\n                        <Box sx={{ \n                          width: 120, \n                          height: 120, \n                          borderRadius: '50%', \n                          background: 'rgba(25, 118, 210, 0.1)', \n                          display: 'flex', \n                          alignItems: 'center', \n                          justifyContent: 'center',\n                          mb: 3\n                        }}>\n                          <Image sx={{ fontSize: 60, color: '#1976d2' }} />\n                        </Box>\n                        <Typography variant=\"h5\" color=\"text.secondary\" sx={{ mb: 2, fontWeight: 600 }}>\n                          No Image Available\n                        </Typography>\n                        <Typography variant=\"body1\" color=\"text.secondary\" sx={{ maxWidth: 400 }}>\n                          This rich menu doesn't have an image uploaded. Images are required for rich menus to be displayed properly in LINE.\n                        </Typography>\n                      </Box>\n                    )}\n                  </Card>\n\n                  {/* Hotspots Section */}\n                  <Card sx={{ \n                    borderRadius: 3, \n                    boxShadow: '0 4px 20px rgba(0,0,0,0.1)'\n                  }}>\n                    <Box sx={{ \n                      p: 2.5, \n                      background: '#1976d2',\n                      color: 'white',\n                      display: 'flex',\n                      alignItems: 'center',\n                      justifyContent: 'space-between'\n                    }}>\n                      <Typography variant=\"h6\" sx={{ fontWeight: 600, display: 'flex', alignItems: 'center' }}>\n                        <Code sx={{ mr: 1.5 }} />\n                        Interactive Hotspots & Actions\n                      </Typography>\n                      <Chip \n                        label={`${richMenuDetails.rich_menu?.areas?.length || 0} Hotspots`} \n                        color=\"secondary\"\n                        variant=\"filled\"\n                        size=\"small\"\n                      />\n                    </Box>\n                    \n                    <Box sx={{ p: 3 }}>\n                      {richMenuDetails.rich_menu?.areas && richMenuDetails.rich_menu.areas.length > 0 ? (\n                        <Grid container spacing={3}>\n                          {richMenuDetails.rich_menu.areas.map((area: any, index: number) => (\n                            <Grid item xs={12} md={6} key={index}>\n                              <Card \n                                variant=\"outlined\" \n                                sx={{ \n                                  borderRadius: 3,\n                                  border: '2px solid #e3f2fd',\n                                  background: '#fafafa',\n                                  '&:hover': {\n                                    borderColor: '#1976d2',\n                                    boxShadow: '0 4px 20px rgba(25, 118, 210, 0.15)',\n                                    transform: 'translateY(-2px)',\n                                    transition: 'all 0.3s ease'\n                                  },\n                                  transition: 'all 0.3s ease'\n                                }}\n                              >\n                                <CardContent sx={{ p: 3 }}>\n                                  {/* Hotspot Header */}\n                                  <Box sx={{ \n                                    display: 'flex', \n                                    alignItems: 'center', \n                                    mb: 3,\n                                    pb: 2,\n                                    borderBottom: '2px solid #e3f2fd'\n                                  }}>\n                                    <Box sx={{ \n                                      width: 40, \n                                      height: 40, \n                                      borderRadius: '50%', \n                                      background: '#1976d2', \n                                      display: 'flex', \n                                      alignItems: 'center', \n                                      justifyContent: 'center',\n                                      mr: 2,\n                                      boxShadow: '0 2px 8px rgba(25, 118, 210, 0.3)'\n                                    }}>\n                                      <Typography variant=\"h6\" sx={{ color: 'white', fontWeight: 700 }}>\n                                        {index + 1}\n                                      </Typography>\n                                    </Box>\n                                    <Box>\n                                      <Typography variant=\"h6\" sx={{ fontWeight: 700, color: '#1976d2' }}>\n                                        Hotspot {index + 1}\n                                      </Typography>\n                                      <Typography variant=\"caption\" color=\"text.secondary\">\n                                        Tap Area Configuration\n                                      </Typography>\n                                    </Box>\n                                  </Box>\n                                  \n                                  {/* Position & Size */}\n                                  <Box sx={{ mb: 3 }}>\n                                    <Typography variant=\"subtitle2\" color=\"text.secondary\" sx={{ fontWeight: 600, mb: 1 }}>\n                                       Position & Dimensions\n                                    </Typography>\n                                    <Box sx={{ \n                                      background: '#e3f2fd', \n                                      p: 2, \n                                      borderRadius: 2,\n                                      border: '1px solid #bbdefb'\n                                    }}>\n                                      <Typography variant=\"body2\" sx={{ \n                                        fontFamily: 'monospace', \n                                        fontSize: '0.9rem',\n                                        color: '#1976d2',\n                                        fontWeight: 600\n                                      }}>\n                                        X: {area.bounds.x} | Y: {area.bounds.y}\n                                      </Typography>\n                                      <Typography variant=\"body2\" sx={{ \n                                        fontFamily: 'monospace', \n                                        fontSize: '0.9rem',\n                                        color: '#1976d2',\n                                        fontWeight: 600\n                                      }}>\n                                        Width: {area.bounds.width} | Height: {area.bounds.height}\n                                      </Typography>\n                                    </Box>\n                                  </Box>\n                                  \n                                  {/* Action Type */}\n                                  <Box sx={{ mb: 3 }}>\n                                    <Typography variant=\"subtitle2\" color=\"text.secondary\" sx={{ fontWeight: 600, mb: 1 }}>\n                                       Action Type\n                                    </Typography>\n                                    <Chip \n                                      label={area.action.type.toUpperCase()} \n                                      size=\"medium\" \n                                      color={\n                                        area.action.type === 'postback' ? 'primary' :\n                                        area.action.type === 'message' ? 'secondary' :\n                                        area.action.type === 'uri' ? 'success' :\n                                        area.action.type === 'richmenuswitch' ? 'warning' : 'default'\n                                      }\n                                      variant=\"filled\"\n                                      sx={{ \n                                        fontWeight: 700,\n                                        fontSize: '0.8rem',\n                                        height: 32\n                                      }}\n                                    />\n                                  </Box>\n                                  \n                                  {/* Action Details */}\n                                  {area.action.type === 'postback' && area.action.data && (\n                                    <Box sx={{ mb: 2 }}>\n                                      <Typography variant=\"subtitle2\" color=\"text.secondary\" sx={{ fontWeight: 600, mb: 1 }}>\n                                         Postback Data\n                                      </Typography>\n                                      <Box sx={{ \n                                        background: '#f5f5f5', \n                                        p: 2, \n                                        borderRadius: 2,\n                                        border: '1px solid #e0e0e0'\n                                      }}>\n                                        <Typography variant=\"body2\" sx={{ \n                                          fontFamily: 'monospace', \n                                          fontSize: '0.85rem',\n                                          wordBreak: 'break-all',\n                                          color: '#424242'\n                                        }}>\n                                          {area.action.data}\n                                        </Typography>\n                                      </Box>\n                                    </Box>\n                                  )}\n                                  \n                                  {area.action.type === 'message' && area.action.text && (\n                                    <Box sx={{ mb: 2 }}>\n                                      <Typography variant=\"subtitle2\" color=\"text.secondary\" sx={{ fontWeight: 600, mb: 1 }}>\n                                         Message Text\n                                      </Typography>\n                                      <Box sx={{ \n                                        background: '#f5f5f5', \n                                        p: 2, \n                                        borderRadius: 2,\n                                        border: '1px solid #e0e0e0'\n                                      }}>\n                                        <Typography variant=\"body2\" sx={{ \n                                          color: '#424242',\n                                          fontStyle: 'italic'\n                                        }}>\n                                          \"{area.action.text}\"\n                                        </Typography>\n                                      </Box>\n                                    </Box>\n                                  )}\n                                  \n                                  {area.action.type === 'uri' && area.action.uri && (\n                                    <Box sx={{ mb: 2 }}>\n                                      <Typography variant=\"subtitle2\" color=\"text.secondary\" sx={{ fontWeight: 600, mb: 1 }}>\n                                         URI Link\n                                      </Typography>\n                                      <Box sx={{ \n                                        background: '#f5f5f5', \n                                        p: 2, \n                                        borderRadius: 2,\n                                        border: '1px solid #e0e0e0'\n                                      }}>\n                                        <Typography variant=\"body2\" sx={{ \n                                          fontFamily: 'monospace', \n                                          fontSize: '0.8rem',\n                                          wordBreak: 'break-all',\n                                          color: '#1976d2',\n                                          textDecoration: 'underline'\n                                        }}>\n                                          {area.action.uri}\n                                        </Typography>\n                                      </Box>\n                                    </Box>\n                                  )}\n                                  \n                                  {area.action.type === 'richmenuswitch' && area.action.richMenuAliasId && (\n                                    <Box sx={{ mb: 2 }}>\n                                      <Typography variant=\"subtitle2\" color=\"text.secondary\" sx={{ fontWeight: 600, mb: 1 }}>\n                                         Target Rich Menu\n                                      </Typography>\n                                      <Box sx={{ \n                                        background: '#fff3e0', \n                                        p: 2, \n                                        borderRadius: 2,\n                                        border: '1px solid #ffcc02'\n                                      }}>\n                                        <Typography variant=\"body2\" sx={{ \n                                          fontFamily: 'monospace', \n                                          fontSize: '0.85rem',\n                                          color: '#f57c00',\n                                          fontWeight: 600\n                                        }}>\n                                          {area.action.richMenuAliasId}\n                                        </Typography>\n                                      </Box>\n                                    </Box>\n                                  )}\n                                </CardContent>\n                              </Card>\n                            </Grid>\n                          ))}\n                        </Grid>\n                      ) : (\n                        <Box sx={{ \n                          p: 6, \n                          textAlign: 'center',\n                          background: 'linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%)',\n                          borderRadius: 3\n                        }}>\n                          <Box sx={{ \n                            width: 100, \n                            height: 100, \n                            borderRadius: '50%', \n                            background: 'rgba(25, 118, 210, 0.1)', \n                            display: 'flex', \n                            alignItems: 'center', \n                            justifyContent: 'center',\n                            mx: 'auto',\n                            mb: 3\n                          }}>\n                            <Code sx={{ fontSize: 50, color: '#1976d2' }} />\n                          </Box>\n                          <Typography variant=\"h5\" color=\"text.secondary\" sx={{ mb: 2, fontWeight: 600 }}>\n                            No Interactive Hotspots\n                          </Typography>\n                          <Typography variant=\"body1\" color=\"text.secondary\" sx={{ maxWidth: 500, mx: 'auto' }}>\n                            This rich menu doesn't have any tap areas or actions configured. \n                            Hotspots allow users to interact with your rich menu by tapping on specific areas.\n                          </Typography>\n                        </Box>\n                      )}\n                    </Box>\n                  </Card>\n                </Grid>\n\n                {/* Right Column - Information Panel */}\n                <Grid item xs={12} lg={4}>\n                  <Box sx={{ position: 'sticky', top: 20 }}>\n                    {/* Rich Menu Information */}\n                    <Card sx={{ \n                      borderRadius: 3, \n                      boxShadow: '0 4px 20px rgba(0,0,0,0.1)',\n                      mb: 3\n                    }}>\n                      <Box sx={{ \n                        p: 2.5, \n                        background: '#1976d2',\n                        color: 'white'\n                      }}>\n                        <Typography variant=\"h6\" sx={{ fontWeight: 600, display: 'flex', alignItems: 'center' }}>\n                          <Settings sx={{ mr: 1.5 }} />\n                          Rich Menu Properties\n                        </Typography>\n                      </Box>\n                      <Box sx={{ p: 3 }}>\n                        <Box sx={{ mb: 3 }}>\n                          <Typography variant=\"subtitle2\" color=\"text.secondary\" sx={{ fontWeight: 600, mb: 1 }}>\n                             Name\n                          </Typography>\n                          <Typography variant=\"h6\" sx={{ \n                            fontWeight: 700, \n                            color: '#1976d2',\n                            p: 2,\n                            background: '#e3f2fd',\n                            borderRadius: 2,\n                            border: '1px solid #bbdefb'\n                          }}>\n                            {richMenuDetails.rich_menu?.name}\n                          </Typography>\n                        </Box>\n                        \n                        <Box sx={{ mb: 3 }}>\n                          <Typography variant=\"subtitle2\" color=\"text.secondary\" sx={{ fontWeight: 600, mb: 1 }}>\n                             Chat Bar Text\n                          </Typography>\n                          <Box sx={{ \n                            p: 2, \n                            background: '#f5f5f5', \n                            borderRadius: 2,\n                            border: '1px solid #e0e0e0',\n                            minHeight: 60,\n                            display: 'flex',\n                            alignItems: 'center'\n                          }}>\n                            <Typography variant=\"body1\" sx={{ \n                              color: '#424242',\n                              fontStyle: 'italic',\n                              textAlign: 'center',\n                              width: '100%'\n                            }}>\n                              \"{richMenuDetails.rich_menu?.chatBarText || 'No chat bar text configured'}\"\n                            </Typography>\n                          </Box>\n                        </Box>\n                        \n                        <Box sx={{ mb: 3 }}>\n                          <Typography variant=\"subtitle2\" color=\"text.secondary\" sx={{ fontWeight: 600, mb: 1 }}>\n                             Default Status\n                          </Typography>\n                          <Box sx={{ display: 'flex', alignItems: 'center' }}>\n                            <Chip \n                              label={richMenuDetails.rich_menu?.selected ? 'DEFAULT' : 'NOT DEFAULT'} \n                              color={richMenuDetails.rich_menu?.selected ? 'success' : 'default'}\n                              variant=\"filled\"\n                              sx={{ \n                                fontWeight: 700,\n                                fontSize: '0.8rem',\n                                height: 32\n                              }}\n                            />\n                            <Typography variant=\"body2\" color=\"text.secondary\" sx={{ ml: 2 }}>\n                              {richMenuDetails.rich_menu?.selected ? 'Auto-displays to all users' : 'Not set as default menu'}\n                            </Typography>\n                          </Box>\n                        </Box>\n                      </Box>\n                    </Card>\n\n                    {/* Technical Details */}\n                    <Card sx={{ \n                      borderRadius: 3, \n                      boxShadow: '0 4px 20px rgba(0,0,0,0.1)'\n                    }}>\n                      <Box sx={{ \n                        p: 2.5, \n                        background: '#424242',\n                        color: 'white'\n                      }}>\n                        <Typography variant=\"h6\" sx={{ fontWeight: 600, display: 'flex', alignItems: 'center' }}>\n                          <Code sx={{ mr: 1.5 }} />\n                          Technical Details\n                        </Typography>\n                      </Box>\n                      <Box sx={{ p: 3 }}>\n                        <Box sx={{ mb: 2 }}>\n                          <Typography variant=\"caption\" color=\"text.secondary\" sx={{ fontWeight: 600 }}>\n                            Rich Menu ID\n                          </Typography>\n                          <Typography variant=\"body2\" sx={{ \n                            fontFamily: 'monospace', \n                            fontSize: '0.75rem',\n                            background: '#f5f5f5',\n                            p: 1.5,\n                            borderRadius: 1,\n                            border: '1px solid #e0e0e0',\n                            wordBreak: 'break-all',\n                            color: '#424242'\n                          }}>\n                            {richMenuDetails.rich_menu?.richMenuId}\n                          </Typography>\n                        </Box>\n                        \n                        <Box sx={{ mb: 2 }}>\n                          <Typography variant=\"caption\" color=\"text.secondary\" sx={{ fontWeight: 600 }}>\n                            Dimensions\n                          </Typography>\n                          <Typography variant=\"body2\" sx={{ \n                            fontFamily: 'monospace', \n                            fontSize: '0.9rem',\n                            background: '#e3f2fd',\n                            p: 1.5,\n                            borderRadius: 1,\n                            border: '1px solid #bbdefb',\n                            color: '#1976d2',\n                            fontWeight: 600\n                          }}>\n                            {richMenuDetails.rich_menu?.size?.width}  {richMenuDetails.rich_menu?.size?.height} px\n                          </Typography>\n                        </Box>\n                        \n                        <Box sx={{ mb: 2 }}>\n                          <Typography variant=\"caption\" color=\"text.secondary\" sx={{ fontWeight: 600 }}>\n                            Hotspot Count\n                          </Typography>\n                          <Typography variant=\"body2\" sx={{ \n                            fontSize: '1.1rem',\n                            background: '#e8f5e8',\n                            p: 1.5,\n                            borderRadius: 1,\n                            border: '1px solid #c8e6c9',\n                            color: '#2e7d32',\n                            fontWeight: 600,\n                            textAlign: 'center'\n                          }}>\n                            {richMenuDetails.rich_menu?.areas?.length || 0} Interactive Areas\n                          </Typography>\n                        </Box>\n                      </Box>\n                    </Card>\n                  </Box>\n                </Grid>\n              </Grid>\n            </Box>\n          ) : (\n            <Box sx={{ \n              p: 8, \n              textAlign: 'center',\n              minHeight: '500px',\n              display: 'flex',\n              flexDirection: 'column',\n              alignItems: 'center',\n              justifyContent: 'center',\n              background: 'linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%)'\n            }}>\n              <Box sx={{ \n                width: 120, \n                height: 120, \n                borderRadius: '50%', \n                background: 'rgba(244, 67, 54, 0.1)', \n                display: 'flex', \n                alignItems: 'center', \n                justifyContent: 'center',\n                mb: 3\n              }}>\n                <ErrorIcon sx={{ fontSize: 60, color: '#f44336' }} />\n              </Box>\n              <Typography variant=\"h4\" color=\"error\" sx={{ mb: 2, fontWeight: 700 }}>\n                Failed to Load Details\n              </Typography>\n              <Typography variant=\"body1\" color=\"text.secondary\" sx={{ maxWidth: 500, mb: 3 }}>\n                Unable to fetch rich menu details from LINE API. Please check your connection and try again.\n              </Typography>\n              <Button \n                variant=\"contained\" \n                color=\"primary\"\n                onClick={() => handleOpenDetailsDialog(selectedRichMenuForDetails)}\n                startIcon={<Refresh />}\n              >\n                Retry Loading\n              </Button>\n            </Box>\n          )}\n        </DialogContent>\n        \n        <DialogActions sx={{ \n          p: 3, \n          borderTop: '2px solid #e3f2fd',\n          background: '#fafafa',\n          borderBottomLeftRadius: 8,\n          borderBottomRightRadius: 8\n        }}>\n          <Button \n            onClick={() => setDetailsDialogOpen(false)}\n            variant=\"outlined\"\n            sx={{ \n              borderColor: '#1976d2',\n              color: '#1976d2',\n              '&:hover': {\n                borderColor: '#1565c0',\n                background: 'rgba(25, 118, 210, 0.04)'\n              }\n            }}\n          >\n            Close\n          </Button>\n        </DialogActions>\n      </Dialog>\n\n      {/* Update Alias Dialog */}\n      <Dialog open={updateAliasDialogOpen} onClose={() => setUpdateAliasDialogOpen(false)} maxWidth=\"md\" fullWidth>\n        <DialogTitle>\n          Update Rich Menu Alias\n        </DialogTitle>\n        <DialogContent>\n          <Alert severity=\"info\" sx={{ mb: 2 }}>\n            <Typography variant=\"body2\">\n              <strong>Update Alias:</strong> Change which rich menu this alias points to. This will update both LINE API and your database.\n            </Typography>\n          </Alert>\n          \n          {selectedAliasForUpdate && (\n            <Box sx={{ mb: 3 }}>\n              <Typography variant=\"h6\" sx={{ mb: 2 }}>\n                Current Alias: {selectedAliasForUpdate.richMenuAliasId}\n              </Typography>\n              \n              <Box sx={{ mb: 2, p: 2, bgcolor: 'grey.50', borderRadius: 1 }}>\n                <Typography variant=\"body2\" sx={{ fontWeight: 600, mb: 1 }}>\n                  Current Rich Menu:\n                </Typography>\n                <Typography variant=\"body2\" color=\"text.secondary\">\n                  {selectedAliasForUpdate.richMenuId || 'Not linked'}\n                </Typography>\n              </Box>\n            </Box>\n          )}\n          \n          <Box sx={{ mb: 3 }}>\n            <Typography variant=\"h6\" sx={{ mb: 2 }}>\n              Select New Rich Menu ({richMenus.length} available)\n            </Typography>\n            <FormControl fullWidth>\n              <InputLabel>Rich Menu</InputLabel>\n              <Select\n                value={selectedRichMenuForUpdate?.rich_menu_id || ''}\n                onChange={(e) => {\n                  const selected = richMenus.find(rm => rm.richMenuId === e.target.value);\n                  setSelectedRichMenuForUpdate(selected || null);\n                }}\n                label=\"Rich Menu\"\n              >\n                {richMenus.map((richMenu) => (\n                  <MenuItem key={richMenu.richMenuId} value={richMenu.richMenuId}>\n                    <Box>\n                      <Typography variant=\"body1\" sx={{ fontWeight: 600 }}>\n                        {richMenu.name}\n                      </Typography>\n                      <Typography variant=\"caption\" color=\"text.secondary\" sx={{ fontFamily: 'monospace' }}>\n                        {richMenu.richMenuId}\n                      </Typography>\n                    </Box>\n                  </MenuItem>\n                ))}\n              </Select>\n            </FormControl>\n          </Box>\n\n          {selectedRichMenuForUpdate && (\n            <Alert severity=\"success\">\n              <Typography variant=\"body2\">\n                <strong>Will Update:</strong> Alias \"{selectedAliasForUpdate?.richMenuAliasId}\" will point to \"{selectedRichMenuForUpdate.name}\"\n              </Typography>\n            </Alert>\n          )}\n        </DialogContent>\n        <DialogActions>\n          <Button onClick={() => setUpdateAliasDialogOpen(false)}>\n            Cancel\n          </Button>\n          <Button \n            onClick={handleUpdateAlias}\n            variant=\"contained\"\n            disabled={!selectedRichMenuForUpdate || updatingAlias}\n            startIcon={updatingAlias ? <CircularProgress size={16} /> : <Edit />}\n          >\n            {updatingAlias ? 'Updating...' : 'Update Alias'}\n          </Button>\n        </DialogActions>\n      </Dialog>\n\n      {/* Create Alias Dialog */}\n      <Dialog open={createAliasDialogOpen} onClose={() => setCreateAliasDialogOpen(false)} maxWidth=\"md\" fullWidth>\n        <DialogTitle>\n          Create Rich Menu Alias\n        </DialogTitle>\n        <DialogContent>\n          <Alert severity=\"info\" sx={{ mb: 2 }}>\n            <Typography variant=\"body2\">\n              <strong>Rich Menu Aliases:</strong> Create aliases for rich menus to enable switching between them using the \"richmenuswitch\" action type. \n              Select a rich menu and provide an alias ID that will be used in richmenuswitch actions.\n            </Typography>\n          </Alert>\n          \n          <Box sx={{ mb: 3 }}>\n            <Typography variant=\"h6\" sx={{ mb: 2 }}>\n              Select Rich Menu ({unlinkedRichMenus.length} available)\n            </Typography>\n            {unlinkedRichMenus.length === 0 ? (\n              <Alert severity=\"warning\">\n                No unlinked rich menus found. All rich menus are already linked to aliases.\n              </Alert>\n            ) : (\n              <FormControl fullWidth>\n                <InputLabel>Rich Menu</InputLabel>\n                <Select\n                  value={selectedUnlinkedRichMenu?.rich_menu_id || ''}\n                  onChange={(e) => {\n                    const selected = unlinkedRichMenus.find(rm => rm.rich_menu_id === e.target.value);\n                    setSelectedUnlinkedRichMenu(selected || null);\n                    if (selected) {\n                      setAliasId(selected.name); // Use rich menu name as default alias ID\n                    }\n                  }}\n                  label=\"Rich Menu\"\n                >\n                  {unlinkedRichMenus.map((richMenu) => (\n                    <MenuItem key={richMenu.rich_menu_id} value={richMenu.rich_menu_id}>\n                      <Box>\n                        <Typography variant=\"body1\" sx={{ fontWeight: 600 }}>\n                          {richMenu.name}\n                        </Typography>\n                        <Typography variant=\"caption\" color=\"text.secondary\" sx={{ fontFamily: 'monospace' }}>\n                          {richMenu.rich_menu_id}\n                        </Typography>\n                      </Box>\n                    </MenuItem>\n                  ))}\n                </Select>\n              </FormControl>\n            )}\n          </Box>\n\n          {selectedUnlinkedRichMenu && (\n            <Box sx={{ mb: 3 }}>\n              <Typography variant=\"h6\" sx={{ mb: 2 }}>\n                Alias Configuration\n              </Typography>\n              \n              <TextField\n                fullWidth\n                label=\"Alias ID\"\n                value={aliasId}\n                onChange={(e) => setAliasId(e.target.value)}\n                placeholder=\"Enter alias ID (e.g., home-menu, dtx-book)\"\n                helperText={`This alias ID will be used in richmenuswitch actions. Will be normalized to: ${aliasId.toLowerCase()} (hyphens preserved, fallback to underscores if needed)`}\n                sx={{ mb: 2 }}\n              />\n              \n              <Alert severity=\"info\">\n                <Typography variant=\"body2\">\n                  <strong>Usage:</strong> Use this alias ID in richmenuswitch actions like: \n                  <code style={{ display: 'block', marginTop: 4, padding: 4, backgroundColor: '#f5f5f5', borderRadius: 4 }}>\n                    {`{\n  \"type\": \"richmenuswitch\",\n  \"richMenuAliasId\": \"${aliasId.toLowerCase() || 'your-alias-id'}\"\n}`}\n                  </code>\n                </Typography>\n              </Alert>\n            </Box>\n          )}\n        </DialogContent>\n        <DialogActions>\n          <Button onClick={() => setCreateAliasDialogOpen(false)}>\n            Cancel\n          </Button>\n          <Button \n            onClick={handleCreateRichMenuAlias}\n            variant=\"contained\"\n            disabled={!selectedUnlinkedRichMenu || !aliasId.trim() || creatingAlias}\n            startIcon={creatingAlias ? <CircularProgress size={16} /> : <Add />}\n          >\n            {creatingAlias ? 'Creating...' : 'Create Alias'}\n          </Button>\n        </DialogActions>\n      </Dialog>\n\n      {/* Assign to User Dialog */}\n      <Dialog open={assignDialogOpen} onClose={() => setAssignDialogOpen(false)} maxWidth=\"sm\" fullWidth>\n        <DialogTitle>\n          Assign Rich Menu to User\n        </DialogTitle>\n        <DialogContent>\n          {selectedRichMenu && (\n            <Box sx={{ mb: 2 }}>\n              <Typography variant=\"subtitle2\" sx={{ fontWeight: 600 }}>\n                Rich Menu: {selectedRichMenu.name}\n              </Typography>\n              <Typography variant=\"body2\" color=\"text.secondary\">\n                ID: {selectedRichMenu.richMenuId}\n              </Typography>\n            </Box>\n          )}\n          \n          <TextField\n            fullWidth\n            label=\"LINE User ID\"\n            value={userId}\n            onChange={(e) => setUserId(e.target.value)}\n            placeholder=\"U1234567890abcdef...\"\n            helperText=\"Enter the LINE User ID to assign this rich menu\"\n            margin=\"normal\"\n          />\n        </DialogContent>\n        <DialogActions>\n          <Button onClick={() => setAssignDialogOpen(false)}>\n            Cancel\n          </Button>\n          <Button\n            onClick={handleAssignToUser}\n            variant=\"contained\"\n            disabled={assigning || !userId.trim()}\n            startIcon={assigning ? <CircularProgress size={16} /> : <Assignment />}\n          >\n            {assigning ? 'Assigning...' : 'Assign'}\n          </Button>\n        </DialogActions>\n      </Dialog>\n\n      {/* Create Rich Menu Dialog */}\n      <Dialog open={createDialogOpen} onClose={() => setCreateDialogOpen(false)} maxWidth=\"lg\" fullWidth>\n        <DialogTitle>Create New Rich Menu</DialogTitle>\n        <DialogContent>\n          {createMode === 'visual' && (\n            <Alert severity=\"info\" sx={{ mb: 2 }}>\n              <Typography variant=\"body2\">\n                <strong>Visual Builder Workflow:</strong>\n                <br />\n                1. Upload a background image first\n                <br />\n                2. Draw hotspots on the image\n                <br />\n                3. Create rich menu (image will be automatically uploaded)\n              </Typography>\n            </Alert>\n          )}\n          <Tabs value={createMode} onChange={(_, newValue) => setCreateMode(newValue)} sx={{ mb: 2 }}>\n            <Tab label=\"Visual Builder\" value=\"visual\" icon={<Palette />} />\n            <Tab label=\"Template\" value=\"template\" icon={<ViewModule />} />\n            <Tab label=\"Manual JSON\" value=\"manual\" icon={<Code />} />\n            <Tab label=\"Import JSON\" value=\"import\" icon={<CloudUpload />} />\n          </Tabs>\n\n          {createMode === 'visual' && (\n            <Grid container spacing={2}>\n              <Grid item xs={12}>\n                <TextField\n                  fullWidth\n                  label=\"Rich Menu Name\"\n                  value={richMenuForm.name}\n                  onChange={(e) => setRichMenuForm({...richMenuForm, name: e.target.value})}\n                  placeholder=\"Enter rich menu name\"\n                  margin=\"normal\"\n                />\n              </Grid>\n              \n              <Grid item xs={12}>\n                <TextField\n                  fullWidth\n                  label=\"Chat Bar Text\"\n                  value={richMenuForm.chatBarText}\n                  onChange={(e) => {\n                    const value = e.target.value;\n                    if (value.length <= 14) {\n                      setRichMenuForm({...richMenuForm, chatBarText: value});\n                    }\n                  }}\n                  placeholder=\"Text shown in chat bar when rich menu is active\"\n                  helperText={`${richMenuForm.chatBarText.length}/14 characters (LINE API limit) - This text appears in the chat input area when the rich menu is displayed`}\n                  margin=\"normal\"\n                  inputProps={{ maxLength: 14 }}\n                  error={richMenuForm.chatBarText.length > 14}\n                />\n              </Grid>\n              \n              <Grid item xs={12}>\n                <FormControlLabel\n                  control={\n                    <Switch\n                      checked={richMenuForm.displayByDefault}\n                      onChange={(e) => setRichMenuForm({...richMenuForm, displayByDefault: e.target.checked})}\n                    />\n                  }\n                  label=\"Display by Default\"\n                />\n                <Typography variant=\"body2\" color=\"text.secondary\" sx={{ ml: 4, mt: 0.5 }}>\n                  When enabled, this rich menu will be displayed by default when users open the chat\n                </Typography>\n              </Grid>\n              \n              <Grid item xs={12}>\n                <FormControl fullWidth margin=\"normal\">\n                  <InputLabel>Rich Menu Size</InputLabel>\n                  <Select\n                    value={selectedRichMenuSize}\n                    onChange={(e) => handleRichMenuSizeChange(e.target.value as keyof typeof LINE_RICH_MENU_SIZES)}\n                    label=\"Rich Menu Size\"\n                  >\n                    {Object.entries(LINE_RICH_MENU_SIZES).map(([key, size]) => (\n                      <MenuItem key={key} value={key}>\n                        {size.label}\n                      </MenuItem>\n                    ))}\n                  </Select>\n                  <Typography variant=\"body2\" color=\"text.secondary\" sx={{ mt: 0.5 }}>\n                    Select the standard LINE rich menu size. The canvas will be scaled to match this ratio.\n                  </Typography>\n                </FormControl>\n              </Grid>\n              \n              <Grid item xs={12}>\n                <Typography variant=\"h6\" gutterBottom>Background Image (Required for Drawing)</Typography>\n                <input\n                  accept=\"image/*\"\n                  type=\"file\"\n                  onChange={(e) => e.target.files?.[0] && handleBackgroundImageUpload(e.target.files[0])}\n                  style={{ display: 'none' }}\n                  id=\"background-image-upload\"\n                />\n                <label htmlFor=\"background-image-upload\">\n                  <Button variant=\"contained\" component=\"span\" startIcon={<Image />}>\n                    Upload Background Image\n                  </Button>\n                </label>\n                {backgroundImageUrl && (\n                  <Alert severity=\"success\" sx={{ mt: 1 }}>\n                    Background image uploaded successfully! You can now draw hotspots on the image.\n                  </Alert>\n                )}\n              </Grid>\n\n              {backgroundImageUrl && (\n                <Grid item xs={12}>\n                  <Typography variant=\"h6\" gutterBottom>Draw Hotspots on Image</Typography>\n                  <Alert severity=\"info\" sx={{ mb: 2 }}>\n                    <Typography variant=\"body2\">\n                      <strong>Instructions:</strong>\n                      <br />\n                       Click and drag on the image to draw hotspots\n                      <br />\n                       Click on existing hotspots to edit them\n                      <br />\n                       Each hotspot will become a touchable area in your rich menu\n                    </Typography>\n                  </Alert>\n                  \n                  <Box sx={{ \n                    border: '2px dashed #ccc', \n                    borderRadius: 2, \n                    p: 2, \n                    textAlign: 'center',\n                    backgroundColor: '#f9f9f9',\n                    position: 'relative'\n                  }}>\n                    {/* Drawing Controls Overlay */}\n                    <Box sx={{\n                      position: 'absolute',\n                      top: 10,\n                      right: 10,\n                      zIndex: 10,\n                      display: 'flex',\n                      flexDirection: 'column',\n                      gap: 1\n                    }}>\n                      <Chip\n                        label={`Zoom: ${Math.round(drawingState.zoom * 100)}%`}\n                        size=\"small\"\n                        color=\"primary\"\n                        variant=\"outlined\"\n                      />\n                      <Chip\n                        label={drawingState.zoomLocked ? \" Zoom Locked\" : \" Zoom Unlocked\"}\n                        size=\"small\"\n                        color={drawingState.zoomLocked ? \"warning\" : \"default\"}\n                        variant=\"outlined\"\n                        onClick={toggleZoomLock}\n                        sx={{ cursor: 'pointer' }}\n                      />\n                      <Chip\n                        label={drawingState.gridSnap ? \"Grid Snap: ON\" : \"Grid Snap: OFF\"}\n                        size=\"small\"\n                        color={drawingState.gridSnap ? \"success\" : \"default\"}\n                        variant=\"outlined\"\n                        onClick={() => setDrawingState({\n                          ...drawingState,\n                          gridSnap: !drawingState.gridSnap\n                        })}\n                        sx={{ cursor: 'pointer' }}\n                      />\n                      <Chip\n                        label={drawingState.showGrid ? \"Grid: ON\" : \"Grid: OFF\"}\n                        size=\"small\"\n                        color={drawingState.showGrid ? \"success\" : \"default\"}\n                        variant=\"outlined\"\n                        onClick={() => setDrawingState({\n                          ...drawingState,\n                          showGrid: !drawingState.showGrid\n                        })}\n                        sx={{ cursor: 'pointer' }}\n                      />\n                    </Box>\n\n                    {/* Instructions Overlay */}\n                    {showDrawingControls ? (\n                      <Box sx={{\n                        position: 'absolute',\n                        top: 10,\n                        left: 10,\n                        zIndex: 10,\n                        backgroundColor: 'rgba(255, 255, 255, 0.95)',\n                        borderRadius: 1,\n                        p: 1.5,\n                        fontSize: '0.75rem',\n                        boxShadow: '0 2px 8px rgba(0,0,0,0.1)',\n                        border: '1px solid rgba(0,0,0,0.1)',\n                        maxWidth: 250\n                      }}>\n                        <Box sx={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', mb: 1 }}>\n                          <Typography variant=\"caption\" sx={{ fontWeight: 'bold', color: '#333' }}>\n                            Drawing Controls:\n                          </Typography>\n                          <IconButton\n                            size=\"small\"\n                            onClick={() => setShowDrawingControls(false)}\n                            sx={{ \n                              p: 0.5, \n                              minWidth: 'auto',\n                              color: '#666',\n                              '&:hover': { color: '#333' }\n                            }}\n                          >\n                            <Close fontSize=\"small\" />\n                          </IconButton>\n                        </Box>\n                        <Typography variant=\"caption\" display=\"block\" sx={{ color: '#555', mb: 0.5 }}>\n                           Click & drag to draw hotspots\n                        </Typography>\n                        <Typography variant=\"caption\" display=\"block\" sx={{ color: '#555', mb: 0.5 }}>\n                           Drag hotspots to move them\n                        </Typography>\n                        <Typography variant=\"caption\" display=\"block\" sx={{ color: '#555', mb: 0.5 }}>\n                           Drag corner handles to resize\n                        </Typography>\n                        <Typography variant=\"caption\" display=\"block\" sx={{ color: '#555', mb: 0.5 }}>\n                           Mouse wheel to zoom\n                        </Typography>\n                        <Typography variant=\"caption\" display=\"block\" sx={{ color: '#555', mb: 0.5 }}>\n                           Lock zoom to prevent accidental changes\n                        </Typography>\n                        <Typography variant=\"caption\" display=\"block\" sx={{ color: '#555', mb: 0.5 }}>\n                           Press 'G' to toggle grid\n                        </Typography>\n                        <Typography variant=\"caption\" display=\"block\" sx={{ color: '#555', mb: 0.5 }}>\n                           Press 'S' to toggle snap\n                        </Typography>\n                        <Typography variant=\"caption\" display=\"block\" sx={{ color: '#555', mb: 0.5 }}>\n                           Press '0' to reset view\n                        </Typography>\n                        <Typography variant=\"caption\" display=\"block\" sx={{ color: '#555' }}>\n                           Press 'Delete' to remove hotspot\n                        </Typography>\n                      </Box>\n                    ) : (\n                      <Box sx={{\n                        position: 'absolute',\n                        top: 10,\n                        left: 10,\n                        zIndex: 10\n                      }}>\n                        <Button\n                          size=\"small\"\n                          variant=\"outlined\"\n                          onClick={() => setShowDrawingControls(true)}\n                          startIcon={<Help />}\n                          sx={{\n                            backgroundColor: 'rgba(255, 255, 255, 0.9)',\n                            borderColor: 'rgba(0, 0, 0, 0.2)',\n                            color: '#666',\n                            fontSize: '0.75rem',\n                            '&:hover': {\n                              backgroundColor: 'rgba(255, 255, 255, 1)',\n                              borderColor: 'rgba(0, 0, 0, 0.3)',\n                              color: '#333'\n                            }\n                          }}\n                        >\n                          Show Help\n                        </Button>\n                      </Box>\n                    )}\n\n                    <canvas\n                      ref={canvasRef}\n                      onMouseDown={handleCanvasMouseDown}\n                      onMouseMove={(e) => {\n                        throttledMouseMove(e);\n                        // Update cursor style\n                        const canvas = canvasRef.current;\n                        if (canvas) {\n                          canvas.style.cursor = getCursorStyle(e.clientX, e.clientY);\n                        }\n                      }}\n                      onMouseUp={handleCanvasMouseUp}\n                      onClick={handleCanvasClick}\n                      onContextMenu={handleCanvasContextMenu}\n                      onKeyDown={handleCanvasKeyDown}\n                      onMouseLeave={() => {\n                        // Reset cursor when leaving canvas\n                        const canvas = canvasRef.current;\n                        if (canvas) {\n                          canvas.style.cursor = 'default';\n                        }\n                        // Clear mouse position\n                        setDrawingState({\n                          ...drawingState,\n                          mousePosition: null\n                        });\n                      }}\n                      tabIndex={0}\n                      style={{\n                        width: '100%',\n                        maxWidth: '800px',\n                        height: 'auto',\n                        cursor: 'default',\n                        border: '1px solid #ddd',\n                        borderRadius: 4,\n                        boxShadow: '0 2px 8px rgba(0,0,0,0.1)',\n                        userSelect: 'none',\n                        touchAction: 'none'\n                      }}\n                    />\n                  </Box>\n                  \n                  <Box sx={{ mt: 2, display: 'flex', gap: 1, flexWrap: 'wrap', alignItems: 'center' }}>\n                    <Button \n                      variant=\"outlined\" \n                      size=\"small\"\n                      onClick={() => {\n                        setHotspots([]);\n                        setImportedHotspots([]);\n                        drawCanvas();\n                      }}\n                      startIcon={<Delete />}\n                    >\n                      Clear All Hotspots\n                    </Button>\n                    <Button \n                      variant=\"outlined\" \n                      size=\"small\"\n                      onClick={() => {\n                        // Create test hotspots that cover the entire image\n                        if (canvasImage) {\n                          const testHotspots: Hotspot[] = [\n                            {\n                              id: 'test_1',\n                              bounds: { x: 0, y: 0, width: canvasImage.width / 3, height: canvasImage.height / 2 },\n                              action: { type: 'postback', data: 'action=test1' },\n                              label: 'Test 1',\n                              color: '#ff0000'\n                            },\n                            {\n                              id: 'test_2',\n                              bounds: { x: canvasImage.width / 3, y: 0, width: canvasImage.width / 3, height: canvasImage.height / 2 },\n                              action: { type: 'postback', data: 'action=test2' },\n                              label: 'Test 2',\n                              color: '#00ff00'\n                            },\n                            {\n                              id: 'test_3',\n                              bounds: { x: (canvasImage.width / 3) * 2, y: 0, width: canvasImage.width / 3, height: canvasImage.height / 2 },\n                              action: { type: 'postback', data: 'action=test3' },\n                              label: 'Test 3',\n                              color: '#0000ff'\n                            }\n                          ];\n                          setHotspots(testHotspots);\n                          drawCanvas();\n                        }\n                      }}\n                      startIcon={<Add />}\n                    >\n                      Add Test Hotspots\n                    </Button>\n                    <Button \n                      variant=\"outlined\" \n                      size=\"small\"\n                      onClick={drawCanvas}\n                      startIcon={<Refresh />}\n                    >\n                      Refresh Canvas\n                    </Button>\n                    <Button \n                      variant=\"outlined\" \n                      size=\"small\"\n                      onClick={() => {\n                        if (canvasImage) {\n                          // Create a test hotspot at the center of the image\n                          const centerX = canvasImage.width / 2;\n                          const centerY = canvasImage.height / 2;\n                          const testHotspot: Hotspot = {\n                            id: 'test_center',\n                            bounds: { \n                              x: centerX - 50, \n                              y: centerY - 50, \n                              width: 100, \n                              height: 100 \n                            },\n                            action: { type: 'postback', data: 'action=test_center' },\n                            label: 'Center Test',\n                            color: '#ff0000'\n                          };\n                          setHotspots([testHotspot]);\n                          drawCanvas();\n                          console.log('Created center test hotspot:', testHotspot);\n                        }\n                      }}\n                      startIcon={<Add />}\n                    >\n                      Test Center Hotspot\n                    </Button>\n                    <Button \n                      variant=\"outlined\" \n                      size=\"small\"\n                      onClick={() => {\n                        if (canvasImage) {\n                          // Create test hotspots at known positions to verify coordinate transformation\n                          const testHotspots: Hotspot[] = [\n                            {\n                              id: 'test_top_left',\n                              bounds: { x: 0, y: 0, width: 100, height: 100 },\n                              action: { type: 'postback', data: 'action=top_left' },\n                              label: 'Top Left',\n                              color: '#ff0000'\n                            },\n                            {\n                              id: 'test_top_right',\n                              bounds: { x: canvasImage.width - 100, y: 0, width: 100, height: 100 },\n                              action: { type: 'postback', data: 'action=top_right' },\n                              label: 'Top Right',\n                              color: '#00ff00'\n                            },\n                            {\n                              id: 'test_bottom_left',\n                              bounds: { x: 0, y: canvasImage.height - 100, width: 100, height: 100 },\n                              action: { type: 'postback', data: 'action=bottom_left' },\n                              label: 'Bottom Left',\n                              color: '#0000ff'\n                            },\n                            {\n                              id: 'test_bottom_right',\n                              bounds: { x: canvasImage.width - 100, y: canvasImage.height - 100, width: 100, height: 100 },\n                              action: { type: 'postback', data: 'action=bottom_right' },\n                              label: 'Bottom Right',\n                              color: '#ffff00'\n                            }\n                          ];\n                          setHotspots(testHotspots);\n                          drawCanvas();\n                          console.log('Created corner test hotspots:', testHotspots);\n                        }\n                      }}\n                      startIcon={<Add />}\n                    >\n                      Test Corner Hotspots\n                    </Button>\n                    <Button \n                      variant=\"outlined\" \n                      size=\"small\"\n                      onClick={() => setDrawingState({\n                        ...drawingState,\n                        zoom: 1,\n                        pan: { x: 0, y: 0 }\n                      })}\n                    >\n                      Reset View\n                    </Button>\n                    <Button \n                      variant={drawingState.zoomLocked ? \"contained\" : \"outlined\"}\n                      size=\"small\"\n                      color={drawingState.zoomLocked ? \"warning\" : \"primary\"}\n                      onClick={toggleZoomLock}\n                      startIcon={drawingState.zoomLocked ? <Lock /> : <LockOpen />}\n                    >\n                      {drawingState.zoomLocked ? \"Unlock Zoom\" : \"Lock Zoom\"}\n                    </Button>\n                    <FormControl size=\"small\" sx={{ minWidth: 120 }}>\n                      <InputLabel>Grid Size</InputLabel>\n                      <Select\n                        value={drawingState.gridSize}\n                        onChange={(e) => setDrawingState({\n                          ...drawingState,\n                          gridSize: e.target.value as number\n                        })}\n                        label=\"Grid Size\"\n                      >\n                        <MenuItem value={50}>50px</MenuItem>\n                        <MenuItem value={100}>100px</MenuItem>\n                        <MenuItem value={200}>200px</MenuItem>\n                        <MenuItem value={500}>500px</MenuItem>\n                      </Select>\n                    </FormControl>\n                    <FormControlLabel\n                      control={\n                        <Switch\n                          checked={drawingState.gridSnap}\n                          onChange={(e: React.ChangeEvent<HTMLInputElement>) => setDrawingState({\n                            ...drawingState,\n                            gridSnap: e.target.checked\n                          })}\n                          size=\"small\"\n                        />\n                      }\n                      label=\"Grid Snap\"\n                      sx={{ ml: 1 }}\n                    />\n                    <FormControlLabel\n                      control={\n                        <Switch\n                          checked={drawingState.showGrid}\n                          onChange={(e: React.ChangeEvent<HTMLInputElement>) => setDrawingState({\n                            ...drawingState,\n                            showGrid: e.target.checked\n                          })}\n                          size=\"small\"\n                        />\n                      }\n                      label=\"Show Grid\"\n                    />\n                    <FormControlLabel\n                      control={\n                        <Switch\n                          checked={drawingState.zoomLocked}\n                          onChange={(e: React.ChangeEvent<HTMLInputElement>) => setDrawingState({\n                            ...drawingState,\n                            zoomLocked: e.target.checked\n                          })}\n                          size=\"small\"\n                        />\n                      }\n                      label=\"Lock Zoom\"\n                    />\n                    <FormControlLabel\n                      control={\n                        <Switch\n                          checked={highTransparency}\n                          onChange={(e: React.ChangeEvent<HTMLInputElement>) => {\n                            setHighTransparency(e.target.checked);\n                            scheduleCanvasRender();\n                          }}\n                          size=\"small\"\n                        />\n                      }\n                      label=\"High Transparency\"\n                    />\n                  </Box>\n                </Grid>\n              )}\n\n              <Grid item xs={12}>\n                <Box sx={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', mb: 2 }}>\n                  <Typography variant=\"h6\">Hotspots ({hotspots.length})</Typography>\n                </Box>\n                \n                {hotspots.length === 0 ? (\n                  <Alert severity=\"info\">\n                    {backgroundImageUrl \n                      ? \"No hotspots drawn yet. Click and drag on the image above to create hotspots.\"\n                      : \"Upload a background image first to start drawing hotspots.\"\n                    }\n                  </Alert>\n                ) : (\n                  <Grid container spacing={1}>\n                    {hotspots.map((hotspot) => (\n                      <Grid item xs={12} sm={6} md={4} key={hotspot.id}>\n                        <Card>\n                          <CardContent>\n                            <Box sx={{ display: 'flex', alignItems: 'center', mb: 1 }}>\n                              <Box \n                                sx={{ \n                                  width: 16, \n                                  height: 16, \n                                  backgroundColor: hotspot.color, \n                                  borderRadius: 1,\n                                  mr: 1\n                                }} \n                              />\n                              <Typography variant=\"subtitle2\">{hotspot.label}</Typography>\n                            </Box>\n                            <Typography variant=\"caption\" color=\"textSecondary\">\n                              {hotspot.action.type} - {Math.round(hotspot.bounds.width)}x{Math.round(hotspot.bounds.height)}\n                              {hotspot.action.data && ` | Data: ${hotspot.action.data.substring(0, 20)}${hotspot.action.data.length > 20 ? '...' : ''}`}\n                              {hotspot.action.text && ` | Text: ${hotspot.action.text.substring(0, 20)}${hotspot.action.text.length > 20 ? '...' : ''}`}\n                              {hotspot.action.uri && ` | URI: ${hotspot.action.uri.substring(0, 20)}${hotspot.action.uri.length > 20 ? '...' : ''}`}\n                            </Typography>\n                          </CardContent>\n                          <CardActions>\n                            <IconButton size=\"small\" onClick={() => {\n                              setEditingHotspot(hotspot);\n                              setHotspotDialogOpen(true);\n                            }}>\n                              <Edit />\n                            </IconButton>\n                            <IconButton size=\"small\" onClick={() => handleHotspotDelete(hotspot.id)}>\n                              <Delete />\n                            </IconButton>\n                            <Button \n                              size=\"small\" \n                              variant=\"outlined\" \n                              color=\"error\"\n                              onClick={() => handleHotspotDelete(hotspot.id)}\n                              sx={{ ml: 'auto' }}\n                            >\n                              Delete\n                            </Button>\n                          </CardActions>\n                        </Card>\n                      </Grid>\n                    ))}\n                  </Grid>\n                )}\n              </Grid>\n            </Grid>\n          )}\n\n          {createMode === 'template' && (\n            <Grid container spacing={2}>\n              <Grid item xs={12}>\n                <Typography variant=\"h6\" gutterBottom>Select a Template</Typography>\n                <Grid container spacing={2}>\n                  {richMenuTemplates.map((template) => (\n                    <Grid item xs={12} md={4} key={template.name}>\n                      <Card>\n                        <CardContent>\n                          <Typography variant=\"h6\">{template.name}</Typography>\n                          <Typography variant=\"body2\" color=\"textSecondary\" sx={{ mb: 2 }}>\n                            {template.description}\n                          </Typography>\n                          <Typography variant=\"caption\">\n                            Size: {template.size.width}x{template.size.height} | Buttons: {template.areas.length}\n                          </Typography>\n                        </CardContent>\n                        <CardActions>\n                          <Button \n                            size=\"small\" \n                            variant=\"contained\"\n                            onClick={() => handleTemplateSelect(template)}\n                          >\n                            Use Template\n                          </Button>\n                        </CardActions>\n                      </Card>\n                    </Grid>\n                  ))}\n                </Grid>\n              </Grid>\n              \n              {buttons.length > 0 && (\n                <Grid item xs={12}>\n                  <Typography variant=\"h6\" gutterBottom>Template Preview</Typography>\n                  <TextField\n                    fullWidth\n                    label=\"Rich Menu Name\"\n                    value={richMenuForm.name}\n                    onChange={(e) => setRichMenuForm({...richMenuForm, name: e.target.value})}\n                    margin=\"normal\"\n                  />\n                  <TextField\n                    fullWidth\n                    label=\"Chat Bar Text\"\n                    value={richMenuForm.chatBarText}\n                    onChange={(e) => setRichMenuForm({...richMenuForm, chatBarText: e.target.value})}\n                    placeholder=\"Text shown in chat bar when rich menu is active\"\n                    helperText=\"This text appears in the chat input area when the rich menu is displayed\"\n                    margin=\"normal\"\n                  />\n                  <FormControlLabel\n                    control={\n                      <Switch\n                        checked={richMenuForm.displayByDefault}\n                        onChange={(e) => setRichMenuForm({...richMenuForm, displayByDefault: e.target.checked})}\n                      />\n                    }\n                    label=\"Display by Default\"\n                  />\n                  <Typography variant=\"body2\" color=\"text.secondary\" sx={{ ml: 4, mt: 0.5 }}>\n                    When enabled, this rich menu will be displayed by default when users open the chat\n                  </Typography>\n                  <TextField\n                    fullWidth\n                    value={richMenuForm.body}\n                    multiline\n                    rows={6}\n                    margin=\"normal\"\n                    InputProps={{ readOnly: true }}\n                    label=\"Generated JSON\"\n                  />\n                </Grid>\n              )}\n            </Grid>\n          )}\n\n          {createMode === 'manual' && (\n            <Grid container spacing={2}>\n              <Grid item xs={12}>\n                <TextField\n                  fullWidth\n                  label=\"Rich Menu Name\"\n                  value={richMenuForm.name}\n                  onChange={(e) => setRichMenuForm({...richMenuForm, name: e.target.value})}\n                  placeholder=\"Enter rich menu name\"\n                  margin=\"normal\"\n                />\n              </Grid>\n              <Grid item xs={12}>\n                <TextField\n                  fullWidth\n                  label=\"Chat Bar Text\"\n                  value={richMenuForm.chatBarText}\n                  onChange={(e) => {\n                    const value = e.target.value;\n                    if (value.length <= 14) {\n                      setRichMenuForm({...richMenuForm, chatBarText: value});\n                    }\n                  }}\n                  placeholder=\"Text shown in chat bar when rich menu is active\"\n                  helperText={`${richMenuForm.chatBarText.length}/14 characters (LINE API limit) - This text appears in the chat input area when the rich menu is displayed`}\n                  margin=\"normal\"\n                  inputProps={{ maxLength: 14 }}\n                  error={richMenuForm.chatBarText.length > 14}\n                />\n              </Grid>\n              <Grid item xs={12}>\n                <FormControlLabel\n                  control={\n                    <Switch\n                      checked={richMenuForm.displayByDefault}\n                      onChange={(e) => setRichMenuForm({...richMenuForm, displayByDefault: e.target.checked})}\n                    />\n                  }\n                  label=\"Display by Default\"\n                />\n                <Typography variant=\"body2\" color=\"text.secondary\" sx={{ ml: 4, mt: 0.5 }}>\n                  When enabled, this rich menu will be displayed by default when users open the chat\n                </Typography>\n              </Grid>\n              <Grid item xs={12}>\n                <Box sx={{ display: 'flex', gap: 1, mb: 1 }}>\n                  <Typography variant=\"subtitle2\" sx={{ fontWeight: 600 }}>\n                    Rich Menu Body (JSON)\n                  </Typography>\n                  <Button\n                    size=\"small\"\n                    variant=\"outlined\"\n                    onClick={async () => {\n                      try {\n                        const richMenuData = JSON.parse(richMenuForm.body);\n                        const response = await autoCorrectRichMenu(richMenuData);\n                        if (response.data.success) {\n                          setRichMenuForm({\n                            ...richMenuForm,\n                            body: JSON.stringify(response.data.corrected_data, null, 2)\n                          });\n                          setSuccess('JSON auto-corrected successfully!');\n                        }\n                      } catch (err: any) {\n                        setError('Invalid JSON format. Please fix the JSON syntax first.');\n                      }\n                    }}\n                    sx={{ ml: 'auto' }}\n                  >\n                    Auto-Correct JSON\n                  </Button>\n                </Box>\n                <TextField\n                  fullWidth\n                  value={richMenuForm.body}\n                  onChange={(e) => setRichMenuForm({...richMenuForm, body: e.target.value})}\n                  multiline\n                  rows={8}\n                  placeholder='{\n  \"size\": { \"width\": 2500, \"height\": 1686 },\n  \"selected\": false,\n  \"name\": \"Rich Menu\",\n  \"chatBarText\": \"Tap to open\",\n  \"areas\": [\n    {\n      \"bounds\": { \"x\": 0, \"y\": 0, \"width\": 2500, \"height\": 1686 },\n      \"action\": { \"type\": \"postback\", \"data\": \"action=menu&item=main\" }\n    }\n  ]\n}'\n                  helperText=\"Complete JSON body sent to LINE API. Use Auto-Correct JSON to fix common format issues.\"\n                  margin=\"normal\"\n                />\n              </Grid>\n            </Grid>\n          )}\n\n          {createMode === 'import' && (\n            <Grid container spacing={2}>\n              <Grid item xs={12}>\n                <Typography variant=\"h6\" gutterBottom>Import Rich Menu JSON</Typography>\n                <Alert severity=\"info\" sx={{ mb: 2 }}>\n                  <Typography variant=\"body2\">\n                    <strong>Instructions:</strong>\n                    <br />\n                     Paste your rich menu JSON below\n                    <br />\n                     The hotspots will be displayed on the canvas\n                    <br />\n                     You can then edit, move, or modify the imported hotspots\n                  </Typography>\n                </Alert>\n              </Grid>\n              <Grid item xs={12}>\n                <TextField\n                  fullWidth\n                  label=\"Rich Menu JSON\"\n                  value={jsonImportText}\n                  onChange={(e) => setJsonImportText(e.target.value)}\n                  placeholder=\"Paste your rich menu JSON here...\"\n                  multiline\n                  rows={12}\n                  margin=\"normal\"\n                />\n              </Grid>\n              <Grid item xs={12}>\n                <Box sx={{ display: 'flex', gap: 2, flexWrap: 'wrap' }}>\n                  <Button\n                    variant=\"contained\"\n                    onClick={handleJsonImport}\n                    startIcon={<CloudUpload />}\n                    disabled={!jsonImportText.trim()}\n                  >\n                    Import & Display Hotspots\n                  </Button>\n                  <Button\n                    variant=\"outlined\"\n                    onClick={clearImportedHotspots}\n                    startIcon={<Delete />}\n                    disabled={!showImportedHotspots}\n                  >\n                    Clear Imported Hotspots\n                  </Button>\n                  <FormControlLabel\n                    control={\n                      <Switch\n                        checked={showImportedHotspots}\n                        onChange={(e) => setShowImportedHotspots(e.target.checked)}\n                        disabled={importedHotspots.length === 0}\n                      />\n                    }\n                    label=\"Show Imported Hotspots\"\n                  />\n                </Box>\n              </Grid>\n              {showImportedHotspots && importedHotspots.length > 0 && (\n                <Grid item xs={12}>\n                  <Alert severity=\"success\">\n                    <Typography variant=\"body2\">\n                      <strong>Imported {importedHotspots.length} hotspots!</strong>\n                      <br />\n                       Hotspots are displayed on the canvas with unique colors\n                      <br />\n                       You can now edit, move, or modify them\n                      <br />\n                       Use the \"Create Rich Menu\" button to create the final rich menu\n                    </Typography>\n                  </Alert>\n                </Grid>\n              )}\n            </Grid>\n          )}\n        </DialogContent>\n        <DialogActions>\n          <Button onClick={() => {\n            setCreateDialogOpen(false);\n            resetCreateForm();\n            setButtons([]);\n            setBackgroundImageUrl('');\n          }}>\n            Cancel\n          </Button>\n          <Button\n            onClick={() => {\n              console.log('Button clicked!');\n              console.log('createMode:', createMode);\n              console.log('creating:', creating);\n              console.log('richMenuForm.name:', richMenuForm.name);\n              console.log('hotspots.length:', hotspots.length);\n              console.log('Button disabled:', creating || !richMenuForm.name.trim() || (createMode === 'visual' && hotspots.length === 0));\n              \n              if (createMode === 'visual') {\n                handleCanvasCreate();\n              } else {\n                handleCreateRichMenu();\n              }\n            }}\n            variant=\"contained\"\n            disabled={creating || !richMenuForm.name.trim() || (createMode === 'visual' && (hotspots.length === 0 || !backgroundImageFile))}\n            startIcon={creating ? <CircularProgress size={16} /> : <Add />}\n          >\n            {creating ? 'Creating...' : 'Create Rich Menu'}\n          </Button>\n        </DialogActions>\n      </Dialog>\n\n      {/* Upload Image Dialog */}\n      <Dialog open={uploadDialogOpen} onClose={() => setUploadDialogOpen(false)} maxWidth=\"sm\" fullWidth>\n        <DialogTitle>\n          {selectedRichMenuForUpload?.hasImage ? 'Change Rich Menu Image' : 'Upload Rich Menu Image'}\n        </DialogTitle>\n        <DialogContent>\n          {selectedRichMenuForUpload && (\n            <Box sx={{ mb: 2 }}>\n              <Typography variant=\"subtitle2\" sx={{ fontWeight: 600 }}>\n                Rich Menu: {selectedRichMenuForUpload.name}\n              </Typography>\n              <Typography variant=\"body2\" color=\"text.secondary\">\n                ID: {selectedRichMenuForUpload.richMenuId}\n              </Typography>\n            </Box>\n          )}\n          \n          <Typography variant=\"subtitle2\" sx={{ fontWeight: 600, mb: 1, color: 'error.main' }}>\n            * Rich Menu Image (Required)\n          </Typography>\n          {selectedRichMenuForUpload?.hasImage && (\n            <Alert severity=\"warning\" sx={{ mb: 2 }}>\n              <Typography variant=\"body2\">\n                <strong>Note:</strong> Changing the image will create a new rich menu with a new ID. \n                The old rich menu will be deleted from LINE. If this rich menu was set as default, \n                the new rich menu will automatically be set as default.\n              </Typography>\n            </Alert>\n          )}\n          <Box sx={{ display: 'flex', alignItems: 'center', gap: 1, mb: 2 }}>\n            <input\n              accept=\"image/*\"\n              style={{ display: 'none' }}\n              id=\"upload-rich-menu-image\"\n              type=\"file\"\n              onChange={handleFileSelect}\n            />\n            <label htmlFor=\"upload-rich-menu-image\">\n              <Button\n                variant=\"outlined\"\n                component=\"span\"\n                startIcon={<CloudUpload />}\n                color={selectedFile ? \"success\" : \"primary\"}\n              >\n                {selectedFile ? 'Select New Image' : 'Select Image'}\n              </Button>\n            </label>\n            {selectedFile && (\n              <Typography variant=\"body2\" color=\"success.main\" sx={{ fontWeight: 600 }}>\n                 {selectedFile.name} ({Math.round(selectedFile.size / 1024)}KB)\n              </Typography>\n            )}\n            {!selectedFile && (\n              <Typography variant=\"body2\" color=\"error.main\">\n                Image is required for rich menu to function\n              </Typography>\n            )}\n          </Box>\n\n          <Alert severity=\"info\">\n            <Typography variant=\"body2\">\n              <strong>Image Requirements:</strong>\n              <br />\n               Supported formats: PNG, JPEG, GIF\n              <br />\n               Recommended size: {selectedRichMenuForUpload?.size.width}{selectedRichMenuForUpload?.size.height} pixels\n              <br />\n               File size: Up to 1MB\n            </Typography>\n          </Alert>\n        </DialogContent>\n        <DialogActions>\n          <Button onClick={() => {\n            setUploadDialogOpen(false);\n            setSelectedFile(null);\n          }}>\n            Cancel\n          </Button>\n          <Button\n            onClick={async () => {\n              if (selectedRichMenuForUpload && selectedFile) {\n                await handleUploadImage(selectedRichMenuForUpload.richMenuId);\n                setUploadDialogOpen(false);\n                setSelectedFile(null);\n                setSelectedRichMenuForUpload(null);\n              }\n            }}\n            variant=\"contained\"\n            disabled={!selectedFile}\n            startIcon={uploadingImage ? <CircularProgress size={16} /> : <CloudUpload />}\n          >\n            {uploadingImage ? 'Processing...' : (selectedRichMenuForUpload?.hasImage ? 'Change Image' : 'Upload Image')}\n          </Button>\n        </DialogActions>\n      </Dialog>\n\n      {/* Button Editor Dialog */}\n      <Dialog open={buttonDialogOpen} onClose={() => setButtonDialogOpen(false)} maxWidth=\"md\" fullWidth>\n        <DialogTitle>\n          {editingButton ? 'Edit Button' : 'Add Button'}\n        </DialogTitle>\n        <DialogContent>\n          <Grid container spacing={2}>\n            <Grid item xs={12}>\n              <TextField\n                fullWidth\n                label=\"Button Label\"\n                value={editingButton?.label || ''}\n                onChange={(e) => setEditingButton(editingButton ? {...editingButton, label: e.target.value} : null)}\n                placeholder=\"Enter button label\"\n                margin=\"normal\"\n              />\n            </Grid>\n            \n            <Grid item xs={12}>\n              <Typography variant=\"h6\" gutterBottom>Button Position & Size</Typography>\n              <Grid container spacing={2}>\n                <Grid item xs={3}>\n                  <TextField\n                    fullWidth\n                    label=\"X Position\"\n                    type=\"number\"\n                    value={editingButton?.bounds.x || 0}\n                    onChange={(e) => setEditingButton(editingButton ? {\n                      ...editingButton, \n                      bounds: {...editingButton.bounds, x: parseInt(e.target.value) || 0}\n                    } : null)}\n                    margin=\"normal\"\n                  />\n                </Grid>\n                <Grid item xs={3}>\n                  <TextField\n                    fullWidth\n                    label=\"Y Position\"\n                    type=\"number\"\n                    value={editingButton?.bounds.y || 0}\n                    onChange={(e) => setEditingButton(editingButton ? {\n                      ...editingButton, \n                      bounds: {...editingButton.bounds, y: parseInt(e.target.value) || 0}\n                    } : null)}\n                    margin=\"normal\"\n                  />\n                </Grid>\n                <Grid item xs={3}>\n                  <TextField\n                    fullWidth\n                    label=\"Width\"\n                    type=\"number\"\n                    value={editingButton?.bounds.width || 200}\n                    onChange={(e) => setEditingButton(editingButton ? {\n                      ...editingButton, \n                      bounds: {...editingButton.bounds, width: parseInt(e.target.value) || 200}\n                    } : null)}\n                    margin=\"normal\"\n                  />\n                </Grid>\n                <Grid item xs={3}>\n                  <TextField\n                    fullWidth\n                    label=\"Height\"\n                    type=\"number\"\n                    value={editingButton?.bounds.height || 100}\n                    onChange={(e) => setEditingButton(editingButton ? {\n                      ...editingButton, \n                      bounds: {...editingButton.bounds, height: parseInt(e.target.value) || 100}\n                    } : null)}\n                    margin=\"normal\"\n                  />\n                </Grid>\n              </Grid>\n            </Grid>\n\n            <Grid item xs={12}>\n              <Typography variant=\"h6\" gutterBottom>Button Action</Typography>\n              <FormControl fullWidth margin=\"normal\">\n                <InputLabel>Action Type</InputLabel>\n                <Select\n                  value={editingButton?.action.type || 'postback'}\n                  onChange={(e) => setEditingButton(editingButton ? {\n                    ...editingButton,\n                    action: { ...editingButton.action, type: e.target.value as any }\n                  } : null)}\n                >\n                  <MenuItem value=\"postback\">Postback</MenuItem>\n                  <MenuItem value=\"message\">Message</MenuItem>\n                  <MenuItem value=\"uri\">URI</MenuItem>\n                  <MenuItem value=\"richmenuswitch\">Rich Menu Switch</MenuItem>\n                </Select>\n              </FormControl>\n            </Grid>\n\n            {editingButton?.action.type === 'postback' && (\n              <Grid item xs={12}>\n                <TextField\n                  fullWidth\n                  label=\"Postback Data\"\n                  value={editingButton.action.data || ''}\n                  onChange={(e) => setEditingButton(editingButton ? {\n                    ...editingButton,\n                    action: { ...editingButton.action, data: e.target.value }\n                  } : null)}\n                  placeholder=\"action=menu&item=1\"\n                  margin=\"normal\"\n                />\n              </Grid>\n            )}\n\n            {editingButton?.action.type === 'message' && (\n              <Grid item xs={12}>\n                <TextField\n                  fullWidth\n                  label=\"Message Text\"\n                  value={editingButton.action.text || ''}\n                  onChange={(e) => setEditingButton(editingButton ? {\n                    ...editingButton,\n                    action: { ...editingButton.action, text: e.target.value }\n                  } : null)}\n                  placeholder=\"Hello, world!\"\n                  margin=\"normal\"\n                />\n              </Grid>\n            )}\n\n            {editingButton?.action.type === 'uri' && (\n              <Grid item xs={12}>\n                <TextField\n                  fullWidth\n                  label=\"URI\"\n                  value={editingButton.action.uri || ''}\n                  onChange={(e) => setEditingButton(editingButton ? {\n                    ...editingButton,\n                    action: { ...editingButton.action, uri: e.target.value }\n                  } : null)}\n                  placeholder=\"https://example.com\"\n                  margin=\"normal\"\n                />\n              </Grid>\n            )}\n\n            {editingButton?.action.type === 'richmenuswitch' && (\n              <>\n                <Grid item xs={6}>\n                  <TextField\n                    fullWidth\n                    label=\"Rich Menu Alias ID\"\n                    value={editingButton.action.richMenuAliasId || ''}\n                    onChange={(e) => setEditingButton(editingButton ? {\n                      ...editingButton,\n                      action: { ...editingButton.action, richMenuAliasId: e.target.value }\n                    } : null)}\n                    placeholder=\"menu-main\"\n                    margin=\"normal\"\n                    helperText=\"1-40 characters, alphanumeric and hyphens only (LINE API requirement)\"\n                    error={editingButton.action.richMenuAliasId ? !validateRichMenuAliasId(editingButton.action.richMenuAliasId) : false}\n                  />\n                </Grid>\n                <Grid item xs={6}>\n                  <TextField\n                    fullWidth\n                    label=\"Switch Data\"\n                    value={editingButton.action.data || ''}\n                    onChange={(e) => setEditingButton(editingButton ? {\n                      ...editingButton,\n                      action: { ...editingButton.action, data: e.target.value }\n                    } : null)}\n                    placeholder=\"change-to-menu\"\n                    margin=\"normal\"\n                  />\n                </Grid>\n              </>\n            )}\n          </Grid>\n        </DialogContent>\n        <DialogActions>\n          <Button onClick={() => setButtonDialogOpen(false)}>Cancel</Button>\n          <Button \n            onClick={() => editingButton && handleHotspotSave(editingButton as any)}\n            variant=\"contained\"\n            disabled={!editingButton?.label?.trim()}\n          >\n            Save Button\n          </Button>\n        </DialogActions>\n      </Dialog>\n\n      {/* Hotspot Editor Dialog */}\n      <Dialog open={hotspotDialogOpen} onClose={() => setHotspotDialogOpen(false)} maxWidth=\"md\" fullWidth>\n        <DialogTitle>\n          {editingHotspot ? 'Edit Hotspot' : 'Add Hotspot'}\n        </DialogTitle>\n        <DialogContent>\n          <Grid container spacing={2}>\n            <Grid item xs={12}>\n              <TextField\n                fullWidth\n                label=\"Hotspot Label\"\n                value={editingHotspot?.label || ''}\n                onChange={(e) => setEditingHotspot(editingHotspot ? {\n                  ...editingHotspot,\n                  label: e.target.value\n                } : null)}\n                placeholder=\"Enter hotspot label\"\n                margin=\"normal\"\n              />\n            </Grid>\n            <Grid item xs={12}>\n              <Typography variant=\"h6\" gutterBottom>Hotspot Position & Size</Typography>\n              <Grid container spacing={2}>\n                <Grid item xs={3}>\n                  <TextField\n                    fullWidth\n                    label=\"X Position\"\n                    type=\"number\"\n                    value={editingHotspot?.bounds.x || 0}\n                    onChange={(e) => setEditingHotspot(editingHotspot ? {\n                      ...editingHotspot, \n                      bounds: {...editingHotspot.bounds, x: parseInt(e.target.value) || 0}\n                    } : null)}\n                    margin=\"normal\"\n                  />\n                </Grid>\n                <Grid item xs={3}>\n                  <TextField\n                    fullWidth\n                    label=\"Y Position\"\n                    type=\"number\"\n                    value={editingHotspot?.bounds.y || 0}\n                    onChange={(e) => setEditingHotspot(editingHotspot ? {\n                      ...editingHotspot, \n                      bounds: {...editingHotspot.bounds, y: parseInt(e.target.value) || 0}\n                    } : null)}\n                    margin=\"normal\"\n                  />\n                </Grid>\n                <Grid item xs={3}>\n                  <TextField\n                    fullWidth\n                    label=\"Width\"\n                    type=\"number\"\n                    value={editingHotspot?.bounds.width || 100}\n                    onChange={(e) => setEditingHotspot(editingHotspot ? {\n                      ...editingHotspot, \n                      bounds: {...editingHotspot.bounds, width: parseInt(e.target.value) || 100}\n                    } : null)}\n                    margin=\"normal\"\n                  />\n                </Grid>\n                <Grid item xs={3}>\n                  <TextField\n                    fullWidth\n                    label=\"Height\"\n                    type=\"number\"\n                    value={editingHotspot?.bounds.height || 100}\n                    onChange={(e) => setEditingHotspot(editingHotspot ? {\n                      ...editingHotspot, \n                      bounds: {...editingHotspot.bounds, height: parseInt(e.target.value) || 100}\n                    } : null)}\n                    margin=\"normal\"\n                  />\n                </Grid>\n              </Grid>\n            </Grid>\n\n            <Grid item xs={12}>\n              <Typography variant=\"h6\" gutterBottom>Hotspot Action</Typography>\n              <FormControl fullWidth margin=\"normal\">\n                <InputLabel>Action Type</InputLabel>\n                <Select\n                  value={editingHotspot?.action.type || 'postback'}\n                  onChange={(e) => setEditingHotspot(editingHotspot ? {\n                    ...editingHotspot,\n                    action: { ...editingHotspot.action, type: e.target.value as any }\n                  } : null)}\n                >\n                  <MenuItem value=\"postback\">Postback</MenuItem>\n                  <MenuItem value=\"message\">Message</MenuItem>\n                  <MenuItem value=\"uri\">URI</MenuItem>\n                  <MenuItem value=\"richmenuswitch\">Rich Menu Switch</MenuItem>\n                </Select>\n              </FormControl>\n            </Grid>\n\n            {editingHotspot?.action.type === 'postback' && (\n              <Grid item xs={12}>\n                <TextField\n                  fullWidth\n                  label=\"Postback Data\"\n                  value={editingHotspot.action.data || ''}\n                  onChange={(e) => setEditingHotspot(editingHotspot ? {\n                    ...editingHotspot,\n                    action: { ...editingHotspot.action, data: e.target.value }\n                  } : null)}\n                  placeholder=\"action=menu&item=1\"\n                  margin=\"normal\"\n                />\n              </Grid>\n            )}\n\n            {editingHotspot?.action.type === 'message' && (\n              <Grid item xs={12}>\n                <TextField\n                  fullWidth\n                  label=\"Message Text\"\n                  value={editingHotspot.action.text || ''}\n                  onChange={(e) => setEditingHotspot(editingHotspot ? {\n                    ...editingHotspot,\n                    action: { ...editingHotspot.action, text: e.target.value }\n                  } : null)}\n                  placeholder=\"Hello, world!\"\n                  margin=\"normal\"\n                />\n              </Grid>\n            )}\n\n            {editingHotspot?.action.type === 'uri' && (\n              <Grid item xs={12}>\n                <TextField\n                  fullWidth\n                  label=\"URI\"\n                  value={editingHotspot.action.uri || ''}\n                  onChange={(e) => {\n                    let uri = e.target.value;\n                    // Auto-add https:// if no protocol is specified\n                    if (uri && !uri.match(/^https?:\\/\\//)) {\n                      uri = `https://${uri}`;\n                    }\n                    setEditingHotspot(editingHotspot ? {\n                      ...editingHotspot,\n                      action: { ...editingHotspot.action, uri: uri }\n                    } : null);\n                  }}\n                  placeholder=\"https://example.com\"\n                  margin=\"normal\"\n                  helperText=\"Must start with http:// or https://\"\n                  error={Boolean(editingHotspot?.action.uri && editingHotspot.action.uri !== '' && !editingHotspot.action.uri.match(/^https?:\\/\\//))}\n                />\n              </Grid>\n            )}\n\n            {editingHotspot?.action.type === 'richmenuswitch' && (\n              <>\n                <Grid item xs={6}>\n                  <TextField\n                    fullWidth\n                    label=\"Rich Menu Alias ID\"\n                    value={editingHotspot.action.richMenuAliasId || ''}\n                    onChange={(e) => setEditingHotspot(editingHotspot ? {\n                      ...editingHotspot,\n                      action: { ...editingHotspot.action, richMenuAliasId: e.target.value }\n                    } : null)}\n                    placeholder=\"menu-main\"\n                    margin=\"normal\"\n                    helperText=\"1-40 characters, alphanumeric and hyphens only (LINE API requirement)\"\n                    error={editingHotspot.action.richMenuAliasId ? !validateRichMenuAliasId(editingHotspot.action.richMenuAliasId) : false}\n                  />\n                </Grid>\n                <Grid item xs={6}>\n                  <TextField\n                    fullWidth\n                    label=\"Switch Data\"\n                    value={editingHotspot.action.data || ''}\n                    onChange={(e) => setEditingHotspot(editingHotspot ? {\n                      ...editingHotspot,\n                      action: { ...editingHotspot.action, data: e.target.value }\n                    } : null)}\n                    placeholder=\"change-to-menu\"\n                    margin=\"normal\"\n                  />\n                </Grid>\n              </>\n            )}\n          </Grid>\n        </DialogContent>\n        <DialogActions>\n          <Button onClick={() => setHotspotDialogOpen(false)}>Cancel</Button>\n          <Button \n            onClick={() => editingHotspot && handleHotspotSave(editingHotspot)}\n            variant=\"contained\"\n            disabled={!editingHotspot?.label?.trim()}\n          >\n            Save Hotspot\n          </Button>\n          {editingHotspot && (\n            <Button \n              onClick={() => handleHotspotDelete(editingHotspot.id)}\n              variant=\"outlined\"\n              color=\"error\"\n              startIcon={<Delete />}\n            >\n              Delete Hotspot\n            </Button>\n          )}\n        </DialogActions>\n      </Dialog>\n\n      {/* Context Menu */}\n      <Menu\n        open={contextMenu !== null}\n        onClose={handleCloseContextMenu}\n        anchorReference=\"anchorPosition\"\n        anchorPosition={\n          contextMenu !== null\n            ? { top: contextMenu.mouseY, left: contextMenu.mouseX }\n            : undefined\n        }\n      >\n        <MenuItem onClick={() => contextMenu?.hotspot && handleMoveHotspot(contextMenu.hotspot.id)}>\n          <ListItemIcon>\n            <DragIndicator fontSize=\"small\" />\n          </ListItemIcon>\n          <ListItemText>Move Hotspot</ListItemText>\n        </MenuItem>\n        <MenuItem onClick={() => contextMenu?.hotspot && handleDeleteHotspot(contextMenu.hotspot.id)}>\n          <ListItemIcon>\n            <Delete fontSize=\"small\" />\n          </ListItemIcon>\n          <ListItemText>Delete Hotspot</ListItemText>\n        </MenuItem>\n      </Menu>\n    </Box>\n  );\n};\n\nexport default RichMenuManager;\n"],"mappings":"6IAAA,MAAO,CAAAA,KAAK,EAAIC,QAAQ,CAAEC,SAAS,CAAEC,MAAM,KAAQ,OAAO,CAC1D,OACEC,GAAG,CACHC,MAAM,CACNC,MAAM,CACNC,WAAW,CACXC,aAAa,CACbC,aAAa,CACbC,SAAS,CACTC,UAAU,CACVC,KAAK,CACLC,IAAI,CACJC,UAAU,CACVC,IAAI,CACJC,KAAK,CACLC,KAAK,CACLC,SAAS,CACTC,SAAS,CACTC,cAAc,CACdC,SAAS,CACTC,QAAQ,CACRC,IAAI,CACJC,QAAQ,CACRC,YAAY,CACZC,uBAAuB,CACvBC,OAAO,CACPC,IAAI,CACJC,GAAG,CACHC,IAAI,CACJC,WAAW,CACXC,WAAW,CACXC,WAAW,CACXC,UAAU,CACVC,MAAM,CACNC,QAAQ,CACRC,gBAAgB,CAChBC,MAAM,CACNC,SAAS,CACTC,gBAAgB,CAChBC,gBAAgB,CAChBC,gBAAgB,CAChBC,IAAI,CACJC,YAAY,KACP,eAAe,CACtB,OACEC,GAAG,CACHC,MAAM,CACNC,IAAI,CACJC,IAAI,CACJC,UAAU,CACVC,OAAO,CACPC,UAAU,CACVC,KAAK,CACLC,KAAK,CACLC,IAAI,CACJC,OAAO,CACPC,UAAU,CACVC,OAAO,CACPC,MAAM,CACNC,WAAW,CACXC,UAAU,CACVC,IAAI,CACJC,QAAQ,CACRC,KAAK,CACLC,IAAI,CACJC,aAAa,CACbC,IAAI,CACJC,UAAU,CACVC,QAAQ,CACRC,KAAK,GAAI,CAAAC,SAAS,KACb,qBAAqB,CAC5B,OAASC,YAAY,CAAEC,kBAAkB,CAAEC,cAAc,CAAEC,mBAAmB,CAAEC,kBAAkB,CAAEC,oBAAoB,CAAEC,cAAc,CAAEC,mBAAmB,CAAEC,gBAAgB,CAAEC,mBAAmB,CAAEC,kBAAkB,CAAEC,mBAAmB,CAAEC,wBAAwB,CAAEC,mBAAmB,CAAEC,oBAAoB,CAAEC,mBAAmB,CAAEC,sBAAsB,CAAEC,mBAAmB,KAAQ,WAAW,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,CAAAC,QAAA,IAAAC,SAAA,yBAmHxY;AACA,KAAM,CAAAC,oBAAoB,CAAG,CAC3BC,IAAI,CAAE,CAAEC,KAAK,CAAE,IAAI,CAAEC,MAAM,CAAE,IAAI,CAAEC,KAAK,CAAE,yBAA0B,CAAC,CACrEC,IAAI,CAAE,CAAEH,KAAK,CAAE,IAAI,CAAEC,MAAM,CAAE,GAAG,CAAEC,KAAK,CAAE,wBAAyB,CACpE,CAAC,CAED,KAAM,CAAAE,eAAyB,CAAGA,CAAA,GAAM,KAAAC,qBAAA,CAAAC,sBAAA,CAAAC,sBAAA,CAAAC,sBAAA,CAAAC,sBAAA,CAAAC,sBAAA,CAAAC,sBAAA,CAAAC,sBAAA,CAAAC,uBAAA,CAAAC,uBAAA,CAAAC,uBAAA,CAAAC,uBAAA,CAAAC,uBAAA,CAAAC,uBAAA,CAAAC,uBAAA,CAAAC,uBAAA,CAAAC,uBAAA,CAAAC,uBAAA,CAAAC,uBAAA,CAAAC,uBAAA,CAAAC,uBAAA,CAAAC,uBAAA,CAAAC,uBAAA,CAAAC,oBAAA,CAAAC,qBAAA,CACtC,KAAM,CAACC,SAAS,CAAEC,YAAY,CAAC,CAAG/H,QAAQ,CAAa,EAAE,CAAC,CAC1D,KAAM,CAACgI,eAAe,CAAEC,kBAAkB,CAAC,CAAGjI,QAAQ,CAAkB,EAAE,CAAC,CAC3E,KAAM,CAACkI,OAAO,CAAEC,UAAU,CAAC,CAAGnI,QAAQ,CAAC,KAAK,CAAC,CAC7C,KAAM,CAACoI,KAAK,CAAEC,QAAQ,CAAC,CAAGrI,QAAQ,CAAgB,IAAI,CAAC,CACvD,KAAM,CAACsI,OAAO,CAAEC,UAAU,CAAC,CAAGvI,QAAQ,CAAgB,IAAI,CAAC,CAG3D;AACA,KAAM,CAACwI,gBAAgB,CAAEC,mBAAmB,CAAC,CAAGzI,QAAQ,CAAC,KAAK,CAAC,CAC/D,KAAM,CAAC0I,gBAAgB,CAAEC,mBAAmB,CAAC,CAAG3I,QAAQ,CAAkB,IAAI,CAAC,CAC/E,KAAM,CAAC4I,MAAM,CAAEC,SAAS,CAAC,CAAG7I,QAAQ,CAAC,EAAE,CAAC,CACxC,KAAM,CAAC8I,SAAS,CAAEC,YAAY,CAAC,CAAG/I,QAAQ,CAAC,KAAK,CAAC,CAEjD;AACA,KAAM,CAACgJ,oBAAoB,CAAEC,uBAAuB,CAAC,CAAGjJ,QAAQ,CAAoC,MAAM,CAAC,CAE3G;AACA,KAAM,CAAAkJ,uBAAuB,CAAIC,OAAe,EAAc,CAC5D,GAAI,CAACA,OAAO,EAAIA,OAAO,CAACC,MAAM,GAAK,CAAC,CAAE,MAAO,MAAK,CAClD,GAAID,OAAO,CAACC,MAAM,CAAG,EAAE,CAAE,MAAO,MAAK,CACrC;AACA,MAAO,kBAAiB,CAACC,IAAI,CAACF,OAAO,CAAC,CACxC,CAAC,CAED;AACA,KAAM,CAAAG,wBAAwB,CAAIC,OAA0C,EAAK,CAC/EN,uBAAuB,CAACM,OAAO,CAAC,CAChC;AACA,GAAIC,mBAAmB,EAAIC,WAAW,CAAE,CACtC,KAAM,CAAAC,GAAG,CAAGD,WAAW,CACvB,KAAM,CAAAE,MAAM,CAAGC,SAAS,CAACC,OAAO,CAChC,GAAIF,MAAM,CAAE,CACV;AACA,KAAM,CAAAG,YAAY,CAAGhE,oBAAoB,CAACyD,OAAO,CAAC,CAClD,KAAM,CAAAQ,WAAW,CAAGD,YAAY,CAAC9D,KAAK,CACtC,KAAM,CAAAgE,YAAY,CAAGF,YAAY,CAAC7D,MAAM,CACxC,KAAM,CAAAgE,iBAAiB,CAAGF,WAAW,CAAGC,YAAY,CAEpD;AACA,KAAM,CAAAE,cAAc,CAAG,GAAG,CAC1B,KAAM,CAAAC,eAAe,CAAG,GAAG,CAE3B,GAAI,CAAAC,WAAW,CAAEC,YAAY,CAE7B;AACA,GAAIJ,iBAAiB,CAAGC,cAAc,CAAGC,eAAe,CAAE,CACxD;AACAC,WAAW,CAAGF,cAAc,CAC5BG,YAAY,CAAGH,cAAc,CAAGD,iBAAiB,CACnD,CAAC,IAAM,CACL;AACAI,YAAY,CAAGF,eAAe,CAC9BC,WAAW,CAAGD,eAAe,CAAGF,iBAAiB,CACnD,CAEA;AACAN,MAAM,CAAC3D,KAAK,CAAGoE,WAAW,CAC1BT,MAAM,CAAC1D,MAAM,CAAGoE,YAAY,CAE5B;AACA,KAAM,CAAAC,MAAM,CAAGF,WAAW,CAAGV,GAAG,CAAC1D,KAAK,CACtC,KAAM,CAAAuE,MAAM,CAAGF,YAAY,CAAGX,GAAG,CAACzD,MAAM,CACxC,KAAM,CAAAuE,KAAK,CAAGC,IAAI,CAACC,GAAG,CAACJ,MAAM,CAAEC,MAAM,CAAC,CAEtC;AACA,KAAM,CAAAI,UAAU,CAAGjB,GAAG,CAAC1D,KAAK,CAAGwE,KAAK,CACpC,KAAM,CAAAI,WAAW,CAAGlB,GAAG,CAACzD,MAAM,CAAGuE,KAAK,CAEtC;AACA,KAAM,CAAAK,OAAO,CAAG,CAACT,WAAW,CAAGO,UAAU,EAAI,CAAC,CAC9C,KAAM,CAAAG,OAAO,CAAG,CAACT,YAAY,CAAGO,WAAW,EAAI,CAAC,CAEhD;AACAjB,MAAM,CAACoB,OAAO,CAACP,KAAK,CAAGA,KAAK,CAACQ,QAAQ,CAAC,CAAC,CACvCrB,MAAM,CAACoB,OAAO,CAACJ,UAAU,CAAGA,UAAU,CAACK,QAAQ,CAAC,CAAC,CACjDrB,MAAM,CAACoB,OAAO,CAACH,WAAW,CAAGA,WAAW,CAACI,QAAQ,CAAC,CAAC,CACnDrB,MAAM,CAACoB,OAAO,CAACF,OAAO,CAAGA,OAAO,CAACG,QAAQ,CAAC,CAAC,CAC3CrB,MAAM,CAACoB,OAAO,CAACD,OAAO,CAAGA,OAAO,CAACE,QAAQ,CAAC,CAAC,CAC3CrB,MAAM,CAACoB,OAAO,CAACE,UAAU,CAAGvB,GAAG,CAAC1D,KAAK,CAACgF,QAAQ,CAAC,CAAC,CAChDrB,MAAM,CAACoB,OAAO,CAACG,WAAW,CAAGxB,GAAG,CAACzD,MAAM,CAAC+E,QAAQ,CAAC,CAAC,CAElDG,OAAO,CAACC,GAAG,CAAC,wCAAwC,CAAEtB,YAAY,CAAC5D,KAAK,CAAC,CACzEiF,OAAO,CAACC,GAAG,CAAC,wBAAwB,CAAEhB,WAAW,CAAE,GAAG,CAAEC,YAAY,CAAC,CAErE;AACAgB,oBAAoB,CAAC,CAAC,CACxB,CACF,CACF,CAAC,CAED;AACA,KAAM,CAACC,qBAAqB,CAAEC,wBAAwB,CAAC,CAAGvL,QAAQ,CAAC,KAAK,CAAC,CACzE,KAAM,CAACwL,iBAAiB,CAAEC,oBAAoB,CAAC,CAAGzL,QAAQ,CAAQ,EAAE,CAAC,CACrE,KAAM,CAAC0L,wBAAwB,CAAEC,2BAA2B,CAAC,CAAG3L,QAAQ,CAAM,IAAI,CAAC,CACnF,KAAM,CAACmJ,OAAO,CAAEyC,UAAU,CAAC,CAAG5L,QAAQ,CAAC,EAAE,CAAC,CAC1C,KAAM,CAAC6L,aAAa,CAAEC,gBAAgB,CAAC,CAAG9L,QAAQ,CAAC,KAAK,CAAC,CAEzD;AACA,KAAM,CAAC+L,qBAAqB,CAAEC,wBAAwB,CAAC,CAAGhM,QAAQ,CAAC,KAAK,CAAC,CACzE,KAAM,CAACiM,sBAAsB,CAAEC,yBAAyB,CAAC,CAAGlM,QAAQ,CAAM,IAAI,CAAC,CAC/E,KAAM,CAACmM,yBAAyB,CAAEC,4BAA4B,CAAC,CAAGpM,QAAQ,CAAM,IAAI,CAAC,CACrF,KAAM,CAACqM,aAAa,CAAEC,gBAAgB,CAAC,CAAGtM,QAAQ,CAAC,KAAK,CAAC,CAEzD;AACA,KAAM,CAACuM,iBAAiB,CAAEC,oBAAoB,CAAC,CAAGxM,QAAQ,CAAC,KAAK,CAAC,CACjE,KAAM,CAACyM,0BAA0B,CAAEC,6BAA6B,CAAC,CAAG1M,QAAQ,CAAM,IAAI,CAAC,CACvF,KAAM,CAAC2M,eAAe,CAAEC,kBAAkB,CAAC,CAAG5M,QAAQ,CAAM,IAAI,CAAC,CACjE,KAAM,CAAC6M,cAAc,CAAEC,iBAAiB,CAAC,CAAG9M,QAAQ,CAAC,KAAK,CAAC,CAC3D,KAAM,CAAC+M,WAAW,CAAEC,cAAc,CAAC,CAAGhN,QAAQ,CAAC,KAAK,CAAC,CACrD,KAAM,CAACiN,eAAe,CAAEC,kBAAkB,CAAC,CAAGlN,QAAQ,CAAC,CAAEgG,KAAK,CAAE,CAAC,CAAEC,MAAM,CAAE,CAAE,CAAC,CAAC,CAE/E;AACA,KAAM,CAACkH,gBAAgB,CAAEC,mBAAmB,CAAC,CAAGpN,QAAQ,CAAC,KAAK,CAAC,CAC/D,KAAM,CAACqN,QAAQ,CAAEC,WAAW,CAAC,CAAGtN,QAAQ,CAAC,KAAK,CAAC,CAC/C,KAAM,CAACuN,YAAY,CAAEC,eAAe,CAAC,CAAGxN,QAAQ,CAAC,CAC/CyN,IAAI,CAAE,EAAE,CACRC,WAAW,CAAE,aAAa,CAC1BC,gBAAgB,CAAE,KAAK,CACvBC,IAAI,CAAEC,IAAI,CAACC,SAAS,CAAC,CACnBC,IAAI,CAAE,CAAE/H,KAAK,CAAE,IAAI,CAAEC,MAAM,CAAE,IAAK,CAAC,CACnC+H,QAAQ,CAAE,KAAK,CACfP,IAAI,CAAE,WAAW,CACjBC,WAAW,CAAE,aAAa,CAC1BO,KAAK,CAAE,CACL,CACEC,MAAM,CAAE,CAAEC,CAAC,CAAE,CAAC,CAAEC,CAAC,CAAE,CAAC,CAAEpI,KAAK,CAAE,IAAI,CAAEC,MAAM,CAAE,IAAK,CAAC,CACjDoI,MAAM,CAAE,CAAEC,IAAI,CAAE,UAAU,CAAEC,IAAI,CAAE,uBAAwB,CAC5D,CAAC,CAEL,CAAC,CAAE,IAAI,CAAE,CAAC,CACZ,CAAC,CAAC,CAEF;AACA,KAAM,CAACC,gBAAgB,CAAEC,mBAAmB,CAAC,CAAGzO,QAAQ,CAAC,KAAK,CAAC,CAC/D,KAAM,CAAC0O,cAAc,CAAEC,iBAAiB,CAAC,CAAG3O,QAAQ,CAAC,KAAK,CAAC,CAC3D,KAAM,CAAC4O,YAAY,CAAEC,eAAe,CAAC,CAAG7O,QAAQ,CAAc,IAAI,CAAC,CACnE,KAAM,CAAC8O,yBAAyB,CAAEC,4BAA4B,CAAC,CAAG/O,QAAQ,CAAkB,IAAI,CAAC,CAEjG;AACA,KAAM,CAACgP,UAAU,CAAEC,aAAa,CAAC,CAAGjP,QAAQ,CAA8C,QAAQ,CAAC,CACnG,KAAM,CAACkP,kBAAkB,CAAEC,qBAAqB,CAAC,CAAGnP,QAAQ,CAAS,EAAE,CAAC,CACxE,KAAM,CAACwJ,mBAAmB,CAAE4F,sBAAsB,CAAC,CAAGpP,QAAQ,CAAc,IAAI,CAAC,CACjF,KAAM,CAACqP,OAAO,CAAEC,UAAU,CAAC,CAAGtP,QAAQ,CAAmB,EAAE,CAAC,CAC5D,KAAM,CAACuP,gBAAgB,CAAEC,mBAAmB,CAAC,CAAGxP,QAAQ,CAAC,KAAK,CAAC,CAC/D,KAAM,CAACyP,aAAa,CAAEC,gBAAgB,CAAC,CAAG1P,QAAQ,CAAwB,IAAI,CAAC,CAE/E;AACA,KAAM,CAAA4J,SAAS,CAAG1J,MAAM,CAAoB,IAAI,CAAC,CACjD,KAAM,CAACyP,QAAQ,CAAEC,WAAW,CAAC,CAAG5P,QAAQ,CAAY,EAAE,CAAC,CACvD,KAAM,CAAC6P,YAAY,CAAEC,eAAe,CAAC,CAAG9P,QAAQ,CAAe,CAC7D+P,SAAS,CAAE,KAAK,CAChBC,MAAM,CAAE,CAAC,CACTC,MAAM,CAAE,CAAC,CACTC,cAAc,CAAE,IAAI,CACpBC,IAAI,CAAE,CAAC,CACPC,GAAG,CAAE,CAAEjC,CAAC,CAAE,CAAC,CAAEC,CAAC,CAAE,CAAE,CAAC,CACnBiC,QAAQ,CAAE,KAAK,CACfC,QAAQ,CAAE,GAAG,CACbC,QAAQ,CAAE,KAAK,CACfC,aAAa,CAAE,CAAC,CAChBC,UAAU,CAAE,KAAK,CACjBC,eAAe,CAAE,IAAI,CACrBC,UAAU,CAAE,CAAExC,CAAC,CAAE,CAAC,CAAEC,CAAC,CAAE,CAAE,CAAC,CAC1BwC,UAAU,CAAE,KAAK,CACjBC,eAAe,CAAE,IAAI,CACrBC,YAAY,CAAE,IAAI,CAClBC,UAAU,CAAE,KAAK,CACjBC,eAAe,CAAE,CAAC,CAClBC,aAAa,CAAE,IACjB,CAAC,CAAC,CACF,KAAM,CAACC,iBAAiB,CAAEC,oBAAoB,CAAC,CAAGnR,QAAQ,CAAC,KAAK,CAAC,CACjE,KAAM,CAACoR,cAAc,CAAEC,iBAAiB,CAAC,CAAGrR,QAAQ,CAAiB,IAAI,CAAC,CAC1E,KAAM,CAACyJ,WAAW,CAAE6H,cAAc,CAAC,CAAGtR,QAAQ,CAA0B,IAAI,CAAC,CAC7E,KAAM,CAACuR,gBAAgB,CAAEC,mBAAmB,CAAC,CAAGxR,QAAQ,CAAgB,IAAI,CAAC,CAC7E,KAAM,CAACyR,aAAa,CAAEC,gBAAgB,CAAC,CAAG1R,QAAQ,CAAC,KAAK,CAAC,CACzD,KAAM,CAAC2R,iBAAiB,CAAEC,oBAAoB,CAAC,CAAG5R,QAAQ,CAAC,CAAC,CAAC,CAC7D,KAAM,CAAC6R,aAAa,CAAC,CAAG7R,QAAQ,CAAC,EAAE,CAAC,CAAE;AACtC,KAAM,CAAC8R,mBAAmB,CAAEC,sBAAsB,CAAC,CAAG/R,QAAQ,CAAC,IAAI,CAAC,CACpE,KAAM,CAACgS,cAAc,CAAEC,iBAAiB,CAAC,CAAGjS,QAAQ,CAAC,EAAE,CAAC,CACxD,KAAM,CAACkS,gBAAgB,CAAEC,mBAAmB,CAAC,CAAGnS,QAAQ,CAAY,EAAE,CAAC,CACvE,KAAM,CAACoS,oBAAoB,CAAEC,uBAAuB,CAAC,CAAGrS,QAAQ,CAAC,KAAK,CAAC,CACvE,KAAM,CAACsS,WAAW,CAAEC,cAAc,CAAC,CAAGvS,QAAQ,CAIpC,IAAI,CAAC,CACf,KAAM,CAACwS,gBAAgB,CAAEC,mBAAmB,CAAC,CAAGzS,QAAQ,CAAC,IAAI,CAAC,CAE9D;AACA,KAAM,CAAA0S,iBAAqC,CAAG,CAC5C,CACEjF,IAAI,CAAE,sBAAsB,CAC5BkF,WAAW,CAAE,yCAAyC,CACtD5E,IAAI,CAAE,CAAE/H,KAAK,CAAE,IAAI,CAAEC,MAAM,CAAE,IAAK,CAAC,CACnCgI,KAAK,CAAE,CACL,CACE2E,EAAE,CAAE,MAAM,CACV1E,MAAM,CAAE,CAAEC,CAAC,CAAE,GAAG,CAAEC,CAAC,CAAE,GAAG,CAAEpI,KAAK,CAAE,GAAG,CAAEC,MAAM,CAAE,GAAI,CAAC,CACnDoI,MAAM,CAAE,CAAEC,IAAI,CAAE,KAAK,CAAEuE,GAAG,CAAE,6BAA8B,CAAC,CAC3D3M,KAAK,CAAE,UACT,CAAC,CACD,CACE0M,EAAE,CAAE,MAAM,CACV1E,MAAM,CAAE,CAAEC,CAAC,CAAE,GAAG,CAAEC,CAAC,CAAE,GAAG,CAAEpI,KAAK,CAAE,GAAG,CAAEC,MAAM,CAAE,GAAI,CAAC,CACnDoI,MAAM,CAAE,CAAEC,IAAI,CAAE,KAAK,CAAEuE,GAAG,CAAE,6BAA8B,CAAC,CAC3D3M,KAAK,CAAE,UACT,CAAC,CACD,CACE0M,EAAE,CAAE,MAAM,CACV1E,MAAM,CAAE,CAAEC,CAAC,CAAE,IAAI,CAAEC,CAAC,CAAE,GAAG,CAAEpI,KAAK,CAAE,GAAG,CAAEC,MAAM,CAAE,GAAI,CAAC,CACpDoI,MAAM,CAAE,CAAEC,IAAI,CAAE,gBAAgB,CAAEC,IAAI,CAAE,sBAAsB,CAAEuE,eAAe,CAAE,YAAa,CAAC,CAC/F5M,KAAK,CAAE,aACT,CAAC,CACD,CACE0M,EAAE,CAAE,MAAM,CACV1E,MAAM,CAAE,CAAEC,CAAC,CAAE,GAAG,CAAEC,CAAC,CAAE,GAAG,CAAEpI,KAAK,CAAE,GAAG,CAAEC,MAAM,CAAE,GAAI,CAAC,CACnDoI,MAAM,CAAE,CAAEC,IAAI,CAAE,gBAAgB,CAAEC,IAAI,CAAE,yBAAyB,CAAEuE,eAAe,CAAE,eAAgB,CAAC,CACrG5M,KAAK,CAAE,UACT,CAAC,CACD,CACE0M,EAAE,CAAE,MAAM,CACV1E,MAAM,CAAE,CAAEC,CAAC,CAAE,GAAG,CAAEC,CAAC,CAAE,GAAG,CAAEpI,KAAK,CAAE,GAAG,CAAEC,MAAM,CAAE,GAAI,CAAC,CACnDoI,MAAM,CAAE,CAAEC,IAAI,CAAE,KAAK,CAAEuE,GAAG,CAAE,6BAA8B,CAAC,CAC3D3M,KAAK,CAAE,UACT,CAAC,CACD,CACE0M,EAAE,CAAE,MAAM,CACV1E,MAAM,CAAE,CAAEC,CAAC,CAAE,IAAI,CAAEC,CAAC,CAAE,GAAG,CAAEpI,KAAK,CAAE,GAAG,CAAEC,MAAM,CAAE,GAAI,CAAC,CACpDoI,MAAM,CAAE,CAAEC,IAAI,CAAE,KAAK,CAAEuE,GAAG,CAAE,6BAA8B,CAAC,CAC3D3M,KAAK,CAAE,UACT,CAAC,CAEL,CAAC,CACD,CACEuH,IAAI,CAAE,wBAAwB,CAC9BkF,WAAW,CAAE,uCAAuC,CACpD5E,IAAI,CAAE,CAAE/H,KAAK,CAAE,IAAI,CAAEC,MAAM,CAAE,IAAK,CAAC,CACnCgI,KAAK,CAAE,CACL,CACE2E,EAAE,CAAE,MAAM,CACV1E,MAAM,CAAE,CAAEC,CAAC,CAAE,GAAG,CAAEC,CAAC,CAAE,GAAG,CAAEpI,KAAK,CAAE,IAAI,CAAEC,MAAM,CAAE,GAAI,CAAC,CACpDoI,MAAM,CAAE,CAAEC,IAAI,CAAE,UAAU,CAAEC,IAAI,CAAE,oBAAqB,CAAC,CACxDrI,KAAK,CAAE,aACT,CAAC,CACD,CACE0M,EAAE,CAAE,MAAM,CACV1E,MAAM,CAAE,CAAEC,CAAC,CAAE,IAAI,CAAEC,CAAC,CAAE,GAAG,CAAEpI,KAAK,CAAE,IAAI,CAAEC,MAAM,CAAE,GAAI,CAAC,CACrDoI,MAAM,CAAE,CAAEC,IAAI,CAAE,UAAU,CAAEC,IAAI,CAAE,oBAAqB,CAAC,CACxDrI,KAAK,CAAE,aACT,CAAC,CACD,CACE0M,EAAE,CAAE,MAAM,CACV1E,MAAM,CAAE,CAAEC,CAAC,CAAE,GAAG,CAAEC,CAAC,CAAE,GAAG,CAAEpI,KAAK,CAAE,IAAI,CAAEC,MAAM,CAAE,GAAI,CAAC,CACpDoI,MAAM,CAAE,CAAEC,IAAI,CAAE,UAAU,CAAEC,IAAI,CAAE,oBAAqB,CAAC,CACxDrI,KAAK,CAAE,aACT,CAAC,CACD,CACE0M,EAAE,CAAE,MAAM,CACV1E,MAAM,CAAE,CAAEC,CAAC,CAAE,IAAI,CAAEC,CAAC,CAAE,GAAG,CAAEpI,KAAK,CAAE,IAAI,CAAEC,MAAM,CAAE,GAAI,CAAC,CACrDoI,MAAM,CAAE,CAAEC,IAAI,CAAE,UAAU,CAAEC,IAAI,CAAE,oBAAqB,CAAC,CACxDrI,KAAK,CAAE,aACT,CAAC,CAEL,CAAC,CACD,CACEuH,IAAI,CAAE,oBAAoB,CAC1BkF,WAAW,CAAE,+CAA+C,CAC5D5E,IAAI,CAAE,CAAE/H,KAAK,CAAE,IAAI,CAAEC,MAAM,CAAE,IAAK,CAAC,CACnCgI,KAAK,CAAE,CACL,CACE2E,EAAE,CAAE,UAAU,CACd1E,MAAM,CAAE,CAAEC,CAAC,CAAE,GAAG,CAAEC,CAAC,CAAE,GAAG,CAAEpI,KAAK,CAAE,IAAI,CAAEC,MAAM,CAAE,IAAK,CAAC,CACrDoI,MAAM,CAAE,CAAEC,IAAI,CAAE,KAAK,CAAEuE,GAAG,CAAE,0BAA2B,CAAC,CACxD3M,KAAK,CAAE,aACT,CAAC,CAEL,CAAC,CACF,CAEDjG,SAAS,CAAC,IAAM,CACd8S,aAAa,CAAC,CAAC,CACfC,mBAAmB,CAAC,CAAC,CACvB,CAAC,CAAE,EAAE,CAAC,CAEN;AACA/S,SAAS,CAAC,IAAM,CACd,GAAIwR,aAAa,EAAIhI,WAAW,CAAE,CAChC4B,oBAAoB,CAAC,CAAC,CACxB,CACF,CAAC,CAAE,CAACsE,QAAQ,CAAET,kBAAkB,CAAEW,YAAY,CAACM,IAAI,CAAEN,YAAY,CAACO,GAAG,CAAEP,YAAY,CAACU,QAAQ,CAAEV,YAAY,CAACK,cAAc,CAAC,CAAC,CAE3H;AACAjQ,SAAS,CAAC,IAAM,CACd,MAAO,IAAM,CACX,GAAIsR,gBAAgB,CAAE,CACpB0B,oBAAoB,CAAC1B,gBAAgB,CAAC,CACxC,CACF,CAAC,CACH,CAAC,CAAE,CAACA,gBAAgB,CAAC,CAAC,CAEtB;AACAtR,SAAS,CAAC,IAAM,CACd,KAAM,CAAA0J,MAAM,CAAGC,SAAS,CAACC,OAAO,CAChC,GAAI,CAACF,MAAM,CAAE,OAEb,KAAM,CAAAuJ,WAAW,CAAIC,CAAa,EAAK,CACrCA,CAAC,CAACC,cAAc,CAAC,CAAC,CAElB;AACA,GAAIvD,YAAY,CAACkB,UAAU,CAAE,CAC3B,OACF,CAEA,KAAM,CAAAsC,KAAK,CAAGF,CAAC,CAACG,MAAM,CAAG,CAAC,CAAG,GAAG,CAAG,GAAG,CACtC,KAAM,CAAAC,OAAO,CAAG9I,IAAI,CAAC+I,GAAG,CAAC,GAAG,CAAE/I,IAAI,CAACC,GAAG,CAAC,CAAC,CAAEmF,YAAY,CAACM,IAAI,CAAGkD,KAAK,CAAC,CAAC,CAErEvD,eAAe,CAAC2D,IAAI,EAAAC,aAAA,CAAAA,aAAA,IACfD,IAAI,MACPtD,IAAI,CAAEoD,OAAO,EACb,CAAC,CAEHlI,oBAAoB,CAAC,CAAC,CACxB,CAAC,CAED;AACA1B,MAAM,CAACgK,gBAAgB,CAAC,OAAO,CAAET,WAAW,CAAE,CAAEU,OAAO,CAAE,KAAM,CAAC,CAAC,CAEjE,MAAO,IAAM,CACXjK,MAAM,CAACkK,mBAAmB,CAAC,OAAO,CAAEX,WAAW,CAAC,CAClD,CAAC,CACH,CAAC,CAAE,CAACrD,YAAY,CAACkB,UAAU,CAAElB,YAAY,CAACM,IAAI,CAAC,CAAC,CAEhD,KAAM,CAAA4C,aAAa,CAAG,KAAAA,CAAA,GAAY,CAChC,GAAI,CACF5K,UAAU,CAAC,IAAI,CAAC,CAChBE,QAAQ,CAAC,IAAI,CAAC,CAEd,KAAM,CAAAyL,QAAQ,CAAG,KAAM,CAAAxP,YAAY,CAAC,CAAC,CACrC,KAAM,CAAAiK,IAAuB,CAAGuF,QAAQ,CAACvF,IAAI,CAE7C,GAAIA,IAAI,CAACjG,OAAO,CAAE,CAChBP,YAAY,CAACwG,IAAI,CAACwF,UAAU,CAAC,CAC7BxL,UAAU,WAAAyL,MAAA,CAAWzF,IAAI,CAAC0F,KAAK,kBAAAD,MAAA,CAAgBzF,IAAI,CAAC2F,cAAc,qBAAAF,MAAA,CAAmBzF,IAAI,CAAC4F,mBAAmB,wBAAsB,CAAC,CACtI,CAAC,IAAM,CACL9L,QAAQ,CAAC,2BAA2B,CAAC,CACvC,CACF,CAAE,MAAO+L,GAAQ,CAAE,KAAAC,aAAA,CAAAC,kBAAA,CACjBjM,QAAQ,CAAC,EAAAgM,aAAA,CAAAD,GAAG,CAACN,QAAQ,UAAAO,aAAA,kBAAAC,kBAAA,CAAZD,aAAA,CAAc9F,IAAI,UAAA+F,kBAAA,iBAAlBA,kBAAA,CAAoBC,MAAM,GAAI,2BAA2B,CAAC,CACrE,CAAC,OAAS,CACRpM,UAAU,CAAC,KAAK,CAAC,CACnB,CACF,CAAC,CAED,KAAM,CAAA6K,mBAAmB,CAAG,KAAAA,CAAA,GAAY,CACtC,GAAI,CACF,KAAM,CAAAc,QAAQ,CAAG,KAAM,CAAA9O,kBAAkB,CAAC,CAAC,CAC3C,KAAM,CAAAuJ,IAA6B,CAAGuF,QAAQ,CAACvF,IAAI,CAEnD,GAAIA,IAAI,CAACjG,OAAO,CAAE,CAChBL,kBAAkB,CAACsG,IAAI,CAACiG,OAAO,CAAC,CAClC,CACF,CAAE,MAAOJ,GAAQ,CAAE,CACjBjJ,OAAO,CAAC/C,KAAK,CAAC,kCAAkC,CAAEgM,GAAG,CAAC,CACxD,CACF,CAAC,CAED,KAAM,CAAAK,yBAAyB,CAAG,KAAAA,CAAA,GAAY,CAC5C,GAAI,CACFpM,QAAQ,CAAC,IAAI,CAAC,CACd,KAAM,CAAAyL,QAAQ,CAAG,KAAM,CAAA3O,mBAAmB,CAAC,CAAC,CAE5C,GAAI2O,QAAQ,CAACvF,IAAI,CAACjG,OAAO,CAAE,CACzB,KAAM,CAAEkM,OAAO,CAAEE,kBAAkB,CAAEC,aAAa,CAAEC,aAAc,CAAC,CAAGd,QAAQ,CAACvF,IAAI,CAEnF,GAAI,CAAAsG,cAAc,WAAAb,MAAA,CAAaU,kBAAkB,4BAA0B,CAC3EG,cAAc,qBAAAb,MAAA,CAAkBW,aAAa,kBAAgB,CAC7DE,cAAc,qBAAAb,MAAA,CAAkBY,aAAa,uBAAqB,CAClEC,cAAc,+BAAAb,MAAA,CAA4BQ,OAAO,CAACpL,MAAM,YAAU,CAElE,GAAIoL,OAAO,CAACpL,MAAM,GAAK,CAAC,CAAE,CACxByL,cAAc,EAAI,6CAA6C,CACjE,CAEAtM,UAAU,CAACsM,cAAc,CAAC,CAC1B5M,kBAAkB,CAACuM,OAAO,CAAC,CAAE;AAC/B,CAAC,IAAM,CACLnM,QAAQ,CAACyL,QAAQ,CAACvF,IAAI,CAACuG,OAAO,EAAI,kCAAkC,CAAC,CACvE,CACF,CAAE,MAAO1M,KAAU,CAAE,KAAA2M,eAAA,CAAAC,oBAAA,CACnB7J,OAAO,CAAC/C,KAAK,CAAC,qCAAqC,CAAEA,KAAK,CAAC,CAC3DC,QAAQ,CAAC,EAAA0M,eAAA,CAAA3M,KAAK,CAAC0L,QAAQ,UAAAiB,eAAA,kBAAAC,oBAAA,CAAdD,eAAA,CAAgBxG,IAAI,UAAAyG,oBAAA,iBAApBA,oBAAA,CAAsBT,MAAM,GAAI,kCAAkC,CAAC,CAC9E,CACF,CAAC,CAED,KAAM,CAAAU,oBAAoB,CAAG,KAAAA,CAAA,GAAY,CACvC,GAAI,CAACC,MAAM,CAACC,OAAO,CAAC,wHAAwH,CAAC,CAAE,CAC7I,OACF,CAEA,GAAI,CACF9M,QAAQ,CAAC,IAAI,CAAC,CACd,KAAM,CAAAyL,QAAQ,CAAG,KAAM,CAAAxO,sBAAsB,CAAC,CAAC,CAE/C,GAAIwO,QAAQ,CAACvF,IAAI,CAACjG,OAAO,CAAE,CACzBC,UAAU,CAACuL,QAAQ,CAACvF,IAAI,CAACuG,OAAO,CAAC,CACjC9B,mBAAmB,CAAC,CAAC,CAAE;AACzB,CAAC,IAAM,CACL3K,QAAQ,CAACyL,QAAQ,CAACvF,IAAI,CAACuG,OAAO,EAAI,2BAA2B,CAAC,CAChE,CACF,CAAE,MAAO1M,KAAU,CAAE,KAAAgN,gBAAA,CAAAC,qBAAA,CACnBlK,OAAO,CAAC/C,KAAK,CAAC,4BAA4B,CAAEA,KAAK,CAAC,CAClDC,QAAQ,CAAC,EAAA+M,gBAAA,CAAAhN,KAAK,CAAC0L,QAAQ,UAAAsB,gBAAA,kBAAAC,qBAAA,CAAdD,gBAAA,CAAgB7G,IAAI,UAAA8G,qBAAA,iBAApBA,qBAAA,CAAsBd,MAAM,GAAI,2BAA2B,CAAC,CACvE,CACF,CAAC,CAED,KAAM,CAAAe,2BAA2B,CAAG,KAAAA,CAAA,GAAY,CAC9C,GAAI,CACFjN,QAAQ,CAAC,IAAI,CAAC,CACd,KAAM,CAAAyL,QAAQ,CAAG,KAAM,CAAA1O,oBAAoB,CAAC,CAAC,CAE7C,GAAI0O,QAAQ,CAACvF,IAAI,CAACjG,OAAO,CAAE,CACzBmD,oBAAoB,CAACqI,QAAQ,CAACvF,IAAI,CAACgH,mBAAmB,CAAC,CACvDhK,wBAAwB,CAAC,IAAI,CAAC,CAChC,CAAC,IAAM,CACLlD,QAAQ,CAACyL,QAAQ,CAACvF,IAAI,CAACuG,OAAO,EAAI,mCAAmC,CAAC,CACxE,CACF,CAAE,MAAO1M,KAAU,CAAE,KAAAoN,gBAAA,CAAAC,qBAAA,CACnBtK,OAAO,CAAC/C,KAAK,CAAC,oCAAoC,CAAEA,KAAK,CAAC,CAC1DC,QAAQ,CAAC,EAAAmN,gBAAA,CAAApN,KAAK,CAAC0L,QAAQ,UAAA0B,gBAAA,kBAAAC,qBAAA,CAAdD,gBAAA,CAAgBjH,IAAI,UAAAkH,qBAAA,iBAApBA,qBAAA,CAAsBlB,MAAM,GAAI,mCAAmC,CAAC,CAC/E,CACF,CAAC,CAED,KAAM,CAAAmB,yBAAyB,CAAG,KAAAA,CAAA,GAAY,CAC5C,GAAI,CAAChK,wBAAwB,EAAI,CAACvC,OAAO,CAACwM,IAAI,CAAC,CAAC,CAAE,CAChDtN,QAAQ,CAAC,iDAAiD,CAAC,CAC3D,OACF,CAEA,GAAI,CACFyD,gBAAgB,CAAC,IAAI,CAAC,CACtBzD,QAAQ,CAAC,IAAI,CAAC,CAEd,KAAM,CAAAuN,SAAS,CAAG,CAChB9C,eAAe,CAAE3J,OAAO,CAACwM,IAAI,CAAC,CAAC,CAC/BE,UAAU,CAAEnK,wBAAwB,CAACoK,YAAY,CACjDrI,IAAI,cAAAuG,MAAA,CAAetI,wBAAwB,CAAC+B,IAAI,CAClD,CAAC,CAED,KAAM,CAAAqG,QAAQ,CAAG,KAAM,CAAAzO,mBAAmB,CAACuQ,SAAS,CAAC,CAErD,GAAI9B,QAAQ,CAACvF,IAAI,CAACjG,OAAO,CAAE,CACzBC,UAAU,YAAAyL,MAAA,CAAW7K,OAAO,6CAAA6K,MAAA,CAAyCtI,wBAAwB,CAAC+B,IAAI,MAAG,CAAC,CACtGlC,wBAAwB,CAAC,KAAK,CAAC,CAC/BI,2BAA2B,CAAC,IAAI,CAAC,CACjCC,UAAU,CAAC,EAAE,CAAC,CACdoH,mBAAmB,CAAC,CAAC,CAAE;AACzB,CAAC,IAAM,CACL3K,QAAQ,CAACyL,QAAQ,CAACvF,IAAI,CAACuG,OAAO,EAAI,wBAAwB,CAAC,CAC7D,CACF,CAAE,MAAO1M,KAAU,CAAE,KAAA2N,gBAAA,CAAAC,qBAAA,CACnB7K,OAAO,CAAC/C,KAAK,CAAC,uBAAuB,CAAEA,KAAK,CAAC,CAC7CC,QAAQ,CAAC,EAAA0N,gBAAA,CAAA3N,KAAK,CAAC0L,QAAQ,UAAAiC,gBAAA,kBAAAC,qBAAA,CAAdD,gBAAA,CAAgBxH,IAAI,UAAAyH,qBAAA,iBAApBA,qBAAA,CAAsBzB,MAAM,GAAI,wBAAwB,CAAC,CACpE,CAAC,OAAS,CACRzI,gBAAgB,CAAC,KAAK,CAAC,CACzB,CACF,CAAC,CAED,KAAM,CAAAmK,iBAAiB,CAAG,KAAO,CAAAJ,UAAkB,EAAK,CACtD,GAAI,CACF,KAAM,CAAA/B,QAAQ,CAAG,KAAM,CAAA5O,wBAAwB,CAAC2Q,UAAU,CAAC,CAC3D,GAAI/B,QAAQ,CAACvF,IAAI,CAACjG,OAAO,CAAE,CACzBC,UAAU,CAACuL,QAAQ,CAACvF,IAAI,CAACuG,OAAO,CAAC,CACjC9B,mBAAmB,CAAC,CAAC,CAAE;AACzB,CAAC,IAAM,CACL3K,QAAQ,CAAC,0BAA0B,CAAC,CACtC,CACF,CAAE,MAAO+L,GAAQ,CAAE,KAAA8B,cAAA,CAAAC,mBAAA,CACjB9N,QAAQ,CAAC,EAAA6N,cAAA,CAAA9B,GAAG,CAACN,QAAQ,UAAAoC,cAAA,kBAAAC,mBAAA,CAAZD,cAAA,CAAc3H,IAAI,UAAA4H,mBAAA,iBAAlBA,mBAAA,CAAoB5B,MAAM,GAAI,0BAA0B,CAAC,CACpE,CACF,CAAC,CAED,KAAM,CAAA6B,iBAAiB,CAAG,KAAO,CAAAjN,OAAe,EAAK,CACnD,GAAI,CAAC+L,MAAM,CAACC,OAAO,gDAAAnB,MAAA,CAA+C7K,OAAO,OAAI,CAAC,CAAE,CAC9E,OACF,CAEA,GAAI,CACF,KAAM,CAAA2K,QAAQ,CAAG,KAAM,CAAA7O,mBAAmB,CAACkE,OAAO,CAAC,CACnD,GAAI2K,QAAQ,CAACvF,IAAI,CAACjG,OAAO,CAAE,CACzBC,UAAU,CAACuL,QAAQ,CAACvF,IAAI,CAACuG,OAAO,CAAC,CACjC9B,mBAAmB,CAAC,CAAC,CAAE;AACzB,CAAC,IAAM,CACL3K,QAAQ,CAAC,wBAAwB,CAAC,CACpC,CACF,CAAE,MAAO+L,GAAQ,CAAE,KAAAiC,cAAA,CAAAC,mBAAA,CACjBjO,QAAQ,CAAC,EAAAgO,cAAA,CAAAjC,GAAG,CAACN,QAAQ,UAAAuC,cAAA,kBAAAC,mBAAA,CAAZD,cAAA,CAAc9H,IAAI,UAAA+H,mBAAA,iBAAlBA,mBAAA,CAAoB/B,MAAM,GAAI,wBAAwB,CAAC,CAClE,CACF,CAAC,CAED,KAAM,CAAAgC,2BAA2B,CAAIC,KAAU,EAAK,CAClDtK,yBAAyB,CAACsK,KAAK,CAAC,CAChCpK,4BAA4B,CAAC,IAAI,CAAC,CAClCJ,wBAAwB,CAAC,IAAI,CAAC,CAChC,CAAC,CAED,KAAM,CAAAyK,iBAAiB,CAAG,KAAAA,CAAA,GAAY,CACpC,GAAI,CAACxK,sBAAsB,EAAI,CAACE,yBAAyB,CAAE,CACzD9D,QAAQ,CAAC,iDAAiD,CAAC,CAC3D,OACF,CAEA,GAAI,CACFiE,gBAAgB,CAAC,IAAI,CAAC,CACtBjE,QAAQ,CAAC,IAAI,CAAC,CAEd,KAAM,CAAAqO,UAAU,CAAG,CACjBb,UAAU,CAAE1J,yBAAyB,CAAC2J,YACxC,CAAC,CAED,KAAM,CAAAhC,QAAQ,CAAG,KAAM,CAAAvO,mBAAmB,CAAC0G,sBAAsB,CAAC6G,eAAe,CAAE4D,UAAU,CAAC,CAE9F,GAAI5C,QAAQ,CAACvF,IAAI,CAACjG,OAAO,CAAE,CACzBC,UAAU,YAAAyL,MAAA,CAAW/H,sBAAsB,CAAC6G,eAAe,2CAAAkB,MAAA,CAAuC7H,yBAAyB,CAACsB,IAAI,MAAG,CAAC,CACpIzB,wBAAwB,CAAC,KAAK,CAAC,CAC/BE,yBAAyB,CAAC,IAAI,CAAC,CAC/BE,4BAA4B,CAAC,IAAI,CAAC,CAClC4G,mBAAmB,CAAC,CAAC,CAAE;AACzB,CAAC,IAAM,CACL3K,QAAQ,CAACyL,QAAQ,CAACvF,IAAI,CAACuG,OAAO,EAAI,wBAAwB,CAAC,CAC7D,CACF,CAAE,MAAO1M,KAAU,CAAE,KAAAuO,gBAAA,CAAAC,qBAAA,CACnBzL,OAAO,CAAC/C,KAAK,CAAC,uBAAuB,CAAEA,KAAK,CAAC,CAC7CC,QAAQ,CAAC,EAAAsO,gBAAA,CAAAvO,KAAK,CAAC0L,QAAQ,UAAA6C,gBAAA,kBAAAC,qBAAA,CAAdD,gBAAA,CAAgBpI,IAAI,UAAAqI,qBAAA,iBAApBA,qBAAA,CAAsBrC,MAAM,GAAI,wBAAwB,CAAC,CACpE,CAAC,OAAS,CACRjI,gBAAgB,CAAC,KAAK,CAAC,CACzB,CACF,CAAC,CAED,KAAM,CAAAuK,uBAAuB,CAAG,KAAO,CAAAC,QAAa,EAAK,CACvDpK,6BAA6B,CAACoK,QAAQ,CAAC,CACvClK,kBAAkB,CAAC,IAAI,CAAC,CACxBI,cAAc,CAAC,KAAK,CAAC,CACrBE,kBAAkB,CAAC,CAAElH,KAAK,CAAE,CAAC,CAAEC,MAAM,CAAE,CAAE,CAAC,CAAC,CAC3CuG,oBAAoB,CAAC,IAAI,CAAC,CAE1B,GAAI,CACFM,iBAAiB,CAAC,IAAI,CAAC,CACvBzE,QAAQ,CAAC,IAAI,CAAC,CAEd,KAAM,CAAAyL,QAAQ,CAAG,KAAM,CAAAvP,kBAAkB,CAACuS,QAAQ,CAACjB,UAAU,CAAC,CAE9D,GAAI/B,QAAQ,CAACvF,IAAI,CAACjG,OAAO,CAAE,CACzBsE,kBAAkB,CAACkH,QAAQ,CAACvF,IAAI,CAAC,CACnC,CAAC,IAAM,CACLlG,QAAQ,CAACyL,QAAQ,CAACvF,IAAI,CAACuG,OAAO,EAAI,kCAAkC,CAAC,CACvE,CACF,CAAE,MAAO1M,KAAU,CAAE,KAAA2O,gBAAA,CAAAC,qBAAA,CACnB7L,OAAO,CAAC/C,KAAK,CAAC,kCAAkC,CAAEA,KAAK,CAAC,CACxDC,QAAQ,CAAC,EAAA0O,gBAAA,CAAA3O,KAAK,CAAC0L,QAAQ,UAAAiD,gBAAA,kBAAAC,qBAAA,CAAdD,gBAAA,CAAgBxI,IAAI,UAAAyI,qBAAA,iBAApBA,qBAAA,CAAsBzC,MAAM,GAAI,kCAAkC,CAAC,CAC9E,CAAC,OAAS,CACRzH,iBAAiB,CAAC,KAAK,CAAC,CAC1B,CACF,CAAC,CAED,KAAM,CAAAmK,eAAe,CAAIC,KAA6C,EAAK,CACzE,KAAM,CAAAxN,GAAG,CAAGwN,KAAK,CAACC,MAA0B,CAC5CjK,kBAAkB,CAAC,CACjBlH,KAAK,CAAE0D,GAAG,CAAC0N,WAAW,CACtBnR,MAAM,CAAEyD,GAAG,CAAC2N,YACd,CAAC,CAAC,CACFrK,cAAc,CAAC,IAAI,CAAC,CACtB,CAAC,CAED,KAAM,CAAAsK,gBAAgB,CAAG,KAAO,CAAAzB,UAAkB,EAAK,CACrD,GAAI,CACF1N,UAAU,CAAC,IAAI,CAAC,CAChBE,QAAQ,CAAC,IAAI,CAAC,CAEd,KAAM,CAAAyL,QAAQ,CAAG,KAAM,CAAApP,kBAAkB,CAACmR,UAAU,CAAC,CAErD,GAAI/B,QAAQ,CAACvF,IAAI,CAACjG,OAAO,CAAE,KAAAiP,eAAA,CACzBxP,YAAY,CAAC0L,IAAI,EAAIA,IAAI,CAAC+D,GAAG,CAACC,IAAI,EAAA/D,aAAA,CAAAA,aAAA,IAC7B+D,IAAI,MACPC,SAAS,CAAED,IAAI,CAAC5B,UAAU,GAAKA,UAAU,EACzC,CAAC,CAAC,CACJtN,UAAU,gBAAAyL,MAAA,EAAAuD,eAAA,CAAezP,SAAS,CAAC6P,IAAI,CAACC,CAAC,EAAIA,CAAC,CAAC/B,UAAU,GAAKA,UAAU,CAAC,UAAA0B,eAAA,iBAAhDA,eAAA,CAAkD9J,IAAI,qBAAkB,CAAC,CACpG,CAAC,IAAM,CACLpF,QAAQ,CAAC,iCAAiC,CAAC,CAC7C,CACF,CAAE,MAAO+L,GAAQ,CAAE,KAAAyD,cAAA,CAAAC,mBAAA,CACjBzP,QAAQ,CAAC,EAAAwP,cAAA,CAAAzD,GAAG,CAACN,QAAQ,UAAA+D,cAAA,kBAAAC,mBAAA,CAAZD,cAAA,CAActJ,IAAI,UAAAuJ,mBAAA,iBAAlBA,mBAAA,CAAoBvD,MAAM,GAAI,iCAAiC,CAAC,CAC3E,CAAC,OAAS,CACRpM,UAAU,CAAC,KAAK,CAAC,CACnB,CACF,CAAC,CAED,KAAM,CAAA4P,oBAAoB,CAAG,KAAO,CAAAjB,QAAkB,EAAK,CACzD,GAAI,CAAC5B,MAAM,CAACC,OAAO,oDAAAnB,MAAA,CAAmD8C,QAAQ,CAACrJ,IAAI,mEAAgE,CAAC,CAAE,CACpJ,OACF,CAEA,GAAI,CACFtF,UAAU,CAAC,IAAI,CAAC,CAChBE,QAAQ,CAAC,IAAI,CAAC,CAEd,KAAM,CAAAyL,QAAQ,CAAG,KAAM,CAAAlP,cAAc,CAACkS,QAAQ,CAACjB,UAAU,CAAC,CAE1D,GAAI/B,QAAQ,CAACvF,IAAI,CAACjG,OAAO,CAAE,CACzBP,YAAY,CAAC0L,IAAI,EAAIA,IAAI,CAACuE,MAAM,CAACP,IAAI,EAAIA,IAAI,CAAC5B,UAAU,GAAKiB,QAAQ,CAACjB,UAAU,CAAC,CAAC,CAClFtN,UAAU,gBAAAyL,MAAA,CAAe8C,QAAQ,CAACrJ,IAAI,2BAAwB,CAAC,CACjE,CAAC,IAAM,CACLpF,QAAQ,CAAC,4BAA4B,CAAC,CACxC,CACF,CAAE,MAAO+L,GAAQ,CAAE,KAAA6D,cAAA,CAAAC,mBAAA,CACjB7P,QAAQ,CAAC,EAAA4P,cAAA,CAAA7D,GAAG,CAACN,QAAQ,UAAAmE,cAAA,kBAAAC,mBAAA,CAAZD,cAAA,CAAc1J,IAAI,UAAA2J,mBAAA,iBAAlBA,mBAAA,CAAoB3D,MAAM,GAAI,4BAA4B,CAAC,CACtE,CAAC,OAAS,CACRpM,UAAU,CAAC,KAAK,CAAC,CACnB,CACF,CAAC,CAED,KAAM,CAAAgQ,kBAAkB,CAAG,KAAAA,CAAA,GAAY,CACrC,GAAI,CAACzP,gBAAgB,EAAI,CAACE,MAAM,CAAC+M,IAAI,CAAC,CAAC,CAAE,CACvCtN,QAAQ,CAAC,wBAAwB,CAAC,CAClC,OACF,CAEA,GAAI,CACFU,YAAY,CAAC,IAAI,CAAC,CAClBV,QAAQ,CAAC,IAAI,CAAC,CAEd,KAAM,CAAAyL,QAAQ,CAAG,KAAM,CAAAnP,oBAAoB,CAAC+D,gBAAgB,CAACmN,UAAU,CAAEjN,MAAM,CAAC+M,IAAI,CAAC,CAAC,CAAC,CAEvF,GAAI7B,QAAQ,CAACvF,IAAI,CAACjG,OAAO,CAAE,CACzBC,UAAU,gBAAAyL,MAAA,CAAetL,gBAAgB,CAAC+E,IAAI,yBAAAuG,MAAA,CAAsBpL,MAAM,CAAE,CAAC,CAC7EH,mBAAmB,CAAC,KAAK,CAAC,CAC1BI,SAAS,CAAC,EAAE,CAAC,CACbF,mBAAmB,CAAC,IAAI,CAAC,CAC3B,CAAC,IAAM,CACLN,QAAQ,CAAC,oCAAoC,CAAC,CAChD,CACF,CAAE,MAAO+L,GAAQ,CAAE,KAAAgE,cAAA,CAAAC,mBAAA,CACjBhQ,QAAQ,CAAC,EAAA+P,cAAA,CAAAhE,GAAG,CAACN,QAAQ,UAAAsE,cAAA,kBAAAC,mBAAA,CAAZD,cAAA,CAAc7J,IAAI,UAAA8J,mBAAA,iBAAlBA,mBAAA,CAAoB9D,MAAM,GAAI,oCAAoC,CAAC,CAC9E,CAAC,OAAS,CACRxL,YAAY,CAAC,KAAK,CAAC,CACrB,CACF,CAAC,CAID,KAAM,CAAAuP,kBAAkB,CAAIC,YAAiB,EAAK,CAChD,GAAIA,YAAY,CAACtK,KAAK,EAAIuK,KAAK,CAACC,OAAO,CAACF,YAAY,CAACtK,KAAK,CAAC,CAAE,CAC3DsK,YAAY,CAACtK,KAAK,CAACyK,OAAO,CAAC,CAACC,IAAS,CAAEC,KAAa,GAAK,CACvD,GAAID,IAAI,CAACtK,MAAM,EAAIsK,IAAI,CAACtK,MAAM,CAACC,IAAI,GAAK,KAAK,EAAIqK,IAAI,CAACtK,MAAM,CAACwE,GAAG,CAAE,CAChE;AACA,GAAI,CAAC8F,IAAI,CAACtK,MAAM,CAACwE,GAAG,CAACgG,KAAK,CAAC,cAAc,CAAC,CAAE,CAC1CF,IAAI,CAACtK,MAAM,CAACwE,GAAG,YAAAmB,MAAA,CAAc2E,IAAI,CAACtK,MAAM,CAACwE,GAAG,CAAE,CAC9C1H,OAAO,CAACC,GAAG,uBAAA4I,MAAA,CAAuB4E,KAAK,OAAA5E,MAAA,CAAK2E,IAAI,CAACtK,MAAM,CAACwE,GAAG,CAAE,CAAC,CAChE,CACF,CACF,CAAC,CAAC,CACJ,CACA,MAAO,CAAA0F,YAAY,CACrB,CAAC,CAED,KAAM,CAAAO,oBAAoB,CAAG,KAAAA,CAAA,GAAY,CACvC,GAAI,CAACvL,YAAY,CAACE,IAAI,CAACkI,IAAI,CAAC,CAAC,CAAE,CAC7BtN,QAAQ,CAAC,+BAA+B,CAAC,CACzC,OACF,CAEA,GAAIkF,YAAY,CAACG,WAAW,CAACtE,MAAM,CAAG,EAAE,CAAE,CACxCf,QAAQ,CAAC,8DAA8D,CAAC,CACxE,OACF,CAEA,GAAI,CAACkF,YAAY,CAACK,IAAI,CAAC+H,IAAI,CAAC,CAAC,CAAE,CAC7BtN,QAAQ,CAAC,sCAAsC,CAAC,CAChD,OACF,CAEA,GAAI,CACF;AACA,GAAI,CAAAkQ,YAAY,CAAG1K,IAAI,CAACkL,KAAK,CAACxL,YAAY,CAACK,IAAI,CAAC,CAEhD;AACA,GAAI2K,YAAY,CAACxK,IAAI,CAAE,CACrB,KAAM,CAAAiL,YAAY,CAAG,CAAEhT,KAAK,CAAEuS,YAAY,CAACxK,IAAI,CAAC/H,KAAK,CAAEC,MAAM,CAAEsS,YAAY,CAACxK,IAAI,CAAC9H,MAAO,CAAC,CACzF,KAAM,CAAAgT,WAAW,CAAGC,MAAM,CAACC,MAAM,CAACrT,oBAAoB,CAAC,CAACsT,IAAI,CAACC,YAAY,EACvEA,YAAY,CAACrT,KAAK,GAAKgT,YAAY,CAAChT,KAAK,EAAIqT,YAAY,CAACpT,MAAM,GAAK+S,YAAY,CAAC/S,MACpF,CAAC,CAED,GAAI,CAACgT,WAAW,CAAE,CAChB,KAAM,CAAAK,YAAY,CAAGJ,MAAM,CAACC,MAAM,CAACrT,oBAAoB,CAAC,CAAC0R,GAAG,CAACzJ,IAAI,KAAAiG,MAAA,CAAOjG,IAAI,CAAC/H,KAAK,QAAAgO,MAAA,CAAMjG,IAAI,CAAC9H,MAAM,CAAE,CAAC,CAACsT,IAAI,CAAC,MAAM,CAAC,CACnHlR,QAAQ,yEAAA2L,MAAA,CAAoEsF,YAAY,CAAE,CAAC,CAC3F,OACF,CACF,CAEA;AACA,GAAIf,YAAY,CAACtK,KAAK,CAAE,CACtB,IAAK,GAAI,CAAAuL,CAAC,CAAG,CAAC,CAAEA,CAAC,CAAGjB,YAAY,CAACtK,KAAK,CAAC7E,MAAM,CAAEoQ,CAAC,EAAE,CAAE,CAClD,KAAM,CAAAb,IAAI,CAAGJ,YAAY,CAACtK,KAAK,CAACuL,CAAC,CAAC,CAClC,GAAIb,IAAI,CAACtK,MAAM,EAAIsK,IAAI,CAACtK,MAAM,CAACC,IAAI,GAAK,gBAAgB,EAAIqK,IAAI,CAACtK,MAAM,CAACyE,eAAe,CAAE,CACvF,GAAI,CAAC5J,uBAAuB,CAACyP,IAAI,CAACtK,MAAM,CAACyE,eAAe,CAAC,CAAE,CACzDzK,QAAQ,8CAAA2L,MAAA,CAAyCwF,CAAC,CAAG,CAAC,SAAAxF,MAAA,CAAM2E,IAAI,CAACtK,MAAM,CAACyE,eAAe,+EAA4E,CAAC,CACpK,OACF,CACF,CACF,CACF,CAEA;AACAyF,YAAY,CAAGD,kBAAkB,CAACC,YAAY,CAAC,CAE/CjL,WAAW,CAAC,IAAI,CAAC,CACjBjF,QAAQ,CAAC,IAAI,CAAC,CAEd;AACA,KAAM,CAAAoR,kBAAkB,CAAG,KAAM,CAAA3U,gBAAgB,CAACyT,YAAY,CAAC,CAE/D,GAAI,CAACkB,kBAAkB,CAAClL,IAAI,CAACjG,OAAO,CAAE,CACpCD,QAAQ,uBAAA2L,MAAA,CAAuByF,kBAAkB,CAAClL,IAAI,CAACuG,OAAO,EAAI,0BAA0B,CAAE,CAAC,CAC/F,OACF,CAEA;AACA,KAAM,CAAAhB,QAAQ,CAAG,KAAM,CAAAtP,cAAc,CAAC+T,YAAY,CAAC,CAEnD,GAAIzE,QAAQ,CAACvF,IAAI,CAACjG,OAAO,CAAE,CACzB,KAAM,CAAAuN,UAAU,CAAG/B,QAAQ,CAACvF,IAAI,CAACuH,YAAY,CAC7C,KAAM,CAAA4D,cAAc,CAAG5F,QAAQ,CAACvF,IAAI,CAACoL,eAAe,EAAI,EAAE,CAC1D,KAAM,CAAAC,cAAc,CAAG9F,QAAQ,CAACvF,IAAI,CAACsL,eAAe,EAAI,EAAE,CAC1D,KAAM,CAAAC,aAAa,CAAGhG,QAAQ,CAACvF,IAAI,CAACwL,cAAc,EAAI,EAAE,CACxD,KAAM,CAAAC,aAAa,CAAGlG,QAAQ,CAACvF,IAAI,CAAC0L,cAAc,EAAI,EAAE,CAExD,GAAI,CAAApF,cAAc,gBAAAb,MAAA,CAAiBzG,YAAY,CAACE,IAAI,kCAAAuG,MAAA,CAA+B6B,UAAU,CAAE,CAE/F;AACA,GAAI6D,cAAc,CAACtQ,MAAM,CAAG,CAAC,CAAE,CAC7ByL,cAAc,6BAAAb,MAAA,CAA0B0F,cAAc,CAACtQ,MAAM,eAAA4K,MAAA,CAAa0F,cAAc,CAACH,IAAI,CAAC,IAAI,CAAC,CAAE,CACvG,CAEA,GAAIS,aAAa,CAAC5Q,MAAM,CAAG,CAAC,CAAE,CAC5ByL,cAAc,kCAAAb,MAAA,CAA0BgG,aAAa,CAAC5Q,MAAM,wBAAA4K,MAAA,CAAsBgG,aAAa,CAACT,IAAI,CAAC,IAAI,CAAC,CAAE,CAC9G,CAEA,GAAIK,cAAc,CAACxQ,MAAM,CAAG,CAAC,CAAE,CAC7ByL,cAAc,8BAAAb,MAAA,CAAsB4F,cAAc,CAACxQ,MAAM,eAAA4K,MAAA,CAAa4F,cAAc,CAACL,IAAI,CAAC,IAAI,CAAC,CAAE,CACnG,CAEA,GAAIO,aAAa,CAAC1Q,MAAM,CAAG,CAAC,CAAE,CAC5ByL,cAAc,iCAAAb,MAAA,CAA8B8F,aAAa,CAAC1Q,MAAM,eAAA4K,MAAA,CAAa8F,aAAa,CAACP,IAAI,CAAC,IAAI,CAAC,CAAE,CACzG,CAEAhR,UAAU,CAACsM,cAAc,CAAC,CAC1BzH,mBAAmB,CAAC,KAAK,CAAC,CAC1B8M,eAAe,CAAC,CAAC,CACjBnH,aAAa,CAAC,CAAC,CAAE;AACjBC,mBAAmB,CAAC,CAAC,CAAE;AACzB,CAAC,IAAM,CACL3K,QAAQ,CAAC,4BAA4B,CAAC,CACxC,CACF,CAAE,MAAO+L,GAAQ,CAAE,CACjB,GAAIA,GAAG,CAACU,OAAO,EAAIV,GAAG,CAACU,OAAO,CAACqF,QAAQ,CAAC,MAAM,CAAC,CAAE,CAC/C9R,QAAQ,CAAC,uCAAuC,CAAC,CACnD,CAAC,IAAM,KAAA+R,cAAA,CAAAC,mBAAA,CACLhS,QAAQ,CAAC,EAAA+R,cAAA,CAAAhG,GAAG,CAACN,QAAQ,UAAAsG,cAAA,kBAAAC,mBAAA,CAAZD,cAAA,CAAc7L,IAAI,UAAA8L,mBAAA,iBAAlBA,mBAAA,CAAoB9F,MAAM,GAAI,4BAA4B,CAAC,CACtE,CACF,CAAC,OAAS,CACRjH,WAAW,CAAC,KAAK,CAAC,CACpB,CACF,CAAC,CAED,KAAM,CAAAgN,iBAAiB,CAAG,KAAO,CAAAzE,UAAkB,EAAK,CACtD,GAAI,CAACjH,YAAY,CAAE,OAEnB,GAAI,CACFD,iBAAiB,CAAC,IAAI,CAAC,CACvBtG,QAAQ,CAAC,IAAI,CAAC,CAEd;AACA,KAAM,CAAAyO,QAAQ,CAAGhP,SAAS,CAAC6P,IAAI,CAAC4C,EAAE,EAAIA,EAAE,CAAC1E,UAAU,GAAKA,UAAU,CAAC,CACnE,KAAM,CAAA2E,gBAAgB,CAAG,CAAA1D,QAAQ,SAARA,QAAQ,iBAARA,QAAQ,CAAE2D,QAAQ,GAAI,KAAK,CAEpD,GAAI,CAAA3G,QAAQ,CACZ,GAAI0G,gBAAgB,CAAE,CACpB;AACA1G,QAAQ,CAAG,KAAM,CAAAjP,mBAAmB,CAACgR,UAAU,CAAEjH,YAAY,CAAC,CAC9D,GAAIkF,QAAQ,CAACvF,IAAI,CAACjG,OAAO,CAAE,CACzBC,UAAU,kDAAAyL,MAAA,CAAkDF,QAAQ,CAACvF,IAAI,CAACmM,gBAAgB,CAAE,CAAC,CAC/F,CAAC,IAAM,CACLrS,QAAQ,CAAC,wBAAwB,CAAC,CACpC,CACF,CAAC,IAAM,CACL;AACAyL,QAAQ,CAAG,KAAM,CAAArP,mBAAmB,CAACoR,UAAU,CAAEjH,YAAY,CAAC,CAC9D,GAAIkF,QAAQ,CAACvF,IAAI,CAACjG,OAAO,CAAE,CACzBC,UAAU,8CAAAyL,MAAA,CAA8C6B,UAAU,CAAE,CAAC,CACvE,CAAC,IAAM,CACLxN,QAAQ,CAAC,wBAAwB,CAAC,CACpC,CACF,CACF,CAAE,MAAO+L,GAAQ,CAAE,KAAAuG,cAAA,CAAAC,mBAAA,CACjBvS,QAAQ,CAAC,EAAAsS,cAAA,CAAAvG,GAAG,CAACN,QAAQ,UAAA6G,cAAA,kBAAAC,mBAAA,CAAZD,cAAA,CAAcpM,IAAI,UAAAqM,mBAAA,iBAAlBA,mBAAA,CAAoBrG,MAAM,GAAI,+BAA+B,CAAC,CACzE,CAAC,OAAS,CACR5F,iBAAiB,CAAC,KAAK,CAAC,CAC1B,CACF,CAAC,CAED,KAAM,CAAAuL,eAAe,CAAGA,CAAA,GAAM,CAC5B1M,eAAe,CAAC,CACdC,IAAI,CAAE,EAAE,CACRC,WAAW,CAAE,aAAa,CAC1BC,gBAAgB,CAAE,KAAK,CACvBC,IAAI,CAAEC,IAAI,CAACC,SAAS,CAAC,CACnBC,IAAI,CAAE,CAAE/H,KAAK,CAAE,IAAI,CAAEC,MAAM,CAAE,IAAK,CAAC,CACnC+H,QAAQ,CAAE,KAAK,CACfP,IAAI,CAAE,WAAW,CACjBC,WAAW,CAAE,aAAa,CAC1BO,KAAK,CAAE,CACL,CACEC,MAAM,CAAE,CAAEC,CAAC,CAAE,CAAC,CAAEC,CAAC,CAAE,CAAC,CAAEpI,KAAK,CAAE,IAAI,CAAEC,MAAM,CAAE,IAAK,CAAC,CACjDoI,MAAM,CAAE,CAAEC,IAAI,CAAE,UAAU,CAAEC,IAAI,CAAE,uBAAwB,CAC5D,CAAC,CAEL,CAAC,CAAE,IAAI,CAAE,CAAC,CACZ,CAAC,CAAC,CACF;AACA4D,mBAAmB,CAAC,EAAE,CAAC,CACvBE,uBAAuB,CAAC,KAAK,CAAC,CAC9BJ,iBAAiB,CAAC,EAAE,CAAC,CACrB;AACA9C,qBAAqB,CAAC,EAAE,CAAC,CACzBC,sBAAsB,CAAC,IAAI,CAAC,CAC9B,CAAC,CAED;AACA,KAAM,CAAAyL,oBAAoB,CAAGA,CAACpN,IAAY,CAAE4B,OAAyB,CAAEtB,IAAuC,GAAK,CACjH,MAAO,CACLA,IAAI,CACJC,QAAQ,CAAET,YAAY,CAACI,gBAAgB,CACvCF,IAAI,CACJC,WAAW,CAAEH,YAAY,CAACG,WAAW,CACrCO,KAAK,CAAEoB,OAAO,CAACmI,GAAG,CAACsD,GAAG,EAAI,CACxB;AACA,GAAI,CAAAzM,MAAM,CAAAqF,aAAA,IAAQoH,GAAG,CAACzM,MAAM,CAAE,CAC9B,GAAIA,MAAM,CAACC,IAAI,GAAK,KAAK,EAAID,MAAM,CAACwE,GAAG,EAAI,CAACxE,MAAM,CAACwE,GAAG,CAACgG,KAAK,CAAC,cAAc,CAAC,CAAE,CAC5ExK,MAAM,CAACwE,GAAG,YAAAmB,MAAA,CAAc3F,MAAM,CAACwE,GAAG,CAAE,CACtC,CAEA,MAAO,CACL3E,MAAM,CAAE4M,GAAG,CAAC5M,MAAM,CAClBG,MAAM,CAAEA,MACV,CAAC,CACH,CAAC,CACH,CAAC,CACH,CAAC,CAED,KAAM,CAAA0M,2BAA2B,CAAIC,IAAU,EAAK,CAClD7P,OAAO,CAACC,GAAG,CAAC,+CAA+C,CAAE4P,IAAI,CAAC,CAClE7P,OAAO,CAACC,GAAG,CAAC,YAAY,CAAE4P,IAAI,CAACvN,IAAI,CAAC,CACpCtC,OAAO,CAACC,GAAG,CAAC,YAAY,CAAE4P,IAAI,CAAC1M,IAAI,CAAC,CACpCnD,OAAO,CAACC,GAAG,CAAC,YAAY,CAAE4P,IAAI,CAACjN,IAAI,CAAC,CAEpC,KAAM,CAAAkN,GAAG,CAAGC,GAAG,CAACC,eAAe,CAACH,IAAI,CAAC,CACrC7L,qBAAqB,CAAC8L,GAAG,CAAC,CAC1B7L,sBAAsB,CAAC4L,IAAI,CAAC,CAAE;AAC9B7P,OAAO,CAACC,GAAG,CAAC,6BAA6B,CAAE4P,IAAI,CAAC,CAEhD;AACA,KAAM,CAAAtR,GAAG,CAAG,GAAI,CAAAwL,MAAM,CAAC9R,KAAK,CAAC,CAAC,CAC9BsG,GAAG,CAAC0R,MAAM,CAAG,IAAM,CACjB9J,cAAc,CAAC5H,GAAG,CAAC,CACnBgI,gBAAgB,CAAC,IAAI,CAAC,CAEtB;AACA,KAAM,CAAA/H,MAAM,CAAGC,SAAS,CAACC,OAAO,CAChC,GAAIF,MAAM,CAAE,CACV;AACA,KAAM,CAAAG,YAAY,CAAGhE,oBAAoB,CAACkD,oBAAoB,CAAC,CAC/D,KAAM,CAAAe,WAAW,CAAGD,YAAY,CAAC9D,KAAK,CACtC,KAAM,CAAAgE,YAAY,CAAGF,YAAY,CAAC7D,MAAM,CACxC,KAAM,CAAAgE,iBAAiB,CAAGF,WAAW,CAAGC,YAAY,CAEpD;AACA,KAAM,CAAAE,cAAc,CAAG,GAAG,CAC1B,KAAM,CAAAC,eAAe,CAAG,GAAG,CAE3B,GAAI,CAAAC,WAAW,CAAEC,YAAY,CAE7B;AACA,GAAIJ,iBAAiB,CAAGC,cAAc,CAAGC,eAAe,CAAE,CACxD;AACAC,WAAW,CAAGF,cAAc,CAC5BG,YAAY,CAAGH,cAAc,CAAGD,iBAAiB,CACnD,CAAC,IAAM,CACL;AACAI,YAAY,CAAGF,eAAe,CAC9BC,WAAW,CAAGD,eAAe,CAAGF,iBAAiB,CACnD,CAEA;AACAN,MAAM,CAAC3D,KAAK,CAAGoE,WAAW,CAC1BT,MAAM,CAAC1D,MAAM,CAAGoE,YAAY,CAE5B;AACA,KAAM,CAAAC,MAAM,CAAGF,WAAW,CAAGV,GAAG,CAAC1D,KAAK,CACtC,KAAM,CAAAuE,MAAM,CAAGF,YAAY,CAAGX,GAAG,CAACzD,MAAM,CACxC,KAAM,CAAAuE,KAAK,CAAGC,IAAI,CAACC,GAAG,CAACJ,MAAM,CAAEC,MAAM,CAAC,CAEtC;AACA,KAAM,CAAAI,UAAU,CAAGjB,GAAG,CAAC1D,KAAK,CAAGwE,KAAK,CACpC,KAAM,CAAAI,WAAW,CAAGlB,GAAG,CAACzD,MAAM,CAAGuE,KAAK,CAEtC;AACA,KAAM,CAAAK,OAAO,CAAG,CAACT,WAAW,CAAGO,UAAU,EAAI,CAAC,CAC9C,KAAM,CAAAG,OAAO,CAAG,CAACT,YAAY,CAAGO,WAAW,EAAI,CAAC,CAEhD;AACAjB,MAAM,CAACoB,OAAO,CAACP,KAAK,CAAGA,KAAK,CAACQ,QAAQ,CAAC,CAAC,CACvCrB,MAAM,CAACoB,OAAO,CAACJ,UAAU,CAAGA,UAAU,CAACK,QAAQ,CAAC,CAAC,CACjDrB,MAAM,CAACoB,OAAO,CAACH,WAAW,CAAGA,WAAW,CAACI,QAAQ,CAAC,CAAC,CACnDrB,MAAM,CAACoB,OAAO,CAACF,OAAO,CAAGA,OAAO,CAACG,QAAQ,CAAC,CAAC,CAC3CrB,MAAM,CAACoB,OAAO,CAACD,OAAO,CAAGA,OAAO,CAACE,QAAQ,CAAC,CAAC,CAC3CrB,MAAM,CAACoB,OAAO,CAACE,UAAU,CAAGvB,GAAG,CAAC1D,KAAK,CAACgF,QAAQ,CAAC,CAAC,CAChDrB,MAAM,CAACoB,OAAO,CAACG,WAAW,CAAGxB,GAAG,CAACzD,MAAM,CAAC+E,QAAQ,CAAC,CAAC,CAElDG,OAAO,CAACC,GAAG,CAAC,0BAA0B,CAAEtB,YAAY,CAAC5D,KAAK,KAAA8N,MAAA,CAAMjK,WAAW,QAAAiK,MAAA,CAAMhK,YAAY,KAAG,CAAC,CACjGmB,OAAO,CAACC,GAAG,CAAC,sBAAsB,CAAEnB,iBAAiB,CAAC,CACtDkB,OAAO,CAACC,GAAG,CAAC,oBAAoB,CAAEhB,WAAW,CAAE,GAAG,CAAEC,YAAY,CAAC,CACjEc,OAAO,CAACC,GAAG,CAAC,mBAAmB,CAAE1B,GAAG,CAAC1D,KAAK,CAAE,GAAG,CAAE0D,GAAG,CAACzD,MAAM,CAAC,CAC5DkF,OAAO,CAACC,GAAG,CAAC,eAAe,CAAEZ,KAAK,CAAC,CACnCW,OAAO,CAACC,GAAG,CAAC,yBAAyB,CAAET,UAAU,CAAE,GAAG,CAAEC,WAAW,CAAC,CACpEO,OAAO,CAACC,GAAG,CAAC,oBAAoB,CAAEP,OAAO,CAAEC,OAAO,CAAC,CACnDK,OAAO,CAACC,GAAG,CAAC,4BAA4B,CAAE,CACxCiQ,eAAe,CAAE5Q,IAAI,CAAC6Q,GAAG,CAAE3Q,UAAU,CAAGjB,GAAG,CAAC1D,KAAK,CAAK4E,WAAW,CAAGlB,GAAG,CAACzD,MAAO,CAAC,CAAG,QAAQ,CAC3FsV,SAAS,CAAE5Q,UAAU,EAAIP,WAAW,EAAIQ,WAAW,EAAIP,YAAY,CACnEmR,QAAQ,CAAE3Q,OAAO,EAAI,CAAC,EAAIC,OAAO,EAAI,CACvC,CAAC,CAAC,CACJ,CAEA;AACA,GAAIyG,gBAAgB,CAAE,CACpB0B,oBAAoB,CAAC1B,gBAAgB,CAAC,CACxC,CACA;AACAlG,oBAAoB,CAAC,CAAC,CACxB,CAAC,CACD3B,GAAG,CAAC+R,GAAG,CAAGR,GAAG,CACf,CAAC,CAED,KAAM,CAAA5P,oBAAoB,CAAGA,CAAA,GAAM,CACjC;AACA,GAAIkG,gBAAgB,CAAE,CACpB0B,oBAAoB,CAAC1B,gBAAgB,CAAC,CACxC,CAEA,KAAM,CAAAmK,OAAO,CAAGC,qBAAqB,CAAC,IAAM,CAC1CC,UAAU,CAAC,CAAC,CACZpK,mBAAmB,CAAC,IAAI,CAAC,CAC3B,CAAC,CAAC,CAEFA,mBAAmB,CAACkK,OAAO,CAAC,CAC9B,CAAC,CAED,KAAM,CAAAE,UAAU,CAAGA,CAAA,GAAM,CACvB,KAAM,CAAAjS,MAAM,CAAGC,SAAS,CAACC,OAAO,CAChC,KAAM,CAAAgS,GAAG,CAAGlS,MAAM,SAANA,MAAM,iBAANA,MAAM,CAAEmS,UAAU,CAAC,IAAI,CAAC,CACpC,GAAI,CAACnS,MAAM,EAAI,CAACkS,GAAG,EAAI,CAACpS,WAAW,CAAE,OAErC;AACAoS,GAAG,CAACE,SAAS,CAAC,CAAC,CAAE,CAAC,CAAEpS,MAAM,CAAC3D,KAAK,CAAE2D,MAAM,CAAC1D,MAAM,CAAC,CAEhD;AACA4V,GAAG,CAACG,IAAI,CAAC,CAAC,CACVH,GAAG,CAACI,SAAS,CAACpM,YAAY,CAACO,GAAG,CAACjC,CAAC,CAAG0B,YAAY,CAACM,IAAI,CAAEN,YAAY,CAACO,GAAG,CAAChC,CAAC,CAAGyB,YAAY,CAACM,IAAI,CAAC,CAC7F0L,GAAG,CAACrR,KAAK,CAACqF,YAAY,CAACM,IAAI,CAAEN,YAAY,CAACM,IAAI,CAAC,CAE/C;AACA,KAAM,CAAA3F,KAAK,CAAG0R,UAAU,CAACvS,MAAM,CAACoB,OAAO,CAACP,KAAK,EAAI,GAAG,CAAC,CACrD,KAAM,CAAAG,UAAU,CAAGuR,UAAU,CAACvS,MAAM,CAACoB,OAAO,CAACJ,UAAU,EAAI,GAAG,CAAC,CAC/D,KAAM,CAAAC,WAAW,CAAGsR,UAAU,CAACvS,MAAM,CAACoB,OAAO,CAACH,WAAW,EAAI,GAAG,CAAC,CACjE,KAAM,CAAAC,OAAO,CAAGqR,UAAU,CAACvS,MAAM,CAACoB,OAAO,CAACF,OAAO,EAAI,GAAG,CAAC,CACzD,KAAM,CAAAC,OAAO,CAAGoR,UAAU,CAACvS,MAAM,CAACoB,OAAO,CAACD,OAAO,EAAI,GAAG,CAAC,CAEzD;AACAK,OAAO,CAACC,GAAG,CAAC,8BAA8B,CAAE,CAC1C+Q,gBAAgB,CAAE,CAAEnW,KAAK,CAAE2D,MAAM,CAAC3D,KAAK,CAAEC,MAAM,CAAE0D,MAAM,CAAC1D,MAAO,CAAC,CAChEgH,eAAe,CAAE,CAAEjH,KAAK,CAAEyD,WAAW,CAACzD,KAAK,CAAEC,MAAM,CAAEwD,WAAW,CAACxD,MAAO,CAAC,CACzEuE,KAAK,CACL4R,eAAe,CAAE,CAAEpW,KAAK,CAAE2E,UAAU,CAAE1E,MAAM,CAAE2E,WAAY,CAAC,CAC3DyR,MAAM,CAAE,CAAElO,CAAC,CAAEtD,OAAO,CAAEuD,CAAC,CAAEtD,OAAQ,CAAC,CAClCwR,cAAc,CAAE9R,KAAK,CAAG,CAAC,EAAIG,UAAU,CAAG,CAAC,EAAIC,WAAW,CAAG,CAC/D,CAAC,CAAC,CAEF;AACAiR,GAAG,CAACU,SAAS,CAAC9S,WAAW,CAAEoB,OAAO,CAAEC,OAAO,CAAEH,UAAU,CAAEC,WAAW,CAAC,CAErE;AACA4R,QAAQ,CAACX,GAAG,CAAElS,MAAM,CAAEa,KAAK,CAAEK,OAAO,CAAEC,OAAO,CAAC,CAE9C;AACA6E,QAAQ,CAAC+I,OAAO,CAAC+D,OAAO,EAAI,CAC1BC,WAAW,CAACb,GAAG,CAAEY,OAAO,CAAEjS,KAAK,CAAEK,OAAO,CAAEC,OAAO,CAAC,CACpD,CAAC,CAAC,CAEF;AACA,GAAIsH,oBAAoB,CAAE,CACxBF,gBAAgB,CAACwG,OAAO,CAAC+D,OAAO,EAAI,CAClCC,WAAW,CAACb,GAAG,CAAEY,OAAO,CAAEjS,KAAK,CAAEK,OAAO,CAAEC,OAAO,CAAE,KAAK,CAAC,CAC3D,CAAC,CAAC,CACJ,CAEA;AACA,GAAI+E,YAAY,CAACK,cAAc,CAAE,CAC/BwM,WAAW,CAACb,GAAG,CAAEhM,YAAY,CAACK,cAAc,CAAE1F,KAAK,CAAEK,OAAO,CAAEC,OAAO,CAAE,IAAI,CAAC,CAC9E,CAEA;AACA,GAAI+E,YAAY,CAACoB,aAAa,CAAE,CAC9B,KAAM,CAAA0L,MAAM,CAAG9M,YAAY,CAACoB,aAAa,CAAC9C,CAAC,CAC3C,KAAM,CAAAyO,MAAM,CAAG/M,YAAY,CAACoB,aAAa,CAAC7C,CAAC,CAE3C;AACA,KAAM,CAAAyO,OAAO,CAAGhS,OAAO,CAAI8R,MAAM,CAAGnS,KAAM,CAC1C,KAAM,CAAAsS,OAAO,CAAGhS,OAAO,CAAI8R,MAAM,CAAGpS,KAAM,CAE1C;AACAqR,GAAG,CAACkB,WAAW,CAAG,SAAS,CAC3BlB,GAAG,CAACmB,SAAS,CAAG,CAAC,CACjBnB,GAAG,CAACoB,WAAW,CAAC,EAAE,CAAC,CAEnB,KAAM,CAAAlP,IAAI,CAAG,EAAE,CACf8N,GAAG,CAACqB,SAAS,CAAC,CAAC,CACfrB,GAAG,CAACsB,MAAM,CAACN,OAAO,CAAG9O,IAAI,CAAE+O,OAAO,CAAC,CACnCjB,GAAG,CAACuB,MAAM,CAACP,OAAO,CAAG9O,IAAI,CAAE+O,OAAO,CAAC,CACnCjB,GAAG,CAACsB,MAAM,CAACN,OAAO,CAAEC,OAAO,CAAG/O,IAAI,CAAC,CACnC8N,GAAG,CAACuB,MAAM,CAACP,OAAO,CAAEC,OAAO,CAAG/O,IAAI,CAAC,CACnC8N,GAAG,CAACwB,MAAM,CAAC,CAAC,CAEZ;AACAxB,GAAG,CAACyB,SAAS,CAAG,SAAS,CACzBzB,GAAG,CAAC0B,IAAI,CAAG,YAAY,CACvB1B,GAAG,CAAC2B,QAAQ,KAAAxJ,MAAA,CAAKvJ,IAAI,CAACgT,KAAK,CAACd,MAAM,CAAC,OAAA3I,MAAA,CAAKvJ,IAAI,CAACgT,KAAK,CAACb,MAAM,CAAC,MAAKC,OAAO,CAAG,EAAE,CAAEC,OAAO,CAAG,EAAE,CAAC,CAC5F,CAEAjB,GAAG,CAAC6B,OAAO,CAAC,CAAC,CACf,CAAC,CAED,KAAM,CAAAC,qBAAqB,CAAGA,CAACC,SAAiB,CAAEC,SAAkE,GAAK,CACvHjO,WAAW,CAACkO,YAAY,EACtBA,YAAY,CAACtG,GAAG,CAACuG,CAAC,EAChBA,CAAC,CAACnL,EAAE,GAAKgL,SAAS,CAAAlK,aAAA,CAAAA,aAAA,IAAQqK,CAAC,MAAE7P,MAAM,CAAE2P,SAAS,GAAKE,CACrD,CACF,CAAC,CAED;AACA1S,oBAAoB,CAAC,CAAC,CACxB,CAAC,CAED,KAAM,CAAA2S,oBAAoB,CAAIC,QAA0B,EAAK,CAC3D3O,UAAU,CAAC2O,QAAQ,CAAChQ,KAAK,CAAC,CAC1BT,eAAe,CAAC,CACdC,IAAI,CAAEwQ,QAAQ,CAACxQ,IAAI,CACnBC,WAAW,CAAE,aAAa,CAC1BC,gBAAgB,CAAE,KAAK,CACvBC,IAAI,CAAEC,IAAI,CAACC,SAAS,CAAC+M,oBAAoB,CAACoD,QAAQ,CAACxQ,IAAI,CAAEwQ,QAAQ,CAAChQ,KAAK,CAAEgQ,QAAQ,CAAClQ,IAAI,CAAC,CAAE,IAAI,CAAE,CAAC,CAClG,CAAC,CAAC,CACFkB,aAAa,CAAC,UAAU,CAAC,CAC3B,CAAC,CAED,KAAM,CAAAiP,mBAAmB,CAAIC,QAAgB,EAAgB,CAC3D,GAAI,CACF,KAAM,CAAAC,QAAQ,CAAGvQ,IAAI,CAACkL,KAAK,CAACoF,QAAQ,CAAC,CAErC,GAAI,CAACC,QAAQ,CAACnQ,KAAK,EAAI,CAACuK,KAAK,CAACC,OAAO,CAAC2F,QAAQ,CAACnQ,KAAK,CAAC,CAAE,CACrD,KAAM,IAAI,CAAA7J,KAAK,CAAC,8CAA8C,CAAC,CACjE,CAEA,MAAO,CAAAga,QAAQ,CAACnQ,KAAK,CAACuJ,GAAG,CAAC,CAACmB,IAAS,CAAEC,KAAa,GAAK,CACtD,GAAI,CAACD,IAAI,CAACzK,MAAM,EAAI,CAACyK,IAAI,CAACtK,MAAM,CAAE,CAChC,KAAM,IAAI,CAAAjK,KAAK,0BAAA4P,MAAA,CAA0B4E,KAAK,8BAA4B,CAAC,CAC7E,CAEA,KAAM,CAAA1K,MAAM,CAAGyK,IAAI,CAACzK,MAAM,CAC1B,KAAM,CAAAG,MAAM,CAAGsK,IAAI,CAACtK,MAAM,CAE1B;AACA,KAAM,CAAAgQ,GAAG,CAAIzF,KAAK,CAAG,KAAK,CAAI,GAAG,CAAE;AACnC,KAAM,CAAA0F,KAAK,QAAAtK,MAAA,CAAUqK,GAAG,eAAa,CAErC;AACA,GAAI,CAAAnY,KAAK,YAAA8N,MAAA,CAAc4E,KAAK,CAAG,CAAC,CAAE,CAClC,GAAIvK,MAAM,CAACC,IAAI,GAAK,KAAK,CAAE,CACzBpI,KAAK,QAAA8N,MAAA,CAAU4E,KAAK,CAAG,CAAC,CAAE,CAC5B,CAAC,IAAM,IAAIvK,MAAM,CAACC,IAAI,GAAK,UAAU,CAAE,CACrCpI,KAAK,aAAA8N,MAAA,CAAe4E,KAAK,CAAG,CAAC,CAAE,CACjC,CAAC,IAAM,IAAIvK,MAAM,CAACC,IAAI,GAAK,SAAS,CAAE,CACpCpI,KAAK,YAAA8N,MAAA,CAAc4E,KAAK,CAAG,CAAC,CAAE,CAChC,CAAC,IAAM,IAAIvK,MAAM,CAACC,IAAI,GAAK,gBAAgB,CAAE,CAC3CpI,KAAK,WAAA8N,MAAA,CAAa4E,KAAK,CAAG,CAAC,CAAE,CAC/B,CAEA,MAAO,CACLhG,EAAE,aAAAoB,MAAA,CAAc4E,KAAK,CAAE,CACvB1K,MAAM,CAAE,CACNC,CAAC,CAAED,MAAM,CAACC,CAAC,EAAI,CAAC,CAChBC,CAAC,CAAEF,MAAM,CAACE,CAAC,EAAI,CAAC,CAChBpI,KAAK,CAAEkI,MAAM,CAAClI,KAAK,EAAI,GAAG,CAC1BC,MAAM,CAAEiI,MAAM,CAACjI,MAAM,EAAI,GAC3B,CAAC,CACDoI,MAAM,CAAE,CACNC,IAAI,CAAED,MAAM,CAACC,IAAI,EAAI,UAAU,CAC/BC,IAAI,CAAEF,MAAM,CAACE,IAAI,EAAI,EAAE,CACvBgQ,IAAI,CAAElQ,MAAM,CAACkQ,IAAI,EAAI,EAAE,CACvB1L,GAAG,CAAExE,MAAM,CAACwE,GAAG,EAAI,EAAE,CACrBC,eAAe,CAAEzE,MAAM,CAACyE,eAAe,EAAI,EAC7C,CAAC,CACD5M,KAAK,CACLoY,KACF,CAAC,CACH,CAAC,CAAC,CACJ,CAAE,MAAOlW,KAAK,CAAE,CACd+C,OAAO,CAAC/C,KAAK,CAAC,qBAAqB,CAAEA,KAAK,CAAC,CAC3C,KAAM,CAAAA,KAAK,CACb,CACF,CAAC,CAED,KAAM,CAAAoW,gBAAgB,CAAGA,CAAA,GAAM,CAC7B,GAAI,CACF,KAAM,CAAAJ,QAAQ,CAAGvQ,IAAI,CAACkL,KAAK,CAAC/G,cAAc,CAAC,CAE3C;AACA,GAAIoM,QAAQ,CAACrQ,IAAI,CAAE,CACjB,KAAM,CAAAiL,YAAY,CAAG,CAAEhT,KAAK,CAAEoY,QAAQ,CAACrQ,IAAI,CAAC/H,KAAK,CAAEC,MAAM,CAAEmY,QAAQ,CAACrQ,IAAI,CAAC9H,MAAO,CAAC,CACjF,KAAM,CAAAgT,WAAW,CAAGC,MAAM,CAACC,MAAM,CAACrT,oBAAoB,CAAC,CAACsT,IAAI,CAACC,YAAY,EACvEA,YAAY,CAACrT,KAAK,GAAKgT,YAAY,CAAChT,KAAK,EAAIqT,YAAY,CAACpT,MAAM,GAAK+S,YAAY,CAAC/S,MACpF,CAAC,CAED,GAAI,CAACgT,WAAW,CAAE,CAChB,KAAM,CAAAK,YAAY,CAAGJ,MAAM,CAACC,MAAM,CAACrT,oBAAoB,CAAC,CAAC0R,GAAG,CAACzJ,IAAI,KAAAiG,MAAA,CAAOjG,IAAI,CAAC/H,KAAK,QAAAgO,MAAA,CAAMjG,IAAI,CAAC9H,MAAM,CAAE,CAAC,CAACsT,IAAI,CAAC,MAAM,CAAC,CACnHlR,QAAQ,yEAAA2L,MAAA,CAAoEsF,YAAY,CAAE,CAAC,CAC3F,OACF,CACF,CAEA,KAAM,CAAA3J,QAAQ,CAAGuO,mBAAmB,CAAClM,cAAc,CAAC,CACpDG,mBAAmB,CAACxC,QAAQ,CAAC,CAC7B0C,uBAAuB,CAAC,IAAI,CAAC,CAE7B;AACA;AACA,KAAM,CAAAoM,aAAa,CAAGL,QAAQ,CAE9B5Q,eAAe,CAAC,CACdC,IAAI,CAAEgR,aAAa,CAAChR,IAAI,EAAI,oBAAoB,CAChDC,WAAW,CAAE+Q,aAAa,CAAC/Q,WAAW,EAAI,aAAa,CACvDC,gBAAgB,CAAE8Q,aAAa,CAACzQ,QAAQ,EAAI,KAAK,CACjDJ,IAAI,CAAEC,IAAI,CAACC,SAAS,CAAC2Q,aAAa,CAAE,IAAI,CAAE,CAAC,CAC7C,CAAC,CAAC,CAEF;AACAlW,UAAU,0BAAAyL,MAAA,CAA0BrE,QAAQ,CAACvG,MAAM,cAAY,CAAC,CAClE,CAAE,MAAOhB,KAAK,CAAE,CACdC,QAAQ,0BAAA2L,MAAA,CAA0B5L,KAAK,WAAY,CAAAhE,KAAK,CAAGgE,KAAK,CAAC0M,OAAO,CAAG,qBAAqB,CAAE,CAAC,CACrG,CACF,CAAC,CAED,KAAM,CAAA4J,qBAAqB,CAAGA,CAAA,GAAM,CAClCvM,mBAAmB,CAAC,EAAE,CAAC,CACvBE,uBAAuB,CAAC,KAAK,CAAC,CAC9BJ,iBAAiB,CAAC,EAAE,CAAC,CACvB,CAAC,CAED,KAAM,CAAA0M,iBAAiB,CAAGA,CAACzH,KAAuB,CAAEuF,OAAgB,GAAK,CACvEvF,KAAK,CAAC9D,cAAc,CAAC,CAAC,CACtBb,cAAc,CAAC,CACboK,MAAM,CAAEzF,KAAK,CAAC0H,OAAO,CAAG,CAAC,CACzBhC,MAAM,CAAE1F,KAAK,CAAC2H,OAAO,CAAG,CAAC,CACzBpC,OACF,CAAC,CAAC,CACJ,CAAC,CAED,KAAM,CAAAqC,sBAAsB,CAAGA,CAAA,GAAM,CACnCvM,cAAc,CAAC,IAAI,CAAC,CACtB,CAAC,CAED,KAAM,CAAAwM,mBAAmB,CAAInB,SAAiB,EAAK,CACjD;AACAhO,WAAW,CAACkO,YAAY,EAAIA,YAAY,CAAC9F,MAAM,CAAC+F,CAAC,EAAIA,CAAC,CAACnL,EAAE,GAAKgL,SAAS,CAAC,CAAC,CAEzE;AACAzL,mBAAmB,CAAC2L,YAAY,EAAIA,YAAY,CAAC9F,MAAM,CAAC+F,CAAC,EAAIA,CAAC,CAACnL,EAAE,GAAKgL,SAAS,CAAC,CAAC,CAEjF;AACA9N,eAAe,CAAC2D,IAAI,OAAAuL,qBAAA,CAAAC,qBAAA,QAAAvL,aAAA,CAAAA,aAAA,IACfD,IAAI,MACP/C,eAAe,CAAE,EAAAsO,qBAAA,CAAAvL,IAAI,CAAC/C,eAAe,UAAAsO,qBAAA,iBAApBA,qBAAA,CAAsBpM,EAAE,IAAKgL,SAAS,CAAG,IAAI,CAAGnK,IAAI,CAAC/C,eAAe,CACrFG,eAAe,CAAE,EAAAoO,qBAAA,CAAAxL,IAAI,CAAC5C,eAAe,UAAAoO,qBAAA,iBAApBA,qBAAA,CAAsBrM,EAAE,IAAKgL,SAAS,CAAG,IAAI,CAAGnK,IAAI,CAAC5C,eAAe,IACrF,CAAC,CAEHiO,sBAAsB,CAAC,CAAC,CACxBzT,oBAAoB,CAAC,CAAC,CACxB,CAAC,CAED,KAAM,CAAA6T,iBAAiB,CAAItB,SAAiB,EAAK,CAC/C,KAAM,CAAAnB,OAAO,CAAG,CAAC,GAAG9M,QAAQ,CAAE,GAAGuC,gBAAgB,CAAC,CAACyF,IAAI,CAACoG,CAAC,EAAIA,CAAC,CAACnL,EAAE,GAAKgL,SAAS,CAAC,CAChF,GAAInB,OAAO,CAAE,CACX3M,eAAe,CAAC2D,IAAI,EAAAC,aAAA,CAAAA,aAAA,IACfD,IAAI,MACPhD,UAAU,CAAE,IAAI,CAChBC,eAAe,CAAE+L,OAAO,CACxB9L,UAAU,CAAE,CAAExC,CAAC,CAAE,CAAC,CAAEC,CAAC,CAAE,CAAE,CAAC,EAC1B,CAAC,CACL,CACA0Q,sBAAsB,CAAC,CAAC,CAC1B,CAAC,CAED,KAAM,CAAAK,cAAc,CAAGA,CAACP,OAAe,CAAEC,OAAe,GAAa,CACnE,GAAI,CAAC3P,kBAAkB,CAAE,MAAO,SAAS,CAEzC,KAAM,CAAAkQ,MAAM,CAAGC,oBAAoB,CAACT,OAAO,CAAEC,OAAO,CAAC,CAErD;AACA,KAAM,CAAAS,cAAc,CAAG,CAAC,GAAG3P,QAAQ,CAAE,IAAIyC,oBAAoB,CAAGF,gBAAgB,CAAG,EAAE,CAAC,CAAC,CAACyF,IAAI,CAAC8E,OAAO,EAClG2C,MAAM,CAACjR,CAAC,EAAIsO,OAAO,CAACvO,MAAM,CAACC,CAAC,EAC5BiR,MAAM,CAACjR,CAAC,EAAIsO,OAAO,CAACvO,MAAM,CAACC,CAAC,CAAGsO,OAAO,CAACvO,MAAM,CAAClI,KAAK,EACnDoZ,MAAM,CAAChR,CAAC,EAAIqO,OAAO,CAACvO,MAAM,CAACE,CAAC,EAC5BgR,MAAM,CAAChR,CAAC,EAAIqO,OAAO,CAACvO,MAAM,CAACE,CAAC,CAAGqO,OAAO,CAACvO,MAAM,CAACjI,MAChD,CAAC,CAED,GAAIqZ,cAAc,CAAE,CAClB;AACA,KAAM,CAAAC,UAAU,CAAG,CAAC,CACpB,KAAM,CAAApR,CAAC,CAAGiR,MAAM,CAACjR,CAAC,CAClB,KAAM,CAAAC,CAAC,CAAGgR,MAAM,CAAChR,CAAC,CAElB,GAAID,CAAC,EAAImR,cAAc,CAACpR,MAAM,CAACC,CAAC,CAAGoR,UAAU,EAAInR,CAAC,EAAIkR,cAAc,CAACpR,MAAM,CAACE,CAAC,CAAGmR,UAAU,CAAE,CAC1F,MAAO,WAAW,CAAE;AACtB,CAAC,IAAM,IAAIpR,CAAC,EAAImR,cAAc,CAACpR,MAAM,CAACC,CAAC,CAAGmR,cAAc,CAACpR,MAAM,CAAClI,KAAK,CAAGuZ,UAAU,EAAInR,CAAC,EAAIkR,cAAc,CAACpR,MAAM,CAACE,CAAC,CAAGmR,UAAU,CAAE,CAC/H,MAAO,WAAW,CAAE;AACtB,CAAC,IAAM,IAAIpR,CAAC,EAAImR,cAAc,CAACpR,MAAM,CAACC,CAAC,CAAGoR,UAAU,EAAInR,CAAC,EAAIkR,cAAc,CAACpR,MAAM,CAACE,CAAC,CAAGkR,cAAc,CAACpR,MAAM,CAACjI,MAAM,CAAGsZ,UAAU,CAAE,CAChI,MAAO,WAAW,CAAE;AACtB,CAAC,IAAM,IAAIpR,CAAC,EAAImR,cAAc,CAACpR,MAAM,CAACC,CAAC,CAAGmR,cAAc,CAACpR,MAAM,CAAClI,KAAK,CAAGuZ,UAAU,EAAInR,CAAC,EAAIkR,cAAc,CAACpR,MAAM,CAACE,CAAC,CAAGkR,cAAc,CAACpR,MAAM,CAACjI,MAAM,CAAGsZ,UAAU,CAAE,CAC9J,MAAO,WAAW,CAAE;AACtB,CAAC,IAAM,CACL,MAAO,MAAM,CAAE;AACjB,CACF,CAEA;AACA,GAAI1P,YAAY,CAACE,SAAS,CAAE,CAC1B,MAAO,WAAW,CACpB,CAAC,IAAM,IAAIF,YAAY,CAACY,UAAU,EAAIZ,YAAY,CAACe,UAAU,CAAE,CAC7D,MAAO,UAAU,CACnB,CAAC,IAAM,CACL,MAAO,SAAS,CAClB,CACF,CAAC,CAED;AACA,KAAM,CAAAyO,oBAAoB,CAAGA,CAACT,OAAe,CAAEC,OAAe,GAAK,CACjE,KAAM,CAAAlV,MAAM,CAAGC,SAAS,CAACC,OAAO,CAChC,GAAI,CAACF,MAAM,EAAI,CAACF,WAAW,CAAE,MAAO,CAAE0E,CAAC,CAAE,CAAC,CAAEC,CAAC,CAAE,CAAE,CAAC,CAElD,KAAM,CAAAoR,IAAI,CAAG7V,MAAM,CAAC8V,qBAAqB,CAAC,CAAC,CAE3C;AACA,KAAM,CAAA5C,OAAO,CAAG,CAAC+B,OAAO,CAAGY,IAAI,CAACE,IAAI,GAAK/V,MAAM,CAAC3D,KAAK,CAAGwZ,IAAI,CAACxZ,KAAK,CAAC,CACnE,KAAM,CAAA8W,OAAO,CAAG,CAAC+B,OAAO,CAAGW,IAAI,CAACG,GAAG,GAAKhW,MAAM,CAAC1D,MAAM,CAAGuZ,IAAI,CAACvZ,MAAM,CAAC,CAEpE;AACA,KAAM,CAAA2Z,YAAY,CAAG,CAAC/C,OAAO,CAAGhN,YAAY,CAACO,GAAG,CAACjC,CAAC,CAAG0B,YAAY,CAACM,IAAI,EAAIN,YAAY,CAACM,IAAI,CAC3F,KAAM,CAAA0P,YAAY,CAAG,CAAC/C,OAAO,CAAGjN,YAAY,CAACO,GAAG,CAAChC,CAAC,CAAGyB,YAAY,CAACM,IAAI,EAAIN,YAAY,CAACM,IAAI,CAE3F;AACA,KAAM,CAAA3F,KAAK,CAAG0R,UAAU,CAACvS,MAAM,CAACoB,OAAO,CAACP,KAAK,EAAI,GAAG,CAAC,CACrD,KAAM,CAAAG,UAAU,CAAGuR,UAAU,CAACvS,MAAM,CAACoB,OAAO,CAACJ,UAAU,EAAI,GAAG,CAAC,CAC/D,KAAM,CAAAC,WAAW,CAAGsR,UAAU,CAACvS,MAAM,CAACoB,OAAO,CAACH,WAAW,EAAI,GAAG,CAAC,CACjE,KAAM,CAAAC,OAAO,CAAGqR,UAAU,CAACvS,MAAM,CAACoB,OAAO,CAACF,OAAO,EAAI,GAAG,CAAC,CACzD,KAAM,CAAAC,OAAO,CAAGoR,UAAU,CAACvS,MAAM,CAACoB,OAAO,CAACD,OAAO,EAAI,GAAG,CAAC,CACzD,KAAM,CAAAG,UAAU,CAAG6U,QAAQ,CAACnW,MAAM,CAACoB,OAAO,CAACE,UAAU,EAAI,GAAG,CAAC,CAC7D,KAAM,CAAAC,WAAW,CAAG4U,QAAQ,CAACnW,MAAM,CAACoB,OAAO,CAACG,WAAW,EAAI,GAAG,CAAC,CAE/D,GAAIV,KAAK,CAAG,CAAC,EAAIG,UAAU,CAAG,CAAC,EAAIC,WAAW,CAAG,CAAC,CAAE,CAClD;AACA,KAAM,CAAAmV,MAAM,CAAG,CAACH,YAAY,CAAG/U,OAAO,EAAIL,KAAK,CAC/C,KAAM,CAAAwV,MAAM,CAAG,CAACH,YAAY,CAAG/U,OAAO,EAAIN,KAAK,CAE/C;AACA,KAAM,CAAAyV,QAAQ,CAAGxV,IAAI,CAAC+I,GAAG,CAAC,CAAC,CAAE/I,IAAI,CAACC,GAAG,CAACqV,MAAM,CAAE9U,UAAU,CAAC,CAAC,CAC1D,KAAM,CAAAiV,QAAQ,CAAGzV,IAAI,CAAC+I,GAAG,CAAC,CAAC,CAAE/I,IAAI,CAACC,GAAG,CAACsV,MAAM,CAAE9U,WAAW,CAAC,CAAC,CAE3D;AACA,GAAI2E,YAAY,CAACE,SAAS,CAAE,CAC1B5E,OAAO,CAACC,GAAG,CAAC,yCAAyC,CAAE,CACrD+U,YAAY,CAAE,CAAEhS,CAAC,CAAEyQ,OAAO,CAAExQ,CAAC,CAAEyQ,OAAQ,CAAC,CACxCW,IAAI,CAAE,CAAEE,IAAI,CAAEF,IAAI,CAACE,IAAI,CAAEC,GAAG,CAAEH,IAAI,CAACG,GAAG,CAAE3Z,KAAK,CAAEwZ,IAAI,CAACxZ,KAAK,CAAEC,MAAM,CAAEuZ,IAAI,CAACvZ,MAAO,CAAC,CAChFma,YAAY,CAAE,CAAEjS,CAAC,CAAE0O,OAAO,CAAEzO,CAAC,CAAE0O,OAAQ,CAAC,CACxCuD,iBAAiB,CAAE,CAAElS,CAAC,CAAEyR,YAAY,CAAExR,CAAC,CAAEyR,YAAa,CAAC,CACvDrV,KAAK,CACL4R,eAAe,CAAE,CAAEpW,KAAK,CAAE2E,UAAU,CAAE1E,MAAM,CAAE2E,WAAY,CAAC,CAC3DyR,MAAM,CAAE,CAAElO,CAAC,CAAEtD,OAAO,CAAEuD,CAAC,CAAEtD,OAAQ,CAAC,CAClCwV,WAAW,CAAE,CAAEnS,CAAC,CAAE4R,MAAM,CAAE3R,CAAC,CAAE4R,MAAO,CAAC,CACrCO,aAAa,CAAE,CAAEpS,CAAC,CAAE8R,QAAQ,CAAE7R,CAAC,CAAE8R,QAAS,CAC5C,CAAC,CAAC,CACJ,CAEA,MAAO,CAAE/R,CAAC,CAAE8R,QAAQ,CAAE7R,CAAC,CAAE8R,QAAS,CAAC,CACrC,CAAC,IAAM,CACL;AACA,KAAM,CAAAM,UAAU,CAAG/V,IAAI,CAACC,GAAG,CACzBf,MAAM,CAAC3D,KAAK,CAAGyD,WAAW,CAACzD,KAAK,CAChC2D,MAAM,CAAC1D,MAAM,CAAGwD,WAAW,CAACxD,MAC9B,CAAC,CAED,KAAM,CAAAwa,WAAW,CAAGhW,IAAI,CAACgT,KAAK,CAAChU,WAAW,CAACzD,KAAK,CAAGwa,UAAU,CAAC,CAC9D,KAAM,CAAAE,YAAY,CAAGjW,IAAI,CAACgT,KAAK,CAAChU,WAAW,CAACxD,MAAM,CAAGua,UAAU,CAAC,CAChE,KAAM,CAAAG,eAAe,CAAGlW,IAAI,CAACgT,KAAK,CAAC,CAAC9T,MAAM,CAAC3D,KAAK,CAAGya,WAAW,EAAI,CAAC,CAAC,CACpE,KAAM,CAAAG,eAAe,CAAGnW,IAAI,CAACgT,KAAK,CAAC,CAAC9T,MAAM,CAAC1D,MAAM,CAAGya,YAAY,EAAI,CAAC,CAAC,CAEtE,KAAM,CAAAX,MAAM,CAAG,CAACH,YAAY,CAAGe,eAAe,EAAIH,UAAU,CAC5D,KAAM,CAAAR,MAAM,CAAG,CAACH,YAAY,CAAGe,eAAe,EAAIJ,UAAU,CAE5D,KAAM,CAAAP,QAAQ,CAAGxV,IAAI,CAAC+I,GAAG,CAAC,CAAC,CAAE/I,IAAI,CAACC,GAAG,CAACqV,MAAM,CAAEtW,WAAW,CAACzD,KAAK,CAAC,CAAC,CACjE,KAAM,CAAAka,QAAQ,CAAGzV,IAAI,CAAC+I,GAAG,CAAC,CAAC,CAAE/I,IAAI,CAACC,GAAG,CAACsV,MAAM,CAAEvW,WAAW,CAACxD,MAAM,CAAC,CAAC,CAElE,MAAO,CAAEkI,CAAC,CAAE8R,QAAQ,CAAE7R,CAAC,CAAE8R,QAAS,CAAC,CACrC,CACF,CAAC,CAED,KAAM,CAAAW,UAAU,CAAGA,CAACC,KAAa,CAAExQ,QAAgB,GAAa,CAC9D,GAAI,CAACT,YAAY,CAACQ,QAAQ,CAAE,MAAO,CAAAyQ,KAAK,CACxC,MAAO,CAAArW,IAAI,CAACgT,KAAK,CAACqD,KAAK,CAAGxQ,QAAQ,CAAC,CAAGA,QAAQ,CAChD,CAAC,CAED,KAAM,CAAAyQ,eAAe,CAAGA,CAAC5S,CAAS,CAAEC,CAAS,GAAK,CAChD,MAAO,CACLD,CAAC,CAAE0S,UAAU,CAAC1S,CAAC,CAAE0B,YAAY,CAACS,QAAQ,CAAC,CACvClC,CAAC,CAAEyS,UAAU,CAACzS,CAAC,CAAEyB,YAAY,CAACS,QAAQ,CACxC,CAAC,CACH,CAAC,CAED,KAAM,CAAA0Q,qBAAqB,CAAI7N,CAAsC,EAAK,CACxE,GAAI,CAACjE,kBAAkB,CAAE,OAEzB,KAAM,CAAAkQ,MAAM,CAAGC,oBAAoB,CAAClM,CAAC,CAACyL,OAAO,CAAEzL,CAAC,CAAC0L,OAAO,CAAC,CAEzD;AACA1T,OAAO,CAACC,GAAG,CAAC,0BAA0B,CAAE,CACtCwT,OAAO,CAAEzL,CAAC,CAACyL,OAAO,CAClBC,OAAO,CAAE1L,CAAC,CAAC0L,OAAO,CAClByB,WAAW,CAAElB,MAAM,CACnB3V,WAAW,CAAEA,WAAW,CAAG,CAAEzD,KAAK,CAAEyD,WAAW,CAACzD,KAAK,CAAEC,MAAM,CAAEwD,WAAW,CAACxD,MAAO,CAAC,CAAG,IAAI,CAC1F0J,QAAQ,CAAEA,QAAQ,CAAC6H,GAAG,CAACuG,CAAC,GAAK,CAC3BnL,EAAE,CAAEmL,CAAC,CAACnL,EAAE,CACR1E,MAAM,CAAE6P,CAAC,CAAC7P,MAAM,CAChB+S,QAAQ,CAAE7B,MAAM,CAACjR,CAAC,EAAI4P,CAAC,CAAC7P,MAAM,CAACC,CAAC,EACvBiR,MAAM,CAACjR,CAAC,EAAI4P,CAAC,CAAC7P,MAAM,CAACC,CAAC,CAAG4P,CAAC,CAAC7P,MAAM,CAAClI,KAAK,EACvCoZ,MAAM,CAAChR,CAAC,EAAI2P,CAAC,CAAC7P,MAAM,CAACE,CAAC,EACtBgR,MAAM,CAAChR,CAAC,EAAI2P,CAAC,CAAC7P,MAAM,CAACE,CAAC,CAAG2P,CAAC,CAAC7P,MAAM,CAACjI,MAC7C,CAAC,CAAC,CACJ,CAAC,CAAC,CAEF;AACA,GAAIkN,CAAC,CAAC+N,QAAQ,CAAE,CAAE;AAChB,KAAM,CAAAC,YAAqB,CAAG,CAC5BvO,EAAE,UAAAoB,MAAA,CAAWoN,IAAI,CAACC,GAAG,CAAC,CAAC,CAAE,CACzBnT,MAAM,CAAE,CACNC,CAAC,CAAEiR,MAAM,CAACjR,CAAC,CAAG,CAAC,CACfC,CAAC,CAAEgR,MAAM,CAAChR,CAAC,CAAG,CAAC,CACfpI,KAAK,CAAE,EAAE,CACTC,MAAM,CAAE,EACV,CAAC,CACDoI,MAAM,CAAE,CAAEC,IAAI,CAAE,UAAU,CAAEC,IAAI,CAAE,cAAe,CAAC,CAClDrI,KAAK,WAAA8N,MAAA,CAAYvJ,IAAI,CAACgT,KAAK,CAAC2B,MAAM,CAACjR,CAAC,CAAC,OAAA6F,MAAA,CAAKvJ,IAAI,CAACgT,KAAK,CAAC2B,MAAM,CAAChR,CAAC,CAAC,KAAG,CACjEkQ,KAAK,CAAE,SACT,CAAC,CACD1O,WAAW,CAAC,CAAC,GAAGD,QAAQ,CAAEwR,YAAY,CAAC,CAAC,CACxCvF,UAAU,CAAC,CAAC,CACZzQ,OAAO,CAACC,GAAG,CAAC,2BAA2B,CAAEgU,MAAM,CAAC,CAChD,OACF,CAEA;AACA,KAAM,CAAAkC,cAAc,CAAG3R,QAAQ,CAACgI,IAAI,CAAC8E,OAAO,EAC1C2C,MAAM,CAACjR,CAAC,EAAIsO,OAAO,CAACvO,MAAM,CAACC,CAAC,EAC5BiR,MAAM,CAACjR,CAAC,EAAIsO,OAAO,CAACvO,MAAM,CAACC,CAAC,CAAGsO,OAAO,CAACvO,MAAM,CAAClI,KAAK,EACnDoZ,MAAM,CAAChR,CAAC,EAAIqO,OAAO,CAACvO,MAAM,CAACE,CAAC,EAC5BgR,MAAM,CAAChR,CAAC,EAAIqO,OAAO,CAACvO,MAAM,CAACE,CAAC,CAAGqO,OAAO,CAACvO,MAAM,CAACjI,MAChD,CAAC,CAED,GAAIqb,cAAc,CAAE,CAClB;AACA,KAAM,CAAA/B,UAAU,CAAG,CAAC,CACpB,KAAM,CAAA9C,OAAO,CAAG6E,cAAc,CAC9B,KAAM,CAAAnT,CAAC,CAAGiR,MAAM,CAACjR,CAAC,CAClB,KAAM,CAAAC,CAAC,CAAGgR,MAAM,CAAChR,CAAC,CAElB;AACA,GAAID,CAAC,EAAIsO,OAAO,CAACvO,MAAM,CAACC,CAAC,CAAGoR,UAAU,EAAInR,CAAC,EAAIqO,OAAO,CAACvO,MAAM,CAACE,CAAC,CAAGmR,UAAU,CAAE,CAC5E;AACAzP,eAAe,CAAA4D,aAAA,CAAAA,aAAA,IACV7D,YAAY,MACfe,UAAU,CAAE,IAAI,CAChBC,eAAe,CAAE4L,OAAO,CACxB3L,YAAY,CAAE,IAAI,EACnB,CAAC,CACJ,CAAC,IAAM,IAAI3C,CAAC,EAAIsO,OAAO,CAACvO,MAAM,CAACC,CAAC,CAAGsO,OAAO,CAACvO,MAAM,CAAClI,KAAK,CAAGuZ,UAAU,EAAInR,CAAC,EAAIqO,OAAO,CAACvO,MAAM,CAACE,CAAC,CAAGmR,UAAU,CAAE,CAC1G;AACAzP,eAAe,CAAA4D,aAAA,CAAAA,aAAA,IACV7D,YAAY,MACfe,UAAU,CAAE,IAAI,CAChBC,eAAe,CAAE4L,OAAO,CACxB3L,YAAY,CAAE,IAAI,EACnB,CAAC,CACJ,CAAC,IAAM,IAAI3C,CAAC,EAAIsO,OAAO,CAACvO,MAAM,CAACC,CAAC,CAAGoR,UAAU,EAAInR,CAAC,EAAIqO,OAAO,CAACvO,MAAM,CAACE,CAAC,CAAGqO,OAAO,CAACvO,MAAM,CAACjI,MAAM,CAAGsZ,UAAU,CAAE,CAC3G;AACAzP,eAAe,CAAA4D,aAAA,CAAAA,aAAA,IACV7D,YAAY,MACfe,UAAU,CAAE,IAAI,CAChBC,eAAe,CAAE4L,OAAO,CACxB3L,YAAY,CAAE,IAAI,EACnB,CAAC,CACJ,CAAC,IAAM,IAAI3C,CAAC,EAAIsO,OAAO,CAACvO,MAAM,CAACC,CAAC,CAAGsO,OAAO,CAACvO,MAAM,CAAClI,KAAK,CAAGuZ,UAAU,EAAInR,CAAC,EAAIqO,OAAO,CAACvO,MAAM,CAACE,CAAC,CAAGqO,OAAO,CAACvO,MAAM,CAACjI,MAAM,CAAGsZ,UAAU,CAAE,CAClI;AACAzP,eAAe,CAAA4D,aAAA,CAAAA,aAAA,IACV7D,YAAY,MACfe,UAAU,CAAE,IAAI,CAChBC,eAAe,CAAE4L,OAAO,CACxB3L,YAAY,CAAE,IAAI,EACnB,CAAC,CACJ,CAAC,IAAM,CACL;AACA,KAAM,CAAAyQ,aAAa,CAAGR,eAAe,CAAC3B,MAAM,CAACjR,CAAC,CAAEiR,MAAM,CAAChR,CAAC,CAAC,CACzD0B,eAAe,CAAA4D,aAAA,CAAAA,aAAA,IACV7D,YAAY,MACfY,UAAU,CAAE,IAAI,CAChBC,eAAe,CAAE+L,OAAO,CACxB9L,UAAU,CAAE,CACVxC,CAAC,CAAEoT,aAAa,CAACpT,CAAC,CAAGsO,OAAO,CAACvO,MAAM,CAACC,CAAC,CACrCC,CAAC,CAAEmT,aAAa,CAACnT,CAAC,CAAGqO,OAAO,CAACvO,MAAM,CAACE,CACtC,CAAC,EACF,CAAC,CACJ,CACA,OACF,CAEA;AACA,KAAM,CAAAmT,aAAa,CAAGR,eAAe,CAAC3B,MAAM,CAACjR,CAAC,CAAEiR,MAAM,CAAChR,CAAC,CAAC,CACzD0B,eAAe,CAAA4D,aAAA,CAAAA,aAAA,IACV7D,YAAY,MACfE,SAAS,CAAE,IAAI,CACfC,MAAM,CAAEuR,aAAa,CAACpT,CAAC,CACvB8B,MAAM,CAAEsR,aAAa,CAACnT,CAAC,CACvB8B,cAAc,CAAE,IAAI,EACrB,CAAC,CACJ,CAAC,CAED,KAAM,CAAAsR,kBAAkB,CAAIrO,CAAsC,EAAK,CACrE,KAAM,CAAAkO,GAAG,CAAGD,IAAI,CAACC,GAAG,CAAC,CAAC,CACtB,GAAIA,GAAG,CAAG1P,iBAAiB,CAAGE,aAAa,CAAE,CAC3C,OACF,CACAD,oBAAoB,CAACyP,GAAG,CAAC,CACzBI,qBAAqB,CAACtO,CAAC,CAAC,CAC1B,CAAC,CAED,KAAM,CAAAsO,qBAAqB,CAAItO,CAAsC,EAAK,CACxE,GAAI,CAACjE,kBAAkB,CAAE,OAEzB,KAAM,CAAAkQ,MAAM,CAAGC,oBAAoB,CAAClM,CAAC,CAACyL,OAAO,CAAEzL,CAAC,CAAC0L,OAAO,CAAC,CAEzD;AACA/O,eAAe,CAAA4D,aAAA,CAAAA,aAAA,IACV7D,YAAY,MACfoB,aAAa,CAAEmO,MAAM,EACtB,CAAC,CAEF;AACA,GAAIvP,YAAY,CAACe,UAAU,EAAIf,YAAY,CAACgB,eAAe,CAAE,CAC3D,KAAM,CAAA4L,OAAO,CAAG5M,YAAY,CAACgB,eAAe,CAC5C,KAAM,CAAA0Q,aAAa,CAAGR,eAAe,CAAC3B,MAAM,CAACjR,CAAC,CAAEiR,MAAM,CAAChR,CAAC,CAAC,CAEzD,GAAI,CAAAyP,SAAS,CAAAnK,aAAA,IAAQ+I,OAAO,CAACvO,MAAM,CAAE,CAErC,OAAQ2B,YAAY,CAACiB,YAAY,EAC/B,IAAK,IAAI,CACP+M,SAAS,CAAC7X,KAAK,CAAGyW,OAAO,CAACvO,MAAM,CAACC,CAAC,CAAGsO,OAAO,CAACvO,MAAM,CAAClI,KAAK,CAAGub,aAAa,CAACpT,CAAC,CAC3E0P,SAAS,CAAC5X,MAAM,CAAGwW,OAAO,CAACvO,MAAM,CAACE,CAAC,CAAGqO,OAAO,CAACvO,MAAM,CAACjI,MAAM,CAAGsb,aAAa,CAACnT,CAAC,CAC7EyP,SAAS,CAAC1P,CAAC,CAAGoT,aAAa,CAACpT,CAAC,CAC7B0P,SAAS,CAACzP,CAAC,CAAGmT,aAAa,CAACnT,CAAC,CAC7B,MACF,IAAK,IAAI,CACPyP,SAAS,CAAC7X,KAAK,CAAGub,aAAa,CAACpT,CAAC,CAAGsO,OAAO,CAACvO,MAAM,CAACC,CAAC,CACpD0P,SAAS,CAAC5X,MAAM,CAAGwW,OAAO,CAACvO,MAAM,CAACE,CAAC,CAAGqO,OAAO,CAACvO,MAAM,CAACjI,MAAM,CAAGsb,aAAa,CAACnT,CAAC,CAC7EyP,SAAS,CAACzP,CAAC,CAAGmT,aAAa,CAACnT,CAAC,CAC7B,MACF,IAAK,IAAI,CACPyP,SAAS,CAAC7X,KAAK,CAAGyW,OAAO,CAACvO,MAAM,CAACC,CAAC,CAAGsO,OAAO,CAACvO,MAAM,CAAClI,KAAK,CAAGub,aAAa,CAACpT,CAAC,CAC3E0P,SAAS,CAAC5X,MAAM,CAAGsb,aAAa,CAACnT,CAAC,CAAGqO,OAAO,CAACvO,MAAM,CAACE,CAAC,CACrDyP,SAAS,CAAC1P,CAAC,CAAGoT,aAAa,CAACpT,CAAC,CAC7B,MACF,IAAK,IAAI,CACP0P,SAAS,CAAC7X,KAAK,CAAGub,aAAa,CAACpT,CAAC,CAAGsO,OAAO,CAACvO,MAAM,CAACC,CAAC,CACpD0P,SAAS,CAAC5X,MAAM,CAAGsb,aAAa,CAACnT,CAAC,CAAGqO,OAAO,CAACvO,MAAM,CAACE,CAAC,CACrD,MACJ,CAEA;AACA,GAAIyP,SAAS,CAAC7X,KAAK,CAAG,EAAE,EAAI6X,SAAS,CAAC5X,MAAM,CAAG,EAAE,CAAE,CACjD,KAAM,CAAAyb,cAAc,CAAAhO,aAAA,CAAAA,aAAA,IAAQ+I,OAAO,MAAEvO,MAAM,CAAE2P,SAAS,EAAE,CACxDF,qBAAqB,CAAClB,OAAO,CAAC7J,EAAE,CAAEiL,SAAS,CAAC,CAC5C/N,eAAe,CAAA4D,aAAA,CAAAA,aAAA,IACV7D,YAAY,MACfgB,eAAe,CAAE6Q,cAAc,EAChC,CAAC,CACJ,CACA,OACF,CAEA;AACA,GAAI7R,YAAY,CAACY,UAAU,EAAIZ,YAAY,CAACa,eAAe,CAAE,CAC3D,KAAM,CAAA+L,OAAO,CAAG5M,YAAY,CAACa,eAAe,CAC5C,KAAM,CAAA6Q,aAAa,CAAGR,eAAe,CAAC3B,MAAM,CAACjR,CAAC,CAAEiR,MAAM,CAAChR,CAAC,CAAC,CAEzD,KAAM,CAAAyP,SAAS,CAAG,CAChB1P,CAAC,CAAEoT,aAAa,CAACpT,CAAC,CAAG0B,YAAY,CAACc,UAAU,CAACxC,CAAC,CAC9CC,CAAC,CAAEmT,aAAa,CAACnT,CAAC,CAAGyB,YAAY,CAACc,UAAU,CAACvC,CAAC,CAC9CpI,KAAK,CAAEyW,OAAO,CAACvO,MAAM,CAAClI,KAAK,CAC3BC,MAAM,CAAEwW,OAAO,CAACvO,MAAM,CAACjI,MACzB,CAAC,CAED,KAAM,CAAAyb,cAAc,CAAAhO,aAAA,CAAAA,aAAA,IAAQ+I,OAAO,MAAEvO,MAAM,CAAE2P,SAAS,EAAE,CACxDF,qBAAqB,CAAClB,OAAO,CAAC7J,EAAE,CAAEiL,SAAS,CAAC,CAC5C/N,eAAe,CAAA4D,aAAA,CAAAA,aAAA,IACV7D,YAAY,MACfa,eAAe,CAAEgR,cAAc,EAChC,CAAC,CACF,OACF,CAEA;AACA,GAAI7R,YAAY,CAACE,SAAS,CAAE,CAC1B,KAAM,CAAAwR,aAAa,CAAGR,eAAe,CAAC3B,MAAM,CAACjR,CAAC,CAAEiR,MAAM,CAAChR,CAAC,CAAC,CAEzD,KAAM,CAAApI,KAAK,CAAGyE,IAAI,CAAC6Q,GAAG,CAACiG,aAAa,CAACpT,CAAC,CAAG0B,YAAY,CAACG,MAAM,CAAC,CAC7D,KAAM,CAAA/J,MAAM,CAAGwE,IAAI,CAAC6Q,GAAG,CAACiG,aAAa,CAACnT,CAAC,CAAGyB,YAAY,CAACI,MAAM,CAAC,CAC9D,KAAM,CAAA9B,CAAC,CAAG1D,IAAI,CAACC,GAAG,CAAC6W,aAAa,CAACpT,CAAC,CAAE0B,YAAY,CAACG,MAAM,CAAC,CACxD,KAAM,CAAA5B,CAAC,CAAG3D,IAAI,CAACC,GAAG,CAAC6W,aAAa,CAACnT,CAAC,CAAEyB,YAAY,CAACI,MAAM,CAAC,CAExD;AACA,KAAM,CAAAC,cAAuB,CAAG,CAC9B0C,EAAE,CAAE,SAAS,CACb1E,MAAM,CAAE,CAAEC,CAAC,CAAEC,CAAC,CAAEpI,KAAK,CAAEC,MAAO,CAAC,CAC/BoI,MAAM,CAAE,CAAEC,IAAI,CAAE,UAAU,CAAEC,IAAI,CAAE,gBAAiB,CAAC,CACpDrI,KAAK,CAAE,aAAa,CACpBoY,KAAK,CAAE,SACT,CAAC,CAEDxO,eAAe,CAAA4D,aAAA,CAAAA,aAAA,IACV7D,YAAY,MACfK,cAAc,EACf,CAAC,CAEF;AACA7E,oBAAoB,CAAC,CAAC,CACxB,CACF,CAAC,CAED,KAAM,CAAAsW,mBAAmB,CAAIxO,CAAsC,EAAK,CACtE,GAAI,CAACjE,kBAAkB,CAAE,OAEzB;AACA,GAAIW,YAAY,CAACe,UAAU,CAAE,CAC3Bd,eAAe,CAAA4D,aAAA,CAAAA,aAAA,IACV7D,YAAY,MACfe,UAAU,CAAE,KAAK,CACjBC,eAAe,CAAE,IAAI,CACrBC,YAAY,CAAE,IAAI,EACnB,CAAC,CACF,OACF,CAEA;AACA,GAAIjB,YAAY,CAACY,UAAU,CAAE,CAC3BX,eAAe,CAAA4D,aAAA,CAAAA,aAAA,IACV7D,YAAY,MACfY,UAAU,CAAE,KAAK,CACjBC,eAAe,CAAE,IAAI,CACrBC,UAAU,CAAE,CAAExC,CAAC,CAAE,CAAC,CAAEC,CAAC,CAAE,CAAE,CAAC,EAC3B,CAAC,CACF,OACF,CAEA;AACA,GAAIyB,YAAY,CAACE,SAAS,CAAE,CAC1B,KAAM,CAAAqP,MAAM,CAAGC,oBAAoB,CAAClM,CAAC,CAACyL,OAAO,CAAEzL,CAAC,CAAC0L,OAAO,CAAC,CACzD,KAAM,CAAA0C,aAAa,CAAGR,eAAe,CAAC3B,MAAM,CAACjR,CAAC,CAAEiR,MAAM,CAAChR,CAAC,CAAC,CACzD,KAAM,CAAApI,KAAK,CAAGyE,IAAI,CAAC6Q,GAAG,CAACiG,aAAa,CAACpT,CAAC,CAAG0B,YAAY,CAACG,MAAM,CAAC,CAC7D,KAAM,CAAA/J,MAAM,CAAGwE,IAAI,CAAC6Q,GAAG,CAACiG,aAAa,CAACnT,CAAC,CAAGyB,YAAY,CAACI,MAAM,CAAC,CAE9D;AACA,GAAIjK,KAAK,CAAG,EAAE,EAAIC,MAAM,CAAG,EAAE,CAAE,CAC7B,KAAM,CAAAkI,CAAC,CAAG1D,IAAI,CAACC,GAAG,CAAC6W,aAAa,CAACpT,CAAC,CAAE0B,YAAY,CAACG,MAAM,CAAC,CACxD,KAAM,CAAA5B,CAAC,CAAG3D,IAAI,CAACC,GAAG,CAAC6W,aAAa,CAACnT,CAAC,CAAEyB,YAAY,CAACI,MAAM,CAAC,CAExD;AACA9E,OAAO,CAACC,GAAG,CAAC,mBAAmB,CAAE,CAC/B+C,CAAC,CAAEC,CAAC,CAAEpI,KAAK,CAAEC,MAAM,CACnBgF,UAAU,CAAExB,WAAW,SAAXA,WAAW,iBAAXA,WAAW,CAAEzD,KAAK,CAC9BkF,WAAW,CAAEzB,WAAW,SAAXA,WAAW,iBAAXA,WAAW,CAAExD,MAAM,CAChCiI,MAAM,CAAE,CAAEC,CAAC,CAAEC,CAAC,CAAEpI,KAAK,CAAEC,MAAO,CAChC,CAAC,CAAC,CAEF,KAAM,CAAA2b,UAAmB,CAAG,CAC1BhP,EAAE,YAAAoB,MAAA,CAAaoN,IAAI,CAACC,GAAG,CAAC,CAAC,CAAE,CAC3BnT,MAAM,CAAE,CAAEC,CAAC,CAAEC,CAAC,CAAEpI,KAAK,CAAEC,MAAO,CAAC,CAC/BoI,MAAM,CAAE,CAAEC,IAAI,CAAE,UAAU,CAAEC,IAAI,CAAE,gBAAiB,CAAC,CACpDrI,KAAK,YAAA8N,MAAA,CAAarE,QAAQ,CAACvG,MAAM,CAAG,CAAC,CAAE,CACvCkV,KAAK,QAAAtK,MAAA,CAASvJ,IAAI,CAACoX,MAAM,CAAC,CAAC,CAAG,GAAG,eACnC,CAAC,CAEDjS,WAAW,CAAC,CAAC,GAAGD,QAAQ,CAAEiS,UAAU,CAAC,CAAC,CACtCvQ,iBAAiB,CAACuQ,UAAU,CAAC,CAC7BzQ,oBAAoB,CAAC,IAAI,CAAC,CAC5B,CAEArB,eAAe,CAAA4D,aAAA,CAAAA,aAAA,IACV7D,YAAY,MACfE,SAAS,CAAE,KAAK,CAChBC,MAAM,CAAE,CAAC,CACTC,MAAM,CAAE,CAAC,CACTC,cAAc,CAAE,IAAI,EACrB,CAAC,CAEF0L,UAAU,CAAC,CAAC,CACd,CACF,CAAC,CAED,KAAM,CAAAkG,iBAAiB,CAAI3O,CAAsC,EAAK,CACpE,GAAItD,YAAY,CAACE,SAAS,EAAIF,YAAY,CAACY,UAAU,EAAIZ,YAAY,CAACe,UAAU,CAAE,OAElF,KAAM,CAAAwO,MAAM,CAAGC,oBAAoB,CAAClM,CAAC,CAACyL,OAAO,CAAEzL,CAAC,CAAC0L,OAAO,CAAC,CAEzD;AACA,KAAM,CAAAyC,cAAc,CAAG,CAAC,GAAG3R,QAAQ,CAAE,IAAIyC,oBAAoB,CAAGF,gBAAgB,CAAG,EAAE,CAAC,CAAC,CAACyF,IAAI,CAAC8E,OAAO,EAClG2C,MAAM,CAACjR,CAAC,EAAIsO,OAAO,CAACvO,MAAM,CAACC,CAAC,EAC5BiR,MAAM,CAACjR,CAAC,EAAIsO,OAAO,CAACvO,MAAM,CAACC,CAAC,CAAGsO,OAAO,CAACvO,MAAM,CAAClI,KAAK,EACnDoZ,MAAM,CAAChR,CAAC,EAAIqO,OAAO,CAACvO,MAAM,CAACE,CAAC,EAC5BgR,MAAM,CAAChR,CAAC,EAAIqO,OAAO,CAACvO,MAAM,CAACE,CAAC,CAAGqO,OAAO,CAACvO,MAAM,CAACjI,MAChD,CAAC,CAED,GAAIqb,cAAc,CAAE,CAClBjQ,iBAAiB,CAACiQ,cAAc,CAAC,CACjCnQ,oBAAoB,CAAC,IAAI,CAAC,CAC5B,CACF,CAAC,CAED,KAAM,CAAA4Q,uBAAuB,CAAI5O,CAAsC,EAAK,CAC1E,GAAI,CAACjE,kBAAkB,CAAE,OAEzB,KAAM,CAAAkQ,MAAM,CAAGC,oBAAoB,CAAClM,CAAC,CAACyL,OAAO,CAAEzL,CAAC,CAAC0L,OAAO,CAAC,CAEzD;AACA,KAAM,CAAAyC,cAAc,CAAG,CAAC,GAAG3R,QAAQ,CAAE,IAAIyC,oBAAoB,CAAGF,gBAAgB,CAAG,EAAE,CAAC,CAAC,CAACyF,IAAI,CAAC8E,OAAO,EAClG2C,MAAM,CAACjR,CAAC,EAAIsO,OAAO,CAACvO,MAAM,CAACC,CAAC,EAC5BiR,MAAM,CAACjR,CAAC,EAAIsO,OAAO,CAACvO,MAAM,CAACC,CAAC,CAAGsO,OAAO,CAACvO,MAAM,CAAClI,KAAK,EACnDoZ,MAAM,CAAChR,CAAC,EAAIqO,OAAO,CAACvO,MAAM,CAACE,CAAC,EAC5BgR,MAAM,CAAChR,CAAC,EAAIqO,OAAO,CAACvO,MAAM,CAACE,CAAC,CAAGqO,OAAO,CAACvO,MAAM,CAACjI,MAChD,CAAC,CAED,GAAIqb,cAAc,CAAE,CAClB3C,iBAAiB,CAACxL,CAAC,CAAEmO,cAAc,CAAC,CACtC,CACF,CAAC,CAED,KAAM,CAAAU,mBAAmB,CAAI7O,CAAyC,EAAK,CACzE,GAAIA,CAAC,CAAC8O,GAAG,GAAK,GAAG,EAAI9O,CAAC,CAAC8O,GAAG,GAAK,GAAG,CAAE,CAClCnS,eAAe,CAAA4D,aAAA,CAAAA,aAAA,IACV7D,YAAY,MACfU,QAAQ,CAAE,CAACV,YAAY,CAACU,QAAQ,EACjC,CAAC,CACFqL,UAAU,CAAC,CAAC,CACd,CAAC,IAAM,IAAIzI,CAAC,CAAC8O,GAAG,GAAK,GAAG,EAAI9O,CAAC,CAAC8O,GAAG,GAAK,GAAG,CAAE,CACzCnS,eAAe,CAAA4D,aAAA,CAAAA,aAAA,IACV7D,YAAY,MACfQ,QAAQ,CAAE,CAACR,YAAY,CAACQ,QAAQ,EACjC,CAAC,CACJ,CAAC,IAAM,IAAI8C,CAAC,CAAC8O,GAAG,GAAK,GAAG,CAAE,CACxBnS,eAAe,CAAA4D,aAAA,CAAAA,aAAA,IACV7D,YAAY,MACfM,IAAI,CAAE,CAAC,CACPC,GAAG,CAAE,CAAEjC,CAAC,CAAE,CAAC,CAAEC,CAAC,CAAE,CAAE,CAAC,EACpB,CAAC,CACFwN,UAAU,CAAC,CAAC,CACd,CAAC,IAAM,IAAIzI,CAAC,CAAC8O,GAAG,GAAK,QAAQ,EAAI9O,CAAC,CAAC8O,GAAG,GAAK,WAAW,CAAE,CACtD;AACA,GAAI7Q,cAAc,CAAE,CAClB8Q,mBAAmB,CAAC9Q,cAAc,CAACwB,EAAE,CAAC,CACxC,CACF,CACF,CAAC,CAID,KAAM,CAAAuP,cAAc,CAAGA,CAAA,GAAM,CAC3BrS,eAAe,CAAA4D,aAAA,CAAAA,aAAA,IACV7D,YAAY,MACfkB,UAAU,CAAE,CAAClB,YAAY,CAACkB,UAAU,CACpCC,eAAe,CAAEnB,YAAY,CAACkB,UAAU,CAAGlB,YAAY,CAACM,IAAI,CAAGN,YAAY,CAACmB,eAAe,EAC5F,CAAC,CACJ,CAAC,CAID,KAAM,CAAAwL,QAAQ,CAAGA,CAACX,GAA6B,CAAElS,MAAyB,CAAEa,KAAa,CAAEK,OAAe,CAAEC,OAAe,GAAK,CAC9H,GAAI,CAAC+E,YAAY,CAACU,QAAQ,CAAE,OAE5BsL,GAAG,CAACkB,WAAW,CAAG,SAAS,CAC3BlB,GAAG,CAACmB,SAAS,CAAG,CAAC,CACjBnB,GAAG,CAACoB,WAAW,CAAC,CAAC,CAAC,CAAE,CAAC,CAAC,CAAC,CAEvB,KAAM,CAAA3M,QAAQ,CAAGT,YAAY,CAACS,QAAQ,CAAG9F,KAAK,CAAGqF,YAAY,CAACM,IAAI,CAElE;AACA,IAAK,GAAI,CAAAhC,CAAC,CAAGtD,OAAO,CAAEsD,CAAC,CAAGxE,MAAM,CAAC3D,KAAK,CAAEmI,CAAC,EAAImC,QAAQ,CAAE,CACrDuL,GAAG,CAACqB,SAAS,CAAC,CAAC,CACfrB,GAAG,CAACsB,MAAM,CAAChP,CAAC,CAAE,CAAC,CAAC,CAChB0N,GAAG,CAACuB,MAAM,CAACjP,CAAC,CAAExE,MAAM,CAAC1D,MAAM,CAAC,CAC5B4V,GAAG,CAACwB,MAAM,CAAC,CAAC,CACd,CAEA;AACA,IAAK,GAAI,CAAAjP,CAAC,CAAGtD,OAAO,CAAEsD,CAAC,CAAGzE,MAAM,CAAC1D,MAAM,CAAEmI,CAAC,EAAIkC,QAAQ,CAAE,CACtDuL,GAAG,CAACqB,SAAS,CAAC,CAAC,CACfrB,GAAG,CAACsB,MAAM,CAAC,CAAC,CAAE/O,CAAC,CAAC,CAChByN,GAAG,CAACuB,MAAM,CAACzT,MAAM,CAAC3D,KAAK,CAAEoI,CAAC,CAAC,CAC3ByN,GAAG,CAACwB,MAAM,CAAC,CAAC,CACd,CAEAxB,GAAG,CAACoB,WAAW,CAAC,EAAE,CAAC,CACrB,CAAC,CAED,KAAM,CAAAP,WAAW,CAAG,QAAAA,CAClBb,GAA6B,CAC7BY,OAAgB,CAChBjS,KAAa,CACbK,OAAe,CACfC,OAAe,CAEZ,KAAAsX,qBAAA,CAAAC,qBAAA,IADH,CAAAtS,SAAkB,CAAAuS,SAAA,CAAAlZ,MAAA,IAAAkZ,SAAA,MAAAC,SAAA,CAAAD,SAAA,IAAG,KAAK,CAE1B;AACA;AACA;AAEA;AACA,KAAM,CAAA3Y,MAAM,CAAGkS,GAAG,CAAClS,MAAM,CACzB,KAAM,CAAA6Y,QAAQ,CAAGtG,UAAU,CAACvS,MAAM,CAACoB,OAAO,CAACP,KAAK,EAAI,GAAG,CAAC,CACxD,KAAM,CAAAG,UAAU,CAAGuR,UAAU,CAACvS,MAAM,CAACoB,OAAO,CAACJ,UAAU,EAAI,GAAG,CAAC,CAC/D,KAAM,CAAAC,WAAW,CAAGsR,UAAU,CAACvS,MAAM,CAACoB,OAAO,CAACH,WAAW,EAAI,GAAG,CAAC,CACjE,KAAM,CAAA6X,UAAU,CAAGvG,UAAU,CAACvS,MAAM,CAACoB,OAAO,CAACF,OAAO,EAAI,GAAG,CAAC,CAC5D,KAAM,CAAA6X,UAAU,CAAGxG,UAAU,CAACvS,MAAM,CAACoB,OAAO,CAACD,OAAO,EAAI,GAAG,CAAC,CAE5D,GAAI,CAAA6X,UAAU,CAAEC,YAAY,CAAEC,YAAY,CAE1C,GAAIL,QAAQ,CAAG,CAAC,EAAI7X,UAAU,CAAG,CAAC,EAAIC,WAAW,CAAG,CAAC,CAAE,CACrD;AACA+X,UAAU,CAAGH,QAAQ,CACrBI,YAAY,CAAGH,UAAU,CACzBI,YAAY,CAAGH,UAAU,CAC3B,CAAC,IAAM,CACL;AACAC,UAAU,CAAGnY,KAAK,CAClBoY,YAAY,CAAG/X,OAAO,CACtBgY,YAAY,CAAG/X,OAAO,CACxB,CAEA;AACA,KAAM,CAAAgY,WAAW,CAAG,CAClB3U,CAAC,CAAEyU,YAAY,CACfxU,CAAC,CAAEyU,YAAY,CACf7c,KAAK,CAAEyD,WAAW,CAAEzD,KAAK,CAAG2c,UAAU,CACtC1c,MAAM,CAAEwD,WAAW,CAAExD,MAAM,CAAG0c,UAChC,CAAC,CAED;AACA,KAAM,CAAAxU,CAAC,CAAG2U,WAAW,CAAC3U,CAAC,CAAIsO,OAAO,CAACvO,MAAM,CAACC,CAAC,CAAGwU,UAAW,CACzD,KAAM,CAAAvU,CAAC,CAAG0U,WAAW,CAAC1U,CAAC,CAAIqO,OAAO,CAACvO,MAAM,CAACE,CAAC,CAAGuU,UAAW,CACzD,KAAM,CAAA3c,KAAK,CAAGyW,OAAO,CAACvO,MAAM,CAAClI,KAAK,CAAG2c,UAAU,CAC/C,KAAM,CAAA1c,MAAM,CAAGwW,OAAO,CAACvO,MAAM,CAACjI,MAAM,CAAG0c,UAAU,CAEjD;AACA,GAAI5S,SAAS,CAAE,CACb5E,OAAO,CAACC,GAAG,CAAC,kBAAkB,CAAE,CAC9BwS,SAAS,CAAEnB,OAAO,CAAC7J,EAAE,CACrBmQ,kBAAkB,CAAEtG,OAAO,CAACvO,MAAM,CAClC8U,aAAa,CAAExY,KAAK,CACpByY,cAAc,CAAE,CAAE9U,CAAC,CAAEtD,OAAO,CAAEuD,CAAC,CAAEtD,OAAQ,CAAC,CAC1C6X,UAAU,CACVO,WAAW,CAAE,CAAE/U,CAAC,CAAEyU,YAAY,CAAExU,CAAC,CAAEyU,YAAa,CAAC,CACjDzC,YAAY,CAAE,CAAEjS,CAAC,CAAEC,CAAC,CAAEpI,KAAK,CAAEC,MAAO,CAAC,CACrC6c,WAAW,CAAEA,WAAW,CACxB3G,gBAAgB,CAAE,CAAEnW,KAAK,CAAE6V,GAAG,CAAClS,MAAM,CAAC3D,KAAK,CAAEC,MAAM,CAAE4V,GAAG,CAAClS,MAAM,CAAC1D,MAAO,CAAC,CACxEgH,eAAe,CAAE,CAAEjH,KAAK,CAAEyD,WAAW,CAAEzD,KAAK,CAAEC,MAAM,CAAEwD,WAAW,CAAExD,MAAO,CAAC,CAC3EqW,cAAc,CAAEkG,QAAQ,CAAG,CAC7B,CAAC,CAAC,CACJ,CAEA;AACA,KAAM,CAAAW,QAAQ,CAAI,EAAAf,qBAAA,CAAAvS,YAAY,CAACa,eAAe,UAAA0R,qBAAA,iBAA5BA,qBAAA,CAA8BxP,EAAE,IAAK6J,OAAO,CAAC7J,EAAE,EAChD,EAAAyP,qBAAA,CAAAxS,YAAY,CAACgB,eAAe,UAAAwR,qBAAA,iBAA5BA,qBAAA,CAA8BzP,EAAE,IAAK6J,OAAO,CAAC7J,EAAG,CAEjE;AACAiJ,GAAG,CAACuH,WAAW,CAAG,oBAAoB,CACtCvH,GAAG,CAACwH,UAAU,CAAGF,QAAQ,CAAG,CAAC,CAAG,CAAC,CACjCtH,GAAG,CAACyH,aAAa,CAAGH,QAAQ,CAAG,CAAC,CAAG,CAAC,CACpCtH,GAAG,CAAC0H,aAAa,CAAGJ,QAAQ,CAAG,CAAC,CAAG,CAAC,CAEpC;AACA,KAAM,CAAAK,aAAa,CAAGhR,gBAAgB,CAAG,IAAI,CAAG,IAAI,CACpDqJ,GAAG,CAACkB,WAAW,CAAGoG,QAAQ,CAAG,SAAS,IAAAnP,MAAA,CAAMyI,OAAO,CAAC6B,KAAK,EAAAtK,MAAA,CAAGwP,aAAa,CAAE,CAC3E3H,GAAG,CAACmB,SAAS,CAAGmG,QAAQ,CAAG,CAAC,CAAIpT,SAAS,CAAG,CAAC,CAAG,CAAE,CAClD8L,GAAG,CAACoB,WAAW,CAAClN,SAAS,CAAG,CAAC,CAAC,CAAE,CAAC,CAAC,CAAG,EAAE,CAAC,CAExC;AACA,KAAM,CAAA0T,MAAM,CAAG,CAAC,CAChB5H,GAAG,CAACqB,SAAS,CAAC,CAAC,CACfrB,GAAG,CAACsB,MAAM,CAAChP,CAAC,CAAGsV,MAAM,CAAErV,CAAC,CAAC,CACzByN,GAAG,CAACuB,MAAM,CAACjP,CAAC,CAAGnI,KAAK,CAAGyd,MAAM,CAAErV,CAAC,CAAC,CACjCyN,GAAG,CAAC6H,gBAAgB,CAACvV,CAAC,CAAGnI,KAAK,CAAEoI,CAAC,CAAED,CAAC,CAAGnI,KAAK,CAAEoI,CAAC,CAAGqV,MAAM,CAAC,CACzD5H,GAAG,CAACuB,MAAM,CAACjP,CAAC,CAAGnI,KAAK,CAAEoI,CAAC,CAAGnI,MAAM,CAAGwd,MAAM,CAAC,CAC1C5H,GAAG,CAAC6H,gBAAgB,CAACvV,CAAC,CAAGnI,KAAK,CAAEoI,CAAC,CAAGnI,MAAM,CAAEkI,CAAC,CAAGnI,KAAK,CAAGyd,MAAM,CAAErV,CAAC,CAAGnI,MAAM,CAAC,CAC3E4V,GAAG,CAACuB,MAAM,CAACjP,CAAC,CAAGsV,MAAM,CAAErV,CAAC,CAAGnI,MAAM,CAAC,CAClC4V,GAAG,CAAC6H,gBAAgB,CAACvV,CAAC,CAAEC,CAAC,CAAGnI,MAAM,CAAEkI,CAAC,CAAEC,CAAC,CAAGnI,MAAM,CAAGwd,MAAM,CAAC,CAC3D5H,GAAG,CAACuB,MAAM,CAACjP,CAAC,CAAEC,CAAC,CAAGqV,MAAM,CAAC,CACzB5H,GAAG,CAAC6H,gBAAgB,CAACvV,CAAC,CAAEC,CAAC,CAAED,CAAC,CAAGsV,MAAM,CAAErV,CAAC,CAAC,CACzCyN,GAAG,CAAC8H,SAAS,CAAC,CAAC,CACf9H,GAAG,CAACwB,MAAM,CAAC,CAAC,CAEZ;AACAxB,GAAG,CAACuH,WAAW,CAAG,aAAa,CAC/BvH,GAAG,CAACwH,UAAU,CAAG,CAAC,CAClBxH,GAAG,CAACyH,aAAa,CAAG,CAAC,CACrBzH,GAAG,CAAC0H,aAAa,CAAG,CAAC,CAErB;AACA,KAAM,CAAAK,WAAW,CAAGpR,gBAAgB,CAAI2Q,QAAQ,CAAG,IAAI,CAAG,IAAI,CAAKA,QAAQ,CAAG,IAAI,CAAG,IAAK,CAC1FtH,GAAG,CAACyB,SAAS,IAAAtJ,MAAA,CAAMyI,OAAO,CAAC6B,KAAK,EAAAtK,MAAA,CAAG4P,WAAW,CAAE,CAChD/H,GAAG,CAACgI,IAAI,CAAC,CAAC,CAEV;AACA,GAAI,CAAC9T,SAAS,CAAE,CACd,KAAM,CAAAwP,UAAU,CAAG,CAAC,CACpB,KAAM,CAAAuE,WAAW,CAAGX,QAAQ,CAAG,SAAS,CAAG,MAAM,CACjD,KAAM,CAAAY,WAAW,CAAGZ,QAAQ,CAAG,MAAM,CAAG,MAAM,CAE9CtH,GAAG,CAACyB,SAAS,CAAGwG,WAAW,CAC3BjI,GAAG,CAACkB,WAAW,CAAGgH,WAAW,CAC7BlI,GAAG,CAACmB,SAAS,CAAG,CAAC,CAEjB;AACA,KAAM,CAAAgH,OAAO,CAAG,CACd,CAAE7V,CAAC,CAAEA,CAAC,CAAEC,CAAC,CAAEA,CAAE,CAAC,CAAE;AAChB,CAAED,CAAC,CAAEA,CAAC,CAAGnI,KAAK,CAAGuZ,UAAU,CAAEnR,CAAC,CAAEA,CAAE,CAAC,CAAE;AACrC,CAAED,CAAC,CAAEA,CAAC,CAAEC,CAAC,CAAEA,CAAC,CAAGnI,MAAM,CAAGsZ,UAAW,CAAC,CAAE;AACtC,CAAEpR,CAAC,CAAEA,CAAC,CAAGnI,KAAK,CAAGuZ,UAAU,CAAEnR,CAAC,CAAEA,CAAC,CAAGnI,MAAM,CAAGsZ,UAAW,CAAE;AAAA,CAC3D,CAEDyE,OAAO,CAACtL,OAAO,CAACuL,MAAM,EAAI,CACxB;AACApI,GAAG,CAACqI,QAAQ,CAACD,MAAM,CAAC9V,CAAC,CAAE8V,MAAM,CAAC7V,CAAC,CAAEmR,UAAU,CAAEA,UAAU,CAAC,CACxD1D,GAAG,CAACsI,UAAU,CAACF,MAAM,CAAC9V,CAAC,CAAE8V,MAAM,CAAC7V,CAAC,CAAEmR,UAAU,CAAEA,UAAU,CAAC,CAE1D;AACA1D,GAAG,CAACkB,WAAW,CAAG,MAAM,CACxBlB,GAAG,CAACmB,SAAS,CAAG,CAAC,CACjBnB,GAAG,CAACsI,UAAU,CAACF,MAAM,CAAC9V,CAAC,CAAG,CAAC,CAAE8V,MAAM,CAAC7V,CAAC,CAAG,CAAC,CAAEmR,UAAU,CAAG,CAAC,CAAEA,UAAU,CAAG,CAAC,CAAC,CAC5E,CAAC,CAAC,CAEF;AACA,GAAI4D,QAAQ,CAAE,CACZtH,GAAG,CAACkB,WAAW,CAAG,yBAAyB,CAC3ClB,GAAG,CAACmB,SAAS,CAAG,CAAC,CACjBnB,GAAG,CAACoB,WAAW,CAAC,CAAC,CAAC,CAAE,CAAC,CAAC,CAAC,CAEvB;AACApB,GAAG,CAACqB,SAAS,CAAC,CAAC,CACfrB,GAAG,CAACsB,MAAM,CAAChP,CAAC,CAAEC,CAAC,CAAC,CAChByN,GAAG,CAACuB,MAAM,CAACjP,CAAC,CAAGnI,KAAK,CAAEoI,CAAC,CAAGnI,MAAM,CAAC,CACjC4V,GAAG,CAACsB,MAAM,CAAChP,CAAC,CAAGnI,KAAK,CAAEoI,CAAC,CAAC,CACxByN,GAAG,CAACuB,MAAM,CAACjP,CAAC,CAAEC,CAAC,CAAGnI,MAAM,CAAC,CACzB4V,GAAG,CAACwB,MAAM,CAAC,CAAC,CAEZxB,GAAG,CAACoB,WAAW,CAAC,EAAE,CAAC,CACrB,CACF,CAEA;AACApB,GAAG,CAACyB,SAAS,CAAG,MAAM,CACtBzB,GAAG,CAAC0B,IAAI,kBAAoB,CAC5B1B,GAAG,CAACuI,SAAS,CAAG,QAAQ,CACxBvI,GAAG,CAACwI,YAAY,CAAG,QAAQ,CAE3B;AACAxI,GAAG,CAACuH,WAAW,CAAG,0BAA0B,CAC5CvH,GAAG,CAACwH,UAAU,CAAG,CAAC,CAClBxH,GAAG,CAACyH,aAAa,CAAG,CAAC,CACrBzH,GAAG,CAAC0H,aAAa,CAAG,CAAC,CAErB1H,GAAG,CAAC2B,QAAQ,CAACf,OAAO,CAACvW,KAAK,CAAEiI,CAAC,CAAGnI,KAAK,CAAG,CAAC,CAAEoI,CAAC,CAAGnI,MAAM,CAAG,CAAC,CAAC,CAE1D;AACA4V,GAAG,CAACuH,WAAW,CAAG,aAAa,CAC/BvH,GAAG,CAACwH,UAAU,CAAG,CAAC,CAClBxH,GAAG,CAACyH,aAAa,CAAG,CAAC,CACrBzH,GAAG,CAAC0H,aAAa,CAAG,CAAC,CACvB,CAAC,CAED,KAAM,CAAAe,iBAAiB,CAAI7H,OAAgB,EAAK,CAC9C,GAAIrL,cAAc,CAAE,CAClB;AACAxB,WAAW,CAACkO,YAAY,EACtBA,YAAY,CAACtG,GAAG,CAACuG,CAAC,EAChBA,CAAC,CAACnL,EAAE,GAAK6J,OAAO,CAAC7J,EAAE,CAAG6J,OAAO,CAAGsB,CAClC,CACF,CAAC,CACD;AACA5L,mBAAmB,CAACoS,oBAAoB,EACtCA,oBAAoB,CAAC/M,GAAG,CAACuG,CAAC,EACxBA,CAAC,CAACnL,EAAE,GAAK6J,OAAO,CAAC7J,EAAE,CAAG6J,OAAO,CAAGsB,CAClC,CACF,CAAC,CACH,CAAC,IAAM,CACLnO,WAAW,CAAC,CAAC,GAAGD,QAAQ,CAAE8M,OAAO,CAAC,CAAC,CACrC,CACAtL,oBAAoB,CAAC,KAAK,CAAC,CAC3BE,iBAAiB,CAAC,IAAI,CAAC,CACvBhG,oBAAoB,CAAC,CAAC,CACxB,CAAC,CAED,KAAM,CAAA6W,mBAAmB,CAAItE,SAAiB,EAAK,CACjD;AACAhO,WAAW,CAACkO,YAAY,EAAIA,YAAY,CAAC9F,MAAM,CAAC+F,CAAC,EAAIA,CAAC,CAACnL,EAAE,GAAKgL,SAAS,CAAC,CAAC,CACzEzL,mBAAmB,CAACoS,oBAAoB,EAAIA,oBAAoB,CAACvM,MAAM,CAAC+F,CAAC,EAAIA,CAAC,CAACnL,EAAE,GAAKgL,SAAS,CAAC,CAAC,CACjGzM,oBAAoB,CAAC,KAAK,CAAC,CAC3BE,iBAAiB,CAAC,IAAI,CAAC,CACvBhG,oBAAoB,CAAC,CAAC,CACxB,CAAC,CAED,KAAM,CAAAmZ,wBAAwB,CAAGA,CAAA,GAAM,CACrC;AACA,KAAM,CAAAC,WAAW,CAAG,CAAC,GAAG9U,QAAQ,CAAE,IAAIyC,oBAAoB,CAAGF,gBAAgB,CAAG,EAAE,CAAC,CAAC,CACpF,MAAO,CAAAuS,WAAW,CAACjN,GAAG,CAACiF,OAAO,GAAK,CACjC7J,EAAE,CAAE6J,OAAO,CAAC7J,EAAE,CACd1E,MAAM,CAAEuO,OAAO,CAACvO,MAAM,CACtBG,MAAM,CAAEoO,OAAO,CAACpO,MAAM,CACtBnI,KAAK,CAAEuW,OAAO,CAACvW,KACjB,CAAC,CAAC,CAAC,CACL,CAAC,CAED,KAAM,CAAAwe,kBAAkB,CAAG,KAAAA,CAAA,GAAY,CACrCvZ,OAAO,CAACC,GAAG,CAAC,2BAA2B,CAAC,CACxCD,OAAO,CAACC,GAAG,CAAC,oBAAoB,CAAEmC,YAAY,CAACE,IAAI,CAAC,CACpDtC,OAAO,CAACC,GAAG,CAAC,kBAAkB,CAAEuE,QAAQ,CAACvG,MAAM,CAAC,CAChD+B,OAAO,CAACC,GAAG,CAAC,0BAA0B,CAAE8G,gBAAgB,CAAC9I,MAAM,CAAC,CAChE+B,OAAO,CAACC,GAAG,CAAC,uBAAuB,CAAEgH,oBAAoB,CAAC,CAE1D,GAAI,CAAC7E,YAAY,CAACE,IAAI,CAACkI,IAAI,CAAC,CAAC,CAAE,CAC7BxK,OAAO,CAACC,GAAG,CAAC,0BAA0B,CAAC,CACvC/C,QAAQ,CAAC,+BAA+B,CAAC,CACzC,OACF,CAEA,GAAIkF,YAAY,CAACG,WAAW,CAACtE,MAAM,CAAG,EAAE,CAAE,CACxC+B,OAAO,CAACC,GAAG,CAAC,+BAA+B,CAAC,CAC5C/C,QAAQ,CAAC,8DAA8D,CAAC,CACxE,OACF,CAEA,KAAM,CAAAsc,aAAa,CAAGhV,QAAQ,CAACvG,MAAM,EAAIgJ,oBAAoB,CAAGF,gBAAgB,CAAC9I,MAAM,CAAG,CAAC,CAAC,CAC5F+B,OAAO,CAACC,GAAG,CAAC,gBAAgB,CAAEuZ,aAAa,CAAC,CAE5C,GAAIA,aAAa,GAAK,CAAC,CAAE,CACvBxZ,OAAO,CAACC,GAAG,CAAC,oBAAoB,CAAC,CACjC/C,QAAQ,CAAC,+DAA+D,CAAC,CACzE,OACF,CAEA,GAAI,CACF8C,OAAO,CAACC,GAAG,CAAC,0BAA0B,CAAC,CACvCkC,WAAW,CAAC,IAAI,CAAC,CACjBjF,QAAQ,CAAC,IAAI,CAAC,CAEd,KAAM,CAAAgH,OAAO,CAAGmV,wBAAwB,CAAC,CAAC,CAC1CrZ,OAAO,CAACC,GAAG,CAAC,oBAAoB,CAAEiE,OAAO,CAAC,CAE1C;AACA,KAAM,CAAAvF,YAAY,CAAGhE,oBAAoB,CAACkD,oBAAoB,CAAC,CAC/D,KAAM,CAAAuP,YAAY,CAAGsC,oBAAoB,CAACtN,YAAY,CAACE,IAAI,CAAE4B,OAAO,CAAE,CAAErJ,KAAK,CAAE8D,YAAY,CAAC9D,KAAK,CAAEC,MAAM,CAAE6D,YAAY,CAAC7D,MAAO,CAAC,CAAC,CACjIkF,OAAO,CAACC,GAAG,CAAC,2BAA2B,CAAEmN,YAAY,CAAC,CAEtD;AACA,KAAM,CAAAS,YAAY,CAAG,CAAEhT,KAAK,CAAEuS,YAAY,CAACxK,IAAI,CAAC/H,KAAK,CAAEC,MAAM,CAAEsS,YAAY,CAACxK,IAAI,CAAC9H,MAAO,CAAC,CACzF,KAAM,CAAAgT,WAAW,CAAGC,MAAM,CAACC,MAAM,CAACrT,oBAAoB,CAAC,CAACsT,IAAI,CAACC,YAAY,EACvEA,YAAY,CAACrT,KAAK,GAAKgT,YAAY,CAAChT,KAAK,EAAIqT,YAAY,CAACpT,MAAM,GAAK+S,YAAY,CAAC/S,MACpF,CAAC,CAED,GAAI,CAACgT,WAAW,CAAE,CAChB,KAAM,CAAAK,YAAY,CAAGJ,MAAM,CAACC,MAAM,CAACrT,oBAAoB,CAAC,CAAC0R,GAAG,CAACzJ,IAAI,KAAAiG,MAAA,CAAOjG,IAAI,CAAC/H,KAAK,QAAAgO,MAAA,CAAMjG,IAAI,CAAC9H,MAAM,CAAE,CAAC,CAACsT,IAAI,CAAC,MAAM,CAAC,CACnHlR,QAAQ,yEAAA2L,MAAA,CAAoEsF,YAAY,CAAE,CAAC,CAC3F,OACF,CAEA;AACA,GAAIf,YAAY,CAACtK,KAAK,CAAE,CACtB,IAAK,GAAI,CAAAuL,CAAC,CAAG,CAAC,CAAEA,CAAC,CAAGjB,YAAY,CAACtK,KAAK,CAAC7E,MAAM,CAAEoQ,CAAC,EAAE,CAAE,CAClD,KAAM,CAAAb,IAAI,CAAGJ,YAAY,CAACtK,KAAK,CAACuL,CAAC,CAAC,CAClC,GAAIb,IAAI,CAACtK,MAAM,EAAIsK,IAAI,CAACtK,MAAM,CAACC,IAAI,GAAK,gBAAgB,EAAIqK,IAAI,CAACtK,MAAM,CAACyE,eAAe,CAAE,CACvF,GAAI,CAAC5J,uBAAuB,CAACyP,IAAI,CAACtK,MAAM,CAACyE,eAAe,CAAC,CAAE,CACzDzK,QAAQ,8CAAA2L,MAAA,CAAyCwF,CAAC,CAAG,CAAC,SAAAxF,MAAA,CAAM2E,IAAI,CAACtK,MAAM,CAACyE,eAAe,+EAA4E,CAAC,CACpK,OACF,CACF,CACF,CACF,CAEA;AACA3H,OAAO,CAACC,GAAG,CAAC,yBAAyB,CAAC,CACtC,GAAI,CACF,KAAM,CAAAqO,kBAAkB,CAAG,KAAM,CAAA3U,gBAAgB,CAACyT,YAAY,CAAC,CAC/DpN,OAAO,CAACC,GAAG,CAAC,sBAAsB,CAAEqO,kBAAkB,CAAC,CAEvD,GAAI,CAACA,kBAAkB,CAAClL,IAAI,CAACjG,OAAO,CAAE,CACpC6C,OAAO,CAACC,GAAG,CAAC,oBAAoB,CAAEqO,kBAAkB,CAAClL,IAAI,CAACuG,OAAO,CAAC,CAClEzM,QAAQ,uBAAA2L,MAAA,CAAuByF,kBAAkB,CAAClL,IAAI,CAACuG,OAAO,EAAI,0BAA0B,CAAE,CAAC,CAC/F,OACF,CACF,CAAE,MAAO8P,aAAkB,CAAE,KAAAC,qBAAA,CAAAC,sBAAA,CAAAC,sBAAA,CAAAC,sBAAA,CAAAC,sBAAA,CAAAC,sBAAA,CAC3B/Z,OAAO,CAACC,GAAG,CAAC,mBAAmB,CAAEwZ,aAAa,CAAC,CAC/C,KAAM,CAAAO,YAAY,CAAG,EAAAN,qBAAA,CAAAD,aAAa,CAAC9Q,QAAQ,UAAA+Q,qBAAA,kBAAAC,sBAAA,CAAtBD,qBAAA,CAAwBtW,IAAI,UAAAuW,sBAAA,kBAAAC,sBAAA,CAA5BD,sBAAA,CAA8BvQ,MAAM,UAAAwQ,sBAAA,kBAAAC,sBAAA,CAApCD,sBAAA,CAAsC3c,KAAK,UAAA4c,sBAAA,iBAA3CA,sBAAA,CAA6ClQ,OAAO,KAAAmQ,sBAAA,CACtDL,aAAa,CAAC9Q,QAAQ,UAAAmR,sBAAA,kBAAAC,sBAAA,CAAtBD,sBAAA,CAAwB1W,IAAI,UAAA2W,sBAAA,iBAA5BA,sBAAA,CAA8B3Q,MAAM,GACpC,mBAAmB,CACtClM,QAAQ,uBAAA2L,MAAA,CAAuBmR,YAAY,CAAE,CAAC,CAC9C,OACF,CAEA;AACAha,OAAO,CAACC,GAAG,CAAC,uBAAuB,CAAC,CACpC,KAAM,CAAA0I,QAAQ,CAAG,KAAM,CAAAtP,cAAc,CAAC+T,YAAY,CAAC,CACnDpN,OAAO,CAACC,GAAG,CAAC,kBAAkB,CAAE0I,QAAQ,CAAC,CAEzC,GAAIA,QAAQ,CAACvF,IAAI,CAACjG,OAAO,CAAE,CACzB,KAAM,CAAAuN,UAAU,CAAG/B,QAAQ,CAACvF,IAAI,CAACuH,YAAY,CAC7C,KAAM,CAAA4D,cAAc,CAAG5F,QAAQ,CAACvF,IAAI,CAACoL,eAAe,EAAI,EAAE,CAC1D,KAAM,CAAAC,cAAc,CAAG9F,QAAQ,CAACvF,IAAI,CAACsL,eAAe,EAAI,EAAE,CAC1D,KAAM,CAAAC,aAAa,CAAGhG,QAAQ,CAACvF,IAAI,CAACwL,cAAc,EAAI,EAAE,CACxD,KAAM,CAAAC,aAAa,CAAGlG,QAAQ,CAACvF,IAAI,CAAC0L,cAAc,EAAI,EAAE,CAExD9O,OAAO,CAACC,GAAG,CAAC,iCAAiC,CAAEyK,UAAU,CAAC,CAC1D1K,OAAO,CAACC,GAAG,CAAC,kBAAkB,CAAEsO,cAAc,CAAC,CAC/CvO,OAAO,CAACC,GAAG,CAAC,kBAAkB,CAAEwO,cAAc,CAAC,CAC/CzO,OAAO,CAACC,GAAG,CAAC,iBAAiB,CAAE0O,aAAa,CAAC,CAC7C3O,OAAO,CAACC,GAAG,CAAC,iBAAiB,CAAE4O,aAAa,CAAC,CAE7C;AACA7O,OAAO,CAACC,GAAG,CAAC,sBAAsB,CAAE5B,mBAAmB,CAAC,CACxD2B,OAAO,CAACC,GAAG,CAAC,2BAA2B,CAAE5B,mBAAmB,SAAnBA,mBAAmB,iBAAnBA,mBAAmB,CAAE8E,IAAI,CAAC,CACnEnD,OAAO,CAACC,GAAG,CAAC,2BAA2B,CAAE5B,mBAAmB,SAAnBA,mBAAmB,iBAAnBA,mBAAmB,CAAEuE,IAAI,CAAC,CAEnE,GAAI,CAAA8G,cAAc,gBAAAb,MAAA,CAAiBzG,YAAY,CAACE,IAAI,kCAAAuG,MAAA,CAA+B6B,UAAU,CAAE,CAE/F;AACA,GAAI6D,cAAc,CAACtQ,MAAM,CAAG,CAAC,CAAE,CAC7ByL,cAAc,6BAAAb,MAAA,CAA0B0F,cAAc,CAACtQ,MAAM,eAAA4K,MAAA,CAAa0F,cAAc,CAACH,IAAI,CAAC,IAAI,CAAC,CAAE,CACvG,CAEA,GAAIS,aAAa,CAAC5Q,MAAM,CAAG,CAAC,CAAE,CAC5ByL,cAAc,kCAAAb,MAAA,CAA0BgG,aAAa,CAAC5Q,MAAM,wBAAA4K,MAAA,CAAsBgG,aAAa,CAACT,IAAI,CAAC,IAAI,CAAC,CAAE,CAC9G,CAEA,GAAIK,cAAc,CAACxQ,MAAM,CAAG,CAAC,CAAE,CAC7ByL,cAAc,8BAAAb,MAAA,CAAsB4F,cAAc,CAACxQ,MAAM,eAAA4K,MAAA,CAAa4F,cAAc,CAACL,IAAI,CAAC,IAAI,CAAC,CAAE,CACnG,CAEA,GAAIO,aAAa,CAAC1Q,MAAM,CAAG,CAAC,CAAE,CAC5ByL,cAAc,iCAAAb,MAAA,CAA8B8F,aAAa,CAAC1Q,MAAM,eAAA4K,MAAA,CAAa8F,aAAa,CAACP,IAAI,CAAC,IAAI,CAAC,CAAE,CACzG,CAEA,GAAI/P,mBAAmB,CAAE,CACvB2B,OAAO,CAACC,GAAG,CAAC,+BAA+B,CAAC,CAC5C,GAAI,CACF,KAAM,CAAAga,cAAc,CAAG,KAAM,CAAA3gB,mBAAmB,CAACoR,UAAU,CAAErM,mBAAmB,CAAC,CACjF,GAAI4b,cAAc,CAAC7W,IAAI,CAACjG,OAAO,CAAE,CAC/B6C,OAAO,CAACC,GAAG,CAAC,6BAA6B,CAAC,CAC1C7C,UAAU,IAAAyL,MAAA,CAAIa,cAAc,2CAAoC,CAAC,CACnE,CAAC,IAAM,CACL1J,OAAO,CAACC,GAAG,CAAC,qBAAqB,CAAC,CAClC7C,UAAU,IAAAyL,MAAA,CAAIa,cAAc,wCAA4B,CAAC,CAC3D,CACF,CAAE,MAAOwQ,SAAc,CAAE,KAAAC,mBAAA,CAAAC,qBAAA,CACvBpa,OAAO,CAACC,GAAG,CAAC,qBAAqB,CAAEia,SAAS,CAAC,CAC7C9c,UAAU,IAAAyL,MAAA,CAAIa,cAAc,2CAAAb,MAAA,CAA+B,EAAAsR,mBAAA,CAAAD,SAAS,CAACvR,QAAQ,UAAAwR,mBAAA,kBAAAC,qBAAA,CAAlBD,mBAAA,CAAoB/W,IAAI,UAAAgX,qBAAA,iBAAxBA,qBAAA,CAA0BhR,MAAM,GAAI,eAAe,CAAE,CAAC,CACnH,CACF,CAAC,IAAM,CACLpJ,OAAO,CAACC,GAAG,CAAC,+BAA+B,CAAC,CAC5C7C,UAAU,CAACsM,cAAc,CAAC,CAC5B,CAEAzH,mBAAmB,CAAC,KAAK,CAAC,CAC1B8M,eAAe,CAAC,CAAC,CACjBtK,WAAW,CAAC,EAAE,CAAC,CACfuC,mBAAmB,CAAC,EAAE,CAAC,CACvBE,uBAAuB,CAAC,KAAK,CAAC,CAC9BlD,qBAAqB,CAAC,EAAE,CAAC,CACzBC,sBAAsB,CAAC,IAAI,CAAC,CAC5B2D,aAAa,CAAC,CAAC,CAAE;AACjBC,mBAAmB,CAAC,CAAC,CAAE;AACzB,CAAC,IAAM,CACL7H,OAAO,CAACC,GAAG,CAAC,4BAA4B,CAAC,CACzC/C,QAAQ,CAAC,4BAA4B,CAAC,CACxC,CACF,CAAE,MAAO+L,GAAQ,CAAE,KAAAoR,cAAA,CAAAC,mBAAA,CACjBta,OAAO,CAACC,GAAG,CAAC,8BAA8B,CAAEgJ,GAAG,CAAC,CAChD/L,QAAQ,CAAC,EAAAmd,cAAA,CAAApR,GAAG,CAACN,QAAQ,UAAA0R,cAAA,kBAAAC,mBAAA,CAAZD,cAAA,CAAcjX,IAAI,UAAAkX,mBAAA,iBAAlBA,mBAAA,CAAoBlR,MAAM,GAAI,4BAA4B,CAAC,CACtE,CAAC,OAAS,CACRpJ,OAAO,CAACC,GAAG,CAAC,2BAA2B,CAAC,CACxCkC,WAAW,CAAC,KAAK,CAAC,CACpB,CACF,CAAC,CAED,KAAM,CAAAoY,gBAAgB,CAAIxO,KAA0C,EAAK,KAAAyO,mBAAA,CACvE,KAAM,CAAA3K,IAAI,EAAA2K,mBAAA,CAAGzO,KAAK,CAACC,MAAM,CAACyO,KAAK,UAAAD,mBAAA,iBAAlBA,mBAAA,CAAqB,CAAC,CAAC,CACpC,GAAI3K,IAAI,CAAE,CACRnM,eAAe,CAACmM,IAAI,CAAC,CACvB,CACF,CAAC,CAID,KAAM,CAAA6K,gBAAgB,CAAI/O,QAAkB,EAAK,CAC/CnO,mBAAmB,CAACmO,QAAQ,CAAC,CAC7BrO,mBAAmB,CAAC,IAAI,CAAC,CAC3B,CAAC,CAED,KAAM,CAAAqd,gBAAgB,CAAIhP,QAAkB,EAAK,CAC/C/H,4BAA4B,CAAC+H,QAAQ,CAAC,CACtCrI,mBAAmB,CAAC,IAAI,CAAC,CAC3B,CAAC,CAED,KAAM,CAAAsX,UAAU,CAAIC,UAAkB,EAAK,CACzC,MAAO,IAAI,CAAA5E,IAAI,CAAC4E,UAAU,CAAC,CAACC,cAAc,CAAC,CAAC,CAC9C,CAAC,CAID,GAAI/d,OAAO,EAAIJ,SAAS,CAACsB,MAAM,GAAK,CAAC,CAAE,CACrC,mBACE3D,IAAA,CAACtF,GAAG,EAAC+lB,EAAE,CAAE,CAAEC,OAAO,CAAE,MAAM,CAAEC,cAAc,CAAE,QAAQ,CAAEC,UAAU,CAAE,QAAQ,CAAEpgB,MAAM,CAAE,OAAQ,CAAE,CAAAqgB,QAAA,cAC5F7gB,IAAA,CAAChD,gBAAgB,GAAE,CAAC,CACjB,CAAC,CAEV,CAEA,mBACEkD,KAAA,CAACxF,GAAG,EAAC+lB,EAAE,CAAE,CACPK,CAAC,CAAE,CAAEC,EAAE,CAAE,CAAC,CAAEC,EAAE,CAAE,CAAE,CAAC,CACnBC,SAAS,CAAE,OAAO,CAClBC,UAAU,CAAE,mDACd,CAAE,CAAAL,QAAA,eAEA3gB,KAAA,CAACxF,GAAG,EAAC+lB,EAAE,CAAE,CACPU,EAAE,CAAE,CAAC,CACLT,OAAO,CAAE,MAAM,CACfE,UAAU,CAAE,QAAQ,CACpBQ,GAAG,CAAE,CAAC,CACNF,UAAU,CAAE,OAAO,CACnBJ,CAAC,CAAE,CAAC,CACJO,YAAY,CAAE,CAAC,CACfC,SAAS,CAAE,6BAA6B,CACxCC,MAAM,CAAE,4BACV,CAAE,CAAAV,QAAA,eACA3gB,KAAA,CAACxF,GAAG,EAAC+lB,EAAE,CAAE,CACPC,OAAO,CAAE,MAAM,CACfE,UAAU,CAAE,QAAQ,CACpBQ,GAAG,CAAE,CAAC,CACNI,IAAI,CAAE,CACR,CAAE,CAAAX,QAAA,eACA7gB,IAAA,CAACtF,GAAG,EAAC+lB,EAAE,CAAE,CACPgB,OAAO,CAAE,cAAc,CACvBlhB,KAAK,CAAE,EAAE,CACTC,MAAM,CAAE,EAAE,CACV6gB,YAAY,CAAE,CAAC,CACfX,OAAO,CAAE,MAAM,CACfE,UAAU,CAAE,QAAQ,CACpBD,cAAc,CAAE,QAAQ,CACxBW,SAAS,CAAE,oCACb,CAAE,CAAAT,QAAA,cACA7gB,IAAA,CAACtC,KAAK,EAAC+iB,EAAE,CAAE,CAAEiB,QAAQ,CAAE,EAAE,CAAE7I,KAAK,CAAE,OAAQ,CAAE,CAAE,CAAC,CAC5C,CAAC,cACN3Y,KAAA,CAACxF,GAAG,EAAAmmB,QAAA,eACF7gB,IAAA,CAAC/E,UAAU,EAAC0mB,OAAO,CAAC,IAAI,CAAClB,EAAE,CAAE,CAC3BmB,UAAU,CAAE,GAAG,CACfT,EAAE,CAAE,CAAC,CACLD,UAAU,CAAE,mDAAmD,CAC/DW,cAAc,CAAE,MAAM,CACtBC,oBAAoB,CAAE,MAAM,CAC5BC,mBAAmB,CAAE,aACvB,CAAE,CAAAlB,QAAA,CAAC,sBAEH,CAAY,CAAC,cACb7gB,IAAA,CAAC/E,UAAU,EAAC0mB,OAAO,CAAC,OAAO,CAAC9I,KAAK,CAAC,gBAAgB,CAAC4H,EAAE,CAAE,CAAEiB,QAAQ,CAAE,QAAS,CAAE,CAAAb,QAAA,CAAC,uCAE/E,CAAY,CAAC,EACV,CAAC,EACH,CAAC,cACN3gB,KAAA,CAACxF,GAAG,EAAC+lB,EAAE,CAAE,CAAEC,OAAO,CAAE,MAAM,CAAEU,GAAG,CAAE,CAAE,CAAE,CAAAP,QAAA,eACnC7gB,IAAA,CAACrF,MAAM,EACLgnB,OAAO,CAAC,UAAU,CAClBK,SAAS,cAAEhiB,IAAA,CAACjC,OAAO,GAAE,CAAE,CACvBkkB,OAAO,CAAE3U,aAAc,CACvB4U,QAAQ,CAAEzf,OAAQ,CAAAoe,QAAA,CAEjBpe,OAAO,CAAG,YAAY,CAAG,SAAS,CAC7B,CAAC,cACTzC,IAAA,CAACrF,MAAM,EACLgnB,OAAO,CAAC,WAAW,CACnBK,SAAS,cAAEhiB,IAAA,CAAC7C,GAAG,GAAE,CAAE,CACnB8kB,OAAO,CAAEA,CAAA,GAAMta,mBAAmB,CAAC,IAAI,CAAE,CACzCua,QAAQ,CAAEzf,OAAQ,CAAAoe,QAAA,CACnB,kBAED,CAAQ,CAAC,EACN,CAAC,EACH,CAAC,CAELle,KAAK,eACJ3C,IAAA,CAAC9E,KAAK,EAACinB,QAAQ,CAAC,OAAO,CAAC1B,EAAE,CAAE,CAAEU,EAAE,CAAE,CAAE,CAAE,CAAAN,QAAA,CACnCle,KAAK,CACD,CACR,CAEAE,OAAO,eACN7C,IAAA,CAAC9E,KAAK,EAACinB,QAAQ,CAAC,SAAS,CAAC1B,EAAE,CAAE,CAAEU,EAAE,CAAE,CAAE,CAAE,CAAAN,QAAA,CACrChe,OAAO,CACH,CACR,cAED3C,KAAA,CAAC7E,IAAI,EAAC+mB,SAAS,MAACC,OAAO,CAAE,CAAE,CAAAxB,QAAA,eAEzB7gB,IAAA,CAAC3E,IAAI,EAACinB,IAAI,MAACvB,EAAE,CAAE,EAAG,CAAAF,QAAA,cAChB7gB,IAAA,CAAC5D,IAAI,EAACqkB,EAAE,CAAE,CACRS,UAAU,CAAE,OAAO,CACnBG,YAAY,CAAE,CAAC,CACfC,SAAS,CAAE,6BAA6B,CACxCC,MAAM,CAAE,4BACV,CAAE,CAAAV,QAAA,cACA3gB,KAAA,CAAC7D,WAAW,EAACokB,EAAE,CAAE,CAAEK,CAAC,CAAE,CAAE,CAAE,CAAAD,QAAA,eACxB3gB,KAAA,CAACjF,UAAU,EAAC0mB,OAAO,CAAC,IAAI,CAAClB,EAAE,CAAE,CAAEU,EAAE,CAAE,CAAC,CAAES,UAAU,CAAE,GAAI,CAAE,CAAAf,QAAA,EAAC,oBACrC,CAACxe,SAAS,CAACsB,MAAM,CAAC,GACtC,EAAY,CAAC,CAEZtB,SAAS,CAACsB,MAAM,GAAK,CAAC,cACrB3D,IAAA,CAAC9E,KAAK,EAACinB,QAAQ,CAAC,MAAM,CAAAtB,QAAA,CAAC,0EAEvB,CAAO,CAAC,cAER7gB,IAAA,CAACtF,GAAG,EAAC+lB,EAAE,CAAE,CAAE8B,SAAS,CAAE,MAAO,CAAE,CAAA1B,QAAA,cAC7B7gB,IAAA,CAACtE,cAAc,EAAC8mB,SAAS,CAAElnB,KAAM,CAACmlB,EAAE,CAAE,CAAEgC,SAAS,CAAE,GAAI,CAAE,CAAA5B,QAAA,cACvD3gB,KAAA,CAAC3E,KAAK,EAACmnB,YAAY,MAACpa,IAAI,CAAC,OAAO,CAAAuY,QAAA,eAC9B7gB,IAAA,CAACrE,SAAS,EAAAklB,QAAA,cACR3gB,KAAA,CAACtE,QAAQ,EAAAilB,QAAA,eACP7gB,IAAA,CAACvE,SAAS,EAACglB,EAAE,CAAE,CAAEmB,UAAU,CAAE,GAAI,CAAE,CAAAf,QAAA,CAAC,cAAY,CAAW,CAAC,cAC5D7gB,IAAA,CAACvE,SAAS,EAACglB,EAAE,CAAE,CAAEmB,UAAU,CAAE,GAAI,CAAE,CAAAf,QAAA,CAAC,MAAI,CAAW,CAAC,cACpD7gB,IAAA,CAACvE,SAAS,EAACglB,EAAE,CAAE,CAAEmB,UAAU,CAAE,GAAI,CAAE,CAAAf,QAAA,CAAC,eAAa,CAAW,CAAC,cAC7D7gB,IAAA,CAACvE,SAAS,EAACglB,EAAE,CAAE,CAAEmB,UAAU,CAAE,GAAI,CAAE,CAAAf,QAAA,CAAC,MAAI,CAAW,CAAC,cACpD7gB,IAAA,CAACvE,SAAS,EAACglB,EAAE,CAAE,CAAEmB,UAAU,CAAE,GAAI,CAAE,CAAAf,QAAA,CAAC,OAAK,CAAW,CAAC,cACrD7gB,IAAA,CAACvE,SAAS,EAACglB,EAAE,CAAE,CAAEmB,UAAU,CAAE,GAAI,CAAE,CAAAf,QAAA,CAAC,OAAK,CAAW,CAAC,cACrD7gB,IAAA,CAACvE,SAAS,EAACglB,EAAE,CAAE,CAAEmB,UAAU,CAAE,GAAI,CAAE,CAAAf,QAAA,CAAC,SAAO,CAAW,CAAC,cACvD7gB,IAAA,CAACvE,SAAS,EAACglB,EAAE,CAAE,CAAEmB,UAAU,CAAE,GAAI,CAAE,CAAAf,QAAA,CAAC,SAAO,CAAW,CAAC,cACvD7gB,IAAA,CAACvE,SAAS,EAACglB,EAAE,CAAE,CAAEmB,UAAU,CAAE,GAAI,CAAE,CAAAf,QAAA,CAAC,SAAO,CAAW,CAAC,EAC/C,CAAC,CACF,CAAC,cACZ7gB,IAAA,CAACxE,SAAS,EAAAqlB,QAAA,CACPxe,SAAS,CAAC0P,GAAG,CAAEV,QAAQ,eACtBnR,KAAA,CAACtE,QAAQ,EAA2B+mB,KAAK,MAAA9B,QAAA,eACvC7gB,IAAA,CAACvE,SAAS,EAACglB,EAAE,CAAE,CAAEmC,UAAU,CAAE,WAAW,CAAElB,QAAQ,CAAE,SAAU,CAAE,CAAAb,QAAA,CAC7DxP,QAAQ,CAACjB,UAAU,CACX,CAAC,cACZpQ,IAAA,CAACvE,SAAS,EAAAolB,QAAA,cACR3gB,KAAA,CAACxF,GAAG,EAAC+lB,EAAE,CAAE,CAAEC,OAAO,CAAE,MAAM,CAAEE,UAAU,CAAE,QAAQ,CAAEQ,GAAG,CAAE,CAAE,CAAE,CAAAP,QAAA,eACzD7gB,IAAA,CAAC/E,UAAU,EAAC0mB,OAAO,CAAC,OAAO,CAAClB,EAAE,CAAE,CAAEmB,UAAU,CAAE,GAAI,CAAE,CAAAf,QAAA,CACjDxP,QAAQ,CAACrJ,IAAI,CACJ,CAAC,CACZqJ,QAAQ,CAACY,SAAS,eACjBjS,IAAA,CAAC1C,IAAI,EAACmjB,EAAE,CAAE,CAAEiB,QAAQ,CAAE,MAAM,CAAE7I,KAAK,CAAE,cAAe,CAAE,CAAE,CACzD,CACAxH,QAAQ,CAACwR,MAAM,GAAK,eAAe,eAClC7iB,IAAA,CAAC7E,IAAI,EACHsF,KAAK,CAAC,SAAS,CACf6H,IAAI,CAAC,OAAO,CACZuQ,KAAK,CAAC,SAAS,CACf8I,OAAO,CAAC,UAAU,CAClBlB,EAAE,CAAE,CAAEiB,QAAQ,CAAE,QAAS,CAAE,CAC5B,CACF,EACE,CAAC,CACG,CAAC,cACZ1hB,IAAA,CAACvE,SAAS,EAAAolB,QAAA,cACR3gB,KAAA,CAACjF,UAAU,EAAC0mB,OAAO,CAAC,OAAO,CAAC9I,KAAK,CAAC,gBAAgB,CAAAgI,QAAA,EAAC,IAChD,CAACxP,QAAQ,CAACpJ,WAAW,CAAC,IACzB,EAAY,CAAC,CACJ,CAAC,cACZjI,IAAA,CAACvE,SAAS,EAAAolB,QAAA,cACR3gB,KAAA,CAACjF,UAAU,EAAC0mB,OAAO,CAAC,OAAO,CAAAd,QAAA,EACxBxP,QAAQ,CAAC/I,IAAI,CAAC/H,KAAK,CAAC,MAAC,CAAC8Q,QAAQ,CAAC/I,IAAI,CAAC9H,MAAM,EACjC,CAAC,CACJ,CAAC,cACZR,IAAA,CAACvE,SAAS,EAAAolB,QAAA,cACR7gB,IAAA,CAAC7E,IAAI,EACHsF,KAAK,CAAE4Q,QAAQ,CAAC7I,KAAK,CAAC7E,MAAO,CAC7B2E,IAAI,CAAC,OAAO,CACZqZ,OAAO,CAAC,UAAU,CACnB,CAAC,CACO,CAAC,cACZ3hB,IAAA,CAACvE,SAAS,EAAAolB,QAAA,cACR7gB,IAAA,CAAC7E,IAAI,EACHsF,KAAK,CAAE4Q,QAAQ,CAAC2D,QAAQ,CAAG,KAAK,CAAG,IAAK,CACxC1M,IAAI,CAAC,OAAO,CACZuQ,KAAK,CAAExH,QAAQ,CAAC2D,QAAQ,CAAG,SAAS,CAAG,OAAQ,CAC/C2M,OAAO,CAAC,UAAU,CACnB,CAAC,CACO,CAAC,cACZzhB,KAAA,CAACzE,SAAS,EAAAolB,QAAA,EACPxP,QAAQ,CAACY,SAAS,cACjBjS,IAAA,CAAC7E,IAAI,EACHsF,KAAK,CAAC,SAAS,CACf6H,IAAI,CAAC,OAAO,CACZuQ,KAAK,CAAC,SAAS,CACf8I,OAAO,CAAC,QAAQ,CAChBmB,IAAI,cAAE9iB,IAAA,CAAC1C,IAAI,GAAE,CAAE,CAChB,CAAC,cAEF0C,IAAA,CAACrF,MAAM,EACLgnB,OAAO,CAAC,UAAU,CAClBrZ,IAAI,CAAC,OAAO,CACZ0Z,SAAS,cAAEhiB,IAAA,CAACzC,UAAU,GAAE,CAAE,CAC1B0kB,OAAO,CAAEA,CAAA,GAAMpQ,gBAAgB,CAACR,QAAQ,CAACjB,UAAU,CAAE,CACrD8R,QAAQ,CAAE,CAAC7Q,QAAQ,CAAC2D,QAAS,CAC7B6D,KAAK,CAAC,SAAS,CACf4H,EAAE,CAAE,CAAEsC,QAAQ,CAAE,OAAO,CAAErB,QAAQ,CAAE,QAAS,CAAE,CAAAb,QAAA,CAC/C,aAED,CAAQ,CACT,CACA,CAACxP,QAAQ,CAAC2D,QAAQ,EAAI,CAAC3D,QAAQ,CAACY,SAAS,eACxCjS,IAAA,CAAC/E,UAAU,EAAC0mB,OAAO,CAAC,SAAS,CAACjB,OAAO,CAAC,OAAO,CAAC7H,KAAK,CAAC,YAAY,CAAC4H,EAAE,CAAE,CAAEuC,EAAE,CAAE,GAAI,CAAE,CAAAnC,QAAA,CAAC,oBAElF,CAAY,CACb,EACQ,CAAC,cACZ3gB,KAAA,CAACzE,SAAS,EAAAolB,QAAA,eACR7gB,IAAA,CAAC/E,UAAU,EAAC0mB,OAAO,CAAC,SAAS,CAACjB,OAAO,CAAC,OAAO,CAAAG,QAAA,CAC1CP,UAAU,CAACjP,QAAQ,CAAC4R,SAAS,CAAC,CACrB,CAAC,CACZ5R,QAAQ,CAAC6R,aAAa,eACrBhjB,KAAA,CAACjF,UAAU,EAAC0mB,OAAO,CAAC,SAAS,CAACjB,OAAO,CAAC,OAAO,CAAC7H,KAAK,CAAC,gBAAgB,CAAAgI,QAAA,EAAC,MAC/D,CAACP,UAAU,CAACjP,QAAQ,CAAC6R,aAAa,CAAC,EAC7B,CACb,EACQ,CAAC,cACZljB,IAAA,CAACvE,SAAS,EAAAolB,QAAA,cACR3gB,KAAA,CAACxF,GAAG,EAAC+lB,EAAE,CAAE,CAAEC,OAAO,CAAE,MAAM,CAAEU,GAAG,CAAE,GAAG,CAAE+B,aAAa,CAAE,QAAS,CAAE,CAAAtC,QAAA,eAC9D7gB,IAAA,CAACrF,MAAM,EACLgnB,OAAO,CAAC,UAAU,CAClBrZ,IAAI,CAAC,OAAO,CACZ0Z,SAAS,cAAEhiB,IAAA,CAAC/B,WAAW,GAAE,CAAE,CAC3BgkB,OAAO,CAAEA,CAAA,GAAM5B,gBAAgB,CAAChP,QAAQ,CAAE,CAC1C6Q,QAAQ,CAAEzf,OAAQ,CAClBge,EAAE,CAAE,CAAEsC,QAAQ,CAAE,MAAM,CAAErB,QAAQ,CAAE,QAAS,CAAE,CAAAb,QAAA,CAE5CxP,QAAQ,CAAC2D,QAAQ,CAAG,QAAQ,CAAG,QAAQ,CAClC,CAAC,cACThV,IAAA,CAACrF,MAAM,EACLgnB,OAAO,CAAC,UAAU,CAClBrZ,IAAI,CAAC,OAAO,CACZ0Z,SAAS,cAAEhiB,IAAA,CAAChC,MAAM,GAAE,CAAE,CACtBikB,OAAO,CAAEA,CAAA,GAAM7B,gBAAgB,CAAC/O,QAAQ,CAAE,CAC1C6Q,QAAQ,CAAEzf,OAAQ,CAClBge,EAAE,CAAE,CAAEsC,QAAQ,CAAE,MAAM,CAAErB,QAAQ,CAAE,QAAS,CAAE,CAAAb,QAAA,CAC9C,QAED,CAAQ,CAAC,cACT7gB,IAAA,CAACrF,MAAM,EACLgnB,OAAO,CAAC,UAAU,CAClBrZ,IAAI,CAAC,OAAO,CACZ0Z,SAAS,cAAEhiB,IAAA,CAAC5C,MAAM,GAAE,CAAE,CACtB6kB,OAAO,CAAEA,CAAA,GAAM3P,oBAAoB,CAACjB,QAAQ,CAAE,CAC9C6Q,QAAQ,CAAEzf,OAAQ,CAClBoW,KAAK,CAAC,OAAO,CACb4H,EAAE,CAAE,CAAEsC,QAAQ,CAAE,MAAM,CAAErB,QAAQ,CAAE,QAAS,CAAE,CAAAb,QAAA,CAC9C,QAED,CAAQ,CAAC,EACN,CAAC,CACG,CAAC,GAxHCxP,QAAQ,CAACjB,UAyHd,CACX,CAAC,CACO,CAAC,EACP,CAAC,CACM,CAAC,CACd,CACN,EACU,CAAC,CACV,CAAC,CACH,CAAC,cAGPpQ,IAAA,CAAC3E,IAAI,EAACinB,IAAI,MAACvB,EAAE,CAAE,EAAG,CAAAF,QAAA,cAChB7gB,IAAA,CAAC5D,IAAI,EAAAykB,QAAA,cACH3gB,KAAA,CAAC7D,WAAW,EAAAwkB,QAAA,eACV3gB,KAAA,CAACjF,UAAU,EAAC0mB,OAAO,CAAC,IAAI,CAAClB,EAAE,CAAE,CAAEU,EAAE,CAAE,CAAC,CAAES,UAAU,CAAE,GAAI,CAAE,CAAAf,QAAA,EAAC,sBACnC,CAACxe,SAAS,CAACsB,MAAM,CAAC,GACxC,EAAY,CAAC,CAEZtB,SAAS,CAACsB,MAAM,GAAK,CAAC,cACrB3D,IAAA,CAAC9E,KAAK,EAACinB,QAAQ,CAAC,MAAM,CAAAtB,QAAA,CAAC,0EAEvB,CAAO,CAAC,cAER7gB,IAAA,CAACnE,IAAI,EAAAglB,QAAA,CACFxe,SAAS,CAAC0P,GAAG,CAAC,CAACV,QAAQ,CAAE8B,KAAK,gBAC7BjT,KAAA,CAAC5F,KAAK,CAAC6F,QAAQ,EAAA0gB,QAAA,eACb3gB,KAAA,CAACpE,QAAQ,EAAA+kB,QAAA,eACP7gB,IAAA,CAACjE,YAAY,EACXqnB,OAAO,cACLljB,KAAA,CAACxF,GAAG,EAAC+lB,EAAE,CAAE,CAAEC,OAAO,CAAE,MAAM,CAAEE,UAAU,CAAE,QAAQ,CAAEQ,GAAG,CAAE,CAAC,CAAED,EAAE,CAAE,CAAE,CAAE,CAAAN,QAAA,eAChE7gB,IAAA,CAAC/E,UAAU,EAAC0mB,OAAO,CAAC,IAAI,CAAClB,EAAE,CAAE,CAAEmB,UAAU,CAAE,GAAG,CAAE/I,KAAK,CAAE,cAAe,CAAE,CAAAgI,QAAA,CACrExP,QAAQ,CAACrJ,IAAI,CACJ,CAAC,CACZqJ,QAAQ,CAACY,SAAS,eACjBjS,IAAA,CAAC7E,IAAI,EACH2nB,IAAI,cAAE9iB,IAAA,CAAC1C,IAAI,GAAE,CAAE,CACfmD,KAAK,CAAC,SAAS,CACfoY,KAAK,CAAC,SAAS,CACfvQ,IAAI,CAAC,OAAO,CACb,CACF,EACE,CACN,CACD+a,SAAS,cACPnjB,KAAA,CAACxF,GAAG,EAAAmmB,QAAA,eAEF3gB,KAAA,CAACxF,GAAG,EAAC+lB,EAAE,CAAE,CAAEU,EAAE,CAAE,CAAC,CAAEL,CAAC,CAAE,CAAC,CAAEW,OAAO,CAAE,SAAS,CAAEJ,YAAY,CAAE,CAAE,CAAE,CAAAR,QAAA,eAC5D7gB,IAAA,CAAC/E,UAAU,EAAC0mB,OAAO,CAAC,OAAO,CAAClB,EAAE,CAAE,CAAEmB,UAAU,CAAE,GAAG,CAAE/I,KAAK,CAAE,cAAe,CAAE,CAAAgI,QAAA,CAAC,eAE5E,CAAY,CAAC,cACb7gB,IAAA,CAAC/E,UAAU,EAAC0mB,OAAO,CAAC,OAAO,CAAClB,EAAE,CAAE,CAAEmC,UAAU,CAAE,WAAW,CAAElB,QAAQ,CAAE,QAAS,CAAE,CAAAb,QAAA,CAC7ExP,QAAQ,CAACjB,UAAU,CACV,CAAC,EACV,CAAC,cAGNlQ,KAAA,CAAC7E,IAAI,EAAC+mB,SAAS,MAACC,OAAO,CAAE,CAAE,CAAC5B,EAAE,CAAE,CAAEU,EAAE,CAAE,CAAE,CAAE,CAAAN,QAAA,eACxC3gB,KAAA,CAAC7E,IAAI,EAACinB,IAAI,MAACvB,EAAE,CAAE,EAAG,CAACC,EAAE,CAAE,CAAE,CAAAH,QAAA,eACvB7gB,IAAA,CAAC/E,UAAU,EAAC0mB,OAAO,CAAC,OAAO,CAAClB,EAAE,CAAE,CAAEmB,UAAU,CAAE,GAAI,CAAE,CAAAf,QAAA,CAAC,gBAErD,CAAY,CAAC,cACb3gB,KAAA,CAACjF,UAAU,EAAC0mB,OAAO,CAAC,OAAO,CAAC9I,KAAK,CAAC,gBAAgB,CAAAgI,QAAA,EAAC,IAChD,CAACxP,QAAQ,CAACpJ,WAAW,CAAC,IACzB,EAAY,CAAC,EACT,CAAC,cACP/H,KAAA,CAAC7E,IAAI,EAACinB,IAAI,MAACvB,EAAE,CAAE,EAAG,CAACC,EAAE,CAAE,CAAE,CAAAH,QAAA,eACvB7gB,IAAA,CAAC/E,UAAU,EAAC0mB,OAAO,CAAC,OAAO,CAAClB,EAAE,CAAE,CAAEmB,UAAU,CAAE,GAAI,CAAE,CAAAf,QAAA,CAAC,OAErD,CAAY,CAAC,cACb3gB,KAAA,CAACjF,UAAU,EAAC0mB,OAAO,CAAC,OAAO,CAAC9I,KAAK,CAAC,gBAAgB,CAAAgI,QAAA,EAC/CxP,QAAQ,CAAC/I,IAAI,CAAC/H,KAAK,CAAC,QAAG,CAAC8Q,QAAQ,CAAC/I,IAAI,CAAC9H,MAAM,CAAC,SAChD,EAAY,CAAC,EACT,CAAC,cACPN,KAAA,CAAC7E,IAAI,EAACinB,IAAI,MAACvB,EAAE,CAAE,EAAG,CAACC,EAAE,CAAE,CAAE,CAAAH,QAAA,eACvB7gB,IAAA,CAAC/E,UAAU,EAAC0mB,OAAO,CAAC,OAAO,CAAClB,EAAE,CAAE,CAAEmB,UAAU,CAAE,GAAI,CAAE,CAAAf,QAAA,CAAC,YAErD,CAAY,CAAC,cACb3gB,KAAA,CAACjF,UAAU,EAAC0mB,OAAO,CAAC,OAAO,CAAC9I,KAAK,CAAC,gBAAgB,CAAAgI,QAAA,EAC/CxP,QAAQ,CAAC7I,KAAK,CAAC7E,MAAM,CAAC,mBACzB,EAAY,CAAC,EACT,CAAC,cACPzD,KAAA,CAAC7E,IAAI,EAACinB,IAAI,MAACvB,EAAE,CAAE,EAAG,CAACC,EAAE,CAAE,CAAE,CAAAH,QAAA,eACvB7gB,IAAA,CAAC/E,UAAU,EAAC0mB,OAAO,CAAC,OAAO,CAAClB,EAAE,CAAE,CAAEmB,UAAU,CAAE,GAAI,CAAE,CAAAf,QAAA,CAAC,SAErD,CAAY,CAAC,cACb3gB,KAAA,CAACxF,GAAG,EAAC+lB,EAAE,CAAE,CAAEC,OAAO,CAAE,MAAM,CAAEU,GAAG,CAAE,CAAC,CAAER,UAAU,CAAE,QAAS,CAAE,CAAAC,QAAA,eACzD7gB,IAAA,CAAC7E,IAAI,EACHsF,KAAK,CAAE4Q,QAAQ,CAACY,SAAS,CAAG,SAAS,CAAG,gBAAiB,CACzD3J,IAAI,CAAC,OAAO,CACZuQ,KAAK,CAAExH,QAAQ,CAACY,SAAS,CAAG,SAAS,CAAG,SAAU,CAClD0P,OAAO,CAAEtQ,QAAQ,CAACY,SAAS,CAAG,QAAQ,CAAG,UAAW,CACpDgQ,OAAO,CAAE5Q,QAAQ,CAACY,SAAS,CAAG6K,SAAS,CAAG,IAAMjL,gBAAgB,CAACR,QAAQ,CAACjB,UAAU,CAAE,CACtFqQ,EAAE,CAAEpP,QAAQ,CAACY,SAAS,CAAG,CAAC,CAAC,CAAG,CAAEqR,MAAM,CAAE,SAAU,CAAE,CACpDpB,QAAQ,CAAE,CAAC7Q,QAAQ,CAAC2D,QAAS,CAC9B,CAAC,CACD,CAAC3D,QAAQ,CAAC2D,QAAQ,eACjBhV,IAAA,CAAC7E,IAAI,EACHsF,KAAK,CAAC,UAAU,CAChB6H,IAAI,CAAC,OAAO,CACZuQ,KAAK,CAAC,OAAO,CACb8I,OAAO,CAAC,UAAU,CACnB,CACF,EACE,CAAC,EACF,CAAC,EACH,CAAC,cAGPzhB,KAAA,CAACxF,GAAG,EAAC+lB,EAAE,CAAE,CAAEU,EAAE,CAAE,CAAC,CAAEL,CAAC,CAAE,CAAC,CAAEW,OAAO,CAAE,SAAS,CAAEJ,YAAY,CAAE,CAAE,CAAE,CAAAR,QAAA,eAC5D7gB,IAAA,CAAC/E,UAAU,EAAC0mB,OAAO,CAAC,OAAO,CAAClB,EAAE,CAAE,CAAEmB,UAAU,CAAE,GAAG,CAAET,EAAE,CAAE,CAAE,CAAE,CAAAN,QAAA,CAAC,aAE5D,CAAY,CAAC,cACb3gB,KAAA,CAAC7E,IAAI,EAAC+mB,SAAS,MAACC,OAAO,CAAE,CAAE,CAAAxB,QAAA,eACzB3gB,KAAA,CAAC7E,IAAI,EAACinB,IAAI,MAACvB,EAAE,CAAE,EAAG,CAACC,EAAE,CAAE,CAAE,CAAAH,QAAA,eACvB7gB,IAAA,CAAC/E,UAAU,EAAC0mB,OAAO,CAAC,SAAS,CAAClB,EAAE,CAAE,CAAEmB,UAAU,CAAE,GAAI,CAAE,CAAAf,QAAA,CAAC,eAEvD,CAAY,CAAC,cACb7gB,IAAA,CAAC/E,UAAU,EAAC0mB,OAAO,CAAC,SAAS,CAACjB,OAAO,CAAC,OAAO,CAAC7H,KAAK,CAAC,gBAAgB,CAAAgI,QAAA,CACjEP,UAAU,CAACjP,QAAQ,CAAC4R,SAAS,CAAC,CACrB,CAAC,EACT,CAAC,CACN5R,QAAQ,CAAC6R,aAAa,eACrBhjB,KAAA,CAAC7E,IAAI,EAACinB,IAAI,MAACvB,EAAE,CAAE,EAAG,CAACC,EAAE,CAAE,CAAE,CAAAH,QAAA,eACvB7gB,IAAA,CAAC/E,UAAU,EAAC0mB,OAAO,CAAC,SAAS,CAAClB,EAAE,CAAE,CAAEmB,UAAU,CAAE,GAAI,CAAE,CAAAf,QAAA,CAAC,aAEvD,CAAY,CAAC,cACb3gB,KAAA,CAACjF,UAAU,EAAC0mB,OAAO,CAAC,SAAS,CAACjB,OAAO,CAAC,OAAO,CAAC7H,KAAK,CAAC,gBAAgB,CAAAgI,QAAA,EACjEP,UAAU,CAACjP,QAAQ,CAAC6R,aAAa,CAAC,CAAC,MAAI,CAAC7R,QAAQ,CAACkS,aAAa,EAAI,SAAS,EAClE,CAAC,EACT,CACP,CACAlS,QAAQ,CAACmS,aAAa,eACrBtjB,KAAA,CAAC7E,IAAI,EAACinB,IAAI,MAACvB,EAAE,CAAE,EAAG,CAACC,EAAE,CAAE,CAAE,CAAAH,QAAA,eACvB7gB,IAAA,CAAC/E,UAAU,EAAC0mB,OAAO,CAAC,SAAS,CAAClB,EAAE,CAAE,CAAEmB,UAAU,CAAE,GAAI,CAAE,CAAAf,QAAA,CAAC,eAEvD,CAAY,CAAC,cACb7gB,IAAA,CAAC/E,UAAU,EAAC0mB,OAAO,CAAC,SAAS,CAACjB,OAAO,CAAC,OAAO,CAAC7H,KAAK,CAAC,gBAAgB,CAAAgI,QAAA,CACjEP,UAAU,CAACjP,QAAQ,CAACmS,aAAa,CAAC,CACzB,CAAC,EACT,CACP,EACG,CAAC,EACJ,CAAC,cAGNxjB,IAAA,CAACtF,GAAG,EAAC+lB,EAAE,CAAE,CAAEU,EAAE,CAAE,CAAE,CAAE,CAAAN,QAAA,cACjB3gB,KAAA,CAACrD,SAAS,EAAC4jB,EAAE,CAAE,CAAEa,SAAS,CAAE,MAAO,CAAE,CAAAT,QAAA,eACnC7gB,IAAA,CAAClD,gBAAgB,EAAC2mB,UAAU,cAAEzjB,IAAA,CAAC9B,UAAU,GAAE,CAAE,CAAA2iB,QAAA,cAC3C7gB,IAAA,CAAC/E,UAAU,EAAC0mB,OAAO,CAAC,OAAO,CAAClB,EAAE,CAAE,CAAEmB,UAAU,CAAE,GAAI,CAAE,CAAAf,QAAA,CAAC,gCAErD,CAAY,CAAC,CACG,CAAC,cACnB7gB,IAAA,CAACjD,gBAAgB,EAAA8jB,QAAA,cACf7gB,IAAA,CAACtF,GAAG,EAAC+lB,EAAE,CAAE,CAAEK,CAAC,CAAE,CAAC,CAAEW,OAAO,CAAE,SAAS,CAAEJ,YAAY,CAAE,CAAE,CAAE,CAAAR,QAAA,cACrD7gB,IAAA,QAAK0jB,KAAK,CAAE,CACVhC,QAAQ,CAAE,SAAS,CACnBiC,QAAQ,CAAE,MAAM,CAChBC,MAAM,CAAE,CAAC,CACThB,UAAU,CAAE,WAAW,CACvBiB,UAAU,CAAE,UAAU,CACtBC,SAAS,CAAE,YACb,CAAE,CAAAjD,QAAA,CACvCzY,IAAI,CAACC,SAAS,CAAC,CACdC,IAAI,CAAE+I,QAAQ,CAAC/I,IAAI,CACnBC,QAAQ,CAAE8I,QAAQ,CAAC9I,QAAQ,CAC3BP,IAAI,CAAEqJ,QAAQ,CAACrJ,IAAI,CACnBC,WAAW,CAAEoJ,QAAQ,CAACpJ,WAAW,CACjCO,KAAK,CAAE6I,QAAQ,CAAC7I,KAClB,CAAC,CAAE,IAAI,CAAE,CAAC,CAAC,CACgC,CAAC,CACH,CAAC,CACU,CAAC,EACV,CAAC,CACT,CAAC,cAGNtI,KAAA,CAACxF,GAAG,EAAC+lB,EAAE,CAAE,CAAEU,EAAE,CAAE,CAAC,CAAEL,CAAC,CAAE,CAAC,CAAEW,OAAO,CAAE,SAAS,CAAEJ,YAAY,CAAE,CAAE,CAAE,CAAAR,QAAA,eAC5D7gB,IAAA,CAAC/E,UAAU,EAAC0mB,OAAO,CAAC,OAAO,CAAClB,EAAE,CAAE,CAAEmB,UAAU,CAAE,GAAG,CAAET,EAAE,CAAE,CAAC,CAAEtI,KAAK,CAAE,cAAe,CAAE,CAAAgI,QAAA,CAAC,kBAEnF,CAAY,CAAC,cACb7gB,IAAA,CAAC/E,UAAU,EAAC0mB,OAAO,CAAC,OAAO,CAAC9I,KAAK,CAAC,gBAAgB,CAAC4H,EAAE,CAAE,CAAEU,EAAE,CAAE,CAAE,CAAE,CAAAN,QAAA,CAAC,mFAElE,CAAY,CAAC,cACb3gB,KAAA,CAACxF,GAAG,EAAC+lB,EAAE,CAAE,CAAEC,OAAO,CAAE,MAAM,CAAEU,GAAG,CAAE,CAAC,CAAE2C,QAAQ,CAAE,MAAO,CAAE,CAAAlD,QAAA,eACrD7gB,IAAA,CAAC7E,IAAI,EACHsF,KAAK,CAAC,gBAAgB,CACtB6H,IAAI,CAAC,OAAO,CACZuQ,KAAK,CAAC,MAAM,CACZ8I,OAAO,CAAC,UAAU,CAClBM,OAAO,CAAEA,CAAA,GAAM7B,gBAAgB,CAAC/O,QAAQ,CAAE,CAC1CoP,EAAE,CAAE,CAAE6C,MAAM,CAAE,SAAU,CAAE,CAC3B,CAAC,CACDjS,QAAQ,CAACY,SAAS,cACjBjS,IAAA,CAAC7E,IAAI,EACHsF,KAAK,CAAC,SAAS,CACf6H,IAAI,CAAC,OAAO,CACZuQ,KAAK,CAAC,SAAS,CACf8I,OAAO,CAAC,QAAQ,CAChBmB,IAAI,cAAE9iB,IAAA,CAAC1C,IAAI,GAAE,CAAE,CAChB,CAAC,cAEF0C,IAAA,CAACrF,MAAM,EACLgnB,OAAO,CAAC,UAAU,CAClBrZ,IAAI,CAAC,OAAO,CACZ0Z,SAAS,cAAEhiB,IAAA,CAACzC,UAAU,GAAE,CAAE,CAC1B0kB,OAAO,CAAEA,CAAA,GAAMpQ,gBAAgB,CAACR,QAAQ,CAACjB,UAAU,CAAE,CACrD8R,QAAQ,CAAE,CAAC7Q,QAAQ,CAAC2D,QAAS,CAC7B6D,KAAK,CAAC,SAAS,CACf4H,EAAE,CAAE,CAAEsC,QAAQ,CAAE,OAAO,CAAErB,QAAQ,CAAE,QAAS,CAAE,CAAAb,QAAA,CAC/C,gBAED,CAAQ,CACT,EACE,CAAC,EACH,CAAC,cAGN3gB,KAAA,CAACrD,SAAS,EAAC4jB,EAAE,CAAE,CAAEuC,EAAE,CAAE,CAAC,CAAE1B,SAAS,CAAE,MAAO,CAAE,CAAAT,QAAA,eAC1C7gB,IAAA,CAAClD,gBAAgB,EAAC2mB,UAAU,cAAEzjB,IAAA,CAAC9B,UAAU,GAAE,CAAE,CAAA2iB,QAAA,cAC3C3gB,KAAA,CAACjF,UAAU,EAAC0mB,OAAO,CAAC,SAAS,CAAAd,QAAA,EAAC,OACvB,CAACxP,QAAQ,CAAC7I,KAAK,CAAC7E,MAAM,CAAC,YAC9B,EAAY,CAAC,CACG,CAAC,cACnB3D,IAAA,CAACjD,gBAAgB,EAAA8jB,QAAA,cACf7gB,IAAA,CAAC3E,IAAI,EAAC+mB,SAAS,MAACC,OAAO,CAAE,CAAE,CAAAxB,QAAA,CACxBxP,QAAQ,CAAC7I,KAAK,CAACuJ,GAAG,CAAC,CAACmB,IAAI,CAAE8Q,SAAS,gBAClChkB,IAAA,CAAC3E,IAAI,EAACinB,IAAI,MAACvB,EAAE,CAAE,EAAG,CAACC,EAAE,CAAE,CAAE,CAAAH,QAAA,cACvB3gB,KAAA,CAACxF,GAAG,EAAC+lB,EAAE,CAAE,CAAEK,CAAC,CAAE,CAAC,CAAES,MAAM,CAAE,CAAC,CAAEjD,WAAW,CAAE,SAAS,CAAE+C,YAAY,CAAE,CAAE,CAAE,CAAAR,QAAA,eACpE3gB,KAAA,CAACjF,UAAU,EAAC0mB,OAAO,CAAC,SAAS,CAAClB,EAAE,CAAE,CAAEmB,UAAU,CAAE,GAAI,CAAE,CAAAf,QAAA,EAAC,OAChD,CAACmD,SAAS,CAAG,CAAC,EACT,CAAC,cACb9jB,KAAA,CAACjF,UAAU,EAAC0mB,OAAO,CAAC,SAAS,CAACjB,OAAO,CAAC,OAAO,CAAAG,QAAA,EAAC,aACjC,CAAC3N,IAAI,CAACzK,MAAM,CAACC,CAAC,CAAC,IAAE,CAACwK,IAAI,CAACzK,MAAM,CAACE,CAAC,CAAC,UACrC,CAACuK,IAAI,CAACzK,MAAM,CAAClI,KAAK,CAAC,MAAC,CAAC2S,IAAI,CAACzK,MAAM,CAACjI,MAAM,EACnC,CAAC,cACbN,KAAA,CAACjF,UAAU,EAAC0mB,OAAO,CAAC,SAAS,CAACjB,OAAO,CAAC,OAAO,CAAAG,QAAA,EAAC,UACpC,CAAC3N,IAAI,CAACtK,MAAM,CAACC,IAAI,CAAC,KAAG,CAACqK,IAAI,CAACtK,MAAM,CAACnI,KAAK,EACrC,CAAC,CACZyS,IAAI,CAACtK,MAAM,CAACwE,GAAG,eACdlN,KAAA,CAACjF,UAAU,EAAC0mB,OAAO,CAAC,SAAS,CAACjB,OAAO,CAAC,OAAO,CAACD,EAAE,CAAE,CAAEqD,SAAS,CAAE,WAAY,CAAE,CAAAjD,QAAA,EAAC,OACvE,CAAC3N,IAAI,CAACtK,MAAM,CAACwE,GAAG,EACX,CACb,EACE,CAAC,EAjBuB4W,SAkBzB,CACP,CAAC,CACE,CAAC,CACS,CAAC,EACV,CAAC,EACT,CACN,CACF,CAAC,cACFhkB,IAAA,CAAChE,uBAAuB,EAAA6kB,QAAA,cACtB3gB,KAAA,CAACxF,GAAG,EAAC+lB,EAAE,CAAE,CAAEC,OAAO,CAAE,MAAM,CAAEyC,aAAa,CAAE,QAAQ,CAAE/B,GAAG,CAAE,CAAC,CAAER,UAAU,CAAE,UAAW,CAAE,CAAAC,QAAA,eAEpF3gB,KAAA,CAACxF,GAAG,EAAC+lB,EAAE,CAAE,CAAE9B,SAAS,CAAE,OAAQ,CAAE,CAAAkC,QAAA,eAC9B7gB,IAAA,CAAC/E,UAAU,EAAC0mB,OAAO,CAAC,SAAS,CAAClB,EAAE,CAAE,CAAEmB,UAAU,CAAE,GAAG,CAAElB,OAAO,CAAE,OAAQ,CAAE,CAAAG,QAAA,CAAC,eAEzE,CAAY,CAAC,cACb7gB,IAAA,CAAC7E,IAAI,EACHsF,KAAK,CAAE4Q,QAAQ,CAAC2D,QAAQ,CAAG,gBAAgB,CAAG,UAAW,CACzD1M,IAAI,CAAC,OAAO,CACZuQ,KAAK,CAAExH,QAAQ,CAAC2D,QAAQ,CAAG,SAAS,CAAG,OAAQ,CAC/C2M,OAAO,CAAC,UAAU,CACnB,CAAC,EACC,CAAC,cAGNzhB,KAAA,CAACxF,GAAG,EAAC+lB,EAAE,CAAE,CAAEC,OAAO,CAAE,MAAM,CAAEU,GAAG,CAAE,CAAC,CAAE+B,aAAa,CAAE,QAAS,CAAE,CAAAtC,QAAA,eAC5D7gB,IAAA,CAACrF,MAAM,EACLgnB,OAAO,CAAC,UAAU,CAClBrZ,IAAI,CAAC,OAAO,CACZ0Z,SAAS,cAAEhiB,IAAA,CAACvB,UAAU,GAAE,CAAE,CAC1BwjB,OAAO,CAAEA,CAAA,GAAM7Q,uBAAuB,CAACC,QAAQ,CAAE,CACjD6Q,QAAQ,CAAEzf,OAAQ,CAClBge,EAAE,CAAE,CAAEsC,QAAQ,CAAE,OAAQ,CAAE,CAAAlC,QAAA,CAC3B,cAED,CAAQ,CAAC,cACT7gB,IAAA,CAACrF,MAAM,EACLgnB,OAAO,CAAC,UAAU,CAClBrZ,IAAI,CAAC,OAAO,CACZ0Z,SAAS,cAAEhiB,IAAA,CAAC/B,WAAW,GAAE,CAAE,CAC3BgkB,OAAO,CAAEA,CAAA,GAAM5B,gBAAgB,CAAChP,QAAQ,CAAE,CAC1C6Q,QAAQ,CAAEzf,OAAQ,CAClBge,EAAE,CAAE,CAAEsC,QAAQ,CAAE,OAAQ,CAAE,CAAAlC,QAAA,CAEzBxP,QAAQ,CAAC2D,QAAQ,CAAG,cAAc,CAAG,cAAc,CAC9C,CAAC,cACThV,IAAA,CAACrF,MAAM,EACLgnB,OAAO,CAAC,UAAU,CAClBrZ,IAAI,CAAC,OAAO,CACZ0Z,SAAS,cAAEhiB,IAAA,CAAChC,MAAM,GAAE,CAAE,CACtBikB,OAAO,CAAEA,CAAA,GAAM7B,gBAAgB,CAAC/O,QAAQ,CAAE,CAC1C6Q,QAAQ,CAAEzf,OAAQ,CAClBge,EAAE,CAAE,CAAEsC,QAAQ,CAAE,OAAQ,CAAE,CAAAlC,QAAA,CAC3B,gBAED,CAAQ,CAAC,cACT7gB,IAAA,CAACrF,MAAM,EACLgnB,OAAO,CAAC,UAAU,CAClBrZ,IAAI,CAAC,OAAO,CACZ0Z,SAAS,cAAEhiB,IAAA,CAACxB,IAAI,GAAE,CAAE,CACpByjB,OAAO,CAAEA,CAAA,GAAMzR,iBAAiB,CAACa,QAAQ,CAACjB,UAAU,CAAE,CACtD8R,QAAQ,CAAEzf,OAAQ,CAClBge,EAAE,CAAE,CAAEsC,QAAQ,CAAE,OAAQ,CAAE,CAC1BlK,KAAK,CAAC,MAAM,CAAAgI,QAAA,CACb,gBAED,CAAQ,CAAC,EACN,CAAC,EACH,CAAC,CACiB,CAAC,EAClB,CAAC,CACV1N,KAAK,CAAG9Q,SAAS,CAACsB,MAAM,CAAG,CAAC,eAAI3D,IAAA,CAAC/D,OAAO,GAAE,CAAC,GAjSzBoV,QAAQ,CAACjB,UAkSd,CACjB,CAAC,CACE,CACP,EACU,CAAC,CACV,CAAC,CACH,CAAC,cAGPpQ,IAAA,CAAC3E,IAAI,EAACinB,IAAI,MAACvB,EAAE,CAAE,EAAG,CAAAF,QAAA,cAChB7gB,IAAA,CAAC5D,IAAI,EAAAykB,QAAA,cACH3gB,KAAA,CAAC7D,WAAW,EAAAwkB,QAAA,eACV7gB,IAAA,CAAC/E,UAAU,EAAC0mB,OAAO,CAAC,IAAI,CAAClB,EAAE,CAAE,CAAEU,EAAE,CAAE,CAAC,CAAES,UAAU,CAAE,GAAI,CAAE,CAAAf,QAAA,CAAC,eAEzD,CAAY,CAAC,cAEb3gB,KAAA,CAAC7E,IAAI,EAAC+mB,SAAS,MAACC,OAAO,CAAE,CAAE,CAAAxB,QAAA,eACzB3gB,KAAA,CAAC7E,IAAI,EAACinB,IAAI,MAACvB,EAAE,CAAE,EAAG,CAACC,EAAE,CAAE,CAAE,CAAAH,QAAA,eACvB7gB,IAAA,CAAChF,SAAS,EACRipB,SAAS,MACTxjB,KAAK,CAAC,mBAAmB,CACzByjB,WAAW,CAAC,oBAAoB,CAChCC,UAAU,CAAC,4DAA4D,CACxE,CAAC,cACFnkB,IAAA,CAACrF,MAAM,EACLgnB,OAAO,CAAC,UAAU,CAClBK,SAAS,cAAEhiB,IAAA,CAACxC,OAAO,GAAE,CAAE,CACvBijB,EAAE,CAAE,CAAEuC,EAAE,CAAE,CAAE,CAAE,CACdd,QAAQ,CAAEzf,OAAQ,CAAAoe,QAAA,CACnB,kBAED,CAAQ,CAAC,EACL,CAAC,cAEP7gB,IAAA,CAAC3E,IAAI,EAACinB,IAAI,MAACvB,EAAE,CAAE,EAAG,CAACC,EAAE,CAAE,CAAE,CAAAH,QAAA,cACvB7gB,IAAA,CAAC9E,KAAK,EAACinB,QAAQ,CAAC,MAAM,CAAAtB,QAAA,cACpB3gB,KAAA,CAACjF,UAAU,EAAC0mB,OAAO,CAAC,OAAO,CAAAd,QAAA,eACzB7gB,IAAA,WAAA6gB,QAAA,CAAQ,4BAA0B,CAAQ,CAAC,cAC3C7gB,IAAA,QAAK,CAAC,sDAEN,cAAAA,IAAA,QAAK,CAAC,iDAEN,cAAAA,IAAA,QAAK,CAAC,kDAEN,cAAAA,IAAA,QAAK,CAAC,gDAER,EAAY,CAAC,CACR,CAAC,CACJ,CAAC,EACH,CAAC,EACI,CAAC,CACV,CAAC,CACH,CAAC,cAGPA,IAAA,CAAC3E,IAAI,EAACinB,IAAI,MAACvB,EAAE,CAAE,EAAG,CAAAF,QAAA,cAChB7gB,IAAA,CAAC5D,IAAI,EAAAykB,QAAA,cACH3gB,KAAA,CAAC7D,WAAW,EAAAwkB,QAAA,eACV3gB,KAAA,CAACjF,UAAU,EAAC0mB,OAAO,CAAC,IAAI,CAAClB,EAAE,CAAE,CAAEU,EAAE,CAAE,CAAC,CAAES,UAAU,CAAE,GAAI,CAAE,CAAAf,QAAA,EAAC,qBACpC,CAACte,eAAe,CAACoB,MAAM,CAAC,GAC7C,EAAY,CAAC,cAEb3D,IAAA,CAAC9E,KAAK,EAACinB,QAAQ,CAAC,MAAM,CAAC1B,EAAE,CAAE,CAAEU,EAAE,CAAE,CAAE,CAAE,CAAAN,QAAA,cACnC3gB,KAAA,CAACjF,UAAU,EAAC0mB,OAAO,CAAC,OAAO,CAAAd,QAAA,eACzB7gB,IAAA,WAAA6gB,QAAA,CAAQ,oBAAkB,CAAQ,CAAC,gOAErC,EAAY,CAAC,CACR,CAAC,cAER3gB,KAAA,CAACxF,GAAG,EAAC+lB,EAAE,CAAE,CAAEU,EAAE,CAAE,CAAC,CAAET,OAAO,CAAE,MAAM,CAAEU,GAAG,CAAE,CAAC,CAAER,UAAU,CAAE,QAAS,CAAE,CAAAC,QAAA,eAChE7gB,IAAA,CAAC/E,UAAU,EAAC0mB,OAAO,CAAC,OAAO,CAAClB,EAAE,CAAE,CAAEmB,UAAU,CAAE,GAAI,CAAE,CAAAf,QAAA,CAAC,eAErD,CAAY,CAAC,cACb7gB,IAAA,CAAC7E,IAAI,EACHsF,KAAK,CAAC,MAAM,CACZoY,KAAK,CAAC,SAAS,CACfvQ,IAAI,CAAC,OAAO,CACZqZ,OAAO,CAAC,QAAQ,CAChBlB,EAAE,CAAE,CAAEiB,QAAQ,CAAE,QAAQ,CAAElhB,MAAM,CAAE,EAAG,CAAE,CACxC,CAAC,cACFR,IAAA,CAAC/E,UAAU,EAAC0mB,OAAO,CAAC,OAAO,CAAC9I,KAAK,CAAC,gBAAgB,CAAAgI,QAAA,CAAC,oBAEnD,CAAY,CAAC,cACb7gB,IAAA,CAAC7E,IAAI,EACHsF,KAAK,CAAC,OAAO,CACboY,KAAK,CAAC,WAAW,CACjBvQ,IAAI,CAAC,OAAO,CACZqZ,OAAO,CAAC,QAAQ,CAChBlB,EAAE,CAAE,CAAEiB,QAAQ,CAAE,QAAQ,CAAElhB,MAAM,CAAE,EAAG,CAAE,CACxC,CAAC,cACFR,IAAA,CAAC/E,UAAU,EAAC0mB,OAAO,CAAC,OAAO,CAAC9I,KAAK,CAAC,gBAAgB,CAAAgI,QAAA,CAAC,oBAEnD,CAAY,CAAC,EACV,CAAC,cAEN3gB,KAAA,CAACxF,GAAG,EAAC+lB,EAAE,CAAE,CAAEU,EAAE,CAAE,CAAC,CAAET,OAAO,CAAE,MAAM,CAAEU,GAAG,CAAE,CAAC,CAAE2C,QAAQ,CAAE,MAAO,CAAE,CAAAlD,QAAA,eAC5D7gB,IAAA,CAACrF,MAAM,EACLgnB,OAAO,CAAC,WAAW,CACnB9I,KAAK,CAAC,SAAS,CACfmJ,SAAS,cAAEhiB,IAAA,CAACjC,OAAO,GAAE,CAAE,CACvBkkB,OAAO,CAAEjT,yBAA0B,CACnCyR,EAAE,CAAE,CAAEsC,QAAQ,CAAE,GAAI,CAAE,CAAAlC,QAAA,CACvB,oBAED,CAAQ,CAAC,cACT7gB,IAAA,CAACrF,MAAM,EACLgnB,OAAO,CAAC,WAAW,CACnB9I,KAAK,CAAC,WAAW,CACjBmJ,SAAS,cAAEhiB,IAAA,CAAC7C,GAAG,GAAE,CAAE,CACnB8kB,OAAO,CAAEpS,2BAA4B,CACrC4Q,EAAE,CAAE,CAAEsC,QAAQ,CAAE,GAAI,CAAE,CAAAlC,QAAA,CACvB,cAED,CAAQ,CAAC,cACT7gB,IAAA,CAACrF,MAAM,EACLgnB,OAAO,CAAC,UAAU,CAClB9I,KAAK,CAAC,SAAS,CACfmJ,SAAS,cAAEhiB,IAAA,CAAC5C,MAAM,GAAE,CAAE,CACtB6kB,OAAO,CAAEzS,oBAAqB,CAC9BiR,EAAE,CAAE,CAAEsC,QAAQ,CAAE,GAAI,CAAE,CAAAlC,QAAA,CACvB,oBAED,CAAQ,CAAC,cACT7gB,IAAA,CAAC/E,UAAU,EAAC0mB,OAAO,CAAC,OAAO,CAAC9I,KAAK,CAAC,gBAAgB,CAAC4H,EAAE,CAAE,CAAE2D,SAAS,CAAE,QAAQ,CAAEC,EAAE,CAAE,CAAE,CAAE,CAAAxD,QAAA,CAAC,+DAEvF,CAAY,CAAC,EACV,CAAC,CAELte,eAAe,CAACoB,MAAM,GAAK,CAAC,cAC3B3D,IAAA,CAAC9E,KAAK,EAACinB,QAAQ,CAAC,SAAS,CAAAtB,QAAA,CAAC,qJAE1B,CAAO,CAAC,cAER7gB,IAAA,CAACtE,cAAc,EAAC8mB,SAAS,CAAElnB,KAAM,CAACmlB,EAAE,CAAE,CAAEgC,SAAS,CAAE,GAAI,CAAE,CAAA5B,QAAA,cACvD3gB,KAAA,CAAC3E,KAAK,EAACmnB,YAAY,MAAA7B,QAAA,eACjB7gB,IAAA,CAACrE,SAAS,EAAAklB,QAAA,cACR3gB,KAAA,CAACtE,QAAQ,EAAAilB,QAAA,eACP7gB,IAAA,CAACvE,SAAS,EAACglB,EAAE,CAAE,CAAEmB,UAAU,CAAE,GAAI,CAAE,CAAAf,QAAA,CAAC,UAAQ,CAAW,CAAC,cACxD7gB,IAAA,CAACvE,SAAS,EAACglB,EAAE,CAAE,CAAEmB,UAAU,CAAE,GAAI,CAAE,CAAAf,QAAA,CAAC,cAAY,CAAW,CAAC,cAC5D7gB,IAAA,CAACvE,SAAS,EAACglB,EAAE,CAAE,CAAEmB,UAAU,CAAE,GAAI,CAAE,CAAAf,QAAA,CAAC,MAAI,CAAW,CAAC,cACpD7gB,IAAA,CAACvE,SAAS,EAACglB,EAAE,CAAE,CAAEmB,UAAU,CAAE,GAAI,CAAE,CAAAf,QAAA,CAAC,QAAM,CAAW,CAAC,cACtD7gB,IAAA,CAACvE,SAAS,EAACglB,EAAE,CAAE,CAAEmB,UAAU,CAAE,GAAI,CAAE,CAAAf,QAAA,CAAC,SAAO,CAAW,CAAC,cACvD7gB,IAAA,CAACvE,SAAS,EAACglB,EAAE,CAAE,CAAEmB,UAAU,CAAE,GAAI,CAAE,CAAAf,QAAA,CAAC,SAAO,CAAW,CAAC,EAC/C,CAAC,CACF,CAAC,cACZ7gB,IAAA,CAACxE,SAAS,EAAAqlB,QAAA,CACPte,eAAe,CAACwP,GAAG,CAAEhB,KAAK,eACzB7Q,KAAA,CAACtE,QAAQ,EAAAilB,QAAA,eACP7gB,IAAA,CAACvE,SAAS,EAAAolB,QAAA,cACR3gB,KAAA,CAACxF,GAAG,EAAC+lB,EAAE,CAAE,CAAEC,OAAO,CAAE,MAAM,CAAEE,UAAU,CAAE,QAAQ,CAAEQ,GAAG,CAAE,CAAE,CAAE,CAAAP,QAAA,eACzD7gB,IAAA,CAAC/E,UAAU,EAAC0mB,OAAO,CAAC,OAAO,CAAClB,EAAE,CAAE,CAAEmC,UAAU,CAAE,WAAW,CAAElB,QAAQ,CAAE,QAAS,CAAE,CAAAb,QAAA,CAC7E9P,KAAK,CAAC1D,eAAe,CACZ,CAAC,cACbnN,KAAA,CAACxF,GAAG,EAAC+lB,EAAE,CAAE,CAAEC,OAAO,CAAE,MAAM,CAAEU,GAAG,CAAE,GAAI,CAAE,CAAAP,QAAA,EACpC9P,KAAK,CAACuT,MAAM,GAAK,QAAQ,eACxBtkB,IAAA,CAAC7E,IAAI,EACHsF,KAAK,CAAC,MAAM,CACZoY,KAAK,CAAC,SAAS,CACfvQ,IAAI,CAAC,OAAO,CACZqZ,OAAO,CAAC,QAAQ,CAChBlB,EAAE,CAAE,CAAEiB,QAAQ,CAAE,QAAQ,CAAElhB,MAAM,CAAE,EAAG,CAAE,CACxC,CACF,cACDR,IAAA,CAAC7E,IAAI,EACHsF,KAAK,CAAC,OAAO,CACboY,KAAK,CAAC,WAAW,CACjBvQ,IAAI,CAAC,OAAO,CACZqZ,OAAO,CAAC,QAAQ,CAChBlB,EAAE,CAAE,CAAEiB,QAAQ,CAAE,QAAQ,CAAElhB,MAAM,CAAE,EAAG,CAAE,CACxC,CAAC,EACC,CAAC,EACH,CAAC,CACG,CAAC,cACZR,IAAA,CAACvE,SAAS,EAAAolB,QAAA,cACR7gB,IAAA,CAAC/E,UAAU,EAAC0mB,OAAO,CAAC,OAAO,CAAClB,EAAE,CAAE,CAAEmC,UAAU,CAAE,WAAW,CAAElB,QAAQ,CAAE,QAAS,CAAE,CAAAb,QAAA,CAC7E9P,KAAK,CAACX,UAAU,EAAI,YAAY,CACvB,CAAC,CACJ,CAAC,cACZpQ,IAAA,CAACvE,SAAS,EAAAolB,QAAA,CAAE9P,KAAK,CAAC/I,IAAI,CAAY,CAAC,cACnChI,IAAA,CAACvE,SAAS,EAAAolB,QAAA,cACR7gB,IAAA,CAAC7E,IAAI,EACHsF,KAAK,CAAEsQ,KAAK,CAACuT,MAAM,EAAI,QAAS,CAChCzL,KAAK,CAAE9H,KAAK,CAACuT,MAAM,GAAK,UAAU,CAAG,SAAS,CAAG,SAAU,CAC3Dhc,IAAI,CAAC,OAAO,CACZqZ,OAAO,CAAC,UAAU,CACnB,CAAC,CACO,CAAC,cACZ3hB,IAAA,CAACvE,SAAS,EAAAolB,QAAA,CAAEP,UAAU,CAACvP,KAAK,CAACwT,UAAU,CAAC,CAAY,CAAC,cACrDvkB,IAAA,CAACvE,SAAS,EAAAolB,QAAA,cACR3gB,KAAA,CAACxF,GAAG,EAAC+lB,EAAE,CAAE,CAAEC,OAAO,CAAE,MAAM,CAAEU,GAAG,CAAE,CAAE,CAAE,CAAAP,QAAA,eACnC7gB,IAAA,CAACrF,MAAM,EACLgnB,OAAO,CAAC,UAAU,CAClBrZ,IAAI,CAAC,OAAO,CACZuQ,KAAK,CAAC,SAAS,CACfmJ,SAAS,cAAEhiB,IAAA,CAAC3C,IAAI,GAAE,CAAE,CACpB4kB,OAAO,CAAEA,CAAA,GAAMnR,2BAA2B,CAACC,KAAK,CAAE,CAAA8P,QAAA,CACnD,QAED,CAAQ,CAAC,cACT7gB,IAAA,CAACrF,MAAM,EACLgnB,OAAO,CAAC,UAAU,CAClBrZ,IAAI,CAAC,OAAO,CACZuQ,KAAK,CAAC,OAAO,CACbmJ,SAAS,cAAEhiB,IAAA,CAAC5C,MAAM,GAAE,CAAE,CACtB6kB,OAAO,CAAEA,CAAA,GAAMtR,iBAAiB,CAACI,KAAK,CAAC1D,eAAe,CAAE,CAAAwT,QAAA,CACzD,QAED,CAAQ,CAAC,EACN,CAAC,CACG,CAAC,GA9DC9P,KAAK,CAAC1D,eA+DX,CACX,CAAC,CACO,CAAC,EACP,CAAC,CACM,CACjB,EACU,CAAC,CACV,CAAC,CACH,CAAC,EACH,CAAC,cAGPnN,KAAA,CAACtF,MAAM,EACL4pB,IAAI,CAAE1d,iBAAkB,CACxB2d,OAAO,CAAEA,CAAA,GAAM1d,oBAAoB,CAAC,KAAK,CAAE,CAC3C2d,QAAQ,CAAC,IAAI,CACbT,SAAS,MACTU,UAAU,CAAE,CACVlE,EAAE,CAAE,CACFY,YAAY,CAAE,CAAC,CACfoB,SAAS,CAAE,MAAM,CACjBvB,UAAU,CAAE,SACd,CACF,CAAE,CAAAL,QAAA,eAGF3gB,KAAA,CAACxF,GAAG,EAAC+lB,EAAE,CAAE,CACPS,UAAU,CAAE,SAAS,CACrBrI,KAAK,CAAE,OAAO,CACdiI,CAAC,CAAE,CAAC,CACJ8D,mBAAmB,CAAE,CAAC,CACtBC,oBAAoB,CAAE,CACxB,CAAE,CAAAhE,QAAA,eACA3gB,KAAA,CAACxF,GAAG,EAAC+lB,EAAE,CAAE,CAAEC,OAAO,CAAE,MAAM,CAAEE,UAAU,CAAE,QAAQ,CAAED,cAAc,CAAE,eAAe,CAAEQ,EAAE,CAAE,CAAE,CAAE,CAAAN,QAAA,eACzF3gB,KAAA,CAACxF,GAAG,EAAC+lB,EAAE,CAAE,CAAEC,OAAO,CAAE,MAAM,CAAEE,UAAU,CAAE,QAAS,CAAE,CAAAC,QAAA,eACjD7gB,IAAA,CAACrC,KAAK,EAAC8iB,EAAE,CAAE,CAAEqE,EAAE,CAAE,CAAC,CAAEpD,QAAQ,CAAE,EAAG,CAAE,CAAE,CAAC,cACtCxhB,KAAA,CAACxF,GAAG,EAAAmmB,QAAA,eACF7gB,IAAA,CAAC/E,UAAU,EAAC0mB,OAAO,CAAC,IAAI,CAAClB,EAAE,CAAE,CAAEmB,UAAU,CAAE,GAAG,CAAET,EAAE,CAAE,GAAI,CAAE,CAAAN,QAAA,CAAC,mBAE3D,CAAY,CAAC,CACZ7Z,0BAA0B,eACzBhH,IAAA,CAAC/E,UAAU,EAAC0mB,OAAO,CAAC,WAAW,CAAClB,EAAE,CAAE,CAAEsE,OAAO,CAAE,GAAG,CAAEnD,UAAU,CAAE,GAAI,CAAE,CAAAf,QAAA,CACnE7Z,0BAA0B,CAACgB,IAAI,CACtB,CACb,EACE,CAAC,EACH,CAAC,cACNhI,IAAA,CAAC5E,UAAU,EACT6mB,OAAO,CAAEA,CAAA,GAAMlb,oBAAoB,CAAC,KAAK,CAAE,CAC3C0Z,EAAE,CAAE,CACF5H,KAAK,CAAE,OAAO,CACd0I,MAAM,CAAE,iCAAiC,CACzC,SAAS,CAAE,CACTjD,WAAW,CAAE,OAAO,CACpB4C,UAAU,CAAE,uBACd,CACF,CAAE,CAAAL,QAAA,cAEF7gB,IAAA,CAAC3B,KAAK,GAAE,CAAC,CACC,CAAC,EACV,CAAC,cAGN6B,KAAA,CAAC7E,IAAI,EAAC+mB,SAAS,MAACC,OAAO,CAAE,CAAE,CAAAxB,QAAA,eACzB7gB,IAAA,CAAC3E,IAAI,EAACinB,IAAI,MAACvB,EAAE,CAAE,EAAG,CAACiE,EAAE,CAAE,CAAE,CAAAnE,QAAA,cACvB3gB,KAAA,CAACxF,GAAG,EAAC+lB,EAAE,CAAE,CACPS,UAAU,CAAE,uBAAuB,CACnCJ,CAAC,CAAE,CAAC,CACJO,YAAY,CAAE,CAAC,CACf1C,SAAS,CAAE,QACb,CAAE,CAAAkC,QAAA,eACA7gB,IAAA,CAAC/E,UAAU,EAAC0mB,OAAO,CAAC,IAAI,CAAClB,EAAE,CAAE,CAAEmB,UAAU,CAAE,GAAG,CAAET,EAAE,CAAE,CAAE,CAAE,CAAAN,QAAA,CAAC,cAEzD,CAAY,CAAC,cACb7gB,IAAA,CAAC/E,UAAU,EAAC0mB,OAAO,CAAC,OAAO,CAAClB,EAAE,CAAE,CAC9BmC,UAAU,CAAE,WAAW,CACvBlB,QAAQ,CAAE,SAAS,CACnBoC,SAAS,CAAE,WAAW,CACtBiB,OAAO,CAAE,GACX,CAAE,CAAAlE,QAAA,CACC,CAAA3Z,eAAe,SAAfA,eAAe,kBAAAtG,qBAAA,CAAfsG,eAAe,CAAE+d,SAAS,UAAArkB,qBAAA,iBAA1BA,qBAAA,CAA4BwP,UAAU,GAAI,YAAY,CAC7C,CAAC,EACV,CAAC,CACF,CAAC,cACPpQ,IAAA,CAAC3E,IAAI,EAACinB,IAAI,MAACvB,EAAE,CAAE,EAAG,CAACiE,EAAE,CAAE,CAAE,CAAAnE,QAAA,cACvB3gB,KAAA,CAACxF,GAAG,EAAC+lB,EAAE,CAAE,CACPS,UAAU,CAAE,uBAAuB,CACnCJ,CAAC,CAAE,CAAC,CACJO,YAAY,CAAE,CAAC,CACf1C,SAAS,CAAE,QACb,CAAE,CAAAkC,QAAA,eACA7gB,IAAA,CAAC/E,UAAU,EAAC0mB,OAAO,CAAC,IAAI,CAAClB,EAAE,CAAE,CAAEmB,UAAU,CAAE,GAAG,CAAET,EAAE,CAAE,CAAE,CAAE,CAAAN,QAAA,CAAC,MAEzD,CAAY,CAAC,cACb3gB,KAAA,CAACjF,UAAU,EAAC0mB,OAAO,CAAC,IAAI,CAAClB,EAAE,CAAE,CAAEmB,UAAU,CAAE,GAAI,CAAE,CAAAf,QAAA,EAC9C,CAAA3Z,eAAe,SAAfA,eAAe,kBAAArG,sBAAA,CAAfqG,eAAe,CAAE+d,SAAS,UAAApkB,sBAAA,kBAAAC,sBAAA,CAA1BD,sBAAA,CAA4ByH,IAAI,UAAAxH,sBAAA,iBAAhCA,sBAAA,CAAkCP,KAAK,GAAI,CAAC,CAAC,QAAG,CAAC,CAAA2G,eAAe,SAAfA,eAAe,kBAAAnG,sBAAA,CAAfmG,eAAe,CAAE+d,SAAS,UAAAlkB,sBAAA,kBAAAC,sBAAA,CAA1BD,sBAAA,CAA4BuH,IAAI,UAAAtH,sBAAA,iBAAhCA,sBAAA,CAAkCR,MAAM,GAAI,CAAC,EACrF,CAAC,EACV,CAAC,CACF,CAAC,cACPR,IAAA,CAAC3E,IAAI,EAACinB,IAAI,MAACvB,EAAE,CAAE,EAAG,CAACiE,EAAE,CAAE,CAAE,CAAAnE,QAAA,cACvB3gB,KAAA,CAACxF,GAAG,EAAC+lB,EAAE,CAAE,CACPS,UAAU,CAAE,uBAAuB,CACnCJ,CAAC,CAAE,CAAC,CACJO,YAAY,CAAE,CAAC,CACf1C,SAAS,CAAE,QACb,CAAE,CAAAkC,QAAA,eACA7gB,IAAA,CAAC/E,UAAU,EAAC0mB,OAAO,CAAC,IAAI,CAAClB,EAAE,CAAE,CAAEmB,UAAU,CAAE,GAAG,CAAET,EAAE,CAAE,CAAE,CAAE,CAAAN,QAAA,CAAC,UAEzD,CAAY,CAAC,cACb7gB,IAAA,CAAC/E,UAAU,EAAC0mB,OAAO,CAAC,IAAI,CAAClB,EAAE,CAAE,CAAEmB,UAAU,CAAE,GAAI,CAAE,CAAAf,QAAA,CAC9C,CAAA3Z,eAAe,SAAfA,eAAe,kBAAAjG,sBAAA,CAAfiG,eAAe,CAAE+d,SAAS,UAAAhkB,sBAAA,kBAAAC,sBAAA,CAA1BD,sBAAA,CAA4BuH,KAAK,UAAAtH,sBAAA,iBAAjCA,sBAAA,CAAmCyC,MAAM,GAAI,CAAC,CACrC,CAAC,EACV,CAAC,CACF,CAAC,EACH,CAAC,EACJ,CAAC,cAEN3D,IAAA,CAAClF,aAAa,EAAC2lB,EAAE,CAAE,CAAEK,CAAC,CAAE,CAAC,CAAEI,UAAU,CAAE,SAAU,CAAE,CAAAL,QAAA,CAChDzZ,cAAc,cACblH,KAAA,CAACxF,GAAG,EAAC+lB,EAAE,CAAE,CACPC,OAAO,CAAE,MAAM,CACfyC,aAAa,CAAE,QAAQ,CACvBvC,UAAU,CAAE,QAAQ,CACpBD,cAAc,CAAE,QAAQ,CACxBG,CAAC,CAAE,CAAC,CACJG,SAAS,CAAE,OACb,CAAE,CAAAJ,QAAA,eACA7gB,IAAA,CAAChD,gBAAgB,EAACsL,IAAI,CAAE,EAAG,CAACmY,EAAE,CAAE,CAAEU,EAAE,CAAE,CAAC,CAAEtI,KAAK,CAAE,SAAU,CAAE,CAAE,CAAC,cAC/D7Y,IAAA,CAAC/E,UAAU,EAAC0mB,OAAO,CAAC,IAAI,CAAC9I,KAAK,CAAC,gBAAgB,CAAC4H,EAAE,CAAE,CAAEU,EAAE,CAAE,CAAE,CAAE,CAAAN,QAAA,CAAC,2BAE/D,CAAY,CAAC,cACb7gB,IAAA,CAAC/E,UAAU,EAAC0mB,OAAO,CAAC,OAAO,CAAC9I,KAAK,CAAC,gBAAgB,CAAAgI,QAAA,CAAC,gCAEnD,CAAY,CAAC,EACV,CAAC,CACJ3Z,eAAe,cACjBlH,IAAA,CAACtF,GAAG,EAAC+lB,EAAE,CAAE,CAAEK,CAAC,CAAE,CAAE,CAAE,CAAAD,QAAA,cAEhB3gB,KAAA,CAAC7E,IAAI,EAAC+mB,SAAS,MAACC,OAAO,CAAE,CAAE,CAAAxB,QAAA,eAEzB3gB,KAAA,CAAC7E,IAAI,EAACinB,IAAI,MAACvB,EAAE,CAAE,EAAG,CAACmE,EAAE,CAAE,CAAE,CAAArE,QAAA,eAEvB3gB,KAAA,CAAC9D,IAAI,EAACqkB,EAAE,CAAE,CACRY,YAAY,CAAE,CAAC,CACfsC,QAAQ,CAAE,QAAQ,CAClBrC,SAAS,CAAE,4BAA4B,CACvCH,EAAE,CAAE,CACN,CAAE,CAAAN,QAAA,eACA3gB,KAAA,CAACxF,GAAG,EAAC+lB,EAAE,CAAE,CACPK,CAAC,CAAE,GAAG,CACNI,UAAU,CAAE,SAAS,CACrBrI,KAAK,CAAE,OAAO,CACd6H,OAAO,CAAE,MAAM,CACfE,UAAU,CAAE,QAAQ,CACpBD,cAAc,CAAE,eAClB,CAAE,CAAAE,QAAA,eACA3gB,KAAA,CAACjF,UAAU,EAAC0mB,OAAO,CAAC,IAAI,CAAClB,EAAE,CAAE,CAAEmB,UAAU,CAAE,GAAG,CAAElB,OAAO,CAAE,MAAM,CAAEE,UAAU,CAAE,QAAS,CAAE,CAAAC,QAAA,eACtF7gB,IAAA,CAACrC,KAAK,EAAC8iB,EAAE,CAAE,CAAEqE,EAAE,CAAE,GAAI,CAAE,CAAE,CAAC,0BAE5B,EAAY,CAAC,cACb9kB,IAAA,CAAC7E,IAAI,EACHsF,KAAK,CAAEyG,eAAe,CAACie,KAAK,CAAG,iBAAiB,CAAG,UAAW,CAC9DtM,KAAK,CAAE3R,eAAe,CAACie,KAAK,CAAG,SAAS,CAAG,SAAU,CACrDxD,OAAO,CAAC,QAAQ,CAChBrZ,IAAI,CAAC,OAAO,CACb,CAAC,EACC,CAAC,CAEgBpB,eAAe,CAACie,KAAK,cACxCnlB,IAAA,CAACtF,GAAG,EAAC+lB,EAAE,CAAE,CACP2E,QAAQ,CAAE,UAAU,CACpBlE,UAAU,CAAE,mDAAmD,CAC/DD,SAAS,CAAE,OAAO,CAClBP,OAAO,CAAE,MAAM,CACfE,UAAU,CAAE,QAAQ,CACpBD,cAAc,CAAE,QAAQ,CACxBG,CAAC,CAAE,CACL,CAAE,CAAAD,QAAA,cACA3gB,KAAA,CAACxF,GAAG,EAAC+lB,EAAE,CAAE,CACP2E,QAAQ,CAAE,UAAU,CACpB/D,YAAY,CAAE,CAAC,CACfsC,QAAQ,CAAE,QAAQ,CAClBrC,SAAS,CAAE,4BAA4B,CACvCC,MAAM,CAAE,iBACV,CAAE,CAAAV,QAAA,eACA7gB,IAAA,QACEgW,GAAG,CAAE9O,eAAe,CAACie,KAAM,CAC3BE,GAAG,CAAC,WAAW,CACfC,MAAM,CAAE9T,eAAgB,CACxBkS,KAAK,CAAE,CACLgB,QAAQ,CAAE,MAAM,CAChBjC,SAAS,CAAE,OAAO,CAClB8C,SAAS,CAAE,SAAS,CACpB7E,OAAO,CAAE,OACX,CAAE,CACH,CAAC,CAGDpZ,WAAW,IAAAnG,sBAAA,CAAI+F,eAAe,CAAC+d,SAAS,UAAA9jB,sBAAA,iBAAzBA,sBAAA,CAA2BqH,KAAK,GAAItB,eAAe,CAAC+d,SAAS,CAACzc,KAAK,CAAC7E,MAAM,CAAG,CAAC,eAC5F3D,IAAA,CAACtF,GAAG,EAAC+lB,EAAE,CAAE,CACP2E,QAAQ,CAAE,UAAU,CACpBlL,GAAG,CAAE,CAAC,CACND,IAAI,CAAE,CAAC,CACP1Z,KAAK,CAAE,MAAM,CACbC,MAAM,CAAE,MAAM,CACdglB,aAAa,CAAE,MACjB,CAAE,CAAA3E,QAAA,CACC3Z,eAAe,CAAC+d,SAAS,CAACzc,KAAK,CAACuJ,GAAG,CAAC,CAACmB,IAAS,CAAEC,KAAa,GAAK,KAAAsS,sBAAA,CAAAC,sBAAA,CAAAC,sBAAA,CAAAC,uBAAA,CACjE;AACA,KAAM,CAAApgB,UAAU,CAAG,EAAAigB,sBAAA,CAAAve,eAAe,CAAC+d,SAAS,UAAAQ,sBAAA,kBAAAC,sBAAA,CAAzBD,sBAAA,CAA2Bnd,IAAI,UAAAod,sBAAA,iBAA/BA,sBAAA,CAAiCnlB,KAAK,GAAI,IAAI,CACjE,KAAM,CAAAkF,WAAW,CAAG,EAAAkgB,sBAAA,CAAAze,eAAe,CAAC+d,SAAS,UAAAU,sBAAA,kBAAAC,uBAAA,CAAzBD,sBAAA,CAA2Brd,IAAI,UAAAsd,uBAAA,iBAA/BA,uBAAA,CAAiCplB,MAAM,GAAI,IAAI,CAEnE;AACA,KAAM,CAAAqE,MAAM,CAAG2C,eAAe,CAACjH,KAAK,CAAGiF,UAAU,CACjD,KAAM,CAAAV,MAAM,CAAG0C,eAAe,CAAChH,MAAM,CAAGiF,WAAW,CAEnD;AACA,KAAM,CAAAogB,OAAO,CAAG3S,IAAI,CAACzK,MAAM,CAACC,CAAC,CAAG7D,MAAM,CACtC,KAAM,CAAAihB,OAAO,CAAG5S,IAAI,CAACzK,MAAM,CAACE,CAAC,CAAG7D,MAAM,CACtC,KAAM,CAAAkW,WAAW,CAAG9H,IAAI,CAACzK,MAAM,CAAClI,KAAK,CAAGsE,MAAM,CAC9C,KAAM,CAAAoW,YAAY,CAAG/H,IAAI,CAACzK,MAAM,CAACjI,MAAM,CAAGsE,MAAM,CAEhD,mBACE9E,IAAA,CAACtF,GAAG,EAEF+lB,EAAE,CAAE,CACF2E,QAAQ,CAAE,UAAU,CACpBnL,IAAI,IAAA1L,MAAA,CAAKsX,OAAO,MAAI,CACpB3L,GAAG,IAAA3L,MAAA,CAAKuX,OAAO,MAAI,CACnBvlB,KAAK,IAAAgO,MAAA,CAAKyM,WAAW,MAAI,CACzBxa,MAAM,IAAA+N,MAAA,CAAK0M,YAAY,MAAI,CAC3BsG,MAAM,CAAE,mBAAmB,CAC3BL,UAAU,CAAE,wBAAwB,CACpCG,YAAY,CAAE,KAAK,CACnBX,OAAO,CAAE,MAAM,CACfE,UAAU,CAAE,QAAQ,CACpBD,cAAc,CAAE,QAAQ,CACxB6E,aAAa,CAAE,MAAM,CACrBO,MAAM,CAAE,EAAE,CACVC,UAAU,CAAE,eACd,CAAE,CAAAnF,QAAA,cAEF3gB,KAAA,CAACxF,GAAG,EAAC+lB,EAAE,CAAE,CACP2E,QAAQ,CAAE,UAAU,CACpBlL,GAAG,CAAE,OAAO,CACZD,IAAI,CAAE,KAAK,CACXgM,SAAS,CAAE,kBAAkB,CAC7B/E,UAAU,CAAE,SAAS,CACrBrI,KAAK,CAAE,OAAO,CACdqN,OAAO,CAAE,SAAS,CAClB7E,YAAY,CAAE,MAAM,CACpBK,QAAQ,CAAE,MAAM,CAChBE,UAAU,CAAE,MAAM,CAClBiC,UAAU,CAAE,QAAQ,CACpBkC,MAAM,CAAE,EAAE,CACVzE,SAAS,CAAE,2BACb,CAAE,CAAAT,QAAA,EAAC,UACO,CAAC1N,KAAK,CAAG,CAAC,EACf,CAAC,EAlCDA,KAmCF,CAAC,CAEV,CAAC,CAAC,CACC,CACN,EACE,CAAC,CACH,CAAC,cAEPjT,KAAA,CAACxF,GAAG,EAAC+lB,EAAE,CAAE,CACPK,CAAC,CAAE,CAAC,CACJnC,SAAS,CAAE,QAAQ,CACnBuC,UAAU,CAAE,mDAAmD,CAC/DD,SAAS,CAAE,OAAO,CAClBP,OAAO,CAAE,MAAM,CACfyC,aAAa,CAAE,QAAQ,CACvBvC,UAAU,CAAE,QAAQ,CACpBD,cAAc,CAAE,QAClB,CAAE,CAAAE,QAAA,eACA7gB,IAAA,CAACtF,GAAG,EAAC+lB,EAAE,CAAE,CACPlgB,KAAK,CAAE,GAAG,CACVC,MAAM,CAAE,GAAG,CACX6gB,YAAY,CAAE,KAAK,CACnBH,UAAU,CAAE,yBAAyB,CACrCR,OAAO,CAAE,MAAM,CACfE,UAAU,CAAE,QAAQ,CACpBD,cAAc,CAAE,QAAQ,CACxBQ,EAAE,CAAE,CACN,CAAE,CAAAN,QAAA,cACA7gB,IAAA,CAACrC,KAAK,EAAC8iB,EAAE,CAAE,CAAEiB,QAAQ,CAAE,EAAE,CAAE7I,KAAK,CAAE,SAAU,CAAE,CAAE,CAAC,CAC9C,CAAC,cACN7Y,IAAA,CAAC/E,UAAU,EAAC0mB,OAAO,CAAC,IAAI,CAAC9I,KAAK,CAAC,gBAAgB,CAAC4H,EAAE,CAAE,CAAEU,EAAE,CAAE,CAAC,CAAES,UAAU,CAAE,GAAI,CAAE,CAAAf,QAAA,CAAC,oBAEhF,CAAY,CAAC,cACb7gB,IAAA,CAAC/E,UAAU,EAAC0mB,OAAO,CAAC,OAAO,CAAC9I,KAAK,CAAC,gBAAgB,CAAC4H,EAAE,CAAE,CAAEiE,QAAQ,CAAE,GAAI,CAAE,CAAA7D,QAAA,CAAC,qHAE1E,CAAY,CAAC,EACV,CACN,EACG,CAAC,cAGP3gB,KAAA,CAAC9D,IAAI,EAACqkB,EAAE,CAAE,CACRY,YAAY,CAAE,CAAC,CACfC,SAAS,CAAE,4BACb,CAAE,CAAAT,QAAA,eACA3gB,KAAA,CAACxF,GAAG,EAAC+lB,EAAE,CAAE,CACPK,CAAC,CAAE,GAAG,CACNI,UAAU,CAAE,SAAS,CACrBrI,KAAK,CAAE,OAAO,CACd6H,OAAO,CAAE,MAAM,CACfE,UAAU,CAAE,QAAQ,CACpBD,cAAc,CAAE,eAClB,CAAE,CAAAE,QAAA,eACA3gB,KAAA,CAACjF,UAAU,EAAC0mB,OAAO,CAAC,IAAI,CAAClB,EAAE,CAAE,CAAEmB,UAAU,CAAE,GAAG,CAAElB,OAAO,CAAE,MAAM,CAAEE,UAAU,CAAE,QAAS,CAAE,CAAAC,QAAA,eACtF7gB,IAAA,CAACpC,IAAI,EAAC6iB,EAAE,CAAE,CAAEqE,EAAE,CAAE,GAAI,CAAE,CAAE,CAAC,iCAE3B,EAAY,CAAC,cACb9kB,IAAA,CAAC7E,IAAI,EACHsF,KAAK,IAAA8N,MAAA,CAAK,EAAAnN,uBAAA,CAAA8F,eAAe,CAAC+d,SAAS,UAAA7jB,uBAAA,kBAAAC,uBAAA,CAAzBD,uBAAA,CAA2BoH,KAAK,UAAAnH,uBAAA,iBAAhCA,uBAAA,CAAkCsC,MAAM,GAAI,CAAC,aAAY,CACnEkV,KAAK,CAAC,WAAW,CACjB8I,OAAO,CAAC,QAAQ,CAChBrZ,IAAI,CAAC,OAAO,CACb,CAAC,EACC,CAAC,cAENtI,IAAA,CAACtF,GAAG,EAAC+lB,EAAE,CAAE,CAAEK,CAAC,CAAE,CAAE,CAAE,CAAAD,QAAA,CACf,CAAAvf,uBAAA,CAAA4F,eAAe,CAAC+d,SAAS,UAAA3jB,uBAAA,WAAzBA,uBAAA,CAA2BkH,KAAK,EAAItB,eAAe,CAAC+d,SAAS,CAACzc,KAAK,CAAC7E,MAAM,CAAG,CAAC,cAC7E3D,IAAA,CAAC3E,IAAI,EAAC+mB,SAAS,MAACC,OAAO,CAAE,CAAE,CAAAxB,QAAA,CACxB3Z,eAAe,CAAC+d,SAAS,CAACzc,KAAK,CAACuJ,GAAG,CAAC,CAACmB,IAAS,CAAEC,KAAa,gBAC5DnT,IAAA,CAAC3E,IAAI,EAACinB,IAAI,MAACvB,EAAE,CAAE,EAAG,CAACC,EAAE,CAAE,CAAE,CAAAH,QAAA,cACvB7gB,IAAA,CAAC5D,IAAI,EACHulB,OAAO,CAAC,UAAU,CAClBlB,EAAE,CAAE,CACFY,YAAY,CAAE,CAAC,CACfE,MAAM,CAAE,mBAAmB,CAC3BL,UAAU,CAAE,SAAS,CACrB,SAAS,CAAE,CACT5C,WAAW,CAAE,SAAS,CACtBgD,SAAS,CAAE,qCAAqC,CAChD2E,SAAS,CAAE,kBAAkB,CAC7BD,UAAU,CAAE,eACd,CAAC,CACDA,UAAU,CAAE,eACd,CAAE,CAAAnF,QAAA,cAEF3gB,KAAA,CAAC7D,WAAW,EAACokB,EAAE,CAAE,CAAEK,CAAC,CAAE,CAAE,CAAE,CAAAD,QAAA,eAExB3gB,KAAA,CAACxF,GAAG,EAAC+lB,EAAE,CAAE,CACPC,OAAO,CAAE,MAAM,CACfE,UAAU,CAAE,QAAQ,CACpBO,EAAE,CAAE,CAAC,CACLgF,EAAE,CAAE,CAAC,CACLC,YAAY,CAAE,mBAChB,CAAE,CAAAvF,QAAA,eACA7gB,IAAA,CAACtF,GAAG,EAAC+lB,EAAE,CAAE,CACPlgB,KAAK,CAAE,EAAE,CACTC,MAAM,CAAE,EAAE,CACV6gB,YAAY,CAAE,KAAK,CACnBH,UAAU,CAAE,SAAS,CACrBR,OAAO,CAAE,MAAM,CACfE,UAAU,CAAE,QAAQ,CACpBD,cAAc,CAAE,QAAQ,CACxBmE,EAAE,CAAE,CAAC,CACLxD,SAAS,CAAE,mCACb,CAAE,CAAAT,QAAA,cACA7gB,IAAA,CAAC/E,UAAU,EAAC0mB,OAAO,CAAC,IAAI,CAAClB,EAAE,CAAE,CAAE5H,KAAK,CAAE,OAAO,CAAE+I,UAAU,CAAE,GAAI,CAAE,CAAAf,QAAA,CAC9D1N,KAAK,CAAG,CAAC,CACA,CAAC,CACV,CAAC,cACNjT,KAAA,CAACxF,GAAG,EAAAmmB,QAAA,eACF3gB,KAAA,CAACjF,UAAU,EAAC0mB,OAAO,CAAC,IAAI,CAAClB,EAAE,CAAE,CAAEmB,UAAU,CAAE,GAAG,CAAE/I,KAAK,CAAE,SAAU,CAAE,CAAAgI,QAAA,EAAC,UAC1D,CAAC1N,KAAK,CAAG,CAAC,EACR,CAAC,cACbnT,IAAA,CAAC/E,UAAU,EAAC0mB,OAAO,CAAC,SAAS,CAAC9I,KAAK,CAAC,gBAAgB,CAAAgI,QAAA,CAAC,wBAErD,CAAY,CAAC,EACV,CAAC,EACH,CAAC,cAGN3gB,KAAA,CAACxF,GAAG,EAAC+lB,EAAE,CAAE,CAAEU,EAAE,CAAE,CAAE,CAAE,CAAAN,QAAA,eACjB7gB,IAAA,CAAC/E,UAAU,EAAC0mB,OAAO,CAAC,WAAW,CAAC9I,KAAK,CAAC,gBAAgB,CAAC4H,EAAE,CAAE,CAAEmB,UAAU,CAAE,GAAG,CAAET,EAAE,CAAE,CAAE,CAAE,CAAAN,QAAA,CAAC,oCAEvF,CAAY,CAAC,cACb3gB,KAAA,CAACxF,GAAG,EAAC+lB,EAAE,CAAE,CACPS,UAAU,CAAE,SAAS,CACrBJ,CAAC,CAAE,CAAC,CACJO,YAAY,CAAE,CAAC,CACfE,MAAM,CAAE,mBACV,CAAE,CAAAV,QAAA,eACA3gB,KAAA,CAACjF,UAAU,EAAC0mB,OAAO,CAAC,OAAO,CAAClB,EAAE,CAAE,CAC9BmC,UAAU,CAAE,WAAW,CACvBlB,QAAQ,CAAE,QAAQ,CAClB7I,KAAK,CAAE,SAAS,CAChB+I,UAAU,CAAE,GACd,CAAE,CAAAf,QAAA,EAAC,KACE,CAAC3N,IAAI,CAACzK,MAAM,CAACC,CAAC,CAAC,QAAM,CAACwK,IAAI,CAACzK,MAAM,CAACE,CAAC,EAC5B,CAAC,cACbzI,KAAA,CAACjF,UAAU,EAAC0mB,OAAO,CAAC,OAAO,CAAClB,EAAE,CAAE,CAC9BmC,UAAU,CAAE,WAAW,CACvBlB,QAAQ,CAAE,QAAQ,CAClB7I,KAAK,CAAE,SAAS,CAChB+I,UAAU,CAAE,GACd,CAAE,CAAAf,QAAA,EAAC,SACM,CAAC3N,IAAI,CAACzK,MAAM,CAAClI,KAAK,CAAC,aAAW,CAAC2S,IAAI,CAACzK,MAAM,CAACjI,MAAM,EAC9C,CAAC,EACV,CAAC,EACH,CAAC,cAGNN,KAAA,CAACxF,GAAG,EAAC+lB,EAAE,CAAE,CAAEU,EAAE,CAAE,CAAE,CAAE,CAAAN,QAAA,eACjB7gB,IAAA,CAAC/E,UAAU,EAAC0mB,OAAO,CAAC,WAAW,CAAC9I,KAAK,CAAC,gBAAgB,CAAC4H,EAAE,CAAE,CAAEmB,UAAU,CAAE,GAAG,CAAET,EAAE,CAAE,CAAE,CAAE,CAAAN,QAAA,CAAC,oBAEvF,CAAY,CAAC,cACb7gB,IAAA,CAAC7E,IAAI,EACHsF,KAAK,CAAEyS,IAAI,CAACtK,MAAM,CAACC,IAAI,CAACwd,WAAW,CAAC,CAAE,CACtC/d,IAAI,CAAC,QAAQ,CACbuQ,KAAK,CACH3F,IAAI,CAACtK,MAAM,CAACC,IAAI,GAAK,UAAU,CAAG,SAAS,CAC3CqK,IAAI,CAACtK,MAAM,CAACC,IAAI,GAAK,SAAS,CAAG,WAAW,CAC5CqK,IAAI,CAACtK,MAAM,CAACC,IAAI,GAAK,KAAK,CAAG,SAAS,CACtCqK,IAAI,CAACtK,MAAM,CAACC,IAAI,GAAK,gBAAgB,CAAG,SAAS,CAAG,SACrD,CACD8Y,OAAO,CAAC,QAAQ,CAChBlB,EAAE,CAAE,CACFmB,UAAU,CAAE,GAAG,CACfF,QAAQ,CAAE,QAAQ,CAClBlhB,MAAM,CAAE,EACV,CAAE,CACH,CAAC,EACC,CAAC,CAGL0S,IAAI,CAACtK,MAAM,CAACC,IAAI,GAAK,UAAU,EAAIqK,IAAI,CAACtK,MAAM,CAACE,IAAI,eAClD5I,KAAA,CAACxF,GAAG,EAAC+lB,EAAE,CAAE,CAAEU,EAAE,CAAE,CAAE,CAAE,CAAAN,QAAA,eACjB7gB,IAAA,CAAC/E,UAAU,EAAC0mB,OAAO,CAAC,WAAW,CAAC9I,KAAK,CAAC,gBAAgB,CAAC4H,EAAE,CAAE,CAAEmB,UAAU,CAAE,GAAG,CAAET,EAAE,CAAE,CAAE,CAAE,CAAAN,QAAA,CAAC,4BAEvF,CAAY,CAAC,cACb7gB,IAAA,CAACtF,GAAG,EAAC+lB,EAAE,CAAE,CACPS,UAAU,CAAE,SAAS,CACrBJ,CAAC,CAAE,CAAC,CACJO,YAAY,CAAE,CAAC,CACfE,MAAM,CAAE,mBACV,CAAE,CAAAV,QAAA,cACA7gB,IAAA,CAAC/E,UAAU,EAAC0mB,OAAO,CAAC,OAAO,CAAClB,EAAE,CAAE,CAC9BmC,UAAU,CAAE,WAAW,CACvBlB,QAAQ,CAAE,SAAS,CACnBoC,SAAS,CAAE,WAAW,CACtBjL,KAAK,CAAE,SACT,CAAE,CAAAgI,QAAA,CACC3N,IAAI,CAACtK,MAAM,CAACE,IAAI,CACP,CAAC,CACV,CAAC,EACH,CACN,CAEAoK,IAAI,CAACtK,MAAM,CAACC,IAAI,GAAK,SAAS,EAAIqK,IAAI,CAACtK,MAAM,CAACkQ,IAAI,eACjD5Y,KAAA,CAACxF,GAAG,EAAC+lB,EAAE,CAAE,CAAEU,EAAE,CAAE,CAAE,CAAE,CAAAN,QAAA,eACjB7gB,IAAA,CAAC/E,UAAU,EAAC0mB,OAAO,CAAC,WAAW,CAAC9I,KAAK,CAAC,gBAAgB,CAAC4H,EAAE,CAAE,CAAEmB,UAAU,CAAE,GAAG,CAAET,EAAE,CAAE,CAAE,CAAE,CAAAN,QAAA,CAAC,2BAEvF,CAAY,CAAC,cACb7gB,IAAA,CAACtF,GAAG,EAAC+lB,EAAE,CAAE,CACPS,UAAU,CAAE,SAAS,CACrBJ,CAAC,CAAE,CAAC,CACJO,YAAY,CAAE,CAAC,CACfE,MAAM,CAAE,mBACV,CAAE,CAAAV,QAAA,cACA3gB,KAAA,CAACjF,UAAU,EAAC0mB,OAAO,CAAC,OAAO,CAAClB,EAAE,CAAE,CAC9B5H,KAAK,CAAE,SAAS,CAChByN,SAAS,CAAE,QACb,CAAE,CAAAzF,QAAA,EAAC,IACA,CAAC3N,IAAI,CAACtK,MAAM,CAACkQ,IAAI,CAAC,IACrB,EAAY,CAAC,CACV,CAAC,EACH,CACN,CAEA5F,IAAI,CAACtK,MAAM,CAACC,IAAI,GAAK,KAAK,EAAIqK,IAAI,CAACtK,MAAM,CAACwE,GAAG,eAC5ClN,KAAA,CAACxF,GAAG,EAAC+lB,EAAE,CAAE,CAAEU,EAAE,CAAE,CAAE,CAAE,CAAAN,QAAA,eACjB7gB,IAAA,CAAC/E,UAAU,EAAC0mB,OAAO,CAAC,WAAW,CAAC9I,KAAK,CAAC,gBAAgB,CAAC4H,EAAE,CAAE,CAAEmB,UAAU,CAAE,GAAG,CAAET,EAAE,CAAE,CAAE,CAAE,CAAAN,QAAA,CAAC,uBAEvF,CAAY,CAAC,cACb7gB,IAAA,CAACtF,GAAG,EAAC+lB,EAAE,CAAE,CACPS,UAAU,CAAE,SAAS,CACrBJ,CAAC,CAAE,CAAC,CACJO,YAAY,CAAE,CAAC,CACfE,MAAM,CAAE,mBACV,CAAE,CAAAV,QAAA,cACA7gB,IAAA,CAAC/E,UAAU,EAAC0mB,OAAO,CAAC,OAAO,CAAClB,EAAE,CAAE,CAC9BmC,UAAU,CAAE,WAAW,CACvBlB,QAAQ,CAAE,QAAQ,CAClBoC,SAAS,CAAE,WAAW,CACtBjL,KAAK,CAAE,SAAS,CAChB0N,cAAc,CAAE,WAClB,CAAE,CAAA1F,QAAA,CACC3N,IAAI,CAACtK,MAAM,CAACwE,GAAG,CACN,CAAC,CACV,CAAC,EACH,CACN,CAEA8F,IAAI,CAACtK,MAAM,CAACC,IAAI,GAAK,gBAAgB,EAAIqK,IAAI,CAACtK,MAAM,CAACyE,eAAe,eACnEnN,KAAA,CAACxF,GAAG,EAAC+lB,EAAE,CAAE,CAAEU,EAAE,CAAE,CAAE,CAAE,CAAAN,QAAA,eACjB7gB,IAAA,CAAC/E,UAAU,EAAC0mB,OAAO,CAAC,WAAW,CAAC9I,KAAK,CAAC,gBAAgB,CAAC4H,EAAE,CAAE,CAAEmB,UAAU,CAAE,GAAG,CAAET,EAAE,CAAE,CAAE,CAAE,CAAAN,QAAA,CAAC,+BAEvF,CAAY,CAAC,cACb7gB,IAAA,CAACtF,GAAG,EAAC+lB,EAAE,CAAE,CACPS,UAAU,CAAE,SAAS,CACrBJ,CAAC,CAAE,CAAC,CACJO,YAAY,CAAE,CAAC,CACfE,MAAM,CAAE,mBACV,CAAE,CAAAV,QAAA,cACA7gB,IAAA,CAAC/E,UAAU,EAAC0mB,OAAO,CAAC,OAAO,CAAClB,EAAE,CAAE,CAC9BmC,UAAU,CAAE,WAAW,CACvBlB,QAAQ,CAAE,SAAS,CACnB7I,KAAK,CAAE,SAAS,CAChB+I,UAAU,CAAE,GACd,CAAE,CAAAf,QAAA,CACC3N,IAAI,CAACtK,MAAM,CAACyE,eAAe,CAClB,CAAC,CACV,CAAC,EACH,CACN,EACU,CAAC,CACV,CAAC,EAnMsB8F,KAoMzB,CACP,CAAC,CACE,CAAC,cAEPjT,KAAA,CAACxF,GAAG,EAAC+lB,EAAE,CAAE,CACPK,CAAC,CAAE,CAAC,CACJnC,SAAS,CAAE,QAAQ,CACnBuC,UAAU,CAAE,mDAAmD,CAC/DG,YAAY,CAAE,CAChB,CAAE,CAAAR,QAAA,eACA7gB,IAAA,CAACtF,GAAG,EAAC+lB,EAAE,CAAE,CACPlgB,KAAK,CAAE,GAAG,CACVC,MAAM,CAAE,GAAG,CACX6gB,YAAY,CAAE,KAAK,CACnBH,UAAU,CAAE,yBAAyB,CACrCR,OAAO,CAAE,MAAM,CACfE,UAAU,CAAE,QAAQ,CACpBD,cAAc,CAAE,QAAQ,CACxB6F,EAAE,CAAE,MAAM,CACVrF,EAAE,CAAE,CACN,CAAE,CAAAN,QAAA,cACA7gB,IAAA,CAACpC,IAAI,EAAC6iB,EAAE,CAAE,CAAEiB,QAAQ,CAAE,EAAE,CAAE7I,KAAK,CAAE,SAAU,CAAE,CAAE,CAAC,CAC7C,CAAC,cACN7Y,IAAA,CAAC/E,UAAU,EAAC0mB,OAAO,CAAC,IAAI,CAAC9I,KAAK,CAAC,gBAAgB,CAAC4H,EAAE,CAAE,CAAEU,EAAE,CAAE,CAAC,CAAES,UAAU,CAAE,GAAI,CAAE,CAAAf,QAAA,CAAC,yBAEhF,CAAY,CAAC,cACb7gB,IAAA,CAAC/E,UAAU,EAAC0mB,OAAO,CAAC,OAAO,CAAC9I,KAAK,CAAC,gBAAgB,CAAC4H,EAAE,CAAE,CAAEiE,QAAQ,CAAE,GAAG,CAAE8B,EAAE,CAAE,MAAO,CAAE,CAAA3F,QAAA,CAAC,qJAGtF,CAAY,CAAC,EACV,CACN,CACE,CAAC,EACF,CAAC,EACH,CAAC,cAGP7gB,IAAA,CAAC3E,IAAI,EAACinB,IAAI,MAACvB,EAAE,CAAE,EAAG,CAACmE,EAAE,CAAE,CAAE,CAAArE,QAAA,cACvB3gB,KAAA,CAACxF,GAAG,EAAC+lB,EAAE,CAAE,CAAE2E,QAAQ,CAAE,QAAQ,CAAElL,GAAG,CAAE,EAAG,CAAE,CAAA2G,QAAA,eAEvC3gB,KAAA,CAAC9D,IAAI,EAACqkB,EAAE,CAAE,CACRY,YAAY,CAAE,CAAC,CACfC,SAAS,CAAE,4BAA4B,CACvCH,EAAE,CAAE,CACN,CAAE,CAAAN,QAAA,eACA7gB,IAAA,CAACtF,GAAG,EAAC+lB,EAAE,CAAE,CACPK,CAAC,CAAE,GAAG,CACNI,UAAU,CAAE,SAAS,CACrBrI,KAAK,CAAE,OACT,CAAE,CAAAgI,QAAA,cACA3gB,KAAA,CAACjF,UAAU,EAAC0mB,OAAO,CAAC,IAAI,CAAClB,EAAE,CAAE,CAAEmB,UAAU,CAAE,GAAG,CAAElB,OAAO,CAAE,MAAM,CAAEE,UAAU,CAAE,QAAS,CAAE,CAAAC,QAAA,eACtF7gB,IAAA,CAACtB,QAAQ,EAAC+hB,EAAE,CAAE,CAAEqE,EAAE,CAAE,GAAI,CAAE,CAAE,CAAC,uBAE/B,EAAY,CAAC,CACV,CAAC,cACN5kB,KAAA,CAACxF,GAAG,EAAC+lB,EAAE,CAAE,CAAEK,CAAC,CAAE,CAAE,CAAE,CAAAD,QAAA,eAChB3gB,KAAA,CAACxF,GAAG,EAAC+lB,EAAE,CAAE,CAAEU,EAAE,CAAE,CAAE,CAAE,CAAAN,QAAA,eACjB7gB,IAAA,CAAC/E,UAAU,EAAC0mB,OAAO,CAAC,WAAW,CAAC9I,KAAK,CAAC,gBAAgB,CAAC4H,EAAE,CAAE,CAAEmB,UAAU,CAAE,GAAG,CAAET,EAAE,CAAE,CAAE,CAAE,CAAAN,QAAA,CAAC,mBAEvF,CAAY,CAAC,cACb7gB,IAAA,CAAC/E,UAAU,EAAC0mB,OAAO,CAAC,IAAI,CAAClB,EAAE,CAAE,CAC3BmB,UAAU,CAAE,GAAG,CACf/I,KAAK,CAAE,SAAS,CAChBiI,CAAC,CAAE,CAAC,CACJI,UAAU,CAAE,SAAS,CACrBG,YAAY,CAAE,CAAC,CACfE,MAAM,CAAE,mBACV,CAAE,CAAAV,QAAA,EAAAtf,uBAAA,CACC2F,eAAe,CAAC+d,SAAS,UAAA1jB,uBAAA,iBAAzBA,uBAAA,CAA2ByG,IAAI,CACtB,CAAC,EACV,CAAC,cAEN9H,KAAA,CAACxF,GAAG,EAAC+lB,EAAE,CAAE,CAAEU,EAAE,CAAE,CAAE,CAAE,CAAAN,QAAA,eACjB7gB,IAAA,CAAC/E,UAAU,EAAC0mB,OAAO,CAAC,WAAW,CAAC9I,KAAK,CAAC,gBAAgB,CAAC4H,EAAE,CAAE,CAAEmB,UAAU,CAAE,GAAG,CAAET,EAAE,CAAE,CAAE,CAAE,CAAAN,QAAA,CAAC,4BAEvF,CAAY,CAAC,cACb7gB,IAAA,CAACtF,GAAG,EAAC+lB,EAAE,CAAE,CACPK,CAAC,CAAE,CAAC,CACJI,UAAU,CAAE,SAAS,CACrBG,YAAY,CAAE,CAAC,CACfE,MAAM,CAAE,mBAAmB,CAC3BN,SAAS,CAAE,EAAE,CACbP,OAAO,CAAE,MAAM,CACfE,UAAU,CAAE,QACd,CAAE,CAAAC,QAAA,cACA3gB,KAAA,CAACjF,UAAU,EAAC0mB,OAAO,CAAC,OAAO,CAAClB,EAAE,CAAE,CAC9B5H,KAAK,CAAE,SAAS,CAChByN,SAAS,CAAE,QAAQ,CACnB3H,SAAS,CAAE,QAAQ,CACnBpe,KAAK,CAAE,MACT,CAAE,CAAAsgB,QAAA,EAAC,IACA,CAAC,EAAArf,uBAAA,CAAA0F,eAAe,CAAC+d,SAAS,UAAAzjB,uBAAA,iBAAzBA,uBAAA,CAA2ByG,WAAW,GAAI,6BAA6B,CAAC,IAC5E,EAAY,CAAC,CACV,CAAC,EACH,CAAC,cAEN/H,KAAA,CAACxF,GAAG,EAAC+lB,EAAE,CAAE,CAAEU,EAAE,CAAE,CAAE,CAAE,CAAAN,QAAA,eACjB7gB,IAAA,CAAC/E,UAAU,EAAC0mB,OAAO,CAAC,WAAW,CAAC9I,KAAK,CAAC,gBAAgB,CAAC4H,EAAE,CAAE,CAAEmB,UAAU,CAAE,GAAG,CAAET,EAAE,CAAE,CAAE,CAAE,CAAAN,QAAA,CAAC,6BAEvF,CAAY,CAAC,cACb3gB,KAAA,CAACxF,GAAG,EAAC+lB,EAAE,CAAE,CAAEC,OAAO,CAAE,MAAM,CAAEE,UAAU,CAAE,QAAS,CAAE,CAAAC,QAAA,eACjD7gB,IAAA,CAAC7E,IAAI,EACHsF,KAAK,CAAE,CAAAgB,uBAAA,CAAAyF,eAAe,CAAC+d,SAAS,UAAAxjB,uBAAA,WAAzBA,uBAAA,CAA2B8G,QAAQ,CAAG,SAAS,CAAG,aAAc,CACvEsQ,KAAK,CAAE,CAAAnX,uBAAA,CAAAwF,eAAe,CAAC+d,SAAS,UAAAvjB,uBAAA,WAAzBA,uBAAA,CAA2B6G,QAAQ,CAAG,SAAS,CAAG,SAAU,CACnEoZ,OAAO,CAAC,QAAQ,CAChBlB,EAAE,CAAE,CACFmB,UAAU,CAAE,GAAG,CACfF,QAAQ,CAAE,QAAQ,CAClBlhB,MAAM,CAAE,EACV,CAAE,CACH,CAAC,cACFR,IAAA,CAAC/E,UAAU,EAAC0mB,OAAO,CAAC,OAAO,CAAC9I,KAAK,CAAC,gBAAgB,CAAC4H,EAAE,CAAE,CAAE4D,EAAE,CAAE,CAAE,CAAE,CAAAxD,QAAA,CAC9D,CAAAlf,uBAAA,CAAAuF,eAAe,CAAC+d,SAAS,UAAAtjB,uBAAA,WAAzBA,uBAAA,CAA2B4G,QAAQ,CAAG,4BAA4B,CAAG,yBAAyB,CACrF,CAAC,EACV,CAAC,EACH,CAAC,EACH,CAAC,EACF,CAAC,cAGPrI,KAAA,CAAC9D,IAAI,EAACqkB,EAAE,CAAE,CACRY,YAAY,CAAE,CAAC,CACfC,SAAS,CAAE,4BACb,CAAE,CAAAT,QAAA,eACA7gB,IAAA,CAACtF,GAAG,EAAC+lB,EAAE,CAAE,CACPK,CAAC,CAAE,GAAG,CACNI,UAAU,CAAE,SAAS,CACrBrI,KAAK,CAAE,OACT,CAAE,CAAAgI,QAAA,cACA3gB,KAAA,CAACjF,UAAU,EAAC0mB,OAAO,CAAC,IAAI,CAAClB,EAAE,CAAE,CAAEmB,UAAU,CAAE,GAAG,CAAElB,OAAO,CAAE,MAAM,CAAEE,UAAU,CAAE,QAAS,CAAE,CAAAC,QAAA,eACtF7gB,IAAA,CAACpC,IAAI,EAAC6iB,EAAE,CAAE,CAAEqE,EAAE,CAAE,GAAI,CAAE,CAAE,CAAC,oBAE3B,EAAY,CAAC,CACV,CAAC,cACN5kB,KAAA,CAACxF,GAAG,EAAC+lB,EAAE,CAAE,CAAEK,CAAC,CAAE,CAAE,CAAE,CAAAD,QAAA,eAChB3gB,KAAA,CAACxF,GAAG,EAAC+lB,EAAE,CAAE,CAAEU,EAAE,CAAE,CAAE,CAAE,CAAAN,QAAA,eACjB7gB,IAAA,CAAC/E,UAAU,EAAC0mB,OAAO,CAAC,SAAS,CAAC9I,KAAK,CAAC,gBAAgB,CAAC4H,EAAE,CAAE,CAAEmB,UAAU,CAAE,GAAI,CAAE,CAAAf,QAAA,CAAC,cAE9E,CAAY,CAAC,cACb7gB,IAAA,CAAC/E,UAAU,EAAC0mB,OAAO,CAAC,OAAO,CAAClB,EAAE,CAAE,CAC9BmC,UAAU,CAAE,WAAW,CACvBlB,QAAQ,CAAE,SAAS,CACnBR,UAAU,CAAE,SAAS,CACrBJ,CAAC,CAAE,GAAG,CACNO,YAAY,CAAE,CAAC,CACfE,MAAM,CAAE,mBAAmB,CAC3BuC,SAAS,CAAE,WAAW,CACtBjL,KAAK,CAAE,SACT,CAAE,CAAAgI,QAAA,EAAAjf,uBAAA,CACCsF,eAAe,CAAC+d,SAAS,UAAArjB,uBAAA,iBAAzBA,uBAAA,CAA2BwO,UAAU,CAC5B,CAAC,EACV,CAAC,cAENlQ,KAAA,CAACxF,GAAG,EAAC+lB,EAAE,CAAE,CAAEU,EAAE,CAAE,CAAE,CAAE,CAAAN,QAAA,eACjB7gB,IAAA,CAAC/E,UAAU,EAAC0mB,OAAO,CAAC,SAAS,CAAC9I,KAAK,CAAC,gBAAgB,CAAC4H,EAAE,CAAE,CAAEmB,UAAU,CAAE,GAAI,CAAE,CAAAf,QAAA,CAAC,YAE9E,CAAY,CAAC,cACb3gB,KAAA,CAACjF,UAAU,EAAC0mB,OAAO,CAAC,OAAO,CAAClB,EAAE,CAAE,CAC9BmC,UAAU,CAAE,WAAW,CACvBlB,QAAQ,CAAE,QAAQ,CAClBR,UAAU,CAAE,SAAS,CACrBJ,CAAC,CAAE,GAAG,CACNO,YAAY,CAAE,CAAC,CACfE,MAAM,CAAE,mBAAmB,CAC3B1I,KAAK,CAAE,SAAS,CAChB+I,UAAU,CAAE,GACd,CAAE,CAAAf,QAAA,GAAAhf,uBAAA,CACCqF,eAAe,CAAC+d,SAAS,UAAApjB,uBAAA,kBAAAC,uBAAA,CAAzBD,uBAAA,CAA2ByG,IAAI,UAAAxG,uBAAA,iBAA/BA,uBAAA,CAAiCvB,KAAK,CAAC,QAAG,EAAAwB,uBAAA,CAACmF,eAAe,CAAC+d,SAAS,UAAAljB,uBAAA,kBAAAC,uBAAA,CAAzBD,uBAAA,CAA2BuG,IAAI,UAAAtG,uBAAA,iBAA/BA,uBAAA,CAAiCxB,MAAM,CAAC,KACtF,EAAY,CAAC,EACV,CAAC,cAENN,KAAA,CAACxF,GAAG,EAAC+lB,EAAE,CAAE,CAAEU,EAAE,CAAE,CAAE,CAAE,CAAAN,QAAA,eACjB7gB,IAAA,CAAC/E,UAAU,EAAC0mB,OAAO,CAAC,SAAS,CAAC9I,KAAK,CAAC,gBAAgB,CAAC4H,EAAE,CAAE,CAAEmB,UAAU,CAAE,GAAI,CAAE,CAAAf,QAAA,CAAC,eAE9E,CAAY,CAAC,cACb3gB,KAAA,CAACjF,UAAU,EAAC0mB,OAAO,CAAC,OAAO,CAAClB,EAAE,CAAE,CAC9BiB,QAAQ,CAAE,QAAQ,CAClBR,UAAU,CAAE,SAAS,CACrBJ,CAAC,CAAE,GAAG,CACNO,YAAY,CAAE,CAAC,CACfE,MAAM,CAAE,mBAAmB,CAC3B1I,KAAK,CAAE,SAAS,CAChB+I,UAAU,CAAE,GAAG,CACfjD,SAAS,CAAE,QACb,CAAE,CAAAkC,QAAA,EACC,EAAA5e,uBAAA,CAAAiF,eAAe,CAAC+d,SAAS,UAAAhjB,uBAAA,kBAAAC,uBAAA,CAAzBD,uBAAA,CAA2BuG,KAAK,UAAAtG,uBAAA,iBAAhCA,uBAAA,CAAkCyB,MAAM,GAAI,CAAC,CAAC,oBACjD,EAAY,CAAC,EACV,CAAC,EACH,CAAC,EACF,CAAC,EACJ,CAAC,CACF,CAAC,EACH,CAAC,CACJ,CAAC,cAENzD,KAAA,CAACxF,GAAG,EAAC+lB,EAAE,CAAE,CACPK,CAAC,CAAE,CAAC,CACJnC,SAAS,CAAE,QAAQ,CACnBsC,SAAS,CAAE,OAAO,CAClBP,OAAO,CAAE,MAAM,CACfyC,aAAa,CAAE,QAAQ,CACvBvC,UAAU,CAAE,QAAQ,CACpBD,cAAc,CAAE,QAAQ,CACxBO,UAAU,CAAE,mDACd,CAAE,CAAAL,QAAA,eACA7gB,IAAA,CAACtF,GAAG,EAAC+lB,EAAE,CAAE,CACPlgB,KAAK,CAAE,GAAG,CACVC,MAAM,CAAE,GAAG,CACX6gB,YAAY,CAAE,KAAK,CACnBH,UAAU,CAAE,wBAAwB,CACpCR,OAAO,CAAE,MAAM,CACfE,UAAU,CAAE,QAAQ,CACpBD,cAAc,CAAE,QAAQ,CACxBQ,EAAE,CAAE,CACN,CAAE,CAAAN,QAAA,cACA7gB,IAAA,CAACpB,SAAS,EAAC6hB,EAAE,CAAE,CAAEiB,QAAQ,CAAE,EAAE,CAAE7I,KAAK,CAAE,SAAU,CAAE,CAAE,CAAC,CAClD,CAAC,cACN7Y,IAAA,CAAC/E,UAAU,EAAC0mB,OAAO,CAAC,IAAI,CAAC9I,KAAK,CAAC,OAAO,CAAC4H,EAAE,CAAE,CAAEU,EAAE,CAAE,CAAC,CAAES,UAAU,CAAE,GAAI,CAAE,CAAAf,QAAA,CAAC,wBAEvE,CAAY,CAAC,cACb7gB,IAAA,CAAC/E,UAAU,EAAC0mB,OAAO,CAAC,OAAO,CAAC9I,KAAK,CAAC,gBAAgB,CAAC4H,EAAE,CAAE,CAAEiE,QAAQ,CAAE,GAAG,CAAEvD,EAAE,CAAE,CAAE,CAAE,CAAAN,QAAA,CAAC,8FAEjF,CAAY,CAAC,cACb7gB,IAAA,CAACrF,MAAM,EACLgnB,OAAO,CAAC,WAAW,CACnB9I,KAAK,CAAC,SAAS,CACfoJ,OAAO,CAAEA,CAAA,GAAM7Q,uBAAuB,CAACpK,0BAA0B,CAAE,CACnEgb,SAAS,cAAEhiB,IAAA,CAACjC,OAAO,GAAE,CAAE,CAAA8iB,QAAA,CACxB,eAED,CAAQ,CAAC,EACN,CACN,CACY,CAAC,cAEhB7gB,IAAA,CAACjF,aAAa,EAAC0lB,EAAE,CAAE,CACjBK,CAAC,CAAE,CAAC,CACJ2F,SAAS,CAAE,mBAAmB,CAC9BvF,UAAU,CAAE,SAAS,CACrBwF,sBAAsB,CAAE,CAAC,CACzBC,uBAAuB,CAAE,CAC3B,CAAE,CAAA9F,QAAA,cACA7gB,IAAA,CAACrF,MAAM,EACLsnB,OAAO,CAAEA,CAAA,GAAMlb,oBAAoB,CAAC,KAAK,CAAE,CAC3C4a,OAAO,CAAC,UAAU,CAClBlB,EAAE,CAAE,CACFnC,WAAW,CAAE,SAAS,CACtBzF,KAAK,CAAE,SAAS,CAChB,SAAS,CAAE,CACTyF,WAAW,CAAE,SAAS,CACtB4C,UAAU,CAAE,0BACd,CACF,CAAE,CAAAL,QAAA,CACH,OAED,CAAQ,CAAC,CACI,CAAC,EACV,CAAC,cAGT3gB,KAAA,CAACtF,MAAM,EAAC4pB,IAAI,CAAEle,qBAAsB,CAACme,OAAO,CAAEA,CAAA,GAAMle,wBAAwB,CAAC,KAAK,CAAE,CAACme,QAAQ,CAAC,IAAI,CAACT,SAAS,MAAApD,QAAA,eAC1G7gB,IAAA,CAACnF,WAAW,EAAAgmB,QAAA,CAAC,wBAEb,CAAa,CAAC,cACd3gB,KAAA,CAACpF,aAAa,EAAA+lB,QAAA,eACZ7gB,IAAA,CAAC9E,KAAK,EAACinB,QAAQ,CAAC,MAAM,CAAC1B,EAAE,CAAE,CAAEU,EAAE,CAAE,CAAE,CAAE,CAAAN,QAAA,cACnC3gB,KAAA,CAACjF,UAAU,EAAC0mB,OAAO,CAAC,OAAO,CAAAd,QAAA,eACzB7gB,IAAA,WAAA6gB,QAAA,CAAQ,eAAa,CAAQ,CAAC,kGAChC,EAAY,CAAC,CACR,CAAC,CAEPra,sBAAsB,eACrBtG,KAAA,CAACxF,GAAG,EAAC+lB,EAAE,CAAE,CAAEU,EAAE,CAAE,CAAE,CAAE,CAAAN,QAAA,eACjB3gB,KAAA,CAACjF,UAAU,EAAC0mB,OAAO,CAAC,IAAI,CAAClB,EAAE,CAAE,CAAEU,EAAE,CAAE,CAAE,CAAE,CAAAN,QAAA,EAAC,iBACvB,CAACra,sBAAsB,CAAC6G,eAAe,EAC5C,CAAC,cAEbnN,KAAA,CAACxF,GAAG,EAAC+lB,EAAE,CAAE,CAAEU,EAAE,CAAE,CAAC,CAAEL,CAAC,CAAE,CAAC,CAAEW,OAAO,CAAE,SAAS,CAAEJ,YAAY,CAAE,CAAE,CAAE,CAAAR,QAAA,eAC5D7gB,IAAA,CAAC/E,UAAU,EAAC0mB,OAAO,CAAC,OAAO,CAAClB,EAAE,CAAE,CAAEmB,UAAU,CAAE,GAAG,CAAET,EAAE,CAAE,CAAE,CAAE,CAAAN,QAAA,CAAC,oBAE5D,CAAY,CAAC,cACb7gB,IAAA,CAAC/E,UAAU,EAAC0mB,OAAO,CAAC,OAAO,CAAC9I,KAAK,CAAC,gBAAgB,CAAAgI,QAAA,CAC/Cra,sBAAsB,CAAC4J,UAAU,EAAI,YAAY,CACxC,CAAC,EACV,CAAC,EACH,CACN,cAEDlQ,KAAA,CAACxF,GAAG,EAAC+lB,EAAE,CAAE,CAAEU,EAAE,CAAE,CAAE,CAAE,CAAAN,QAAA,eACjB3gB,KAAA,CAACjF,UAAU,EAAC0mB,OAAO,CAAC,IAAI,CAAClB,EAAE,CAAE,CAAEU,EAAE,CAAE,CAAE,CAAE,CAAAN,QAAA,EAAC,wBAChB,CAACxe,SAAS,CAACsB,MAAM,CAAC,aAC1C,EAAY,CAAC,cACbzD,KAAA,CAAC3D,WAAW,EAAC0nB,SAAS,MAAApD,QAAA,eACpB7gB,IAAA,CAACxD,UAAU,EAAAqkB,QAAA,CAAC,WAAS,CAAY,CAAC,cAClC7gB,IAAA,CAACvD,MAAM,EACL4e,KAAK,CAAE,CAAA3U,yBAAyB,SAAzBA,yBAAyB,iBAAzBA,yBAAyB,CAAE2J,YAAY,GAAI,EAAG,CACrDuW,QAAQ,CAAGlZ,CAAC,EAAK,CACf,KAAM,CAAAnF,QAAQ,CAAGlG,SAAS,CAAC6P,IAAI,CAAC4C,EAAE,EAAIA,EAAE,CAAC1E,UAAU,GAAK1C,CAAC,CAACgE,MAAM,CAAC2J,KAAK,CAAC,CACvE1U,4BAA4B,CAAC4B,QAAQ,EAAI,IAAI,CAAC,CAChD,CAAE,CACF9H,KAAK,CAAC,WAAW,CAAAogB,QAAA,CAEhBxe,SAAS,CAAC0P,GAAG,CAAEV,QAAQ,eACtBrR,IAAA,CAACtD,QAAQ,EAA2B2e,KAAK,CAAEhK,QAAQ,CAACjB,UAAW,CAAAyQ,QAAA,cAC7D3gB,KAAA,CAACxF,GAAG,EAAAmmB,QAAA,eACF7gB,IAAA,CAAC/E,UAAU,EAAC0mB,OAAO,CAAC,OAAO,CAAClB,EAAE,CAAE,CAAEmB,UAAU,CAAE,GAAI,CAAE,CAAAf,QAAA,CACjDxP,QAAQ,CAACrJ,IAAI,CACJ,CAAC,cACbhI,IAAA,CAAC/E,UAAU,EAAC0mB,OAAO,CAAC,SAAS,CAAC9I,KAAK,CAAC,gBAAgB,CAAC4H,EAAE,CAAE,CAAEmC,UAAU,CAAE,WAAY,CAAE,CAAA/B,QAAA,CAClFxP,QAAQ,CAACjB,UAAU,CACV,CAAC,EACV,CAAC,EAROiB,QAAQ,CAACjB,UASd,CACX,CAAC,CACI,CAAC,EACE,CAAC,EACX,CAAC,CAEL1J,yBAAyB,eACxB1G,IAAA,CAAC9E,KAAK,EAACinB,QAAQ,CAAC,SAAS,CAAAtB,QAAA,cACvB3gB,KAAA,CAACjF,UAAU,EAAC0mB,OAAO,CAAC,OAAO,CAAAd,QAAA,eACzB7gB,IAAA,WAAA6gB,QAAA,CAAQ,cAAY,CAAQ,CAAC,YAAQ,CAACra,sBAAsB,SAAtBA,sBAAsB,iBAAtBA,sBAAsB,CAAE6G,eAAe,CAAC,qBAAiB,CAAC3G,yBAAyB,CAACsB,IAAI,CAAC,IACjI,EAAY,CAAC,CACR,CACR,EACY,CAAC,cAChB9H,KAAA,CAACnF,aAAa,EAAA8lB,QAAA,eACZ7gB,IAAA,CAACrF,MAAM,EAACsnB,OAAO,CAAEA,CAAA,GAAM1b,wBAAwB,CAAC,KAAK,CAAE,CAAAsa,QAAA,CAAC,QAExD,CAAQ,CAAC,cACT7gB,IAAA,CAACrF,MAAM,EACLsnB,OAAO,CAAEjR,iBAAkB,CAC3B2Q,OAAO,CAAC,WAAW,CACnBO,QAAQ,CAAE,CAACxb,yBAAyB,EAAIE,aAAc,CACtDob,SAAS,CAAEpb,aAAa,cAAG5G,IAAA,CAAChD,gBAAgB,EAACsL,IAAI,CAAE,EAAG,CAAE,CAAC,cAAGtI,IAAA,CAAC3C,IAAI,GAAE,CAAE,CAAAwjB,QAAA,CAEpEja,aAAa,CAAG,aAAa,CAAG,cAAc,CACzC,CAAC,EACI,CAAC,EACV,CAAC,cAGT1G,KAAA,CAACtF,MAAM,EAAC4pB,IAAI,CAAE3e,qBAAsB,CAAC4e,OAAO,CAAEA,CAAA,GAAM3e,wBAAwB,CAAC,KAAK,CAAE,CAAC4e,QAAQ,CAAC,IAAI,CAACT,SAAS,MAAApD,QAAA,eAC1G7gB,IAAA,CAACnF,WAAW,EAAAgmB,QAAA,CAAC,wBAEb,CAAa,CAAC,cACd3gB,KAAA,CAACpF,aAAa,EAAA+lB,QAAA,eACZ7gB,IAAA,CAAC9E,KAAK,EAACinB,QAAQ,CAAC,MAAM,CAAC1B,EAAE,CAAE,CAAEU,EAAE,CAAE,CAAE,CAAE,CAAAN,QAAA,cACnC3gB,KAAA,CAACjF,UAAU,EAAC0mB,OAAO,CAAC,OAAO,CAAAd,QAAA,eACzB7gB,IAAA,WAAA6gB,QAAA,CAAQ,oBAAkB,CAAQ,CAAC,oMAErC,EAAY,CAAC,CACR,CAAC,cAER3gB,KAAA,CAACxF,GAAG,EAAC+lB,EAAE,CAAE,CAAEU,EAAE,CAAE,CAAE,CAAE,CAAAN,QAAA,eACjB3gB,KAAA,CAACjF,UAAU,EAAC0mB,OAAO,CAAC,IAAI,CAAClB,EAAE,CAAE,CAAEU,EAAE,CAAE,CAAE,CAAE,CAAAN,QAAA,EAAC,oBACpB,CAAC9a,iBAAiB,CAACpC,MAAM,CAAC,aAC9C,EAAY,CAAC,CACZoC,iBAAiB,CAACpC,MAAM,GAAK,CAAC,cAC7B3D,IAAA,CAAC9E,KAAK,EAACinB,QAAQ,CAAC,SAAS,CAAAtB,QAAA,CAAC,6EAE1B,CAAO,CAAC,cAER3gB,KAAA,CAAC3D,WAAW,EAAC0nB,SAAS,MAAApD,QAAA,eACpB7gB,IAAA,CAACxD,UAAU,EAAAqkB,QAAA,CAAC,WAAS,CAAY,CAAC,cAClC7gB,IAAA,CAACvD,MAAM,EACL4e,KAAK,CAAE,CAAApV,wBAAwB,SAAxBA,wBAAwB,iBAAxBA,wBAAwB,CAAEoK,YAAY,GAAI,EAAG,CACpDuW,QAAQ,CAAGlZ,CAAC,EAAK,CACf,KAAM,CAAAnF,QAAQ,CAAGxC,iBAAiB,CAACmM,IAAI,CAAC4C,EAAE,EAAIA,EAAE,CAACzE,YAAY,GAAK3C,CAAC,CAACgE,MAAM,CAAC2J,KAAK,CAAC,CACjFnV,2BAA2B,CAACqC,QAAQ,EAAI,IAAI,CAAC,CAC7C,GAAIA,QAAQ,CAAE,CACZpC,UAAU,CAACoC,QAAQ,CAACP,IAAI,CAAC,CAAE;AAC7B,CACF,CAAE,CACFvH,KAAK,CAAC,WAAW,CAAAogB,QAAA,CAEhB9a,iBAAiB,CAACgM,GAAG,CAAEV,QAAQ,eAC9BrR,IAAA,CAACtD,QAAQ,EAA6B2e,KAAK,CAAEhK,QAAQ,CAAChB,YAAa,CAAAwQ,QAAA,cACjE3gB,KAAA,CAACxF,GAAG,EAAAmmB,QAAA,eACF7gB,IAAA,CAAC/E,UAAU,EAAC0mB,OAAO,CAAC,OAAO,CAAClB,EAAE,CAAE,CAAEmB,UAAU,CAAE,GAAI,CAAE,CAAAf,QAAA,CACjDxP,QAAQ,CAACrJ,IAAI,CACJ,CAAC,cACbhI,IAAA,CAAC/E,UAAU,EAAC0mB,OAAO,CAAC,SAAS,CAAC9I,KAAK,CAAC,gBAAgB,CAAC4H,EAAE,CAAE,CAAEmC,UAAU,CAAE,WAAY,CAAE,CAAA/B,QAAA,CAClFxP,QAAQ,CAAChB,YAAY,CACZ,CAAC,EACV,CAAC,EAROgB,QAAQ,CAAChB,YASd,CACX,CAAC,CACI,CAAC,EACE,CACd,EACE,CAAC,CAELpK,wBAAwB,eACvB/F,KAAA,CAACxF,GAAG,EAAC+lB,EAAE,CAAE,CAAEU,EAAE,CAAE,CAAE,CAAE,CAAAN,QAAA,eACjB7gB,IAAA,CAAC/E,UAAU,EAAC0mB,OAAO,CAAC,IAAI,CAAClB,EAAE,CAAE,CAAEU,EAAE,CAAE,CAAE,CAAE,CAAAN,QAAA,CAAC,qBAExC,CAAY,CAAC,cAEb7gB,IAAA,CAAChF,SAAS,EACRipB,SAAS,MACTxjB,KAAK,CAAC,UAAU,CAChB4a,KAAK,CAAE3X,OAAQ,CACfkjB,QAAQ,CAAGlZ,CAAC,EAAKvH,UAAU,CAACuH,CAAC,CAACgE,MAAM,CAAC2J,KAAK,CAAE,CAC5C6I,WAAW,CAAC,4CAA4C,CACxDC,UAAU,iFAAA5V,MAAA,CAAkF7K,OAAO,CAACmjB,WAAW,CAAC,CAAC,2DAA0D,CAC3KpG,EAAE,CAAE,CAAEU,EAAE,CAAE,CAAE,CAAE,CACf,CAAC,cAEFnhB,IAAA,CAAC9E,KAAK,EAACinB,QAAQ,CAAC,MAAM,CAAAtB,QAAA,cACpB3gB,KAAA,CAACjF,UAAU,EAAC0mB,OAAO,CAAC,OAAO,CAAAd,QAAA,eACzB7gB,IAAA,WAAA6gB,QAAA,CAAQ,QAAM,CAAQ,CAAC,qDACvB,cAAA7gB,IAAA,SAAM0jB,KAAK,CAAE,CAAEhD,OAAO,CAAE,OAAO,CAAEoG,SAAS,CAAE,CAAC,CAAEZ,OAAO,CAAE,CAAC,CAAEa,eAAe,CAAE,SAAS,CAAE1F,YAAY,CAAE,CAAE,CAAE,CAAAR,QAAA,iEAAAtS,MAAA,CAGnG7K,OAAO,CAACmjB,WAAW,CAAC,CAAC,EAAI,eAAe,UAExC,CAAC,EACG,CAAC,CACR,CAAC,EACL,CACN,EACY,CAAC,cAChB3mB,KAAA,CAACnF,aAAa,EAAA8lB,QAAA,eACZ7gB,IAAA,CAACrF,MAAM,EAACsnB,OAAO,CAAEA,CAAA,GAAMnc,wBAAwB,CAAC,KAAK,CAAE,CAAA+a,QAAA,CAAC,QAExD,CAAQ,CAAC,cACT7gB,IAAA,CAACrF,MAAM,EACLsnB,OAAO,CAAEhS,yBAA0B,CACnC0R,OAAO,CAAC,WAAW,CACnBO,QAAQ,CAAE,CAACjc,wBAAwB,EAAI,CAACvC,OAAO,CAACwM,IAAI,CAAC,CAAC,EAAI9J,aAAc,CACxE4b,SAAS,CAAE5b,aAAa,cAAGpG,IAAA,CAAChD,gBAAgB,EAACsL,IAAI,CAAE,EAAG,CAAE,CAAC,cAAGtI,IAAA,CAAC7C,GAAG,GAAE,CAAE,CAAA0jB,QAAA,CAEnEza,aAAa,CAAG,aAAa,CAAG,cAAc,CACzC,CAAC,EACI,CAAC,EACV,CAAC,cAGTlG,KAAA,CAACtF,MAAM,EAAC4pB,IAAI,CAAEzhB,gBAAiB,CAAC0hB,OAAO,CAAEA,CAAA,GAAMzhB,mBAAmB,CAAC,KAAK,CAAE,CAAC0hB,QAAQ,CAAC,IAAI,CAACT,SAAS,MAAApD,QAAA,eAChG7gB,IAAA,CAACnF,WAAW,EAAAgmB,QAAA,CAAC,0BAEb,CAAa,CAAC,cACd3gB,KAAA,CAACpF,aAAa,EAAA+lB,QAAA,EACX5d,gBAAgB,eACf/C,KAAA,CAACxF,GAAG,EAAC+lB,EAAE,CAAE,CAAEU,EAAE,CAAE,CAAE,CAAE,CAAAN,QAAA,eACjB3gB,KAAA,CAACjF,UAAU,EAAC0mB,OAAO,CAAC,WAAW,CAAClB,EAAE,CAAE,CAAEmB,UAAU,CAAE,GAAI,CAAE,CAAAf,QAAA,EAAC,aAC5C,CAAC5d,gBAAgB,CAAC+E,IAAI,EACvB,CAAC,cACb9H,KAAA,CAACjF,UAAU,EAAC0mB,OAAO,CAAC,OAAO,CAAC9I,KAAK,CAAC,gBAAgB,CAAAgI,QAAA,EAAC,MAC7C,CAAC5d,gBAAgB,CAACmN,UAAU,EACtB,CAAC,EACV,CACN,cAEDpQ,IAAA,CAAChF,SAAS,EACRipB,SAAS,MACTxjB,KAAK,CAAC,cAAc,CACpB4a,KAAK,CAAElY,MAAO,CACdyjB,QAAQ,CAAGlZ,CAAC,EAAKtK,SAAS,CAACsK,CAAC,CAACgE,MAAM,CAAC2J,KAAK,CAAE,CAC3C6I,WAAW,CAAC,sBAAsB,CAClCC,UAAU,CAAC,iDAAiD,CAC5DP,MAAM,CAAC,QAAQ,CAChB,CAAC,EACW,CAAC,cAChB1jB,KAAA,CAACnF,aAAa,EAAA8lB,QAAA,eACZ7gB,IAAA,CAACrF,MAAM,EAACsnB,OAAO,CAAEA,CAAA,GAAMjf,mBAAmB,CAAC,KAAK,CAAE,CAAA6d,QAAA,CAAC,QAEnD,CAAQ,CAAC,cACT7gB,IAAA,CAACrF,MAAM,EACLsnB,OAAO,CAAEvP,kBAAmB,CAC5BiP,OAAO,CAAC,WAAW,CACnBO,QAAQ,CAAE7e,SAAS,EAAI,CAACF,MAAM,CAAC+M,IAAI,CAAC,CAAE,CACtC8R,SAAS,CAAE3e,SAAS,cAAGrD,IAAA,CAAChD,gBAAgB,EAACsL,IAAI,CAAE,EAAG,CAAE,CAAC,cAAGtI,IAAA,CAACvC,UAAU,GAAE,CAAE,CAAAojB,QAAA,CAEtExd,SAAS,CAAG,cAAc,CAAG,QAAQ,CAChC,CAAC,EACI,CAAC,EACV,CAAC,cAGTnD,KAAA,CAACtF,MAAM,EAAC4pB,IAAI,CAAE9c,gBAAiB,CAAC+c,OAAO,CAAEA,CAAA,GAAM9c,mBAAmB,CAAC,KAAK,CAAE,CAAC+c,QAAQ,CAAC,IAAI,CAACT,SAAS,MAAApD,QAAA,eAChG7gB,IAAA,CAACnF,WAAW,EAAAgmB,QAAA,CAAC,sBAAoB,CAAa,CAAC,cAC/C3gB,KAAA,CAACpF,aAAa,EAAA+lB,QAAA,EACXtX,UAAU,GAAK,QAAQ,eACtBvJ,IAAA,CAAC9E,KAAK,EAACinB,QAAQ,CAAC,MAAM,CAAC1B,EAAE,CAAE,CAAEU,EAAE,CAAE,CAAE,CAAE,CAAAN,QAAA,cACnC3gB,KAAA,CAACjF,UAAU,EAAC0mB,OAAO,CAAC,OAAO,CAAAd,QAAA,eACzB7gB,IAAA,WAAA6gB,QAAA,CAAQ,0BAAwB,CAAQ,CAAC,cACzC7gB,IAAA,QAAK,CAAC,qCAEN,cAAAA,IAAA,QAAK,CAAC,gCAEN,cAAAA,IAAA,QAAK,CAAC,6DAER,EAAY,CAAC,CACR,CACR,cACDE,KAAA,CAAChE,IAAI,EAACmf,KAAK,CAAE9R,UAAW,CAACqd,QAAQ,CAAEA,CAACI,CAAC,CAAEC,QAAQ,GAAKzd,aAAa,CAACyd,QAAQ,CAAE,CAACxG,EAAE,CAAE,CAAEU,EAAE,CAAE,CAAE,CAAE,CAAAN,QAAA,eACzF7gB,IAAA,CAAC7D,GAAG,EAACsE,KAAK,CAAC,gBAAgB,CAAC4a,KAAK,CAAC,QAAQ,CAACyH,IAAI,cAAE9iB,IAAA,CAACnC,OAAO,GAAE,CAAE,CAAE,CAAC,cAChEmC,IAAA,CAAC7D,GAAG,EAACsE,KAAK,CAAC,UAAU,CAAC4a,KAAK,CAAC,UAAU,CAACyH,IAAI,cAAE9iB,IAAA,CAAClC,UAAU,GAAE,CAAE,CAAE,CAAC,cAC/DkC,IAAA,CAAC7D,GAAG,EAACsE,KAAK,CAAC,aAAa,CAAC4a,KAAK,CAAC,QAAQ,CAACyH,IAAI,cAAE9iB,IAAA,CAACpC,IAAI,GAAE,CAAE,CAAE,CAAC,cAC1DoC,IAAA,CAAC7D,GAAG,EAACsE,KAAK,CAAC,aAAa,CAAC4a,KAAK,CAAC,QAAQ,CAACyH,IAAI,cAAE9iB,IAAA,CAAC/B,WAAW,GAAE,CAAE,CAAE,CAAC,EAC7D,CAAC,CAENsL,UAAU,GAAK,QAAQ,eACtBrJ,KAAA,CAAC7E,IAAI,EAAC+mB,SAAS,MAACC,OAAO,CAAE,CAAE,CAAAxB,QAAA,eACzB7gB,IAAA,CAAC3E,IAAI,EAACinB,IAAI,MAACvB,EAAE,CAAE,EAAG,CAAAF,QAAA,cAChB7gB,IAAA,CAAChF,SAAS,EACRipB,SAAS,MACTxjB,KAAK,CAAC,gBAAgB,CACtB4a,KAAK,CAAEvT,YAAY,CAACE,IAAK,CACzB4e,QAAQ,CAAGlZ,CAAC,EAAK3F,eAAe,CAAAkG,aAAA,CAAAA,aAAA,IAAKnG,YAAY,MAAEE,IAAI,CAAE0F,CAAC,CAACgE,MAAM,CAAC2J,KAAK,EAAC,CAAE,CAC1E6I,WAAW,CAAC,sBAAsB,CAClCN,MAAM,CAAC,QAAQ,CAChB,CAAC,CACE,CAAC,cAEP5jB,IAAA,CAAC3E,IAAI,EAACinB,IAAI,MAACvB,EAAE,CAAE,EAAG,CAAAF,QAAA,cAChB7gB,IAAA,CAAChF,SAAS,EACRipB,SAAS,MACTxjB,KAAK,CAAC,eAAe,CACrB4a,KAAK,CAAEvT,YAAY,CAACG,WAAY,CAChC2e,QAAQ,CAAGlZ,CAAC,EAAK,CACf,KAAM,CAAA2N,KAAK,CAAG3N,CAAC,CAACgE,MAAM,CAAC2J,KAAK,CAC5B,GAAIA,KAAK,CAAC1X,MAAM,EAAI,EAAE,CAAE,CACtBoE,eAAe,CAAAkG,aAAA,CAAAA,aAAA,IAAKnG,YAAY,MAAEG,WAAW,CAAEoT,KAAK,EAAC,CAAC,CACxD,CACF,CAAE,CACF6I,WAAW,CAAC,iDAAiD,CAC7DC,UAAU,IAAA5V,MAAA,CAAKzG,YAAY,CAACG,WAAW,CAACtE,MAAM,8GAA6G,CAC3JigB,MAAM,CAAC,QAAQ,CACfsD,UAAU,CAAE,CAAEC,SAAS,CAAE,EAAG,CAAE,CAC9BxkB,KAAK,CAAEmF,YAAY,CAACG,WAAW,CAACtE,MAAM,CAAG,EAAG,CAC7C,CAAC,CACE,CAAC,cAEPzD,KAAA,CAAC7E,IAAI,EAACinB,IAAI,MAACvB,EAAE,CAAE,EAAG,CAAAF,QAAA,eAChB7gB,IAAA,CAACrD,gBAAgB,EACfyqB,OAAO,cACLpnB,IAAA,CAACpD,MAAM,EACLyqB,OAAO,CAAEvf,YAAY,CAACI,gBAAiB,CACvC0e,QAAQ,CAAGlZ,CAAC,EAAK3F,eAAe,CAAAkG,aAAA,CAAAA,aAAA,IAAKnG,YAAY,MAAEI,gBAAgB,CAAEwF,CAAC,CAACgE,MAAM,CAAC2V,OAAO,EAAC,CAAE,CACzF,CACF,CACD5mB,KAAK,CAAC,oBAAoB,CAC3B,CAAC,cACFT,IAAA,CAAC/E,UAAU,EAAC0mB,OAAO,CAAC,OAAO,CAAC9I,KAAK,CAAC,gBAAgB,CAAC4H,EAAE,CAAE,CAAE4D,EAAE,CAAE,CAAC,CAAErB,EAAE,CAAE,GAAI,CAAE,CAAAnC,QAAA,CAAC,oFAE3E,CAAY,CAAC,EACT,CAAC,cAEP7gB,IAAA,CAAC3E,IAAI,EAACinB,IAAI,MAACvB,EAAE,CAAE,EAAG,CAAAF,QAAA,cAChB3gB,KAAA,CAAC3D,WAAW,EAAC0nB,SAAS,MAACL,MAAM,CAAC,QAAQ,CAAA/C,QAAA,eACpC7gB,IAAA,CAACxD,UAAU,EAAAqkB,QAAA,CAAC,gBAAc,CAAY,CAAC,cACvC7gB,IAAA,CAACvD,MAAM,EACL4e,KAAK,CAAE9X,oBAAqB,CAC5BqjB,QAAQ,CAAGlZ,CAAC,EAAK7J,wBAAwB,CAAC6J,CAAC,CAACgE,MAAM,CAAC2J,KAA0C,CAAE,CAC/F5a,KAAK,CAAC,gBAAgB,CAAAogB,QAAA,CAErBpN,MAAM,CAAC6T,OAAO,CAACjnB,oBAAoB,CAAC,CAAC0R,GAAG,CAACwV,IAAA,MAAC,CAAC/K,GAAG,CAAElU,IAAI,CAAC,CAAAif,IAAA,oBACpDvnB,IAAA,CAACtD,QAAQ,EAAW2e,KAAK,CAAEmB,GAAI,CAAAqE,QAAA,CAC5BvY,IAAI,CAAC7H,KAAK,EADE+b,GAEL,CAAC,EACZ,CAAC,CACI,CAAC,cACTxc,IAAA,CAAC/E,UAAU,EAAC0mB,OAAO,CAAC,OAAO,CAAC9I,KAAK,CAAC,gBAAgB,CAAC4H,EAAE,CAAE,CAAEuC,EAAE,CAAE,GAAI,CAAE,CAAAnC,QAAA,CAAC,yFAEpE,CAAY,CAAC,EACF,CAAC,CACV,CAAC,cAEP3gB,KAAA,CAAC7E,IAAI,EAACinB,IAAI,MAACvB,EAAE,CAAE,EAAG,CAAAF,QAAA,eAChB7gB,IAAA,CAAC/E,UAAU,EAAC0mB,OAAO,CAAC,IAAI,CAAC6F,YAAY,MAAA3G,QAAA,CAAC,yCAAuC,CAAY,CAAC,cAC1F7gB,IAAA,UACEynB,MAAM,CAAC,SAAS,CAChB5e,IAAI,CAAC,MAAM,CACX+d,QAAQ,CAAGlZ,CAAC,OAAAga,eAAA,OAAK,EAAAA,eAAA,CAAAha,CAAC,CAACgE,MAAM,CAACyO,KAAK,UAAAuH,eAAA,iBAAdA,eAAA,CAAiB,CAAC,CAAC,GAAIpS,2BAA2B,CAAC5H,CAAC,CAACgE,MAAM,CAACyO,KAAK,CAAC,CAAC,CAAC,CAAC,EAAC,CACvFuD,KAAK,CAAE,CAAEhD,OAAO,CAAE,MAAO,CAAE,CAC3BvT,EAAE,CAAC,yBAAyB,CAC7B,CAAC,cACFnN,IAAA,UAAO2nB,OAAO,CAAC,yBAAyB,CAAA9G,QAAA,cACtC7gB,IAAA,CAACrF,MAAM,EAACgnB,OAAO,CAAC,WAAW,CAACa,SAAS,CAAC,MAAM,CAACR,SAAS,cAAEhiB,IAAA,CAACrC,KAAK,GAAE,CAAE,CAAAkjB,QAAA,CAAC,yBAEnE,CAAQ,CAAC,CACJ,CAAC,CACPpX,kBAAkB,eACjBzJ,IAAA,CAAC9E,KAAK,EAACinB,QAAQ,CAAC,SAAS,CAAC1B,EAAE,CAAE,CAAEuC,EAAE,CAAE,CAAE,CAAE,CAAAnC,QAAA,CAAC,iFAEzC,CAAO,CACR,EACG,CAAC,CAENpX,kBAAkB,eACjBvJ,KAAA,CAAC7E,IAAI,EAACinB,IAAI,MAACvB,EAAE,CAAE,EAAG,CAAAF,QAAA,eAChB7gB,IAAA,CAAC/E,UAAU,EAAC0mB,OAAO,CAAC,IAAI,CAAC6F,YAAY,MAAA3G,QAAA,CAAC,wBAAsB,CAAY,CAAC,cACzE7gB,IAAA,CAAC9E,KAAK,EAACinB,QAAQ,CAAC,MAAM,CAAC1B,EAAE,CAAE,CAAEU,EAAE,CAAE,CAAE,CAAE,CAAAN,QAAA,cACnC3gB,KAAA,CAACjF,UAAU,EAAC0mB,OAAO,CAAC,OAAO,CAAAd,QAAA,eACzB7gB,IAAA,WAAA6gB,QAAA,CAAQ,eAAa,CAAQ,CAAC,cAC9B7gB,IAAA,QAAK,CAAC,sDAEN,cAAAA,IAAA,QAAK,CAAC,iDAEN,cAAAA,IAAA,QAAK,CAAC,qEAER,EAAY,CAAC,CACR,CAAC,cAERE,KAAA,CAACxF,GAAG,EAAC+lB,EAAE,CAAE,CACPc,MAAM,CAAE,iBAAiB,CACzBF,YAAY,CAAE,CAAC,CACfP,CAAC,CAAE,CAAC,CACJnC,SAAS,CAAE,QAAQ,CACnBoI,eAAe,CAAE,SAAS,CAC1B3B,QAAQ,CAAE,UACZ,CAAE,CAAAvE,QAAA,eAEA3gB,KAAA,CAACxF,GAAG,EAAC+lB,EAAE,CAAE,CACP2E,QAAQ,CAAE,UAAU,CACpBlL,GAAG,CAAE,EAAE,CACP0N,KAAK,CAAE,EAAE,CACT7B,MAAM,CAAE,EAAE,CACVrF,OAAO,CAAE,MAAM,CACfyC,aAAa,CAAE,QAAQ,CACvB/B,GAAG,CAAE,CACP,CAAE,CAAAP,QAAA,eACA7gB,IAAA,CAAC7E,IAAI,EACHsF,KAAK,UAAA8N,MAAA,CAAWvJ,IAAI,CAACgT,KAAK,CAAC5N,YAAY,CAACM,IAAI,CAAG,GAAG,CAAC,KAAI,CACvDpC,IAAI,CAAC,OAAO,CACZuQ,KAAK,CAAC,SAAS,CACf8I,OAAO,CAAC,UAAU,CACnB,CAAC,cACF3hB,IAAA,CAAC7E,IAAI,EACHsF,KAAK,CAAE2J,YAAY,CAACkB,UAAU,CAAG,gBAAgB,CAAG,kBAAmB,CACvEhD,IAAI,CAAC,OAAO,CACZuQ,KAAK,CAAEzO,YAAY,CAACkB,UAAU,CAAG,SAAS,CAAG,SAAU,CACvDqW,OAAO,CAAC,UAAU,CAClBM,OAAO,CAAEvF,cAAe,CACxB+D,EAAE,CAAE,CAAE6C,MAAM,CAAE,SAAU,CAAE,CAC3B,CAAC,cACFtjB,IAAA,CAAC7E,IAAI,EACHsF,KAAK,CAAE2J,YAAY,CAACQ,QAAQ,CAAG,eAAe,CAAG,gBAAiB,CAClEtC,IAAI,CAAC,OAAO,CACZuQ,KAAK,CAAEzO,YAAY,CAACQ,QAAQ,CAAG,SAAS,CAAG,SAAU,CACrD+W,OAAO,CAAC,UAAU,CAClBM,OAAO,CAAEA,CAAA,GAAM5X,eAAe,CAAA4D,aAAA,CAAAA,aAAA,IACzB7D,YAAY,MACfQ,QAAQ,CAAE,CAACR,YAAY,CAACQ,QAAQ,EACjC,CAAE,CACH6V,EAAE,CAAE,CAAE6C,MAAM,CAAE,SAAU,CAAE,CAC3B,CAAC,cACFtjB,IAAA,CAAC7E,IAAI,EACHsF,KAAK,CAAE2J,YAAY,CAACU,QAAQ,CAAG,UAAU,CAAG,WAAY,CACxDxC,IAAI,CAAC,OAAO,CACZuQ,KAAK,CAAEzO,YAAY,CAACU,QAAQ,CAAG,SAAS,CAAG,SAAU,CACrD6W,OAAO,CAAC,UAAU,CAClBM,OAAO,CAAEA,CAAA,GAAM5X,eAAe,CAAA4D,aAAA,CAAAA,aAAA,IACzB7D,YAAY,MACfU,QAAQ,CAAE,CAACV,YAAY,CAACU,QAAQ,EACjC,CAAE,CACH2V,EAAE,CAAE,CAAE6C,MAAM,CAAE,SAAU,CAAE,CAC3B,CAAC,EACC,CAAC,CAGLjX,mBAAmB,cAClBnM,KAAA,CAACxF,GAAG,EAAC+lB,EAAE,CAAE,CACP2E,QAAQ,CAAE,UAAU,CACpBlL,GAAG,CAAE,EAAE,CACPD,IAAI,CAAE,EAAE,CACR8L,MAAM,CAAE,EAAE,CACVgB,eAAe,CAAE,2BAA2B,CAC5C1F,YAAY,CAAE,CAAC,CACfP,CAAC,CAAE,GAAG,CACNY,QAAQ,CAAE,SAAS,CACnBJ,SAAS,CAAE,2BAA2B,CACtCC,MAAM,CAAE,2BAA2B,CACnCmD,QAAQ,CAAE,GACZ,CAAE,CAAA7D,QAAA,eACA3gB,KAAA,CAACxF,GAAG,EAAC+lB,EAAE,CAAE,CAAEC,OAAO,CAAE,MAAM,CAAEC,cAAc,CAAE,eAAe,CAAEC,UAAU,CAAE,QAAQ,CAAEO,EAAE,CAAE,CAAE,CAAE,CAAAN,QAAA,eACzF7gB,IAAA,CAAC/E,UAAU,EAAC0mB,OAAO,CAAC,SAAS,CAAClB,EAAE,CAAE,CAAEmB,UAAU,CAAE,MAAM,CAAE/I,KAAK,CAAE,MAAO,CAAE,CAAAgI,QAAA,CAAC,mBAEzE,CAAY,CAAC,cACb7gB,IAAA,CAAC5E,UAAU,EACTkN,IAAI,CAAC,OAAO,CACZ2Z,OAAO,CAAEA,CAAA,GAAM3V,sBAAsB,CAAC,KAAK,CAAE,CAC7CmU,EAAE,CAAE,CACFK,CAAC,CAAE,GAAG,CACNiC,QAAQ,CAAE,MAAM,CAChBlK,KAAK,CAAE,MAAM,CACb,SAAS,CAAE,CAAEA,KAAK,CAAE,MAAO,CAC7B,CAAE,CAAAgI,QAAA,cAEF7gB,IAAA,CAAC3B,KAAK,EAACqjB,QAAQ,CAAC,OAAO,CAAE,CAAC,CAChB,CAAC,EACV,CAAC,cACN1hB,IAAA,CAAC/E,UAAU,EAAC0mB,OAAO,CAAC,SAAS,CAACjB,OAAO,CAAC,OAAO,CAACD,EAAE,CAAE,CAAE5H,KAAK,CAAE,MAAM,CAAEsI,EAAE,CAAE,GAAI,CAAE,CAAAN,QAAA,CAAC,sCAE9E,CAAY,CAAC,cACb7gB,IAAA,CAAC/E,UAAU,EAAC0mB,OAAO,CAAC,SAAS,CAACjB,OAAO,CAAC,OAAO,CAACD,EAAE,CAAE,CAAE5H,KAAK,CAAE,MAAM,CAAEsI,EAAE,CAAE,GAAI,CAAE,CAAAN,QAAA,CAAC,mCAE9E,CAAY,CAAC,cACb7gB,IAAA,CAAC/E,UAAU,EAAC0mB,OAAO,CAAC,SAAS,CAACjB,OAAO,CAAC,OAAO,CAACD,EAAE,CAAE,CAAE5H,KAAK,CAAE,MAAM,CAAEsI,EAAE,CAAE,GAAI,CAAE,CAAAN,QAAA,CAAC,sCAE9E,CAAY,CAAC,cACb7gB,IAAA,CAAC/E,UAAU,EAAC0mB,OAAO,CAAC,SAAS,CAACjB,OAAO,CAAC,OAAO,CAACD,EAAE,CAAE,CAAE5H,KAAK,CAAE,MAAM,CAAEsI,EAAE,CAAE,GAAI,CAAE,CAAAN,QAAA,CAAC,4BAE9E,CAAY,CAAC,cACb7gB,IAAA,CAAC/E,UAAU,EAAC0mB,OAAO,CAAC,SAAS,CAACjB,OAAO,CAAC,OAAO,CAACD,EAAE,CAAE,CAAE5H,KAAK,CAAE,MAAM,CAAEsI,EAAE,CAAE,GAAI,CAAE,CAAAN,QAAA,CAAC,gDAE9E,CAAY,CAAC,cACb7gB,IAAA,CAAC/E,UAAU,EAAC0mB,OAAO,CAAC,SAAS,CAACjB,OAAO,CAAC,OAAO,CAACD,EAAE,CAAE,CAAE5H,KAAK,CAAE,MAAM,CAAEsI,EAAE,CAAE,GAAI,CAAE,CAAAN,QAAA,CAAC,iCAE9E,CAAY,CAAC,cACb7gB,IAAA,CAAC/E,UAAU,EAAC0mB,OAAO,CAAC,SAAS,CAACjB,OAAO,CAAC,OAAO,CAACD,EAAE,CAAE,CAAE5H,KAAK,CAAE,MAAM,CAAEsI,EAAE,CAAE,GAAI,CAAE,CAAAN,QAAA,CAAC,iCAE9E,CAAY,CAAC,cACb7gB,IAAA,CAAC/E,UAAU,EAAC0mB,OAAO,CAAC,SAAS,CAACjB,OAAO,CAAC,OAAO,CAACD,EAAE,CAAE,CAAE5H,KAAK,CAAE,MAAM,CAAEsI,EAAE,CAAE,GAAI,CAAE,CAAAN,QAAA,CAAC,gCAE9E,CAAY,CAAC,cACb7gB,IAAA,CAAC/E,UAAU,EAAC0mB,OAAO,CAAC,SAAS,CAACjB,OAAO,CAAC,OAAO,CAACD,EAAE,CAAE,CAAE5H,KAAK,CAAE,MAAO,CAAE,CAAAgI,QAAA,CAAC,yCAErE,CAAY,CAAC,EACV,CAAC,cAEN7gB,IAAA,CAACtF,GAAG,EAAC+lB,EAAE,CAAE,CACP2E,QAAQ,CAAE,UAAU,CACpBlL,GAAG,CAAE,EAAE,CACPD,IAAI,CAAE,EAAE,CACR8L,MAAM,CAAE,EACV,CAAE,CAAAlF,QAAA,cACA7gB,IAAA,CAACrF,MAAM,EACL2N,IAAI,CAAC,OAAO,CACZqZ,OAAO,CAAC,UAAU,CAClBM,OAAO,CAAEA,CAAA,GAAM3V,sBAAsB,CAAC,IAAI,CAAE,CAC5C0V,SAAS,cAAEhiB,IAAA,CAAC1B,IAAI,GAAE,CAAE,CACpBmiB,EAAE,CAAE,CACFsG,eAAe,CAAE,0BAA0B,CAC3CzI,WAAW,CAAE,oBAAoB,CACjCzF,KAAK,CAAE,MAAM,CACb6I,QAAQ,CAAE,SAAS,CACnB,SAAS,CAAE,CACTqF,eAAe,CAAE,wBAAwB,CACzCzI,WAAW,CAAE,oBAAoB,CACjCzF,KAAK,CAAE,MACT,CACF,CAAE,CAAAgI,QAAA,CACH,WAED,CAAQ,CAAC,CACN,CACN,cAED7gB,IAAA,WACE6nB,GAAG,CAAE1jB,SAAU,CACf2jB,WAAW,CAAEvM,qBAAsB,CACnCwM,WAAW,CAAGra,CAAC,EAAK,CAClBqO,kBAAkB,CAACrO,CAAC,CAAC,CACrB;AACA,KAAM,CAAAxJ,MAAM,CAAGC,SAAS,CAACC,OAAO,CAChC,GAAIF,MAAM,CAAE,CACVA,MAAM,CAACwf,KAAK,CAACJ,MAAM,CAAG5J,cAAc,CAAChM,CAAC,CAACyL,OAAO,CAAEzL,CAAC,CAAC0L,OAAO,CAAC,CAC5D,CACF,CAAE,CACF4O,SAAS,CAAE9L,mBAAoB,CAC/B+F,OAAO,CAAE5F,iBAAkB,CAC3B4L,aAAa,CAAE3L,uBAAwB,CACvC4L,SAAS,CAAE3L,mBAAoB,CAC/B4L,YAAY,CAAEA,CAAA,GAAM,CAClB;AACA,KAAM,CAAAjkB,MAAM,CAAGC,SAAS,CAACC,OAAO,CAChC,GAAIF,MAAM,CAAE,CACVA,MAAM,CAACwf,KAAK,CAACJ,MAAM,CAAG,SAAS,CACjC,CACA;AACAjZ,eAAe,CAAA4D,aAAA,CAAAA,aAAA,IACV7D,YAAY,MACfoB,aAAa,CAAE,IAAI,EACpB,CAAC,CACJ,CAAE,CACF4c,QAAQ,CAAE,CAAE,CACZ1E,KAAK,CAAE,CACLnjB,KAAK,CAAE,MAAM,CACbmkB,QAAQ,CAAE,OAAO,CACjBlkB,MAAM,CAAE,MAAM,CACd8iB,MAAM,CAAE,SAAS,CACjB/B,MAAM,CAAE,gBAAgB,CACxBF,YAAY,CAAE,CAAC,CACfC,SAAS,CAAE,2BAA2B,CACtC+G,UAAU,CAAE,MAAM,CAClBC,WAAW,CAAE,MACf,CAAE,CACH,CAAC,EACC,CAAC,cAENpoB,KAAA,CAACxF,GAAG,EAAC+lB,EAAE,CAAE,CAAEuC,EAAE,CAAE,CAAC,CAAEtC,OAAO,CAAE,MAAM,CAAEU,GAAG,CAAE,CAAC,CAAE2C,QAAQ,CAAE,MAAM,CAAEnD,UAAU,CAAE,QAAS,CAAE,CAAAC,QAAA,eAClF7gB,IAAA,CAACrF,MAAM,EACLgnB,OAAO,CAAC,UAAU,CAClBrZ,IAAI,CAAC,OAAO,CACZ2Z,OAAO,CAAEA,CAAA,GAAM,CACb9X,WAAW,CAAC,EAAE,CAAC,CACfuC,mBAAmB,CAAC,EAAE,CAAC,CACvByJ,UAAU,CAAC,CAAC,CACd,CAAE,CACF6L,SAAS,cAAEhiB,IAAA,CAAC5C,MAAM,GAAE,CAAE,CAAAyjB,QAAA,CACvB,oBAED,CAAQ,CAAC,cACT7gB,IAAA,CAACrF,MAAM,EACLgnB,OAAO,CAAC,UAAU,CAClBrZ,IAAI,CAAC,OAAO,CACZ2Z,OAAO,CAAEA,CAAA,GAAM,CACb;AACA,GAAIje,WAAW,CAAE,CACf,KAAM,CAAAukB,YAAuB,CAAG,CAC9B,CACEpb,EAAE,CAAE,QAAQ,CACZ1E,MAAM,CAAE,CAAEC,CAAC,CAAE,CAAC,CAAEC,CAAC,CAAE,CAAC,CAAEpI,KAAK,CAAEyD,WAAW,CAACzD,KAAK,CAAG,CAAC,CAAEC,MAAM,CAAEwD,WAAW,CAACxD,MAAM,CAAG,CAAE,CAAC,CACpFoI,MAAM,CAAE,CAAEC,IAAI,CAAE,UAAU,CAAEC,IAAI,CAAE,cAAe,CAAC,CAClDrI,KAAK,CAAE,QAAQ,CACfoY,KAAK,CAAE,SACT,CAAC,CACD,CACE1L,EAAE,CAAE,QAAQ,CACZ1E,MAAM,CAAE,CAAEC,CAAC,CAAE1E,WAAW,CAACzD,KAAK,CAAG,CAAC,CAAEoI,CAAC,CAAE,CAAC,CAAEpI,KAAK,CAAEyD,WAAW,CAACzD,KAAK,CAAG,CAAC,CAAEC,MAAM,CAAEwD,WAAW,CAACxD,MAAM,CAAG,CAAE,CAAC,CACxGoI,MAAM,CAAE,CAAEC,IAAI,CAAE,UAAU,CAAEC,IAAI,CAAE,cAAe,CAAC,CAClDrI,KAAK,CAAE,QAAQ,CACfoY,KAAK,CAAE,SACT,CAAC,CACD,CACE1L,EAAE,CAAE,QAAQ,CACZ1E,MAAM,CAAE,CAAEC,CAAC,CAAG1E,WAAW,CAACzD,KAAK,CAAG,CAAC,CAAI,CAAC,CAAEoI,CAAC,CAAE,CAAC,CAAEpI,KAAK,CAAEyD,WAAW,CAACzD,KAAK,CAAG,CAAC,CAAEC,MAAM,CAAEwD,WAAW,CAACxD,MAAM,CAAG,CAAE,CAAC,CAC9GoI,MAAM,CAAE,CAAEC,IAAI,CAAE,UAAU,CAAEC,IAAI,CAAE,cAAe,CAAC,CAClDrI,KAAK,CAAE,QAAQ,CACfoY,KAAK,CAAE,SACT,CAAC,CACF,CACD1O,WAAW,CAACoe,YAAY,CAAC,CACzBpS,UAAU,CAAC,CAAC,CACd,CACF,CAAE,CACF6L,SAAS,cAAEhiB,IAAA,CAAC7C,GAAG,GAAE,CAAE,CAAA0jB,QAAA,CACpB,mBAED,CAAQ,CAAC,cACT7gB,IAAA,CAACrF,MAAM,EACLgnB,OAAO,CAAC,UAAU,CAClBrZ,IAAI,CAAC,OAAO,CACZ2Z,OAAO,CAAE9L,UAAW,CACpB6L,SAAS,cAAEhiB,IAAA,CAACjC,OAAO,GAAE,CAAE,CAAA8iB,QAAA,CACxB,gBAED,CAAQ,CAAC,cACT7gB,IAAA,CAACrF,MAAM,EACLgnB,OAAO,CAAC,UAAU,CAClBrZ,IAAI,CAAC,OAAO,CACZ2Z,OAAO,CAAEA,CAAA,GAAM,CACb,GAAIje,WAAW,CAAE,CACf;AACA,KAAM,CAAAwkB,OAAO,CAAGxkB,WAAW,CAACzD,KAAK,CAAG,CAAC,CACrC,KAAM,CAAAkoB,OAAO,CAAGzkB,WAAW,CAACxD,MAAM,CAAG,CAAC,CACtC,KAAM,CAAAkoB,WAAoB,CAAG,CAC3Bvb,EAAE,CAAE,aAAa,CACjB1E,MAAM,CAAE,CACNC,CAAC,CAAE8f,OAAO,CAAG,EAAE,CACf7f,CAAC,CAAE8f,OAAO,CAAG,EAAE,CACfloB,KAAK,CAAE,GAAG,CACVC,MAAM,CAAE,GACV,CAAC,CACDoI,MAAM,CAAE,CAAEC,IAAI,CAAE,UAAU,CAAEC,IAAI,CAAE,oBAAqB,CAAC,CACxDrI,KAAK,CAAE,aAAa,CACpBoY,KAAK,CAAE,SACT,CAAC,CACD1O,WAAW,CAAC,CAACue,WAAW,CAAC,CAAC,CAC1BvS,UAAU,CAAC,CAAC,CACZzQ,OAAO,CAACC,GAAG,CAAC,8BAA8B,CAAE+iB,WAAW,CAAC,CAC1D,CACF,CAAE,CACF1G,SAAS,cAAEhiB,IAAA,CAAC7C,GAAG,GAAE,CAAE,CAAA0jB,QAAA,CACpB,qBAED,CAAQ,CAAC,cACT7gB,IAAA,CAACrF,MAAM,EACLgnB,OAAO,CAAC,UAAU,CAClBrZ,IAAI,CAAC,OAAO,CACZ2Z,OAAO,CAAEA,CAAA,GAAM,CACb,GAAIje,WAAW,CAAE,CACf;AACA,KAAM,CAAAukB,YAAuB,CAAG,CAC9B,CACEpb,EAAE,CAAE,eAAe,CACnB1E,MAAM,CAAE,CAAEC,CAAC,CAAE,CAAC,CAAEC,CAAC,CAAE,CAAC,CAAEpI,KAAK,CAAE,GAAG,CAAEC,MAAM,CAAE,GAAI,CAAC,CAC/CoI,MAAM,CAAE,CAAEC,IAAI,CAAE,UAAU,CAAEC,IAAI,CAAE,iBAAkB,CAAC,CACrDrI,KAAK,CAAE,UAAU,CACjBoY,KAAK,CAAE,SACT,CAAC,CACD,CACE1L,EAAE,CAAE,gBAAgB,CACpB1E,MAAM,CAAE,CAAEC,CAAC,CAAE1E,WAAW,CAACzD,KAAK,CAAG,GAAG,CAAEoI,CAAC,CAAE,CAAC,CAAEpI,KAAK,CAAE,GAAG,CAAEC,MAAM,CAAE,GAAI,CAAC,CACrEoI,MAAM,CAAE,CAAEC,IAAI,CAAE,UAAU,CAAEC,IAAI,CAAE,kBAAmB,CAAC,CACtDrI,KAAK,CAAE,WAAW,CAClBoY,KAAK,CAAE,SACT,CAAC,CACD,CACE1L,EAAE,CAAE,kBAAkB,CACtB1E,MAAM,CAAE,CAAEC,CAAC,CAAE,CAAC,CAAEC,CAAC,CAAE3E,WAAW,CAACxD,MAAM,CAAG,GAAG,CAAED,KAAK,CAAE,GAAG,CAAEC,MAAM,CAAE,GAAI,CAAC,CACtEoI,MAAM,CAAE,CAAEC,IAAI,CAAE,UAAU,CAAEC,IAAI,CAAE,oBAAqB,CAAC,CACxDrI,KAAK,CAAE,aAAa,CACpBoY,KAAK,CAAE,SACT,CAAC,CACD,CACE1L,EAAE,CAAE,mBAAmB,CACvB1E,MAAM,CAAE,CAAEC,CAAC,CAAE1E,WAAW,CAACzD,KAAK,CAAG,GAAG,CAAEoI,CAAC,CAAE3E,WAAW,CAACxD,MAAM,CAAG,GAAG,CAAED,KAAK,CAAE,GAAG,CAAEC,MAAM,CAAE,GAAI,CAAC,CAC5FoI,MAAM,CAAE,CAAEC,IAAI,CAAE,UAAU,CAAEC,IAAI,CAAE,qBAAsB,CAAC,CACzDrI,KAAK,CAAE,cAAc,CACrBoY,KAAK,CAAE,SACT,CAAC,CACF,CACD1O,WAAW,CAACoe,YAAY,CAAC,CACzBpS,UAAU,CAAC,CAAC,CACZzQ,OAAO,CAACC,GAAG,CAAC,+BAA+B,CAAE4iB,YAAY,CAAC,CAC5D,CACF,CAAE,CACFvG,SAAS,cAAEhiB,IAAA,CAAC7C,GAAG,GAAE,CAAE,CAAA0jB,QAAA,CACpB,sBAED,CAAQ,CAAC,cACT7gB,IAAA,CAACrF,MAAM,EACLgnB,OAAO,CAAC,UAAU,CAClBrZ,IAAI,CAAC,OAAO,CACZ2Z,OAAO,CAAEA,CAAA,GAAM5X,eAAe,CAAA4D,aAAA,CAAAA,aAAA,IACzB7D,YAAY,MACfM,IAAI,CAAE,CAAC,CACPC,GAAG,CAAE,CAAEjC,CAAC,CAAE,CAAC,CAAEC,CAAC,CAAE,CAAE,CAAC,EACpB,CAAE,CAAAkY,QAAA,CACJ,YAED,CAAQ,CAAC,cACT7gB,IAAA,CAACrF,MAAM,EACLgnB,OAAO,CAAEvX,YAAY,CAACkB,UAAU,CAAG,WAAW,CAAG,UAAW,CAC5DhD,IAAI,CAAC,OAAO,CACZuQ,KAAK,CAAEzO,YAAY,CAACkB,UAAU,CAAG,SAAS,CAAG,SAAU,CACvD2W,OAAO,CAAEvF,cAAe,CACxBsF,SAAS,CAAE5X,YAAY,CAACkB,UAAU,cAAGtL,IAAA,CAAC7B,IAAI,GAAE,CAAC,cAAG6B,IAAA,CAAC5B,QAAQ,GAAE,CAAE,CAAAyiB,QAAA,CAE5DzW,YAAY,CAACkB,UAAU,CAAG,aAAa,CAAG,WAAW,CAChD,CAAC,cACTpL,KAAA,CAAC3D,WAAW,EAAC+L,IAAI,CAAC,OAAO,CAACmY,EAAE,CAAE,CAAEsC,QAAQ,CAAE,GAAI,CAAE,CAAAlC,QAAA,eAC9C7gB,IAAA,CAACxD,UAAU,EAAAqkB,QAAA,CAAC,WAAS,CAAY,CAAC,cAClC3gB,KAAA,CAACzD,MAAM,EACL4e,KAAK,CAAEjR,YAAY,CAACS,QAAS,CAC7B+b,QAAQ,CAAGlZ,CAAC,EAAKrD,eAAe,CAAA4D,aAAA,CAAAA,aAAA,IAC3B7D,YAAY,MACfS,QAAQ,CAAE6C,CAAC,CAACgE,MAAM,CAAC2J,KAAe,EACnC,CAAE,CACH5a,KAAK,CAAC,WAAW,CAAAogB,QAAA,eAEjB7gB,IAAA,CAACtD,QAAQ,EAAC2e,KAAK,CAAE,EAAG,CAAAwF,QAAA,CAAC,MAAI,CAAU,CAAC,cACpC7gB,IAAA,CAACtD,QAAQ,EAAC2e,KAAK,CAAE,GAAI,CAAAwF,QAAA,CAAC,OAAK,CAAU,CAAC,cACtC7gB,IAAA,CAACtD,QAAQ,EAAC2e,KAAK,CAAE,GAAI,CAAAwF,QAAA,CAAC,OAAK,CAAU,CAAC,cACtC7gB,IAAA,CAACtD,QAAQ,EAAC2e,KAAK,CAAE,GAAI,CAAAwF,QAAA,CAAC,OAAK,CAAU,CAAC,EAChC,CAAC,EACE,CAAC,cACd7gB,IAAA,CAACrD,gBAAgB,EACfyqB,OAAO,cACLpnB,IAAA,CAACpD,MAAM,EACLyqB,OAAO,CAAEjd,YAAY,CAACQ,QAAS,CAC/Bgc,QAAQ,CAAGlZ,CAAsC,EAAKrD,eAAe,CAAA4D,aAAA,CAAAA,aAAA,IAChE7D,YAAY,MACfQ,QAAQ,CAAE8C,CAAC,CAACgE,MAAM,CAAC2V,OAAO,EAC3B,CAAE,CACH/e,IAAI,CAAC,OAAO,CACb,CACF,CACD7H,KAAK,CAAC,WAAW,CACjBggB,EAAE,CAAE,CAAE4D,EAAE,CAAE,CAAE,CAAE,CACf,CAAC,cACFrkB,IAAA,CAACrD,gBAAgB,EACfyqB,OAAO,cACLpnB,IAAA,CAACpD,MAAM,EACLyqB,OAAO,CAAEjd,YAAY,CAACU,QAAS,CAC/B8b,QAAQ,CAAGlZ,CAAsC,EAAKrD,eAAe,CAAA4D,aAAA,CAAAA,aAAA,IAChE7D,YAAY,MACfU,QAAQ,CAAE4C,CAAC,CAACgE,MAAM,CAAC2V,OAAO,EAC3B,CAAE,CACH/e,IAAI,CAAC,OAAO,CACb,CACF,CACD7H,KAAK,CAAC,WAAW,CAClB,CAAC,cACFT,IAAA,CAACrD,gBAAgB,EACfyqB,OAAO,cACLpnB,IAAA,CAACpD,MAAM,EACLyqB,OAAO,CAAEjd,YAAY,CAACkB,UAAW,CACjCsb,QAAQ,CAAGlZ,CAAsC,EAAKrD,eAAe,CAAA4D,aAAA,CAAAA,aAAA,IAChE7D,YAAY,MACfkB,UAAU,CAAEoC,CAAC,CAACgE,MAAM,CAAC2V,OAAO,EAC7B,CAAE,CACH/e,IAAI,CAAC,OAAO,CACb,CACF,CACD7H,KAAK,CAAC,WAAW,CAClB,CAAC,cACFT,IAAA,CAACrD,gBAAgB,EACfyqB,OAAO,cACLpnB,IAAA,CAACpD,MAAM,EACLyqB,OAAO,CAAEta,gBAAiB,CAC1B6Z,QAAQ,CAAGlZ,CAAsC,EAAK,CACpDV,mBAAmB,CAACU,CAAC,CAACgE,MAAM,CAAC2V,OAAO,CAAC,CACrCzhB,oBAAoB,CAAC,CAAC,CACxB,CAAE,CACF0C,IAAI,CAAC,OAAO,CACb,CACF,CACD7H,KAAK,CAAC,mBAAmB,CAC1B,CAAC,EACC,CAAC,EACF,CACP,cAEDP,KAAA,CAAC7E,IAAI,EAACinB,IAAI,MAACvB,EAAE,CAAE,EAAG,CAAAF,QAAA,eAChB7gB,IAAA,CAACtF,GAAG,EAAC+lB,EAAE,CAAE,CAAEC,OAAO,CAAE,MAAM,CAAEC,cAAc,CAAE,eAAe,CAAEC,UAAU,CAAE,QAAQ,CAAEO,EAAE,CAAE,CAAE,CAAE,CAAAN,QAAA,cACzF3gB,KAAA,CAACjF,UAAU,EAAC0mB,OAAO,CAAC,IAAI,CAAAd,QAAA,EAAC,YAAU,CAAC3W,QAAQ,CAACvG,MAAM,CAAC,GAAC,EAAY,CAAC,CAC/D,CAAC,CAELuG,QAAQ,CAACvG,MAAM,GAAK,CAAC,cACpB3D,IAAA,CAAC9E,KAAK,EAACinB,QAAQ,CAAC,MAAM,CAAAtB,QAAA,CACnBpX,kBAAkB,CACf,8EAA8E,CAC9E,4DAA4D,CAE3D,CAAC,cAERzJ,IAAA,CAAC3E,IAAI,EAAC+mB,SAAS,MAACC,OAAO,CAAE,CAAE,CAAAxB,QAAA,CACxB3W,QAAQ,CAAC6H,GAAG,CAAEiF,OAAO,eACpBhX,IAAA,CAAC3E,IAAI,EAACinB,IAAI,MAACvB,EAAE,CAAE,EAAG,CAACiE,EAAE,CAAE,CAAE,CAAChE,EAAE,CAAE,CAAE,CAAAH,QAAA,cAC9B3gB,KAAA,CAAC9D,IAAI,EAAAykB,QAAA,eACH3gB,KAAA,CAAC7D,WAAW,EAAAwkB,QAAA,eACV3gB,KAAA,CAACxF,GAAG,EAAC+lB,EAAE,CAAE,CAAEC,OAAO,CAAE,MAAM,CAAEE,UAAU,CAAE,QAAQ,CAAEO,EAAE,CAAE,CAAE,CAAE,CAAAN,QAAA,eACxD7gB,IAAA,CAACtF,GAAG,EACF+lB,EAAE,CAAE,CACFlgB,KAAK,CAAE,EAAE,CACTC,MAAM,CAAE,EAAE,CACVumB,eAAe,CAAE/P,OAAO,CAAC6B,KAAK,CAC9BwI,YAAY,CAAE,CAAC,CACfyD,EAAE,CAAE,CACN,CAAE,CACH,CAAC,cACF9kB,IAAA,CAAC/E,UAAU,EAAC0mB,OAAO,CAAC,WAAW,CAAAd,QAAA,CAAE7J,OAAO,CAACvW,KAAK,CAAa,CAAC,EACzD,CAAC,cACNP,KAAA,CAACjF,UAAU,EAAC0mB,OAAO,CAAC,SAAS,CAAC9I,KAAK,CAAC,eAAe,CAAAgI,QAAA,EAChD7J,OAAO,CAACpO,MAAM,CAACC,IAAI,CAAC,KAAG,CAAC7D,IAAI,CAACgT,KAAK,CAAChB,OAAO,CAACvO,MAAM,CAAClI,KAAK,CAAC,CAAC,GAAC,CAACyE,IAAI,CAACgT,KAAK,CAAChB,OAAO,CAACvO,MAAM,CAACjI,MAAM,CAAC,CAC5FwW,OAAO,CAACpO,MAAM,CAACE,IAAI,cAAAyF,MAAA,CAAgByI,OAAO,CAACpO,MAAM,CAACE,IAAI,CAAC6f,SAAS,CAAC,CAAC,CAAE,EAAE,CAAC,EAAApa,MAAA,CAAGyI,OAAO,CAACpO,MAAM,CAACE,IAAI,CAACnF,MAAM,CAAG,EAAE,CAAG,KAAK,CAAG,EAAE,CAAE,CACxHqT,OAAO,CAACpO,MAAM,CAACkQ,IAAI,cAAAvK,MAAA,CAAgByI,OAAO,CAACpO,MAAM,CAACkQ,IAAI,CAAC6P,SAAS,CAAC,CAAC,CAAE,EAAE,CAAC,EAAApa,MAAA,CAAGyI,OAAO,CAACpO,MAAM,CAACkQ,IAAI,CAACnV,MAAM,CAAG,EAAE,CAAG,KAAK,CAAG,EAAE,CAAE,CACxHqT,OAAO,CAACpO,MAAM,CAACwE,GAAG,aAAAmB,MAAA,CAAeyI,OAAO,CAACpO,MAAM,CAACwE,GAAG,CAACub,SAAS,CAAC,CAAC,CAAE,EAAE,CAAC,EAAApa,MAAA,CAAGyI,OAAO,CAACpO,MAAM,CAACwE,GAAG,CAACzJ,MAAM,CAAG,EAAE,CAAG,KAAK,CAAG,EAAE,CAAE,EAC3G,CAAC,EACF,CAAC,cACdzD,KAAA,CAAC5D,WAAW,EAAAukB,QAAA,eACV7gB,IAAA,CAAC5E,UAAU,EAACkN,IAAI,CAAC,OAAO,CAAC2Z,OAAO,CAAEA,CAAA,GAAM,CACtCrW,iBAAiB,CAACoL,OAAO,CAAC,CAC1BtL,oBAAoB,CAAC,IAAI,CAAC,CAC5B,CAAE,CAAAmV,QAAA,cACA7gB,IAAA,CAAC3C,IAAI,GAAE,CAAC,CACE,CAAC,cACb2C,IAAA,CAAC5E,UAAU,EAACkN,IAAI,CAAC,OAAO,CAAC2Z,OAAO,CAAEA,CAAA,GAAMxF,mBAAmB,CAACzF,OAAO,CAAC7J,EAAE,CAAE,CAAA0T,QAAA,cACtE7gB,IAAA,CAAC5C,MAAM,GAAE,CAAC,CACA,CAAC,cACb4C,IAAA,CAACrF,MAAM,EACL2N,IAAI,CAAC,OAAO,CACZqZ,OAAO,CAAC,UAAU,CAClB9I,KAAK,CAAC,OAAO,CACboJ,OAAO,CAAEA,CAAA,GAAMxF,mBAAmB,CAACzF,OAAO,CAAC7J,EAAE,CAAE,CAC/CsT,EAAE,CAAE,CAAE4D,EAAE,CAAE,MAAO,CAAE,CAAAxD,QAAA,CACpB,QAED,CAAQ,CAAC,EACE,CAAC,EACV,CAAC,EA1C6B7J,OAAO,CAAC7J,EA2CxC,CACP,CAAC,CACE,CACP,EACG,CAAC,EACH,CACP,CAEA5D,UAAU,GAAK,UAAU,eACxBrJ,KAAA,CAAC7E,IAAI,EAAC+mB,SAAS,MAACC,OAAO,CAAE,CAAE,CAAAxB,QAAA,eACzB3gB,KAAA,CAAC7E,IAAI,EAACinB,IAAI,MAACvB,EAAE,CAAE,EAAG,CAAAF,QAAA,eAChB7gB,IAAA,CAAC/E,UAAU,EAAC0mB,OAAO,CAAC,IAAI,CAAC6F,YAAY,MAAA3G,QAAA,CAAC,mBAAiB,CAAY,CAAC,cACpE7gB,IAAA,CAAC3E,IAAI,EAAC+mB,SAAS,MAACC,OAAO,CAAE,CAAE,CAAAxB,QAAA,CACxB5T,iBAAiB,CAAC8E,GAAG,CAAEyG,QAAQ,eAC9BxY,IAAA,CAAC3E,IAAI,EAACinB,IAAI,MAACvB,EAAE,CAAE,EAAG,CAACC,EAAE,CAAE,CAAE,CAAAH,QAAA,cACvB3gB,KAAA,CAAC9D,IAAI,EAAAykB,QAAA,eACH3gB,KAAA,CAAC7D,WAAW,EAAAwkB,QAAA,eACV7gB,IAAA,CAAC/E,UAAU,EAAC0mB,OAAO,CAAC,IAAI,CAAAd,QAAA,CAAErI,QAAQ,CAACxQ,IAAI,CAAa,CAAC,cACrDhI,IAAA,CAAC/E,UAAU,EAAC0mB,OAAO,CAAC,OAAO,CAAC9I,KAAK,CAAC,eAAe,CAAC4H,EAAE,CAAE,CAAEU,EAAE,CAAE,CAAE,CAAE,CAAAN,QAAA,CAC7DrI,QAAQ,CAACtL,WAAW,CACX,CAAC,cACbhN,KAAA,CAACjF,UAAU,EAAC0mB,OAAO,CAAC,SAAS,CAAAd,QAAA,EAAC,QACtB,CAACrI,QAAQ,CAAClQ,IAAI,CAAC/H,KAAK,CAAC,GAAC,CAACiY,QAAQ,CAAClQ,IAAI,CAAC9H,MAAM,CAAC,cAAY,CAACgY,QAAQ,CAAChQ,KAAK,CAAC7E,MAAM,EAC1E,CAAC,EACF,CAAC,cACd3D,IAAA,CAAC1D,WAAW,EAAAukB,QAAA,cACV7gB,IAAA,CAACrF,MAAM,EACL2N,IAAI,CAAC,OAAO,CACZqZ,OAAO,CAAC,WAAW,CACnBM,OAAO,CAAEA,CAAA,GAAM1J,oBAAoB,CAACC,QAAQ,CAAE,CAAAqI,QAAA,CAC/C,cAED,CAAQ,CAAC,CACE,CAAC,EACV,CAAC,EApBsBrI,QAAQ,CAACxQ,IAqBlC,CACP,CAAC,CACE,CAAC,EACH,CAAC,CAEN4B,OAAO,CAACjG,MAAM,CAAG,CAAC,eACjBzD,KAAA,CAAC7E,IAAI,EAACinB,IAAI,MAACvB,EAAE,CAAE,EAAG,CAAAF,QAAA,eAChB7gB,IAAA,CAAC/E,UAAU,EAAC0mB,OAAO,CAAC,IAAI,CAAC6F,YAAY,MAAA3G,QAAA,CAAC,kBAAgB,CAAY,CAAC,cACnE7gB,IAAA,CAAChF,SAAS,EACRipB,SAAS,MACTxjB,KAAK,CAAC,gBAAgB,CACtB4a,KAAK,CAAEvT,YAAY,CAACE,IAAK,CACzB4e,QAAQ,CAAGlZ,CAAC,EAAK3F,eAAe,CAAAkG,aAAA,CAAAA,aAAA,IAAKnG,YAAY,MAAEE,IAAI,CAAE0F,CAAC,CAACgE,MAAM,CAAC2J,KAAK,EAAC,CAAE,CAC1EuI,MAAM,CAAC,QAAQ,CAChB,CAAC,cACF5jB,IAAA,CAAChF,SAAS,EACRipB,SAAS,MACTxjB,KAAK,CAAC,eAAe,CACrB4a,KAAK,CAAEvT,YAAY,CAACG,WAAY,CAChC2e,QAAQ,CAAGlZ,CAAC,EAAK3F,eAAe,CAAAkG,aAAA,CAAAA,aAAA,IAAKnG,YAAY,MAAEG,WAAW,CAAEyF,CAAC,CAACgE,MAAM,CAAC2J,KAAK,EAAC,CAAE,CACjF6I,WAAW,CAAC,iDAAiD,CAC7DC,UAAU,CAAC,0EAA0E,CACrFP,MAAM,CAAC,QAAQ,CAChB,CAAC,cACF5jB,IAAA,CAACrD,gBAAgB,EACfyqB,OAAO,cACLpnB,IAAA,CAACpD,MAAM,EACLyqB,OAAO,CAAEvf,YAAY,CAACI,gBAAiB,CACvC0e,QAAQ,CAAGlZ,CAAC,EAAK3F,eAAe,CAAAkG,aAAA,CAAAA,aAAA,IAAKnG,YAAY,MAAEI,gBAAgB,CAAEwF,CAAC,CAACgE,MAAM,CAAC2V,OAAO,EAAC,CAAE,CACzF,CACF,CACD5mB,KAAK,CAAC,oBAAoB,CAC3B,CAAC,cACFT,IAAA,CAAC/E,UAAU,EAAC0mB,OAAO,CAAC,OAAO,CAAC9I,KAAK,CAAC,gBAAgB,CAAC4H,EAAE,CAAE,CAAE4D,EAAE,CAAE,CAAC,CAAErB,EAAE,CAAE,GAAI,CAAE,CAAAnC,QAAA,CAAC,oFAE3E,CAAY,CAAC,cACb7gB,IAAA,CAAChF,SAAS,EACRipB,SAAS,MACT5I,KAAK,CAAEvT,YAAY,CAACK,IAAK,CACzBygB,SAAS,MACTC,IAAI,CAAE,CAAE,CACRjF,MAAM,CAAC,QAAQ,CACfkF,UAAU,CAAE,CAAEC,QAAQ,CAAE,IAAK,CAAE,CAC/BtoB,KAAK,CAAC,gBAAgB,CACvB,CAAC,EACE,CACP,EACG,CACP,CAEA8I,UAAU,GAAK,QAAQ,eACtBrJ,KAAA,CAAC7E,IAAI,EAAC+mB,SAAS,MAACC,OAAO,CAAE,CAAE,CAAAxB,QAAA,eACzB7gB,IAAA,CAAC3E,IAAI,EAACinB,IAAI,MAACvB,EAAE,CAAE,EAAG,CAAAF,QAAA,cAChB7gB,IAAA,CAAChF,SAAS,EACRipB,SAAS,MACTxjB,KAAK,CAAC,gBAAgB,CACtB4a,KAAK,CAAEvT,YAAY,CAACE,IAAK,CACzB4e,QAAQ,CAAGlZ,CAAC,EAAK3F,eAAe,CAAAkG,aAAA,CAAAA,aAAA,IAAKnG,YAAY,MAAEE,IAAI,CAAE0F,CAAC,CAACgE,MAAM,CAAC2J,KAAK,EAAC,CAAE,CAC1E6I,WAAW,CAAC,sBAAsB,CAClCN,MAAM,CAAC,QAAQ,CAChB,CAAC,CACE,CAAC,cACP5jB,IAAA,CAAC3E,IAAI,EAACinB,IAAI,MAACvB,EAAE,CAAE,EAAG,CAAAF,QAAA,cAChB7gB,IAAA,CAAChF,SAAS,EACRipB,SAAS,MACTxjB,KAAK,CAAC,eAAe,CACrB4a,KAAK,CAAEvT,YAAY,CAACG,WAAY,CAChC2e,QAAQ,CAAGlZ,CAAC,EAAK,CACf,KAAM,CAAA2N,KAAK,CAAG3N,CAAC,CAACgE,MAAM,CAAC2J,KAAK,CAC5B,GAAIA,KAAK,CAAC1X,MAAM,EAAI,EAAE,CAAE,CACtBoE,eAAe,CAAAkG,aAAA,CAAAA,aAAA,IAAKnG,YAAY,MAAEG,WAAW,CAAEoT,KAAK,EAAC,CAAC,CACxD,CACF,CAAE,CACF6I,WAAW,CAAC,iDAAiD,CAC7DC,UAAU,IAAA5V,MAAA,CAAKzG,YAAY,CAACG,WAAW,CAACtE,MAAM,8GAA6G,CAC3JigB,MAAM,CAAC,QAAQ,CACfsD,UAAU,CAAE,CAAEC,SAAS,CAAE,EAAG,CAAE,CAC9BxkB,KAAK,CAAEmF,YAAY,CAACG,WAAW,CAACtE,MAAM,CAAG,EAAG,CAC7C,CAAC,CACE,CAAC,cACPzD,KAAA,CAAC7E,IAAI,EAACinB,IAAI,MAACvB,EAAE,CAAE,EAAG,CAAAF,QAAA,eAChB7gB,IAAA,CAACrD,gBAAgB,EACfyqB,OAAO,cACLpnB,IAAA,CAACpD,MAAM,EACLyqB,OAAO,CAAEvf,YAAY,CAACI,gBAAiB,CACvC0e,QAAQ,CAAGlZ,CAAC,EAAK3F,eAAe,CAAAkG,aAAA,CAAAA,aAAA,IAAKnG,YAAY,MAAEI,gBAAgB,CAAEwF,CAAC,CAACgE,MAAM,CAAC2V,OAAO,EAAC,CAAE,CACzF,CACF,CACD5mB,KAAK,CAAC,oBAAoB,CAC3B,CAAC,cACFT,IAAA,CAAC/E,UAAU,EAAC0mB,OAAO,CAAC,OAAO,CAAC9I,KAAK,CAAC,gBAAgB,CAAC4H,EAAE,CAAE,CAAE4D,EAAE,CAAE,CAAC,CAAErB,EAAE,CAAE,GAAI,CAAE,CAAAnC,QAAA,CAAC,oFAE3E,CAAY,CAAC,EACT,CAAC,cACP3gB,KAAA,CAAC7E,IAAI,EAACinB,IAAI,MAACvB,EAAE,CAAE,EAAG,CAAAF,QAAA,eAChB3gB,KAAA,CAACxF,GAAG,EAAC+lB,EAAE,CAAE,CAAEC,OAAO,CAAE,MAAM,CAAEU,GAAG,CAAE,CAAC,CAAED,EAAE,CAAE,CAAE,CAAE,CAAAN,QAAA,eAC1C7gB,IAAA,CAAC/E,UAAU,EAAC0mB,OAAO,CAAC,WAAW,CAAClB,EAAE,CAAE,CAAEmB,UAAU,CAAE,GAAI,CAAE,CAAAf,QAAA,CAAC,uBAEzD,CAAY,CAAC,cACb7gB,IAAA,CAACrF,MAAM,EACL2N,IAAI,CAAC,OAAO,CACZqZ,OAAO,CAAC,UAAU,CAClBM,OAAO,CAAE,KAAAA,CAAA,GAAY,CACnB,GAAI,CACF,KAAM,CAAAnP,YAAY,CAAG1K,IAAI,CAACkL,KAAK,CAACxL,YAAY,CAACK,IAAI,CAAC,CAClD,KAAM,CAAAkG,QAAQ,CAAG,KAAM,CAAA/O,mBAAmB,CAACwT,YAAY,CAAC,CACxD,GAAIzE,QAAQ,CAACvF,IAAI,CAACjG,OAAO,CAAE,CACzBkF,eAAe,CAAAkG,aAAA,CAAAA,aAAA,IACVnG,YAAY,MACfK,IAAI,CAAEC,IAAI,CAACC,SAAS,CAACgG,QAAQ,CAACvF,IAAI,CAACkgB,cAAc,CAAE,IAAI,CAAE,CAAC,CAAC,EAC5D,CAAC,CACFlmB,UAAU,CAAC,mCAAmC,CAAC,CACjD,CACF,CAAE,MAAO6L,GAAQ,CAAE,CACjB/L,QAAQ,CAAC,wDAAwD,CAAC,CACpE,CACF,CAAE,CACF6d,EAAE,CAAE,CAAE4D,EAAE,CAAE,MAAO,CAAE,CAAAxD,QAAA,CACpB,mBAED,CAAQ,CAAC,EACN,CAAC,cACN7gB,IAAA,CAAChF,SAAS,EACRipB,SAAS,MACT5I,KAAK,CAAEvT,YAAY,CAACK,IAAK,CACzBye,QAAQ,CAAGlZ,CAAC,EAAK3F,eAAe,CAAAkG,aAAA,CAAAA,aAAA,IAAKnG,YAAY,MAAEK,IAAI,CAAEuF,CAAC,CAACgE,MAAM,CAAC2J,KAAK,EAAC,CAAE,CAC1EuN,SAAS,MACTC,IAAI,CAAE,CAAE,CACR3E,WAAW,CAAC,6SAW5B,CACgBC,UAAU,CAAC,yFAAyF,CACpGP,MAAM,CAAC,QAAQ,CAChB,CAAC,EACE,CAAC,EACH,CACP,CAEAra,UAAU,GAAK,QAAQ,eACtBrJ,KAAA,CAAC7E,IAAI,EAAC+mB,SAAS,MAACC,OAAO,CAAE,CAAE,CAAAxB,QAAA,eACzB3gB,KAAA,CAAC7E,IAAI,EAACinB,IAAI,MAACvB,EAAE,CAAE,EAAG,CAAAF,QAAA,eAChB7gB,IAAA,CAAC/E,UAAU,EAAC0mB,OAAO,CAAC,IAAI,CAAC6F,YAAY,MAAA3G,QAAA,CAAC,uBAAqB,CAAY,CAAC,cACxE7gB,IAAA,CAAC9E,KAAK,EAACinB,QAAQ,CAAC,MAAM,CAAC1B,EAAE,CAAE,CAAEU,EAAE,CAAE,CAAE,CAAE,CAAAN,QAAA,cACnC3gB,KAAA,CAACjF,UAAU,EAAC0mB,OAAO,CAAC,OAAO,CAAAd,QAAA,eACzB7gB,IAAA,WAAA6gB,QAAA,CAAQ,eAAa,CAAQ,CAAC,cAC9B7gB,IAAA,QAAK,CAAC,yCAEN,cAAAA,IAAA,QAAK,CAAC,sDAEN,cAAAA,IAAA,QAAK,CAAC,kEAER,EAAY,CAAC,CACR,CAAC,EACJ,CAAC,cACPA,IAAA,CAAC3E,IAAI,EAACinB,IAAI,MAACvB,EAAE,CAAE,EAAG,CAAAF,QAAA,cAChB7gB,IAAA,CAAChF,SAAS,EACRipB,SAAS,MACTxjB,KAAK,CAAC,gBAAgB,CACtB4a,KAAK,CAAE9O,cAAe,CACtBqa,QAAQ,CAAGlZ,CAAC,EAAKlB,iBAAiB,CAACkB,CAAC,CAACgE,MAAM,CAAC2J,KAAK,CAAE,CACnD6I,WAAW,CAAC,mCAAmC,CAC/C0E,SAAS,MACTC,IAAI,CAAE,EAAG,CACTjF,MAAM,CAAC,QAAQ,CAChB,CAAC,CACE,CAAC,cACP5jB,IAAA,CAAC3E,IAAI,EAACinB,IAAI,MAACvB,EAAE,CAAE,EAAG,CAAAF,QAAA,cAChB3gB,KAAA,CAACxF,GAAG,EAAC+lB,EAAE,CAAE,CAAEC,OAAO,CAAE,MAAM,CAAEU,GAAG,CAAE,CAAC,CAAE2C,QAAQ,CAAE,MAAO,CAAE,CAAAlD,QAAA,eACrD7gB,IAAA,CAACrF,MAAM,EACLgnB,OAAO,CAAC,WAAW,CACnBM,OAAO,CAAElJ,gBAAiB,CAC1BiJ,SAAS,cAAEhiB,IAAA,CAAC/B,WAAW,GAAE,CAAE,CAC3BikB,QAAQ,CAAE,CAAC3V,cAAc,CAAC2D,IAAI,CAAC,CAAE,CAAA2Q,QAAA,CAClC,2BAED,CAAQ,CAAC,cACT7gB,IAAA,CAACrF,MAAM,EACLgnB,OAAO,CAAC,UAAU,CAClBM,OAAO,CAAEhJ,qBAAsB,CAC/B+I,SAAS,cAAEhiB,IAAA,CAAC5C,MAAM,GAAE,CAAE,CACtB8kB,QAAQ,CAAE,CAACvV,oBAAqB,CAAAkU,QAAA,CACjC,yBAED,CAAQ,CAAC,cACT7gB,IAAA,CAACrD,gBAAgB,EACfyqB,OAAO,cACLpnB,IAAA,CAACpD,MAAM,EACLyqB,OAAO,CAAE1a,oBAAqB,CAC9Bia,QAAQ,CAAGlZ,CAAC,EAAKd,uBAAuB,CAACc,CAAC,CAACgE,MAAM,CAAC2V,OAAO,CAAE,CAC3DnF,QAAQ,CAAEzV,gBAAgB,CAAC9I,MAAM,GAAK,CAAE,CACzC,CACF,CACDlD,KAAK,CAAC,wBAAwB,CAC/B,CAAC,EACC,CAAC,CACF,CAAC,CACNkM,oBAAoB,EAAIF,gBAAgB,CAAC9I,MAAM,CAAG,CAAC,eAClD3D,IAAA,CAAC3E,IAAI,EAACinB,IAAI,MAACvB,EAAE,CAAE,EAAG,CAAAF,QAAA,cAChB7gB,IAAA,CAAC9E,KAAK,EAACinB,QAAQ,CAAC,SAAS,CAAAtB,QAAA,cACvB3gB,KAAA,CAACjF,UAAU,EAAC0mB,OAAO,CAAC,OAAO,CAAAd,QAAA,eACzB3gB,KAAA,WAAA2gB,QAAA,EAAQ,WAAS,CAACpU,gBAAgB,CAAC9I,MAAM,CAAC,YAAU,EAAQ,CAAC,cAC7D3D,IAAA,QAAK,CAAC,iEAEN,cAAAA,IAAA,QAAK,CAAC,gDAEN,cAAAA,IAAA,QAAK,CAAC,2EAER,EAAY,CAAC,CACR,CAAC,CACJ,CACP,EACG,CACP,EACY,CAAC,cAChBE,KAAA,CAACnF,aAAa,EAAA8lB,QAAA,eACZ7gB,IAAA,CAACrF,MAAM,EAACsnB,OAAO,CAAEA,CAAA,GAAM,CACrBta,mBAAmB,CAAC,KAAK,CAAC,CAC1B8M,eAAe,CAAC,CAAC,CACjB5K,UAAU,CAAC,EAAE,CAAC,CACdH,qBAAqB,CAAC,EAAE,CAAC,CAC3B,CAAE,CAAAmX,QAAA,CAAC,QAEH,CAAQ,CAAC,cACT7gB,IAAA,CAACrF,MAAM,EACLsnB,OAAO,CAAEA,CAAA,GAAM,CACbvc,OAAO,CAACC,GAAG,CAAC,iBAAiB,CAAC,CAC9BD,OAAO,CAACC,GAAG,CAAC,aAAa,CAAE4D,UAAU,CAAC,CACtC7D,OAAO,CAACC,GAAG,CAAC,WAAW,CAAEiC,QAAQ,CAAC,CAClClC,OAAO,CAACC,GAAG,CAAC,oBAAoB,CAAEmC,YAAY,CAACE,IAAI,CAAC,CACpDtC,OAAO,CAACC,GAAG,CAAC,kBAAkB,CAAEuE,QAAQ,CAACvG,MAAM,CAAC,CAChD+B,OAAO,CAACC,GAAG,CAAC,kBAAkB,CAAEiC,QAAQ,EAAI,CAACE,YAAY,CAACE,IAAI,CAACkI,IAAI,CAAC,CAAC,EAAK3G,UAAU,GAAK,QAAQ,EAAIW,QAAQ,CAACvG,MAAM,GAAK,CAAE,CAAC,CAE5H,GAAI4F,UAAU,GAAK,QAAQ,CAAE,CAC3B0V,kBAAkB,CAAC,CAAC,CACtB,CAAC,IAAM,CACL5L,oBAAoB,CAAC,CAAC,CACxB,CACF,CAAE,CACFsO,OAAO,CAAC,WAAW,CACnBO,QAAQ,CAAEta,QAAQ,EAAI,CAACE,YAAY,CAACE,IAAI,CAACkI,IAAI,CAAC,CAAC,EAAK3G,UAAU,GAAK,QAAQ,GAAKW,QAAQ,CAACvG,MAAM,GAAK,CAAC,EAAI,CAACI,mBAAmB,CAAG,CAChIie,SAAS,CAAEpa,QAAQ,cAAG5H,IAAA,CAAChD,gBAAgB,EAACsL,IAAI,CAAE,EAAG,CAAE,CAAC,cAAGtI,IAAA,CAAC7C,GAAG,GAAE,CAAE,CAAA0jB,QAAA,CAE9DjZ,QAAQ,CAAG,aAAa,CAAG,kBAAkB,CACxC,CAAC,EACI,CAAC,EACV,CAAC,cAGT1H,KAAA,CAACtF,MAAM,EAAC4pB,IAAI,CAAEzb,gBAAiB,CAAC0b,OAAO,CAAEA,CAAA,GAAMzb,mBAAmB,CAAC,KAAK,CAAE,CAAC0b,QAAQ,CAAC,IAAI,CAACT,SAAS,MAAApD,QAAA,eAChG7gB,IAAA,CAACnF,WAAW,EAAAgmB,QAAA,CACTxX,yBAAyB,SAAzBA,yBAAyB,WAAzBA,yBAAyB,CAAE2L,QAAQ,CAAG,wBAAwB,CAAG,wBAAwB,CAC/E,CAAC,cACd9U,KAAA,CAACpF,aAAa,EAAA+lB,QAAA,EACXxX,yBAAyB,eACxBnJ,KAAA,CAACxF,GAAG,EAAC+lB,EAAE,CAAE,CAAEU,EAAE,CAAE,CAAE,CAAE,CAAAN,QAAA,eACjB3gB,KAAA,CAACjF,UAAU,EAAC0mB,OAAO,CAAC,WAAW,CAAClB,EAAE,CAAE,CAAEmB,UAAU,CAAE,GAAI,CAAE,CAAAf,QAAA,EAAC,aAC5C,CAACxX,yBAAyB,CAACrB,IAAI,EAChC,CAAC,cACb9H,KAAA,CAACjF,UAAU,EAAC0mB,OAAO,CAAC,OAAO,CAAC9I,KAAK,CAAC,gBAAgB,CAAAgI,QAAA,EAAC,MAC7C,CAACxX,yBAAyB,CAAC+G,UAAU,EAC/B,CAAC,EACV,CACN,cAEDpQ,IAAA,CAAC/E,UAAU,EAAC0mB,OAAO,CAAC,WAAW,CAAClB,EAAE,CAAE,CAAEmB,UAAU,CAAE,GAAG,CAAET,EAAE,CAAE,CAAC,CAAEtI,KAAK,CAAE,YAAa,CAAE,CAAAgI,QAAA,CAAC,8BAErF,CAAY,CAAC,CACZ,CAAAxX,yBAAyB,SAAzBA,yBAAyB,iBAAzBA,yBAAyB,CAAE2L,QAAQ,gBAClChV,IAAA,CAAC9E,KAAK,EAACinB,QAAQ,CAAC,SAAS,CAAC1B,EAAE,CAAE,CAAEU,EAAE,CAAE,CAAE,CAAE,CAAAN,QAAA,cACtC3gB,KAAA,CAACjF,UAAU,EAAC0mB,OAAO,CAAC,OAAO,CAAAd,QAAA,eACzB7gB,IAAA,WAAA6gB,QAAA,CAAQ,OAAK,CAAQ,CAAC,4MAGxB,EAAY,CAAC,CACR,CACR,cACD3gB,KAAA,CAACxF,GAAG,EAAC+lB,EAAE,CAAE,CAAEC,OAAO,CAAE,MAAM,CAAEE,UAAU,CAAE,QAAQ,CAAEQ,GAAG,CAAE,CAAC,CAAED,EAAE,CAAE,CAAE,CAAE,CAAAN,QAAA,eAChE7gB,IAAA,UACEynB,MAAM,CAAC,SAAS,CAChB/D,KAAK,CAAE,CAAEhD,OAAO,CAAE,MAAO,CAAE,CAC3BvT,EAAE,CAAC,wBAAwB,CAC3BtE,IAAI,CAAC,MAAM,CACX+d,QAAQ,CAAE3G,gBAAiB,CAC5B,CAAC,cACFjgB,IAAA,UAAO2nB,OAAO,CAAC,wBAAwB,CAAA9G,QAAA,cACrC7gB,IAAA,CAACrF,MAAM,EACLgnB,OAAO,CAAC,UAAU,CAClBa,SAAS,CAAC,MAAM,CAChBR,SAAS,cAAEhiB,IAAA,CAAC/B,WAAW,GAAE,CAAE,CAC3B4a,KAAK,CAAE1P,YAAY,CAAG,SAAS,CAAG,SAAU,CAAA0X,QAAA,CAE3C1X,YAAY,CAAG,kBAAkB,CAAG,cAAc,CAC7C,CAAC,CACJ,CAAC,CACPA,YAAY,eACXjJ,KAAA,CAACjF,UAAU,EAAC0mB,OAAO,CAAC,OAAO,CAAC9I,KAAK,CAAC,cAAc,CAAC4H,EAAE,CAAE,CAAEmB,UAAU,CAAE,GAAI,CAAE,CAAAf,QAAA,EAAC,SACtE,CAAC1X,YAAY,CAACnB,IAAI,CAAC,IAAE,CAAChD,IAAI,CAACgT,KAAK,CAAC7O,YAAY,CAACb,IAAI,CAAG,IAAI,CAAC,CAAC,KAC/D,EAAY,CACb,CACA,CAACa,YAAY,eACZnJ,IAAA,CAAC/E,UAAU,EAAC0mB,OAAO,CAAC,OAAO,CAAC9I,KAAK,CAAC,YAAY,CAAAgI,QAAA,CAAC,6CAE/C,CAAY,CACb,EACE,CAAC,cAEN7gB,IAAA,CAAC9E,KAAK,EAACinB,QAAQ,CAAC,MAAM,CAAAtB,QAAA,cACpB3gB,KAAA,CAACjF,UAAU,EAAC0mB,OAAO,CAAC,OAAO,CAAAd,QAAA,eACzB7gB,IAAA,WAAA6gB,QAAA,CAAQ,qBAAmB,CAAQ,CAAC,cACpC7gB,IAAA,QAAK,CAAC,2CAEN,cAAAA,IAAA,QAAK,CAAC,4BACc,CAACqJ,yBAAyB,SAAzBA,yBAAyB,iBAAzBA,yBAAyB,CAAEf,IAAI,CAAC/H,KAAK,CAAC,MAAC,CAAC8I,yBAAyB,SAAzBA,yBAAyB,iBAAzBA,yBAAyB,CAAEf,IAAI,CAAC9H,MAAM,CAAC,SACpG,cAAAR,IAAA,QAAK,CAAC,8BAER,EAAY,CAAC,CACR,CAAC,EACK,CAAC,cAChBE,KAAA,CAACnF,aAAa,EAAA8lB,QAAA,eACZ7gB,IAAA,CAACrF,MAAM,EAACsnB,OAAO,CAAEA,CAAA,GAAM,CACrBjZ,mBAAmB,CAAC,KAAK,CAAC,CAC1BI,eAAe,CAAC,IAAI,CAAC,CACvB,CAAE,CAAAyX,QAAA,CAAC,QAEH,CAAQ,CAAC,cACT7gB,IAAA,CAACrF,MAAM,EACLsnB,OAAO,CAAE,KAAAA,CAAA,GAAY,CACnB,GAAI5Y,yBAAyB,EAAIF,YAAY,CAAE,CAC7C,KAAM,CAAA0L,iBAAiB,CAACxL,yBAAyB,CAAC+G,UAAU,CAAC,CAC7DpH,mBAAmB,CAAC,KAAK,CAAC,CAC1BI,eAAe,CAAC,IAAI,CAAC,CACrBE,4BAA4B,CAAC,IAAI,CAAC,CACpC,CACF,CAAE,CACFqY,OAAO,CAAC,WAAW,CACnBO,QAAQ,CAAE,CAAC/Y,YAAa,CACxB6Y,SAAS,CAAE/Y,cAAc,cAAGjJ,IAAA,CAAChD,gBAAgB,EAACsL,IAAI,CAAE,EAAG,CAAE,CAAC,cAAGtI,IAAA,CAAC/B,WAAW,GAAE,CAAE,CAAA4iB,QAAA,CAE5E5X,cAAc,CAAG,eAAe,CAAII,yBAAyB,SAAzBA,yBAAyB,WAAzBA,yBAAyB,CAAE2L,QAAQ,CAAG,cAAc,CAAG,cAAe,CACrG,CAAC,EACI,CAAC,EACV,CAAC,cAGT9U,KAAA,CAACtF,MAAM,EAAC4pB,IAAI,CAAE1a,gBAAiB,CAAC2a,OAAO,CAAEA,CAAA,GAAM1a,mBAAmB,CAAC,KAAK,CAAE,CAAC2a,QAAQ,CAAC,IAAI,CAACT,SAAS,MAAApD,QAAA,eAChG7gB,IAAA,CAACnF,WAAW,EAAAgmB,QAAA,CACT7W,aAAa,CAAG,aAAa,CAAG,YAAY,CAClC,CAAC,cACdhK,IAAA,CAAClF,aAAa,EAAA+lB,QAAA,cACZ3gB,KAAA,CAAC7E,IAAI,EAAC+mB,SAAS,MAACC,OAAO,CAAE,CAAE,CAAAxB,QAAA,eACzB7gB,IAAA,CAAC3E,IAAI,EAACinB,IAAI,MAACvB,EAAE,CAAE,EAAG,CAAAF,QAAA,cAChB7gB,IAAA,CAAChF,SAAS,EACRipB,SAAS,MACTxjB,KAAK,CAAC,cAAc,CACpB4a,KAAK,CAAE,CAAArR,aAAa,SAAbA,aAAa,iBAAbA,aAAa,CAAEvJ,KAAK,GAAI,EAAG,CAClCmmB,QAAQ,CAAGlZ,CAAC,EAAKzD,gBAAgB,CAACD,aAAa,CAAAiE,aAAA,CAAAA,aAAA,IAAOjE,aAAa,MAAEvJ,KAAK,CAAEiN,CAAC,CAACgE,MAAM,CAAC2J,KAAK,GAAI,IAAI,CAAE,CACpG6I,WAAW,CAAC,oBAAoB,CAChCN,MAAM,CAAC,QAAQ,CAChB,CAAC,CACE,CAAC,cAEP1jB,KAAA,CAAC7E,IAAI,EAACinB,IAAI,MAACvB,EAAE,CAAE,EAAG,CAAAF,QAAA,eAChB7gB,IAAA,CAAC/E,UAAU,EAAC0mB,OAAO,CAAC,IAAI,CAAC6F,YAAY,MAAA3G,QAAA,CAAC,wBAAsB,CAAY,CAAC,cACzE3gB,KAAA,CAAC7E,IAAI,EAAC+mB,SAAS,MAACC,OAAO,CAAE,CAAE,CAAAxB,QAAA,eACzB7gB,IAAA,CAAC3E,IAAI,EAACinB,IAAI,MAACvB,EAAE,CAAE,CAAE,CAAAF,QAAA,cACf7gB,IAAA,CAAChF,SAAS,EACRipB,SAAS,MACTxjB,KAAK,CAAC,YAAY,CAClBoI,IAAI,CAAC,QAAQ,CACbwS,KAAK,CAAE,CAAArR,aAAa,SAAbA,aAAa,iBAAbA,aAAa,CAAEvB,MAAM,CAACC,CAAC,GAAI,CAAE,CACpCke,QAAQ,CAAGlZ,CAAC,EAAKzD,gBAAgB,CAACD,aAAa,CAAAiE,aAAA,CAAAA,aAAA,IAC1CjE,aAAa,MAChBvB,MAAM,CAAAwF,aAAA,CAAAA,aAAA,IAAMjE,aAAa,CAACvB,MAAM,MAAEC,CAAC,CAAE2R,QAAQ,CAAC3M,CAAC,CAACgE,MAAM,CAAC2J,KAAK,CAAC,EAAI,CAAC,EAAC,GACjE,IAAI,CAAE,CACVuI,MAAM,CAAC,QAAQ,CAChB,CAAC,CACE,CAAC,cACP5jB,IAAA,CAAC3E,IAAI,EAACinB,IAAI,MAACvB,EAAE,CAAE,CAAE,CAAAF,QAAA,cACf7gB,IAAA,CAAChF,SAAS,EACRipB,SAAS,MACTxjB,KAAK,CAAC,YAAY,CAClBoI,IAAI,CAAC,QAAQ,CACbwS,KAAK,CAAE,CAAArR,aAAa,SAAbA,aAAa,iBAAbA,aAAa,CAAEvB,MAAM,CAACE,CAAC,GAAI,CAAE,CACpCie,QAAQ,CAAGlZ,CAAC,EAAKzD,gBAAgB,CAACD,aAAa,CAAAiE,aAAA,CAAAA,aAAA,IAC1CjE,aAAa,MAChBvB,MAAM,CAAAwF,aAAA,CAAAA,aAAA,IAAMjE,aAAa,CAACvB,MAAM,MAAEE,CAAC,CAAE0R,QAAQ,CAAC3M,CAAC,CAACgE,MAAM,CAAC2J,KAAK,CAAC,EAAI,CAAC,EAAC,GACjE,IAAI,CAAE,CACVuI,MAAM,CAAC,QAAQ,CAChB,CAAC,CACE,CAAC,cACP5jB,IAAA,CAAC3E,IAAI,EAACinB,IAAI,MAACvB,EAAE,CAAE,CAAE,CAAAF,QAAA,cACf7gB,IAAA,CAAChF,SAAS,EACRipB,SAAS,MACTxjB,KAAK,CAAC,OAAO,CACboI,IAAI,CAAC,QAAQ,CACbwS,KAAK,CAAE,CAAArR,aAAa,SAAbA,aAAa,iBAAbA,aAAa,CAAEvB,MAAM,CAAClI,KAAK,GAAI,GAAI,CAC1CqmB,QAAQ,CAAGlZ,CAAC,EAAKzD,gBAAgB,CAACD,aAAa,CAAAiE,aAAA,CAAAA,aAAA,IAC1CjE,aAAa,MAChBvB,MAAM,CAAAwF,aAAA,CAAAA,aAAA,IAAMjE,aAAa,CAACvB,MAAM,MAAElI,KAAK,CAAE8Z,QAAQ,CAAC3M,CAAC,CAACgE,MAAM,CAAC2J,KAAK,CAAC,EAAI,GAAG,EAAC,GACvE,IAAI,CAAE,CACVuI,MAAM,CAAC,QAAQ,CAChB,CAAC,CACE,CAAC,cACP5jB,IAAA,CAAC3E,IAAI,EAACinB,IAAI,MAACvB,EAAE,CAAE,CAAE,CAAAF,QAAA,cACf7gB,IAAA,CAAChF,SAAS,EACRipB,SAAS,MACTxjB,KAAK,CAAC,QAAQ,CACdoI,IAAI,CAAC,QAAQ,CACbwS,KAAK,CAAE,CAAArR,aAAa,SAAbA,aAAa,iBAAbA,aAAa,CAAEvB,MAAM,CAACjI,MAAM,GAAI,GAAI,CAC3ComB,QAAQ,CAAGlZ,CAAC,EAAKzD,gBAAgB,CAACD,aAAa,CAAAiE,aAAA,CAAAA,aAAA,IAC1CjE,aAAa,MAChBvB,MAAM,CAAAwF,aAAA,CAAAA,aAAA,IAAMjE,aAAa,CAACvB,MAAM,MAAEjI,MAAM,CAAE6Z,QAAQ,CAAC3M,CAAC,CAACgE,MAAM,CAAC2J,KAAK,CAAC,EAAI,GAAG,EAAC,GACxE,IAAI,CAAE,CACVuI,MAAM,CAAC,QAAQ,CAChB,CAAC,CACE,CAAC,EACH,CAAC,EACH,CAAC,cAEP1jB,KAAA,CAAC7E,IAAI,EAACinB,IAAI,MAACvB,EAAE,CAAE,EAAG,CAAAF,QAAA,eAChB7gB,IAAA,CAAC/E,UAAU,EAAC0mB,OAAO,CAAC,IAAI,CAAC6F,YAAY,MAAA3G,QAAA,CAAC,eAAa,CAAY,CAAC,cAChE3gB,KAAA,CAAC3D,WAAW,EAAC0nB,SAAS,MAACL,MAAM,CAAC,QAAQ,CAAA/C,QAAA,eACpC7gB,IAAA,CAACxD,UAAU,EAAAqkB,QAAA,CAAC,aAAW,CAAY,CAAC,cACpC3gB,KAAA,CAACzD,MAAM,EACL4e,KAAK,CAAE,CAAArR,aAAa,SAAbA,aAAa,iBAAbA,aAAa,CAAEpB,MAAM,CAACC,IAAI,GAAI,UAAW,CAChD+d,QAAQ,CAAGlZ,CAAC,EAAKzD,gBAAgB,CAACD,aAAa,CAAAiE,aAAA,CAAAA,aAAA,IAC1CjE,aAAa,MAChBpB,MAAM,CAAAqF,aAAA,CAAAA,aAAA,IAAOjE,aAAa,CAACpB,MAAM,MAAEC,IAAI,CAAE6E,CAAC,CAACgE,MAAM,CAAC2J,KAAY,EAAE,GAC9D,IAAI,CAAE,CAAAwF,QAAA,eAEV7gB,IAAA,CAACtD,QAAQ,EAAC2e,KAAK,CAAC,UAAU,CAAAwF,QAAA,CAAC,UAAQ,CAAU,CAAC,cAC9C7gB,IAAA,CAACtD,QAAQ,EAAC2e,KAAK,CAAC,SAAS,CAAAwF,QAAA,CAAC,SAAO,CAAU,CAAC,cAC5C7gB,IAAA,CAACtD,QAAQ,EAAC2e,KAAK,CAAC,KAAK,CAAAwF,QAAA,CAAC,KAAG,CAAU,CAAC,cACpC7gB,IAAA,CAACtD,QAAQ,EAAC2e,KAAK,CAAC,gBAAgB,CAAAwF,QAAA,CAAC,kBAAgB,CAAU,CAAC,EACtD,CAAC,EACE,CAAC,EACV,CAAC,CAEN,CAAA7W,aAAa,SAAbA,aAAa,iBAAbA,aAAa,CAAEpB,MAAM,CAACC,IAAI,IAAK,UAAU,eACxC7I,IAAA,CAAC3E,IAAI,EAACinB,IAAI,MAACvB,EAAE,CAAE,EAAG,CAAAF,QAAA,cAChB7gB,IAAA,CAAChF,SAAS,EACRipB,SAAS,MACTxjB,KAAK,CAAC,eAAe,CACrB4a,KAAK,CAAErR,aAAa,CAACpB,MAAM,CAACE,IAAI,EAAI,EAAG,CACvC8d,QAAQ,CAAGlZ,CAAC,EAAKzD,gBAAgB,CAACD,aAAa,CAAAiE,aAAA,CAAAA,aAAA,IAC1CjE,aAAa,MAChBpB,MAAM,CAAAqF,aAAA,CAAAA,aAAA,IAAOjE,aAAa,CAACpB,MAAM,MAAEE,IAAI,CAAE4E,CAAC,CAACgE,MAAM,CAAC2J,KAAK,EAAE,GACvD,IAAI,CAAE,CACV6I,WAAW,CAAC,oBAAoB,CAChCN,MAAM,CAAC,QAAQ,CAChB,CAAC,CACE,CACP,CAEA,CAAA5Z,aAAa,SAAbA,aAAa,iBAAbA,aAAa,CAAEpB,MAAM,CAACC,IAAI,IAAK,SAAS,eACvC7I,IAAA,CAAC3E,IAAI,EAACinB,IAAI,MAACvB,EAAE,CAAE,EAAG,CAAAF,QAAA,cAChB7gB,IAAA,CAAChF,SAAS,EACRipB,SAAS,MACTxjB,KAAK,CAAC,cAAc,CACpB4a,KAAK,CAAErR,aAAa,CAACpB,MAAM,CAACkQ,IAAI,EAAI,EAAG,CACvC8N,QAAQ,CAAGlZ,CAAC,EAAKzD,gBAAgB,CAACD,aAAa,CAAAiE,aAAA,CAAAA,aAAA,IAC1CjE,aAAa,MAChBpB,MAAM,CAAAqF,aAAA,CAAAA,aAAA,IAAOjE,aAAa,CAACpB,MAAM,MAAEkQ,IAAI,CAAEpL,CAAC,CAACgE,MAAM,CAAC2J,KAAK,EAAE,GACvD,IAAI,CAAE,CACV6I,WAAW,CAAC,eAAe,CAC3BN,MAAM,CAAC,QAAQ,CAChB,CAAC,CACE,CACP,CAEA,CAAA5Z,aAAa,SAAbA,aAAa,iBAAbA,aAAa,CAAEpB,MAAM,CAACC,IAAI,IAAK,KAAK,eACnC7I,IAAA,CAAC3E,IAAI,EAACinB,IAAI,MAACvB,EAAE,CAAE,EAAG,CAAAF,QAAA,cAChB7gB,IAAA,CAAChF,SAAS,EACRipB,SAAS,MACTxjB,KAAK,CAAC,KAAK,CACX4a,KAAK,CAAErR,aAAa,CAACpB,MAAM,CAACwE,GAAG,EAAI,EAAG,CACtCwZ,QAAQ,CAAGlZ,CAAC,EAAKzD,gBAAgB,CAACD,aAAa,CAAAiE,aAAA,CAAAA,aAAA,IAC1CjE,aAAa,MAChBpB,MAAM,CAAAqF,aAAA,CAAAA,aAAA,IAAOjE,aAAa,CAACpB,MAAM,MAAEwE,GAAG,CAAEM,CAAC,CAACgE,MAAM,CAAC2J,KAAK,EAAE,GACtD,IAAI,CAAE,CACV6I,WAAW,CAAC,qBAAqB,CACjCN,MAAM,CAAC,QAAQ,CAChB,CAAC,CACE,CACP,CAEA,CAAA5Z,aAAa,SAAbA,aAAa,iBAAbA,aAAa,CAAEpB,MAAM,CAACC,IAAI,IAAK,gBAAgB,eAC9C3I,KAAA,CAAAE,SAAA,EAAAygB,QAAA,eACE7gB,IAAA,CAAC3E,IAAI,EAACinB,IAAI,MAACvB,EAAE,CAAE,CAAE,CAAAF,QAAA,cACf7gB,IAAA,CAAChF,SAAS,EACRipB,SAAS,MACTxjB,KAAK,CAAC,oBAAoB,CAC1B4a,KAAK,CAAErR,aAAa,CAACpB,MAAM,CAACyE,eAAe,EAAI,EAAG,CAClDuZ,QAAQ,CAAGlZ,CAAC,EAAKzD,gBAAgB,CAACD,aAAa,CAAAiE,aAAA,CAAAA,aAAA,IAC1CjE,aAAa,MAChBpB,MAAM,CAAAqF,aAAA,CAAAA,aAAA,IAAOjE,aAAa,CAACpB,MAAM,MAAEyE,eAAe,CAAEK,CAAC,CAACgE,MAAM,CAAC2J,KAAK,EAAE,GAClE,IAAI,CAAE,CACV6I,WAAW,CAAC,WAAW,CACvBN,MAAM,CAAC,QAAQ,CACfO,UAAU,CAAC,uEAAuE,CAClFxhB,KAAK,CAAEqH,aAAa,CAACpB,MAAM,CAACyE,eAAe,CAAG,CAAC5J,uBAAuB,CAACuG,aAAa,CAACpB,MAAM,CAACyE,eAAe,CAAC,CAAG,KAAM,CACtH,CAAC,CACE,CAAC,cACPrN,IAAA,CAAC3E,IAAI,EAACinB,IAAI,MAACvB,EAAE,CAAE,CAAE,CAAAF,QAAA,cACf7gB,IAAA,CAAChF,SAAS,EACRipB,SAAS,MACTxjB,KAAK,CAAC,aAAa,CACnB4a,KAAK,CAAErR,aAAa,CAACpB,MAAM,CAACE,IAAI,EAAI,EAAG,CACvC8d,QAAQ,CAAGlZ,CAAC,EAAKzD,gBAAgB,CAACD,aAAa,CAAAiE,aAAA,CAAAA,aAAA,IAC1CjE,aAAa,MAChBpB,MAAM,CAAAqF,aAAA,CAAAA,aAAA,IAAOjE,aAAa,CAACpB,MAAM,MAAEE,IAAI,CAAE4E,CAAC,CAACgE,MAAM,CAAC2J,KAAK,EAAE,GACvD,IAAI,CAAE,CACV6I,WAAW,CAAC,gBAAgB,CAC5BN,MAAM,CAAC,QAAQ,CAChB,CAAC,CACE,CAAC,EACP,CACH,EACG,CAAC,CACM,CAAC,cAChB1jB,KAAA,CAACnF,aAAa,EAAA8lB,QAAA,eACZ7gB,IAAA,CAACrF,MAAM,EAACsnB,OAAO,CAAEA,CAAA,GAAMlY,mBAAmB,CAAC,KAAK,CAAE,CAAA8W,QAAA,CAAC,QAAM,CAAQ,CAAC,cAClE7gB,IAAA,CAACrF,MAAM,EACLsnB,OAAO,CAAEA,CAAA,GAAMjY,aAAa,EAAI6U,iBAAiB,CAAC7U,aAAoB,CAAE,CACxE2X,OAAO,CAAC,WAAW,CACnBO,QAAQ,CAAE,EAAClY,aAAa,SAAbA,aAAa,YAAA7H,oBAAA,CAAb6H,aAAa,CAAEvJ,KAAK,UAAA0B,oBAAA,WAApBA,oBAAA,CAAsB+N,IAAI,CAAC,CAAC,CAAC,CAAA2Q,QAAA,CACzC,aAED,CAAQ,CAAC,EACI,CAAC,EACV,CAAC,cAGT3gB,KAAA,CAACtF,MAAM,EAAC4pB,IAAI,CAAE/Y,iBAAkB,CAACgZ,OAAO,CAAEA,CAAA,GAAM/Y,oBAAoB,CAAC,KAAK,CAAE,CAACgZ,QAAQ,CAAC,IAAI,CAACT,SAAS,MAAApD,QAAA,eAClG7gB,IAAA,CAACnF,WAAW,EAAAgmB,QAAA,CACTlV,cAAc,CAAG,cAAc,CAAG,aAAa,CACrC,CAAC,cACd3L,IAAA,CAAClF,aAAa,EAAA+lB,QAAA,cACZ3gB,KAAA,CAAC7E,IAAI,EAAC+mB,SAAS,MAACC,OAAO,CAAE,CAAE,CAAAxB,QAAA,eACzB7gB,IAAA,CAAC3E,IAAI,EAACinB,IAAI,MAACvB,EAAE,CAAE,EAAG,CAAAF,QAAA,cAChB7gB,IAAA,CAAChF,SAAS,EACRipB,SAAS,MACTxjB,KAAK,CAAC,eAAe,CACrB4a,KAAK,CAAE,CAAA1P,cAAc,SAAdA,cAAc,iBAAdA,cAAc,CAAElL,KAAK,GAAI,EAAG,CACnCmmB,QAAQ,CAAGlZ,CAAC,EAAK9B,iBAAiB,CAACD,cAAc,CAAAsC,aAAA,CAAAA,aAAA,IAC5CtC,cAAc,MACjBlL,KAAK,CAAEiN,CAAC,CAACgE,MAAM,CAAC2J,KAAK,GACnB,IAAI,CAAE,CACV6I,WAAW,CAAC,qBAAqB,CACjCN,MAAM,CAAC,QAAQ,CAChB,CAAC,CACE,CAAC,cACP1jB,KAAA,CAAC7E,IAAI,EAACinB,IAAI,MAACvB,EAAE,CAAE,EAAG,CAAAF,QAAA,eAChB7gB,IAAA,CAAC/E,UAAU,EAAC0mB,OAAO,CAAC,IAAI,CAAC6F,YAAY,MAAA3G,QAAA,CAAC,yBAAuB,CAAY,CAAC,cAC1E3gB,KAAA,CAAC7E,IAAI,EAAC+mB,SAAS,MAACC,OAAO,CAAE,CAAE,CAAAxB,QAAA,eACzB7gB,IAAA,CAAC3E,IAAI,EAACinB,IAAI,MAACvB,EAAE,CAAE,CAAE,CAAAF,QAAA,cACf7gB,IAAA,CAAChF,SAAS,EACRipB,SAAS,MACTxjB,KAAK,CAAC,YAAY,CAClBoI,IAAI,CAAC,QAAQ,CACbwS,KAAK,CAAE,CAAA1P,cAAc,SAAdA,cAAc,iBAAdA,cAAc,CAAElD,MAAM,CAACC,CAAC,GAAI,CAAE,CACrCke,QAAQ,CAAGlZ,CAAC,EAAK9B,iBAAiB,CAACD,cAAc,CAAAsC,aAAA,CAAAA,aAAA,IAC5CtC,cAAc,MACjBlD,MAAM,CAAAwF,aAAA,CAAAA,aAAA,IAAMtC,cAAc,CAAClD,MAAM,MAAEC,CAAC,CAAE2R,QAAQ,CAAC3M,CAAC,CAACgE,MAAM,CAAC2J,KAAK,CAAC,EAAI,CAAC,EAAC,GAClE,IAAI,CAAE,CACVuI,MAAM,CAAC,QAAQ,CAChB,CAAC,CACE,CAAC,cACP5jB,IAAA,CAAC3E,IAAI,EAACinB,IAAI,MAACvB,EAAE,CAAE,CAAE,CAAAF,QAAA,cACf7gB,IAAA,CAAChF,SAAS,EACRipB,SAAS,MACTxjB,KAAK,CAAC,YAAY,CAClBoI,IAAI,CAAC,QAAQ,CACbwS,KAAK,CAAE,CAAA1P,cAAc,SAAdA,cAAc,iBAAdA,cAAc,CAAElD,MAAM,CAACE,CAAC,GAAI,CAAE,CACrCie,QAAQ,CAAGlZ,CAAC,EAAK9B,iBAAiB,CAACD,cAAc,CAAAsC,aAAA,CAAAA,aAAA,IAC5CtC,cAAc,MACjBlD,MAAM,CAAAwF,aAAA,CAAAA,aAAA,IAAMtC,cAAc,CAAClD,MAAM,MAAEE,CAAC,CAAE0R,QAAQ,CAAC3M,CAAC,CAACgE,MAAM,CAAC2J,KAAK,CAAC,EAAI,CAAC,EAAC,GAClE,IAAI,CAAE,CACVuI,MAAM,CAAC,QAAQ,CAChB,CAAC,CACE,CAAC,cACP5jB,IAAA,CAAC3E,IAAI,EAACinB,IAAI,MAACvB,EAAE,CAAE,CAAE,CAAAF,QAAA,cACf7gB,IAAA,CAAChF,SAAS,EACRipB,SAAS,MACTxjB,KAAK,CAAC,OAAO,CACboI,IAAI,CAAC,QAAQ,CACbwS,KAAK,CAAE,CAAA1P,cAAc,SAAdA,cAAc,iBAAdA,cAAc,CAAElD,MAAM,CAAClI,KAAK,GAAI,GAAI,CAC3CqmB,QAAQ,CAAGlZ,CAAC,EAAK9B,iBAAiB,CAACD,cAAc,CAAAsC,aAAA,CAAAA,aAAA,IAC5CtC,cAAc,MACjBlD,MAAM,CAAAwF,aAAA,CAAAA,aAAA,IAAMtC,cAAc,CAAClD,MAAM,MAAElI,KAAK,CAAE8Z,QAAQ,CAAC3M,CAAC,CAACgE,MAAM,CAAC2J,KAAK,CAAC,EAAI,GAAG,EAAC,GACxE,IAAI,CAAE,CACVuI,MAAM,CAAC,QAAQ,CAChB,CAAC,CACE,CAAC,cACP5jB,IAAA,CAAC3E,IAAI,EAACinB,IAAI,MAACvB,EAAE,CAAE,CAAE,CAAAF,QAAA,cACf7gB,IAAA,CAAChF,SAAS,EACRipB,SAAS,MACTxjB,KAAK,CAAC,QAAQ,CACdoI,IAAI,CAAC,QAAQ,CACbwS,KAAK,CAAE,CAAA1P,cAAc,SAAdA,cAAc,iBAAdA,cAAc,CAAElD,MAAM,CAACjI,MAAM,GAAI,GAAI,CAC5ComB,QAAQ,CAAGlZ,CAAC,EAAK9B,iBAAiB,CAACD,cAAc,CAAAsC,aAAA,CAAAA,aAAA,IAC5CtC,cAAc,MACjBlD,MAAM,CAAAwF,aAAA,CAAAA,aAAA,IAAMtC,cAAc,CAAClD,MAAM,MAAEjI,MAAM,CAAE6Z,QAAQ,CAAC3M,CAAC,CAACgE,MAAM,CAAC2J,KAAK,CAAC,EAAI,GAAG,EAAC,GACzE,IAAI,CAAE,CACVuI,MAAM,CAAC,QAAQ,CAChB,CAAC,CACE,CAAC,EACH,CAAC,EACH,CAAC,cAEP1jB,KAAA,CAAC7E,IAAI,EAACinB,IAAI,MAACvB,EAAE,CAAE,EAAG,CAAAF,QAAA,eAChB7gB,IAAA,CAAC/E,UAAU,EAAC0mB,OAAO,CAAC,IAAI,CAAC6F,YAAY,MAAA3G,QAAA,CAAC,gBAAc,CAAY,CAAC,cACjE3gB,KAAA,CAAC3D,WAAW,EAAC0nB,SAAS,MAACL,MAAM,CAAC,QAAQ,CAAA/C,QAAA,eACpC7gB,IAAA,CAACxD,UAAU,EAAAqkB,QAAA,CAAC,aAAW,CAAY,CAAC,cACpC3gB,KAAA,CAACzD,MAAM,EACL4e,KAAK,CAAE,CAAA1P,cAAc,SAAdA,cAAc,iBAAdA,cAAc,CAAE/C,MAAM,CAACC,IAAI,GAAI,UAAW,CACjD+d,QAAQ,CAAGlZ,CAAC,EAAK9B,iBAAiB,CAACD,cAAc,CAAAsC,aAAA,CAAAA,aAAA,IAC5CtC,cAAc,MACjB/C,MAAM,CAAAqF,aAAA,CAAAA,aAAA,IAAOtC,cAAc,CAAC/C,MAAM,MAAEC,IAAI,CAAE6E,CAAC,CAACgE,MAAM,CAAC2J,KAAY,EAAE,GAC/D,IAAI,CAAE,CAAAwF,QAAA,eAEV7gB,IAAA,CAACtD,QAAQ,EAAC2e,KAAK,CAAC,UAAU,CAAAwF,QAAA,CAAC,UAAQ,CAAU,CAAC,cAC9C7gB,IAAA,CAACtD,QAAQ,EAAC2e,KAAK,CAAC,SAAS,CAAAwF,QAAA,CAAC,SAAO,CAAU,CAAC,cAC5C7gB,IAAA,CAACtD,QAAQ,EAAC2e,KAAK,CAAC,KAAK,CAAAwF,QAAA,CAAC,KAAG,CAAU,CAAC,cACpC7gB,IAAA,CAACtD,QAAQ,EAAC2e,KAAK,CAAC,gBAAgB,CAAAwF,QAAA,CAAC,kBAAgB,CAAU,CAAC,EACtD,CAAC,EACE,CAAC,EACV,CAAC,CAEN,CAAAlV,cAAc,SAAdA,cAAc,iBAAdA,cAAc,CAAE/C,MAAM,CAACC,IAAI,IAAK,UAAU,eACzC7I,IAAA,CAAC3E,IAAI,EAACinB,IAAI,MAACvB,EAAE,CAAE,EAAG,CAAAF,QAAA,cAChB7gB,IAAA,CAAChF,SAAS,EACRipB,SAAS,MACTxjB,KAAK,CAAC,eAAe,CACrB4a,KAAK,CAAE1P,cAAc,CAAC/C,MAAM,CAACE,IAAI,EAAI,EAAG,CACxC8d,QAAQ,CAAGlZ,CAAC,EAAK9B,iBAAiB,CAACD,cAAc,CAAAsC,aAAA,CAAAA,aAAA,IAC5CtC,cAAc,MACjB/C,MAAM,CAAAqF,aAAA,CAAAA,aAAA,IAAOtC,cAAc,CAAC/C,MAAM,MAAEE,IAAI,CAAE4E,CAAC,CAACgE,MAAM,CAAC2J,KAAK,EAAE,GACxD,IAAI,CAAE,CACV6I,WAAW,CAAC,oBAAoB,CAChCN,MAAM,CAAC,QAAQ,CAChB,CAAC,CACE,CACP,CAEA,CAAAjY,cAAc,SAAdA,cAAc,iBAAdA,cAAc,CAAE/C,MAAM,CAACC,IAAI,IAAK,SAAS,eACxC7I,IAAA,CAAC3E,IAAI,EAACinB,IAAI,MAACvB,EAAE,CAAE,EAAG,CAAAF,QAAA,cAChB7gB,IAAA,CAAChF,SAAS,EACRipB,SAAS,MACTxjB,KAAK,CAAC,cAAc,CACpB4a,KAAK,CAAE1P,cAAc,CAAC/C,MAAM,CAACkQ,IAAI,EAAI,EAAG,CACxC8N,QAAQ,CAAGlZ,CAAC,EAAK9B,iBAAiB,CAACD,cAAc,CAAAsC,aAAA,CAAAA,aAAA,IAC5CtC,cAAc,MACjB/C,MAAM,CAAAqF,aAAA,CAAAA,aAAA,IAAOtC,cAAc,CAAC/C,MAAM,MAAEkQ,IAAI,CAAEpL,CAAC,CAACgE,MAAM,CAAC2J,KAAK,EAAE,GACxD,IAAI,CAAE,CACV6I,WAAW,CAAC,eAAe,CAC3BN,MAAM,CAAC,QAAQ,CAChB,CAAC,CACE,CACP,CAEA,CAAAjY,cAAc,SAAdA,cAAc,iBAAdA,cAAc,CAAE/C,MAAM,CAACC,IAAI,IAAK,KAAK,eACpC7I,IAAA,CAAC3E,IAAI,EAACinB,IAAI,MAACvB,EAAE,CAAE,EAAG,CAAAF,QAAA,cAChB7gB,IAAA,CAAChF,SAAS,EACRipB,SAAS,MACTxjB,KAAK,CAAC,KAAK,CACX4a,KAAK,CAAE1P,cAAc,CAAC/C,MAAM,CAACwE,GAAG,EAAI,EAAG,CACvCwZ,QAAQ,CAAGlZ,CAAC,EAAK,CACf,GAAI,CAAAN,GAAG,CAAGM,CAAC,CAACgE,MAAM,CAAC2J,KAAK,CACxB;AACA,GAAIjO,GAAG,EAAI,CAACA,GAAG,CAACgG,KAAK,CAAC,cAAc,CAAC,CAAE,CACrChG,GAAG,YAAAmB,MAAA,CAAcnB,GAAG,CAAE,CACxB,CACAxB,iBAAiB,CAACD,cAAc,CAAAsC,aAAA,CAAAA,aAAA,IAC3BtC,cAAc,MACjB/C,MAAM,CAAAqF,aAAA,CAAAA,aAAA,IAAOtC,cAAc,CAAC/C,MAAM,MAAEwE,GAAG,CAAEA,GAAG,EAAE,GAC5C,IAAI,CAAC,CACX,CAAE,CACF8W,WAAW,CAAC,qBAAqB,CACjCN,MAAM,CAAC,QAAQ,CACfO,UAAU,CAAC,qCAAqC,CAChDxhB,KAAK,CAAEsmB,OAAO,CAAC,CAAAtd,cAAc,SAAdA,cAAc,iBAAdA,cAAc,CAAE/C,MAAM,CAACwE,GAAG,GAAIzB,cAAc,CAAC/C,MAAM,CAACwE,GAAG,GAAK,EAAE,EAAI,CAACzB,cAAc,CAAC/C,MAAM,CAACwE,GAAG,CAACgG,KAAK,CAAC,cAAc,CAAC,CAAE,CACpI,CAAC,CACE,CACP,CAEA,CAAAzH,cAAc,SAAdA,cAAc,iBAAdA,cAAc,CAAE/C,MAAM,CAACC,IAAI,IAAK,gBAAgB,eAC/C3I,KAAA,CAAAE,SAAA,EAAAygB,QAAA,eACE7gB,IAAA,CAAC3E,IAAI,EAACinB,IAAI,MAACvB,EAAE,CAAE,CAAE,CAAAF,QAAA,cACf7gB,IAAA,CAAChF,SAAS,EACRipB,SAAS,MACTxjB,KAAK,CAAC,oBAAoB,CAC1B4a,KAAK,CAAE1P,cAAc,CAAC/C,MAAM,CAACyE,eAAe,EAAI,EAAG,CACnDuZ,QAAQ,CAAGlZ,CAAC,EAAK9B,iBAAiB,CAACD,cAAc,CAAAsC,aAAA,CAAAA,aAAA,IAC5CtC,cAAc,MACjB/C,MAAM,CAAAqF,aAAA,CAAAA,aAAA,IAAOtC,cAAc,CAAC/C,MAAM,MAAEyE,eAAe,CAAEK,CAAC,CAACgE,MAAM,CAAC2J,KAAK,EAAE,GACnE,IAAI,CAAE,CACV6I,WAAW,CAAC,WAAW,CACvBN,MAAM,CAAC,QAAQ,CACfO,UAAU,CAAC,uEAAuE,CAClFxhB,KAAK,CAAEgJ,cAAc,CAAC/C,MAAM,CAACyE,eAAe,CAAG,CAAC5J,uBAAuB,CAACkI,cAAc,CAAC/C,MAAM,CAACyE,eAAe,CAAC,CAAG,KAAM,CACxH,CAAC,CACE,CAAC,cACPrN,IAAA,CAAC3E,IAAI,EAACinB,IAAI,MAACvB,EAAE,CAAE,CAAE,CAAAF,QAAA,cACf7gB,IAAA,CAAChF,SAAS,EACRipB,SAAS,MACTxjB,KAAK,CAAC,aAAa,CACnB4a,KAAK,CAAE1P,cAAc,CAAC/C,MAAM,CAACE,IAAI,EAAI,EAAG,CACxC8d,QAAQ,CAAGlZ,CAAC,EAAK9B,iBAAiB,CAACD,cAAc,CAAAsC,aAAA,CAAAA,aAAA,IAC5CtC,cAAc,MACjB/C,MAAM,CAAAqF,aAAA,CAAAA,aAAA,IAAOtC,cAAc,CAAC/C,MAAM,MAAEE,IAAI,CAAE4E,CAAC,CAACgE,MAAM,CAAC2J,KAAK,EAAE,GACxD,IAAI,CAAE,CACV6I,WAAW,CAAC,gBAAgB,CAC5BN,MAAM,CAAC,QAAQ,CAChB,CAAC,CACE,CAAC,EACP,CACH,EACG,CAAC,CACM,CAAC,cAChB1jB,KAAA,CAACnF,aAAa,EAAA8lB,QAAA,eACZ7gB,IAAA,CAACrF,MAAM,EAACsnB,OAAO,CAAEA,CAAA,GAAMvW,oBAAoB,CAAC,KAAK,CAAE,CAAAmV,QAAA,CAAC,QAAM,CAAQ,CAAC,cACnE7gB,IAAA,CAACrF,MAAM,EACLsnB,OAAO,CAAEA,CAAA,GAAMtW,cAAc,EAAIkT,iBAAiB,CAAClT,cAAc,CAAE,CACnEgW,OAAO,CAAC,WAAW,CACnBO,QAAQ,CAAE,EAACvW,cAAc,SAAdA,cAAc,YAAAvJ,qBAAA,CAAduJ,cAAc,CAAElL,KAAK,UAAA2B,qBAAA,WAArBA,qBAAA,CAAuB8N,IAAI,CAAC,CAAC,CAAC,CAAA2Q,QAAA,CAC1C,cAED,CAAQ,CAAC,CACRlV,cAAc,eACb3L,IAAA,CAACrF,MAAM,EACLsnB,OAAO,CAAEA,CAAA,GAAMxF,mBAAmB,CAAC9Q,cAAc,CAACwB,EAAE,CAAE,CACtDwU,OAAO,CAAC,UAAU,CAClB9I,KAAK,CAAC,OAAO,CACbmJ,SAAS,cAAEhiB,IAAA,CAAC5C,MAAM,GAAE,CAAE,CAAAyjB,QAAA,CACvB,gBAED,CAAQ,CACT,EACY,CAAC,EACV,CAAC,cAGT3gB,KAAA,CAACjD,IAAI,EACHunB,IAAI,CAAE3X,WAAW,GAAK,IAAK,CAC3B4X,OAAO,CAAEpL,sBAAuB,CAChC6P,eAAe,CAAC,gBAAgB,CAChCC,cAAc,CACZtc,WAAW,GAAK,IAAI,CAChB,CAAEqN,GAAG,CAAErN,WAAW,CAACsK,MAAM,CAAE8C,IAAI,CAAEpN,WAAW,CAACqK,MAAO,CAAC,CACrD4F,SACL,CAAA+D,QAAA,eAED3gB,KAAA,CAACxD,QAAQ,EAACulB,OAAO,CAAEA,CAAA,GAAM,CAAApV,WAAW,SAAXA,WAAW,iBAAXA,WAAW,CAAEmK,OAAO,GAAIyC,iBAAiB,CAAC5M,WAAW,CAACmK,OAAO,CAAC7J,EAAE,CAAE,CAAA0T,QAAA,eACzF7gB,IAAA,CAAC9C,YAAY,EAAA2jB,QAAA,cACX7gB,IAAA,CAACzB,aAAa,EAACmjB,QAAQ,CAAC,OAAO,CAAE,CAAC,CACtB,CAAC,cACf1hB,IAAA,CAACjE,YAAY,EAAA8kB,QAAA,CAAC,cAAY,CAAc,CAAC,EACjC,CAAC,cACX3gB,KAAA,CAACxD,QAAQ,EAACulB,OAAO,CAAEA,CAAA,GAAM,CAAApV,WAAW,SAAXA,WAAW,iBAAXA,WAAW,CAAEmK,OAAO,GAAIsC,mBAAmB,CAACzM,WAAW,CAACmK,OAAO,CAAC7J,EAAE,CAAE,CAAA0T,QAAA,eAC3F7gB,IAAA,CAAC9C,YAAY,EAAA2jB,QAAA,cACX7gB,IAAA,CAAC5C,MAAM,EAACskB,QAAQ,CAAC,OAAO,CAAE,CAAC,CACf,CAAC,cACf1hB,IAAA,CAACjE,YAAY,EAAA8kB,QAAA,CAAC,gBAAc,CAAc,CAAC,EACnC,CAAC,EACP,CAAC,EACJ,CAAC,CAEV,CAAC,CAED,cAAe,CAAAlgB,eAAe","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}